<!DOCTYPE html>
<!-- Generated by Cython 3.0.0a11 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: ccluster.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { color: #000000; margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.cython .hll { background-color: #ffffcc }
.cython { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 3.0.0a11</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="ccluster.c">ccluster.c</a></p>
<div class="cython"><pre class="cython line score-0">&#xA0;<span class="">0001</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0002</span>: <span class="c">#!/usr/bin/env python3</span></pre>
<pre class='cython code score-8 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0003</span>: <span class="c">#cython: language_level=3</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0004</span>: <span class="c"># -*- coding: utf-8 -*-</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0005</span>: <span class="c"># distutils: language = c++</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0006</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0007</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0008</span>: <span class="k">import</span> <span class="nn">time</span></pre>
<pre class='cython code score-8 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_time, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 8, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_time, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 8, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0009</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0010</span>: <span class="k">import</span> <span class="nn">random</span></pre>
<pre class='cython code score-8 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_random, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_random, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0011</span>: <span class="k">import</span> <span class="nn">concurrent.futures</span></pre>
<pre class='cython code score-13 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_concurrent_futures, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_concurrent, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 11, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_tuple__38 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_concurrent, __pyx_n_s_futures);<span class='error_goto'> if (unlikely(!__pyx_tuple__38)) __PYX_ERR(0, 11, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__38);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__38);</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0012</span>: <span class="k">import</span> <span class="nn">concurrent.futures</span></pre>
<pre class='cython code score-8 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_concurrent_futures, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 12, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_concurrent, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 12, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0013</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0014</span>: <span class="k">import</span> <span class="nn">numpy</span></pre>
<pre class='cython code score-8 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_numpy, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 14, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_numpy, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 14, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0015</span>: <span class="k">cimport</span> <span class="nn">numpy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0016</span>: <span class="k">cimport</span> <span class="nn">cython</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0017</span>: <span class="n">numpy</span><span class="o">.</span><span class="n">import_array</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>__pyx_t_3 = __pyx_f_5numpy_import_array();<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 17, __pyx_L1_error)</span></pre><pre class="cython line score-0">&#xA0;<span class="">0018</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0019</span>: <span class="k">from</span> <span class="nn">cython.parallel</span> <span class="k">import</span> <span class="n">prange</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0020</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0021</span>: <span class="k">from</span> <span class="nn">libcpp.map</span> <span class="k">cimport</span> <span class="nb">map</span> <span class="k">as</span> <span class="n">mapp</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0022</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0023</span>: <span class="k">from</span> <span class="nn">libc.stdlib</span> <span class="k">cimport</span> <span class="n">calloc</span><span class="p">,</span> <span class="n">free</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0024</span>: <span class="k">from</span> <span class="nn">libc.stdio</span> <span class="k">cimport</span> <span class="n">FILE</span><span class="p">,</span> <span class="n">fopen</span><span class="p">,</span> <span class="n">fwrite</span><span class="p">,</span> <span class="n">fscanf</span><span class="p">,</span> <span class="n">fclose</span><span class="p">,</span> <span class="n">fprintf</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0025</span>: <span class="c"># cython: profile=True</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0026</span>: <span class="k">from</span> <span class="nn">sklearn.metrics.pairwise</span> <span class="k">import</span> <span class="n">euclidean_distances</span></pre>
<pre class='cython code score-19 '>__pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 26, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_euclidean_distances);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_euclidean_distances);<span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_euclidean_distances);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sklearn_metrics_pairwise, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 26, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_4, __pyx_n_s_euclidean_distances);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 26, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_euclidean_distances, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 26, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0027</span>: <span class="k">from</span> <span class="nn">scipy.spatial.distance</span> <span class="k">import</span> <span class="n">pdist</span><span class="p">,</span> <span class="n">squareform</span></pre>
<pre class='cython code score-29 '>__pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 27, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_pdist);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_pdist);<span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_n_s_pdist);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_squareform);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_squareform);<span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_n_s_squareform);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_spatial_distance, __pyx_t_4, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 27, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_pdist);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 27, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_pdist, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 27, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_squareform);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 27, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_squareform, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 27, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0028</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0029</span>: <span class="k">from</span> <span class="nn">sklearn.utils</span> <span class="k">import</span> <span class="n">check_array</span></pre>
<pre class='cython code score-19 '>__pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 29, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_check_array);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_check_array);<span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_check_array);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sklearn_utils, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 29, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_4, __pyx_n_s_check_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 29, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_check_array, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 29, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0030</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0031</span>: <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0032</span>: <span class="sd">Wraper for C EMD implementation</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0033</span>: <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0034</span>: <span class="k">from</span> <span class="nn">scipy.spatial.distance</span> <span class="k">import</span> <span class="n">cdist</span></pre>
<pre class='cython code score-19 '>__pyx_t_4 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 34, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_cdist);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_cdist);<span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_n_s_cdist);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_spatial_distance, __pyx_t_4, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 34, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_cdist);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 34, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_cdist, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 34, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0035</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0036</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0037</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0038</span>: <span class="k">ctypedef</span> <span class="n">numpy</span><span class="o">.</span><span class="n">uint8_t</span> <span class="n">uint8</span></pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_uint8_t __pyx_t_8ccluster_uint8;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0039</span>: <span class="k">ctypedef</span> <span class="n">numpy</span><span class="o">.</span><span class="n">uint16_t</span> <span class="n">uint16</span></pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_uint16_t __pyx_t_8ccluster_uint16;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0040</span>: <span class="k">ctypedef</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int16_t</span> <span class="n">int16</span></pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_int16_t __pyx_t_8ccluster_int16;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0041</span>: <span class="k">ctypedef</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int32_t</span> <span class="n">int32</span></pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_int32_t __pyx_t_8ccluster_int32;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0042</span>: <span class="k">ctypedef</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32_t</span> <span class="n">float32</span></pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_float32_t __pyx_t_8ccluster_float32;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0043</span>: <span class="k">ctypedef</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64_t</span> <span class="n">float64</span></pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_float64_t __pyx_t_8ccluster_float64;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0044</span>: <span class="k">ctypedef</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int64_t</span> <span class="n">int64</span></pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_int64_t __pyx_t_8ccluster_int64;</pre><pre class="cython line score-0">&#xA0;<span class="">0045</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0046</span>: <span class="k">ctypedef</span> <span class="n">numpy</span><span class="o">.</span><span class="n">npy_bool</span> <span class="n">boolean</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0047</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0048</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0049</span>: <span class="c">#################################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0050</span>: <span class="c"># The below code is taken from eval7 - https://pypi.org/project/eval7/</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0051</span>: <span class="c">#################################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0052</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0053</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0054</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;arrays.h&quot;</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0055</span>:     <span class="nb">unsigned</span> <span class="n">short</span> <span class="n">N_BITS_TABLE</span><span class="p">[</span><span class="mf">8192</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0056</span>:     <span class="nb">unsigned</span> <span class="n">short</span> <span class="n">STRAIGHT_TABLE</span><span class="p">[</span><span class="mf">8192</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0057</span>:     <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">TOP_FIVE_CARDS_TABLE</span><span class="p">[</span><span class="mf">8192</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0058</span>:     <span class="nb">unsigned</span> <span class="n">short</span> <span class="n">TOP_CARD_TABLE</span><span class="p">[</span><span class="mf">8192</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0059</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0060</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0061</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0062</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">CLUB_OFFSET</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_CLUB_OFFSET = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0063</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">DIAMOND_OFFSET</span> <span class="o">=</span> <span class="mf">13</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_DIAMOND_OFFSET = 13;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0064</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">HEART_OFFSET</span> <span class="o">=</span> <span class="mf">26</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HEART_OFFSET = 26;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0065</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">SPADE_OFFSET</span> <span class="o">=</span> <span class="mf">39</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_SPADE_OFFSET = 39;</pre><pre class="cython line score-0">&#xA0;<span class="">0066</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0067</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">HANDTYPE_SHIFT</span> <span class="o">=</span> <span class="mf">24</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_SHIFT = 24;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0068</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">TOP_CARD_SHIFT</span> <span class="o">=</span> <span class="mf">16</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_TOP_CARD_SHIFT = 16;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0069</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">SECOND_CARD_SHIFT</span> <span class="o">=</span> <span class="mf">12</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_SECOND_CARD_SHIFT = 12;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0070</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">THIRD_CARD_SHIFT</span> <span class="o">=</span> <span class="mf">8</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_THIRD_CARD_SHIFT = 8;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0071</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">CARD_WIDTH</span> <span class="o">=</span> <span class="mf">4</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_CARD_WIDTH = 4;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0072</span>: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">TOP_CARD_MASK</span> <span class="o">=</span> <span class="mf">0</span><span class="n">x000F0000</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_TOP_CARD_MASK = 0x000F0000;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0073</span>: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">SECOND_CARD_MASK</span> <span class="o">=</span> <span class="mf">0</span><span class="n">x0000F000</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_SECOND_CARD_MASK = 0x0000F000;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0074</span>: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">FIFTH_CARD_MASK</span> <span class="o">=</span> <span class="mf">0</span><span class="n">x0000000F</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_FIFTH_CARD_MASK = 0x0000000F;</pre><pre class="cython line score-0">&#xA0;<span class="">0075</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0076</span>: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">HANDTYPE_VALUE_STRAIGHTFLUSH</span> <span class="o">=</span> <span class="p">((</span><span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="mf">8</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">HANDTYPE_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_VALUE_STRAIGHTFLUSH = (((unsigned int)8) &lt;&lt; __pyx_v_8ccluster_HANDTYPE_SHIFT);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0077</span>: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">HANDTYPE_VALUE_FOUR_OF_A_KIND</span> <span class="o">=</span> <span class="p">((</span><span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="mf">7</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">HANDTYPE_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_VALUE_FOUR_OF_A_KIND = (((unsigned int)7) &lt;&lt; __pyx_v_8ccluster_HANDTYPE_SHIFT);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0078</span>: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">HANDTYPE_VALUE_FULLHOUSE</span> <span class="o">=</span> <span class="p">((</span><span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="mf">6</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">HANDTYPE_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_VALUE_FULLHOUSE = (((unsigned int)6) &lt;&lt; __pyx_v_8ccluster_HANDTYPE_SHIFT);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0079</span>: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">HANDTYPE_VALUE_FLUSH</span> <span class="o">=</span> <span class="p">((</span><span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="mf">5</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">HANDTYPE_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_VALUE_FLUSH = (((unsigned int)5) &lt;&lt; __pyx_v_8ccluster_HANDTYPE_SHIFT);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0080</span>: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">HANDTYPE_VALUE_STRAIGHT</span> <span class="o">=</span> <span class="p">((</span><span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="mf">4</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">HANDTYPE_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_VALUE_STRAIGHT = (((unsigned int)4) &lt;&lt; __pyx_v_8ccluster_HANDTYPE_SHIFT);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0081</span>: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">HANDTYPE_VALUE_TRIPS</span> <span class="o">=</span> <span class="p">((</span><span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="mf">3</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">HANDTYPE_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_VALUE_TRIPS = (((unsigned int)3) &lt;&lt; __pyx_v_8ccluster_HANDTYPE_SHIFT);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0082</span>: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">HANDTYPE_VALUE_TWOPAIR</span> <span class="o">=</span> <span class="p">((</span><span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="mf">2</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">HANDTYPE_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_VALUE_TWOPAIR = (((unsigned int)2) &lt;&lt; __pyx_v_8ccluster_HANDTYPE_SHIFT);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0083</span>: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">HANDTYPE_VALUE_PAIR</span> <span class="o">=</span> <span class="p">((</span><span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="mf">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">HANDTYPE_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_VALUE_PAIR = (((unsigned int)1) &lt;&lt; __pyx_v_8ccluster_HANDTYPE_SHIFT);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0084</span>: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">HANDTYPE_VALUE_HIGHCARD</span> <span class="o">=</span> <span class="p">((</span><span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="mf">0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">HANDTYPE_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_VALUE_HIGHCARD = (((unsigned int)0) &lt;&lt; __pyx_v_8ccluster_HANDTYPE_SHIFT);</pre><pre class="cython line score-0">&#xA0;<span class="">0085</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0086</span>: <span class="c">#@cython.profile(True)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0087</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0088</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0089</span>: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">cy_evaluate</span><span class="p">(</span><span class="nb">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">cards</span><span class="p">,</span> <span class="nb">unsigned</span> <span class="nb">int</span> <span class="n">num_cards</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static unsigned int __pyx_f_8ccluster_cy_evaluate(unsigned PY_LONG_LONG __pyx_v_cards, unsigned int __pyx_v_num_cards) {unsigned int __pyx_v_retval;unsigned int __pyx_v_four_mask;unsigned int __pyx_v_three_mask;unsigned int __pyx_v_two_mask;unsigned int __pyx_v_sc;unsigned int __pyx_v_sd;unsigned int __pyx_v_sh;unsigned int __pyx_v_ss;unsigned int __pyx_v_ranks;unsigned int __pyx_v_n_ranks;unsigned int __pyx_v_n_dups;unsigned int __pyx_v_st;unsigned int __pyx_v_t;unsigned int __pyx_v_kickers;unsigned int __pyx_v_second;unsigned int __pyx_v_tc;unsigned int __pyx_v_top;unsigned int __pyx_r;/* function exit code */__pyx_L0:;return __pyx_r;}</pre><pre class="cython line score-0">&#xA0;<span class="">0090</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0091</span>: <span class="sd">    7-card evaluation function based on Keith Rule&#39;s port of PokerEval.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0092</span>: <span class="sd">    Pure Python: 20000 calls in 0.176 seconds (113636 calls/sec)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0093</span>: <span class="sd">    Cython: 20000 calls in 0.044 seconds (454545 calls/sec)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0094</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0095</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">retval</span> <span class="o">=</span> <span class="mf">0</span><span class="p">,</span> <span class="n">four_mask</span><span class="p">,</span> <span class="n">three_mask</span><span class="p">,</span> <span class="n">two_mask</span></pre>
<pre class='cython code score-0 '>__pyx_v_retval = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0096</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0097</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">sc</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">((</span><span class="n">cards</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">CLUB_OFFSET</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mf">0</span><span class="n">x1fffUL</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_sc = ((unsigned int)((__pyx_v_cards &gt;&gt; __pyx_v_8ccluster_CLUB_OFFSET) &amp; 0x1fffUL));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0098</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">sd</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">((</span><span class="n">cards</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">DIAMOND_OFFSET</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mf">0</span><span class="n">x1fffUL</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_sd = ((unsigned int)((__pyx_v_cards &gt;&gt; __pyx_v_8ccluster_DIAMOND_OFFSET) &amp; 0x1fffUL));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0099</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">sh</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">((</span><span class="n">cards</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">HEART_OFFSET</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mf">0</span><span class="n">x1fffUL</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_sh = ((unsigned int)((__pyx_v_cards &gt;&gt; __pyx_v_8ccluster_HEART_OFFSET) &amp; 0x1fffUL));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0100</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">ss</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">((</span><span class="n">cards</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">SPADE_OFFSET</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mf">0</span><span class="n">x1fffUL</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_ss = ((unsigned int)((__pyx_v_cards &gt;&gt; __pyx_v_8ccluster_SPADE_OFFSET) &amp; 0x1fffUL));</pre><pre class="cython line score-0">&#xA0;<span class="">0101</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0102</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">ranks</span> <span class="o">=</span> <span class="n">sc</span> <span class="o">|</span> <span class="n">sd</span> <span class="o">|</span> <span class="n">sh</span> <span class="o">|</span> <span class="n">ss</span></pre>
<pre class='cython code score-0 '>__pyx_v_ranks = (((__pyx_v_sc | __pyx_v_sd) | __pyx_v_sh) | __pyx_v_ss);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0103</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">n_ranks</span> <span class="o">=</span> <span class="n">N_BITS_TABLE</span><span class="p">[</span><span class="n">ranks</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_v_n_ranks = (N_BITS_TABLE[__pyx_v_ranks]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0104</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">n_dups</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">num_cards</span> <span class="o">-</span> <span class="n">n_ranks</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_n_dups = ((unsigned int)(__pyx_v_num_cards - __pyx_v_n_ranks));</pre><pre class="cython line score-0">&#xA0;<span class="">0105</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0106</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">st</span><span class="p">,</span> <span class="nf">t</span><span class="p">,</span> <span class="nf">kickers</span><span class="p">,</span> <span class="nf">second</span><span class="p">,</span> <span class="nf">tc</span><span class="p">,</span> <span class="nf">top</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0107</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0108</span>:     <span class="k">if</span> <span class="n">n_ranks</span> <span class="o">&gt;=</span> <span class="mf">5</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = (__pyx_v_n_ranks &gt;= 5);if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0109</span>:         <span class="k">if</span> <span class="n">N_BITS_TABLE</span><span class="p">[</span><span class="n">ss</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">5</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = ((N_BITS_TABLE[__pyx_v_ss]) &gt;= 5);if (__pyx_t_1) {goto __pyx_L4;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0110</span>:             <span class="k">if</span> <span class="n">STRAIGHT_TABLE</span><span class="p">[</span><span class="n">ss</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = ((STRAIGHT_TABLE[__pyx_v_ss]) != 0);if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0111</span>:                 <span class="k">return</span> <span class="n">HANDTYPE_VALUE_STRAIGHTFLUSH</span> <span class="o">+</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">STRAIGHT_TABLE</span><span class="p">[</span><span class="n">ss</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">TOP_CARD_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_r = (__pyx_v_8ccluster_HANDTYPE_VALUE_STRAIGHTFLUSH + ((unsigned int)((STRAIGHT_TABLE[__pyx_v_ss]) &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT)));goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0112</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0113</span>:                 <span class="n">retval</span> <span class="o">=</span> <span class="n">HANDTYPE_VALUE_FLUSH</span> <span class="o">+</span> <span class="n">TOP_FIVE_CARDS_TABLE</span><span class="p">[</span><span class="n">ss</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_v_retval = (__pyx_v_8ccluster_HANDTYPE_VALUE_FLUSH + (TOP_FIVE_CARDS_TABLE[__pyx_v_ss]));}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0114</span>:         <span class="k">elif</span> <span class="n">N_BITS_TABLE</span><span class="p">[</span><span class="n">sc</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">5</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = ((N_BITS_TABLE[__pyx_v_sc]) &gt;= 5);if (__pyx_t_1) {goto __pyx_L4;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0115</span>:             <span class="k">if</span> <span class="n">STRAIGHT_TABLE</span><span class="p">[</span><span class="n">sc</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = ((STRAIGHT_TABLE[__pyx_v_sc]) != 0);if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0116</span>:                 <span class="k">return</span> <span class="n">HANDTYPE_VALUE_STRAIGHTFLUSH</span> <span class="o">+</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">STRAIGHT_TABLE</span><span class="p">[</span><span class="n">sc</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">TOP_CARD_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_r = (__pyx_v_8ccluster_HANDTYPE_VALUE_STRAIGHTFLUSH + ((unsigned int)((STRAIGHT_TABLE[__pyx_v_sc]) &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT)));goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0117</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0118</span>:                 <span class="n">retval</span> <span class="o">=</span> <span class="n">HANDTYPE_VALUE_FLUSH</span> <span class="o">+</span> <span class="n">TOP_FIVE_CARDS_TABLE</span><span class="p">[</span><span class="n">sc</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_v_retval = (__pyx_v_8ccluster_HANDTYPE_VALUE_FLUSH + (TOP_FIVE_CARDS_TABLE[__pyx_v_sc]));}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0119</span>:         <span class="k">elif</span> <span class="n">N_BITS_TABLE</span><span class="p">[</span><span class="n">sd</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">5</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = ((N_BITS_TABLE[__pyx_v_sd]) &gt;= 5);if (__pyx_t_1) {goto __pyx_L4;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0120</span>:             <span class="k">if</span> <span class="n">STRAIGHT_TABLE</span><span class="p">[</span><span class="n">sd</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = ((STRAIGHT_TABLE[__pyx_v_sd]) != 0);if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0121</span>:                 <span class="k">return</span> <span class="n">HANDTYPE_VALUE_STRAIGHTFLUSH</span> <span class="o">+</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">STRAIGHT_TABLE</span><span class="p">[</span><span class="n">sd</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">TOP_CARD_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_r = (__pyx_v_8ccluster_HANDTYPE_VALUE_STRAIGHTFLUSH + ((unsigned int)((STRAIGHT_TABLE[__pyx_v_sd]) &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT)));goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0122</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0123</span>:                 <span class="n">retval</span> <span class="o">=</span> <span class="n">HANDTYPE_VALUE_FLUSH</span> <span class="o">+</span> <span class="n">TOP_FIVE_CARDS_TABLE</span><span class="p">[</span><span class="n">sd</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_v_retval = (__pyx_v_8ccluster_HANDTYPE_VALUE_FLUSH + (TOP_FIVE_CARDS_TABLE[__pyx_v_sd]));}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0124</span>:         <span class="k">elif</span> <span class="n">N_BITS_TABLE</span><span class="p">[</span><span class="n">sh</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">5</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = ((N_BITS_TABLE[__pyx_v_sh]) &gt;= 5);if (__pyx_t_1) {goto __pyx_L4;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0125</span>:             <span class="k">if</span> <span class="n">STRAIGHT_TABLE</span><span class="p">[</span><span class="n">sh</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = ((STRAIGHT_TABLE[__pyx_v_sh]) != 0);if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0126</span>:                 <span class="k">return</span> <span class="n">HANDTYPE_VALUE_STRAIGHTFLUSH</span> <span class="o">+</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">STRAIGHT_TABLE</span><span class="p">[</span><span class="n">sh</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">TOP_CARD_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_r = (__pyx_v_8ccluster_HANDTYPE_VALUE_STRAIGHTFLUSH + ((unsigned int)((STRAIGHT_TABLE[__pyx_v_sh]) &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT)));goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0127</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0128</span>:                 <span class="n">retval</span> <span class="o">=</span> <span class="n">HANDTYPE_VALUE_FLUSH</span> <span class="o">+</span> <span class="n">TOP_FIVE_CARDS_TABLE</span><span class="p">[</span><span class="n">sh</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_v_retval = (__pyx_v_8ccluster_HANDTYPE_VALUE_FLUSH + (TOP_FIVE_CARDS_TABLE[__pyx_v_sh]));}</pre><pre class="cython line score-0">&#xA0;<span class="">0129</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0130</span>:             <span class="n">st</span> <span class="o">=</span> <span class="n">STRAIGHT_TABLE</span><span class="p">[</span><span class="n">ranks</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_v_st = (STRAIGHT_TABLE[__pyx_v_ranks]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0131</span>:             <span class="k">if</span> <span class="n">st</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = (__pyx_v_st != 0);if (__pyx_t_1) {}}__pyx_L4:;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0132</span>:                 <span class="n">retval</span> <span class="o">=</span> <span class="n">HANDTYPE_VALUE_STRAIGHT</span> <span class="o">+</span> <span class="p">(</span><span class="n">st</span> <span class="o">&lt;&lt;</span> <span class="n">TOP_CARD_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_retval = (__pyx_v_8ccluster_HANDTYPE_VALUE_STRAIGHT + (__pyx_v_st &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT));</pre><pre class="cython line score-0">&#xA0;<span class="">0133</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0134</span>:         <span class="k">if</span> <span class="n">retval</span> <span class="o">!=</span> <span class="mf">0</span> <span class="ow">and</span> <span class="n">n_dups</span> <span class="o">&lt;</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_2 = (__pyx_v_retval != 0);if (__pyx_t_2) {} else {__pyx_t_1 = __pyx_t_2;goto __pyx_L11_bool_binop_done;}__pyx_t_2 = (__pyx_v_n_dups &lt; 3);__pyx_t_1 = __pyx_t_2;__pyx_L11_bool_binop_done:;if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0135</span>:             <span class="k">return</span> <span class="n">retval</span></pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_v_retval;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0136</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0137</span>:     <span class="k">if</span> <span class="n">n_dups</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>switch (__pyx_v_n_dups) {case 0:break;case 1:</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0138</span>:         <span class="k">return</span> <span class="n">HANDTYPE_VALUE_HIGHCARD</span> <span class="o">+</span> <span class="n">TOP_FIVE_CARDS_TABLE</span><span class="p">[</span><span class="n">ranks</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_r = (__pyx_v_8ccluster_HANDTYPE_VALUE_HIGHCARD + (TOP_FIVE_CARDS_TABLE[__pyx_v_ranks]));goto __pyx_L0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0139</span>:     <span class="k">elif</span> <span class="n">n_dups</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>break;case 2:</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0140</span>:         <span class="n">two_mask</span> <span class="o">=</span> <span class="n">ranks</span> <span class="o">^</span> <span class="p">(</span><span class="n">sc</span> <span class="o">^</span> <span class="n">sd</span> <span class="o">^</span> <span class="n">sh</span> <span class="o">^</span> <span class="n">ss</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_two_mask = (__pyx_v_ranks ^ (((__pyx_v_sc ^ __pyx_v_sd) ^ __pyx_v_sh) ^ __pyx_v_ss));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0141</span>:         <span class="n">retval</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">HANDTYPE_VALUE_PAIR</span> <span class="o">+</span> <span class="p">(</span><span class="n">TOP_CARD_TABLE</span><span class="p">[</span><span class="n">two_mask</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">TOP_CARD_SHIFT</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>__pyx_v_retval = ((unsigned int)(__pyx_v_8ccluster_HANDTYPE_VALUE_PAIR + ((TOP_CARD_TABLE[__pyx_v_two_mask]) &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT)));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0142</span>:         <span class="n">t</span> <span class="o">=</span> <span class="n">ranks</span> <span class="o">^</span> <span class="n">two_mask</span></pre>
<pre class='cython code score-0 '>__pyx_v_t = (__pyx_v_ranks ^ __pyx_v_two_mask);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0143</span>:         <span class="n">kickers</span> <span class="o">=</span> <span class="p">(</span><span class="n">TOP_FIVE_CARDS_TABLE</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">CARD_WIDTH</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">FIFTH_CARD_MASK</span></pre>
<pre class='cython code score-0 '>__pyx_v_kickers = (((TOP_FIVE_CARDS_TABLE[__pyx_v_t]) &gt;&gt; __pyx_v_8ccluster_CARD_WIDTH) &amp; (~__pyx_v_8ccluster_FIFTH_CARD_MASK));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0144</span>:         <span class="n">retval</span> <span class="o">+=</span> <span class="n">kickers</span></pre>
<pre class='cython code score-0 '>__pyx_v_retval = (__pyx_v_retval + __pyx_v_kickers);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0145</span>:         <span class="k">return</span> <span class="n">retval</span></pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_v_retval;goto __pyx_L0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0146</span>:     <span class="k">elif</span> <span class="n">n_dups</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>break;default:</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0147</span>:         <span class="n">two_mask</span> <span class="o">=</span> <span class="n">ranks</span> <span class="o">^</span> <span class="p">(</span><span class="n">sc</span> <span class="o">^</span> <span class="n">sd</span> <span class="o">^</span> <span class="n">sh</span> <span class="o">^</span> <span class="n">ss</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_two_mask = (__pyx_v_ranks ^ (((__pyx_v_sc ^ __pyx_v_sd) ^ __pyx_v_sh) ^ __pyx_v_ss));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0148</span>:         <span class="k">if</span> <span class="n">two_mask</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = (__pyx_v_two_mask != 0);if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0149</span>:             <span class="n">t</span> <span class="o">=</span> <span class="n">ranks</span> <span class="o">^</span> <span class="n">two_mask</span></pre>
<pre class='cython code score-0 '>__pyx_v_t = (__pyx_v_ranks ^ __pyx_v_two_mask);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0150</span>:             <span class="n">retval</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">HANDTYPE_VALUE_TWOPAIR</span></pre>
<pre class='cython code score-0 '>__pyx_v_retval = ((unsigned int)((__pyx_v_8ccluster_HANDTYPE_VALUE_TWOPAIR + ((TOP_FIVE_CARDS_TABLE[__pyx_v_two_mask]) &amp; (__pyx_v_8ccluster_TOP_CARD_MASK | __pyx_v_8ccluster_SECOND_CARD_MASK))) + ((TOP_CARD_TABLE[__pyx_v_t]) &lt;&lt; __pyx_v_8ccluster_THIRD_CARD_SHIFT)));</pre><pre class="cython line score-0">&#xA0;<span class="">0151</span>:                 <span class="o">+</span> <span class="p">(</span><span class="n">TOP_FIVE_CARDS_TABLE</span><span class="p">[</span><span class="n">two_mask</span><span class="p">]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0152</span>:                 <span class="o">&amp;</span> <span class="p">(</span><span class="n">TOP_CARD_MASK</span> <span class="o">|</span> <span class="n">SECOND_CARD_MASK</span><span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0153</span>:                 <span class="o">+</span> <span class="p">(</span><span class="n">TOP_CARD_TABLE</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">THIRD_CARD_SHIFT</span><span class="p">))</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0154</span>:             <span class="k">return</span> <span class="n">retval</span></pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_v_retval;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0155</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0156</span>:             <span class="n">three_mask</span> <span class="o">=</span> <span class="p">((</span><span class="n">sc</span> <span class="o">&amp;</span> <span class="n">sd</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">sh</span> <span class="o">&amp;</span> <span class="n">ss</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">sc</span> <span class="o">&amp;</span> <span class="n">sh</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">sd</span> <span class="o">&amp;</span> <span class="n">ss</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_v_three_mask = (((__pyx_v_sc &amp; __pyx_v_sd) | (__pyx_v_sh &amp; __pyx_v_ss)) &amp; ((__pyx_v_sc &amp; __pyx_v_sh) | (__pyx_v_sd &amp; __pyx_v_ss)));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0157</span>:             <span class="n">retval</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">HANDTYPE_VALUE_TRIPS</span> <span class="o">+</span> <span class="p">(</span><span class="n">TOP_CARD_TABLE</span><span class="p">[</span><span class="n">three_mask</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">TOP_CARD_SHIFT</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>__pyx_v_retval = ((unsigned int)(__pyx_v_8ccluster_HANDTYPE_VALUE_TRIPS + ((TOP_CARD_TABLE[__pyx_v_three_mask]) &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT)));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0158</span>:             <span class="n">t</span> <span class="o">=</span> <span class="n">ranks</span> <span class="o">^</span> <span class="n">three_mask</span></pre>
<pre class='cython code score-0 '>__pyx_v_t = (__pyx_v_ranks ^ __pyx_v_three_mask);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0159</span>:             <span class="n">second</span> <span class="o">=</span> <span class="n">TOP_CARD_TABLE</span><span class="p">[</span><span class="n">t</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_v_second = (TOP_CARD_TABLE[__pyx_v_t]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0160</span>:             <span class="n">retval</span> <span class="o">+=</span> <span class="p">(</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="n">SECOND_CARD_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_retval = (__pyx_v_retval + (__pyx_v_second &lt;&lt; __pyx_v_8ccluster_SECOND_CARD_SHIFT));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0161</span>:             <span class="n">t</span> <span class="o">^=</span> <span class="p">(</span><span class="mf">1</span><span class="n">U</span> <span class="o">&lt;&lt;</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="n">second</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_t = (__pyx_v_t ^ (1U &lt;&lt; ((int)__pyx_v_second)));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0162</span>:             <span class="n">retval</span> <span class="o">+=</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">TOP_CARD_TABLE</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">THIRD_CARD_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_retval = (__pyx_v_retval + ((unsigned int)((TOP_CARD_TABLE[__pyx_v_t]) &lt;&lt; __pyx_v_8ccluster_THIRD_CARD_SHIFT)));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0163</span>:             <span class="k">return</span> <span class="n">retval</span></pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_v_retval;goto __pyx_L0;}</pre><pre class="cython line score-0">&#xA0;<span class="">0164</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0165</span>:         <span class="n">four_mask</span> <span class="o">=</span> <span class="n">sh</span> <span class="o">&amp;</span> <span class="n">sd</span> <span class="o">&amp;</span> <span class="n">sc</span> <span class="o">&amp;</span> <span class="n">ss</span></pre>
<pre class='cython code score-0 '>__pyx_v_four_mask = (((__pyx_v_sh &amp; __pyx_v_sd) &amp; __pyx_v_sc) &amp; __pyx_v_ss);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0166</span>:         <span class="k">if</span> <span class="n">four_mask</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = (__pyx_v_four_mask != 0);if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0167</span>:             <span class="n">tc</span> <span class="o">=</span> <span class="n">TOP_CARD_TABLE</span><span class="p">[</span><span class="n">four_mask</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_v_tc = (TOP_CARD_TABLE[__pyx_v_four_mask]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0168</span>:             <span class="n">retval</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">HANDTYPE_VALUE_FOUR_OF_A_KIND</span></pre>
<pre class='cython code score-0 '>__pyx_v_retval = ((unsigned int)((__pyx_v_8ccluster_HANDTYPE_VALUE_FOUR_OF_A_KIND + (__pyx_v_tc &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT)) + ((TOP_CARD_TABLE[(__pyx_v_ranks ^ (1U &lt;&lt; ((int)__pyx_v_tc)))]) &lt;&lt; __pyx_v_8ccluster_SECOND_CARD_SHIFT)));</pre><pre class="cython line score-0">&#xA0;<span class="">0169</span>:                 <span class="o">+</span> <span class="p">(</span><span class="n">tc</span> <span class="o">&lt;&lt;</span> <span class="n">TOP_CARD_SHIFT</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0170</span>:                 <span class="o">+</span> <span class="p">((</span><span class="n">TOP_CARD_TABLE</span><span class="p">[</span><span class="n">ranks</span> <span class="o">^</span> <span class="p">(</span><span class="mf">1</span><span class="n">U</span> <span class="o">&lt;&lt;</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="n">tc</span><span class="p">)])</span> <span class="o">&lt;&lt;</span> <span class="n">SECOND_CARD_SHIFT</span><span class="p">))</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0171</span>:             <span class="k">return</span> <span class="n">retval</span></pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_v_retval;goto __pyx_L0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0172</span>:         <span class="n">two_mask</span> <span class="o">=</span> <span class="n">ranks</span> <span class="o">^</span> <span class="p">(</span><span class="n">sc</span> <span class="o">^</span> <span class="n">sd</span> <span class="o">^</span> <span class="n">sh</span> <span class="o">^</span> <span class="n">ss</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_two_mask = (__pyx_v_ranks ^ (((__pyx_v_sc ^ __pyx_v_sd) ^ __pyx_v_sh) ^ __pyx_v_ss));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0173</span>:         <span class="k">if</span> <span class="n">N_BITS_TABLE</span><span class="p">[</span><span class="n">two_mask</span><span class="p">]</span> <span class="o">!=</span> <span class="n">n_dups</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = ((N_BITS_TABLE[__pyx_v_two_mask]) != __pyx_v_n_dups);if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0174</span>:             <span class="n">three_mask</span> <span class="o">=</span> <span class="p">((</span><span class="n">sc</span> <span class="o">&amp;</span> <span class="n">sd</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">sh</span> <span class="o">&amp;</span> <span class="n">ss</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">((</span><span class="n">sc</span> <span class="o">&amp;</span> <span class="n">sh</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">sd</span> <span class="o">&amp;</span> <span class="n">ss</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>__pyx_v_three_mask = (((__pyx_v_sc &amp; __pyx_v_sd) | (__pyx_v_sh &amp; __pyx_v_ss)) &amp; ((__pyx_v_sc &amp; __pyx_v_sh) | (__pyx_v_sd &amp; __pyx_v_ss)));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0175</span>:             <span class="n">retval</span> <span class="o">=</span> <span class="n">HANDTYPE_VALUE_FULLHOUSE</span></pre>
<pre class='cython code score-0 '>__pyx_v_retval = __pyx_v_8ccluster_HANDTYPE_VALUE_FULLHOUSE;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0176</span>:             <span class="n">tc</span> <span class="o">=</span> <span class="n">TOP_CARD_TABLE</span><span class="p">[</span><span class="n">three_mask</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_v_tc = (TOP_CARD_TABLE[__pyx_v_three_mask]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0177</span>:             <span class="n">retval</span> <span class="o">+=</span> <span class="p">(</span><span class="n">tc</span> <span class="o">&lt;&lt;</span> <span class="n">TOP_CARD_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_retval = (__pyx_v_retval + (__pyx_v_tc &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0178</span>:             <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">two_mask</span> <span class="o">|</span> <span class="n">three_mask</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="mf">1</span><span class="n">U</span> <span class="o">&lt;&lt;</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="n">tc</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_t = ((__pyx_v_two_mask | __pyx_v_three_mask) ^ (1U &lt;&lt; ((int)__pyx_v_tc)));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0179</span>:             <span class="n">retval</span> <span class="o">+=</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">TOP_CARD_TABLE</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">SECOND_CARD_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_retval = (__pyx_v_retval + ((unsigned int)((TOP_CARD_TABLE[__pyx_v_t]) &lt;&lt; __pyx_v_8ccluster_SECOND_CARD_SHIFT)));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0180</span>:             <span class="k">return</span> <span class="n">retval</span></pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_v_retval;goto __pyx_L0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0181</span>:         <span class="k">if</span> <span class="n">retval</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = (__pyx_v_retval != 0);if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0182</span>:             <span class="k">return</span> <span class="n">retval</span></pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_v_retval;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0183</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0184</span>:             <span class="n">retval</span> <span class="o">=</span> <span class="n">HANDTYPE_VALUE_TWOPAIR</span></pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_v_retval = __pyx_v_8ccluster_HANDTYPE_VALUE_TWOPAIR;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0185</span>:             <span class="n">top</span> <span class="o">=</span> <span class="n">TOP_CARD_TABLE</span><span class="p">[</span><span class="n">two_mask</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_v_top = (TOP_CARD_TABLE[__pyx_v_two_mask]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0186</span>:             <span class="n">retval</span> <span class="o">+=</span> <span class="p">(</span><span class="n">top</span> <span class="o">&lt;&lt;</span> <span class="n">TOP_CARD_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_retval = (__pyx_v_retval + (__pyx_v_top &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0187</span>:             <span class="n">second</span> <span class="o">=</span> <span class="n">TOP_CARD_TABLE</span><span class="p">[</span><span class="n">two_mask</span> <span class="o">^</span> <span class="p">(</span><span class="mf">1</span> <span class="o">&lt;&lt;</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="n">top</span><span class="p">)]</span></pre>
<pre class='cython code score-0 '>__pyx_v_second = (TOP_CARD_TABLE[(__pyx_v_two_mask ^ (1 &lt;&lt; ((int)__pyx_v_top)))]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0188</span>:             <span class="n">retval</span> <span class="o">+=</span> <span class="p">(</span><span class="n">second</span> <span class="o">&lt;&lt;</span> <span class="n">SECOND_CARD_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_retval = (__pyx_v_retval + (__pyx_v_second &lt;&lt; __pyx_v_8ccluster_SECOND_CARD_SHIFT));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0189</span>:             <span class="n">retval</span> <span class="o">+=</span> <span class="o">&lt;</span><span class="nb">unsigned</span> <span class="nb">int</span><span class="o">&gt;</span><span class="p">((</span><span class="n">TOP_CARD_TABLE</span><span class="p">[</span><span class="n">ranks</span> <span class="o">^</span> <span class="p">(</span><span class="mf">1</span><span class="n">U</span> <span class="o">&lt;&lt;</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="n">top</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="mf">1</span> <span class="o">&lt;&lt;</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="n">second</span><span class="p">)])</span> <span class="o">&lt;&lt;</span> <span class="n">THIRD_CARD_SHIFT</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_retval = (__pyx_v_retval + ((unsigned int)((TOP_CARD_TABLE[((__pyx_v_ranks ^ (1U &lt;&lt; ((int)__pyx_v_top))) ^ (1 &lt;&lt; ((int)__pyx_v_second)))]) &lt;&lt; __pyx_v_8ccluster_THIRD_CARD_SHIFT)));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0190</span>:             <span class="k">return</span> <span class="n">retval</span></pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_v_retval;goto __pyx_L0;}break;}</pre><pre class="cython line score-0">&#xA0;<span class="">0191</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0192</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0193</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0194</span>: <span class="c">#####################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0195</span>: <span class="c">#####################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0196</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0197</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0198</span>: <span class="c">######################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0199</span>: <span class="c"># https://github.com/obachem/kmc2/blob/master/kmc2.pyx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0200</span>: <span class="c"># </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0201</span>: <span class="c">###################### </span></pre>
<pre class="cython line score-127" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0202</span>: <span class="k">def</span> <span class="nf">kmc2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">chain_length</span><span class="o">=</span><span class="mf">200</span><span class="p">,</span> <span class="n">afkmc2</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre>
<pre class='cython code score-127 '>/* Python wrapper */static PyObject *__pyx_pw_8ccluster_1kmc2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8ccluster_kmc2, "Cython implementation of k-MC2 and AFK-MC2 seeding\n    \n    Args:\n      X: (n,d)-shaped numpy.ndarray with data points (or scipy CSR matrix)\n      k: number of cluster centers\n      chain_length: length of the MCMC chain\n      afkmc2: Whether to run AFK-MC2 (if True) or vanilla K-MC2 (if False)\n      random_state: numpy.random.RandomState instance or integer to be used as seed\n      weights: n-sized numpy.ndarray with weights of data points (default: uniform weights)\n    Returns:\n      (k, d)-shaped numpy.ndarray with cluster centers\n    ");static PyMethodDef __pyx_mdef_8ccluster_1kmc2 = {"kmc2", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8ccluster_1kmc2, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8ccluster_kmc2};static PyObject *__pyx_pw_8ccluster_1kmc2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {PyObject *__pyx_v_X = 0;PyObject *__pyx_v_k = 0;PyObject *__pyx_v_chain_length = 0;PyObject *__pyx_v_afkmc2 = 0;PyObject *__pyx_v_random_state = 0;PyObject *__pyx_v_weights = 0;#if !CYTHON_METH_FASTCALLCYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);#endifCYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);PyObject *__pyx_r = 0;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("kmc2 (wrapper)", 0);{#if CYTHON_USE_MODULE_STATEPyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X,&amp;__pyx_n_s_k,&amp;__pyx_n_s_chain_length,&amp;__pyx_n_s_afkmc2,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_weights,0};#elsestatic PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X,&amp;__pyx_n_s_k,&amp;__pyx_n_s_chain_length,&amp;__pyx_n_s_afkmc2,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_weights,0};#endifPyObject* values[6] = {0,0,0,0,0,0};values[2] = ((PyObject *)((PyObject *)__pyx_int_200));values[3] = ((PyObject *)((PyObject *)Py_True));values[4] = ((PyObject *)((PyObject *)Py_None));values[5] = ((PyObject *)((PyObject *)Py_None));if (__pyx_kwds) {Py_ssize_t kw_args;switch (__pyx_nargs) {case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);CYTHON_FALLTHROUGH;case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);CYTHON_FALLTHROUGH;case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);CYTHON_FALLTHROUGH;case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);CYTHON_FALLTHROUGH;case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);CYTHON_FALLTHROUGH;case  0: break;default: goto __pyx_L5_argtuple_error;}kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);switch (__pyx_nargs) {case  0:if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_X)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 202, __pyx_L3_error)</span>else goto __pyx_L5_argtuple_error;CYTHON_FALLTHROUGH;case  1:if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_k)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 202, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("kmc2", 0, 2, 6, 1); <span class='error_goto'>__PYX_ERR(0, 202, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  2:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_chain_length);if (value) { values[2] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 202, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  3:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_afkmc2);if (value) { values[3] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 202, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  4:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);if (value) { values[4] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 202, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  5:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_weights);if (value) { values[5] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 202, __pyx_L3_error)</span>}}if (unlikely(kw_args &gt; 0)) {const Py_ssize_t kwd_pos_args = __pyx_nargs;if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "kmc2") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 202, __pyx_L3_error)</span>}} else {switch (__pyx_nargs) {case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);CYTHON_FALLTHROUGH;case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);CYTHON_FALLTHROUGH;case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);CYTHON_FALLTHROUGH;case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);break;default: goto __pyx_L5_argtuple_error;}}__pyx_v_X = values[0];__pyx_v_k = values[1];__pyx_v_chain_length = values[2];__pyx_v_afkmc2 = values[3];__pyx_v_random_state = values[4];__pyx_v_weights = values[5];}goto __pyx_L4_argument_unpacking_done;__pyx_L5_argtuple_error:;<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("kmc2", 0, 2, 6, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 202, __pyx_L3_error)</span>__pyx_L3_error:;<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.kmc2", __pyx_clineno, __pyx_lineno, __pyx_filename);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return NULL;__pyx_L4_argument_unpacking_done:;__pyx_r = __pyx_pf_8ccluster_kmc2(__pyx_self, __pyx_v_X, __pyx_v_k, __pyx_v_chain_length, __pyx_v_afkmc2, __pyx_v_random_state, __pyx_v_weights);/* function exit code */<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}static PyObject *__pyx_gb_8ccluster_4kmc2_2generator(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */static PyObject *__pyx_pf_8ccluster_kmc2(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_k, PyObject *__pyx_v_chain_length, PyObject *__pyx_v_afkmc2, PyObject *__pyx_v_random_state, PyObject *__pyx_v_weights) {struct __pyx_obj_8ccluster___pyx_scope_struct__kmc2 *__pyx_cur_scope;__pyx_t_5numpy_intp_t __pyx_v_j;__pyx_t_5numpy_intp_t __pyx_v_curr_ind;double __pyx_v_cand_prob;double __pyx_v_curr_prob;__Pyx_memviewslice __pyx_v_q_cand = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_p_cand = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_rand_a = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_XX = { 0, 0, { 0 }, { 0 }, { 0 } };CYTHON_UNUSED int __pyx_v_sparse;PyObject *__pyx_v_di = NULL;PyObject *__pyx_v_q = NULL;PyObject *__pyx_v_i = NULL;PyObject *__pyx_v_t1 = NULL;PyObject *__pyx_v_cand_ind = NULL;PyObject *__pyx_v_dist = NULL;PyObject *__pyx_v_t2 = NULL;PyObject *__pyx_v_t = NULL;PyObject *__pyx_gb_8ccluster_4kmc2_2generator = 0;PyObject *__pyx_8genexpr1__pyx_v_xi = NULL;Py_ssize_t __pyx_8genexpr2__pyx_v_yi;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("kmc2", 0);__pyx_cur_scope = (struct __pyx_obj_8ccluster___pyx_scope_struct__kmc2 *)__pyx_tp_new_8ccluster___pyx_scope_struct__kmc2(__pyx_ptype_8ccluster___pyx_scope_struct__kmc2, __pyx_empty_tuple, NULL);if (unlikely(!__pyx_cur_scope)) {__pyx_cur_scope = ((struct __pyx_obj_8ccluster___pyx_scope_struct__kmc2 *)Py_None);<span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);<span class='error_goto'>__PYX_ERR(0, 202, __pyx_L1_error)</span>} else {<span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);}__pyx_cur_scope-&gt;__pyx_v_X = __pyx_v_X;<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_X);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_X);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_random_state);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_weights);/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_13, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_19, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_20, 1);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.kmc2", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = NULL;__pyx_L0:;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_q_cand, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_p_cand, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rand_a, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_XX, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_di);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_q);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cand_ind);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dist);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_gb_8ccluster_4kmc2_2generator);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_xi);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_random_state);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_weights);<span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}__pyx_tuple__39 = <span class='py_c_api'>PyTuple_Pack</span>(28, __pyx_n_s_X, __pyx_n_s_k, __pyx_n_s_chain_length, __pyx_n_s_afkmc2, __pyx_n_s_random_state, __pyx_n_s_weights, __pyx_n_s_j, __pyx_n_s_curr_ind, __pyx_n_s_cand_prob, __pyx_n_s_curr_prob, __pyx_n_s_q_cand, __pyx_n_s_p_cand, __pyx_n_s_rand_a, __pyx_n_s_XX, __pyx_n_s_sparse, __pyx_n_s_cntrs, __pyx_n_s_di, __pyx_n_s_q, __pyx_n_s_i, __pyx_n_s_t1, __pyx_n_s_cand_ind, __pyx_n_s_dist, __pyx_n_s_t2, __pyx_n_s_t, __pyx_n_s_genexpr, __pyx_n_s_genexpr, __pyx_n_s_xi, __pyx_n_s_yi);<span class='error_goto'> if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 202, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__39);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__39);__pyx_codeobj__40 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(6, 0, 0, 28, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__39, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ccluster_pyx, __pyx_n_s_kmc2, 202, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__40)) __PYX_ERR(0, 202, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8ccluster_1kmc2, 0, __pyx_n_s_kmc2, NULL, __pyx_n_s_ccluster, __pyx_d, ((PyObject *)__pyx_codeobj__40));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 202, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__41);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_kmc2, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 202, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_tuple__41 = <span class='py_c_api'>PyTuple_Pack</span>(4, ((PyObject *)__pyx_int_200), ((PyObject *)Py_True), ((PyObject *)Py_None), ((PyObject *)Py_None));<span class='error_goto'> if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 202, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__41);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__41);struct __pyx_obj_8ccluster___pyx_scope_struct__kmc2 {PyObject_HEADPyObject *__pyx_v_X;PyObject *__pyx_v_cntrs;};</pre><pre class="cython line score-0">&#xA0;<span class="">0203</span>:     <span class="sd">&quot;&quot;&quot;Cython implementation of k-MC2 and AFK-MC2 seeding</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0204</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0205</span>: <span class="sd">    Args:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0206</span>: <span class="sd">      X: (n,d)-shaped numpy.ndarray with data points (or scipy CSR matrix)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0207</span>: <span class="sd">      k: number of cluster centers</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0208</span>: <span class="sd">      chain_length: length of the MCMC chain</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0209</span>: <span class="sd">      afkmc2: Whether to run AFK-MC2 (if True) or vanilla K-MC2 (if False)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0210</span>: <span class="sd">      random_state: numpy.random.RandomState instance or integer to be used as seed</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0211</span>: <span class="sd">      weights: n-sized numpy.ndarray with weights of data points (default: uniform weights)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0212</span>: <span class="sd">    Returns:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0213</span>: <span class="sd">      (k, d)-shaped numpy.ndarray with cluster centers</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0214</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0215</span>:     <span class="c"># Local cython variables</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0216</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">intp_t</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">curr_ind</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0217</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">cand_prob</span><span class="p">,</span> <span class="nf">curr_prob</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0218</span>:     <span class="k">cdef</span> <span class="kt">double</span>[<span class="p">::</span><span class="mf">1</span><span class="p">]</span> <span class="n">q_cand</span><span class="p">,</span> <span class="n">p_cand</span><span class="p">,</span> <span class="n">rand_a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0219</span>: </pre>
<pre class="cython line score-62" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0220</span>:     <span class="k">cdef</span> <span class="kt">float32</span>[<span class="p">:,</span> <span class="p">:]</span><span class="n">XX</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mf">0</span><span class="p">])),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-62 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 220, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 220, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = __pyx_cur_scope-&gt;__pyx_v_X;<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);__pyx_t_3 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 220, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 220, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope-&gt;__pyx_v_X, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 220, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 220, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 220, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 220, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);__pyx_t_1 = 0;__pyx_t_4 = 0;__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 220, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);__pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 220, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 220, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 220, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 220, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 220, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_float32(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 220, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_v_XX = __pyx_t_7;__pyx_t_7.memview = NULL;__pyx_t_7.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0221</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0222</span>:     <span class="c">#XX[:] = X[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0223</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0224</span>:     <span class="n">sparse</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>__pyx_v_sparse = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0225</span>:     <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_8 = (__pyx_v_weights == Py_None);if (__pyx_t_8) {}</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0226</span>:         <span class="n">weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">XX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-35 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_XX.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6);__pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 226, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_weights, __pyx_t_1);__pyx_t_1 = 0;</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0227</span>:     <span class="k">if</span> <span class="n">random_state</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_state</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>__pyx_t_9 = (__pyx_v_random_state == Py_None);if (!__pyx_t_9) {} else {__pyx_t_8 = __pyx_t_9;goto __pyx_L5_bool_binop_done;}__pyx_t_9 = <span class='py_c_api'>PyInt_Check</span>(__pyx_v_random_state); __pyx_t_8 = __pyx_t_9;__pyx_L5_bool_binop_done:;if (__pyx_t_8) {}</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0228</span>:         <span class="n">random_state</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="n">random_state</span><span class="p">)</span></pre>
<pre class='cython code score-23 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 228, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 228, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_RandomState);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 228, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {__pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);if (likely(__pyx_t_4)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_random_state};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 228, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_random_state, __pyx_t_1);__pyx_t_1 = 0;</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0229</span>:     <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">random_state</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">):</span></pre>
<pre class='cython code score-14 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 229, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 229, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_RandomState);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 229, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_8 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_random_state, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 229, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_9 = (!__pyx_t_8);if (unlikely(__pyx_t_9)) {}</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0230</span>:         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;RandomState should either be a numpy.random.RandomState&quot;</span></pre>
<pre class='cython code score-10 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple_, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 230, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>__PYX_ERR(0, 230, __pyx_L1_error)</span>__pyx_tuple_ = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_RandomState_should_either_be_a_n);<span class='error_goto'> if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 230, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple_);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple_);</pre><pre class="cython line score-0">&#xA0;<span class="">0231</span>:                          <span class="s">&quot; instance, None or an integer to be used as seed.&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0232</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0233</span>:     <span class="c"># Initialize result</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0234</span>: </pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0235</span>:     <span class="n">cntrs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-42 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 235, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 235, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_cur_scope-&gt;__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 235, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 235, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 235, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_k);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4);__pyx_t_4 = 0;__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 235, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);__pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 235, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 235, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 235, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 235, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 235, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);__pyx_cur_scope-&gt;__pyx_v_cntrs = __pyx_t_2;__pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0236</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0237</span>:     <span class="c"># print(centers)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0238</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0239</span>:     <span class="c">#centers = numpy.reshape(numpy.linspace(0, 1, num = k*X.shape[1], dtype=float64), (-1, X.shape[1]))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0240</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0241</span>:     <span class="c">#print(centers)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0242</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0243</span>:     <span class="c"># Sample first center and compute proposal</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0244</span>: </pre>
<pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0245</span>:     <span class="k">print</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">random_state</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">p</span><span class="o">=</span><span class="n">weights</span><span class="o">/</span><span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">())])</span></pre>
<pre class='cython code score-52 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_random_state, __pyx_n_s_choice);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 245, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_cur_scope-&gt;__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 245, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 245, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 245, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);__pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 245, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_weights, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 245, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_11 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {__pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);if (likely(__pyx_t_11)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_11, };__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_10, 0+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 245, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;}__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_weights, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 245, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_p, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 245, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 245, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_cur_scope-&gt;__pyx_v_X, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 245, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 245, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0246</span>:     <span class="n">cntrs</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">random_state</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">p</span><span class="o">=</span><span class="n">weights</span><span class="o">/</span><span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">())]</span></pre>
<pre class='cython code score-51 '>__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_random_state, __pyx_n_s_choice);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 246, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_cur_scope-&gt;__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 246, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 246, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 246, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);__pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 246, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_weights, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 246, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_11 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {__pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);if (likely(__pyx_t_11)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_11, };__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_10, 0+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 246, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;}__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_weights, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 246, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_p, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 246, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 246, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_cur_scope-&gt;__pyx_v_X, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 246, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_cur_scope-&gt;__pyx_v_cntrs, 0, __pyx_t_1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 246, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0247</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0248</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0249</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0250</span>:     <span class="c"># print(list(map(numpy.linalg.norm, (X - centers[0:1, :])**2)))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0251</span>:     <span class="c"># print(numpy.reshape(euclidean_distances(X, centers[0:1, :], squared = True), newshape = X.shape[0]))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0252</span>:     <span class="c"># print(numpy.reshape(X, newshape=X.shape[0]))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0253</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0254</span>:     <span class="k">if</span> <span class="n">afkmc2</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_afkmc2); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 254, __pyx_L1_error)</span>if (__pyx_t_9) {goto __pyx_L8;}</pre><pre class="cython line score-0">&#xA0;<span class="">0255</span>:         <span class="c"># di = numpy.min(euclidean_distances(X, centers[0:1, :], squared=True), axis=1)*weights</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0256</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0257</span>:         <span class="k">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_cur_scope-&gt;__pyx_v_X);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 257, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0258</span>:         <span class="k">print</span><span class="p">(</span><span class="n">cntrs</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-6 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope-&gt;__pyx_v_cntrs, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 258, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 258, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0259</span>: </pre>
<pre class="cython line score-118" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0260</span>:         <span class="n">di</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fromiter</span><span class="p">((</span><span class="n">emd_cp</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">cntrs</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">X</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-118 '>static PyObject *__pyx_pf_8ccluster_4kmc2_genexpr(PyObject *__pyx_self) {struct __pyx_obj_8ccluster___pyx_scope_struct_1_genexpr *__pyx_cur_scope;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("genexpr", 0);__pyx_cur_scope = (struct __pyx_obj_8ccluster___pyx_scope_struct_1_genexpr *)__pyx_tp_new_8ccluster___pyx_scope_struct_1_genexpr(__pyx_ptype_8ccluster___pyx_scope_struct_1_genexpr, __pyx_empty_tuple, NULL);if (unlikely(!__pyx_cur_scope)) {__pyx_cur_scope = ((struct __pyx_obj_8ccluster___pyx_scope_struct_1_genexpr *)Py_None);<span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);<span class='error_goto'>__PYX_ERR(0, 260, __pyx_L1_error)</span>} else {<span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);}__pyx_cur_scope-&gt;__pyx_outer_scope = (struct __pyx_obj_8ccluster___pyx_scope_struct__kmc2 *) __pyx_self;<span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);<span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);{__pyx_CoroutineObject *gen = <span class='pyx_c_api'>__Pyx_Generator_New</span>((__pyx_coroutine_body_t) __pyx_gb_8ccluster_4kmc2_2generator, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_kmc2_locals_genexpr, __pyx_n_s_ccluster);<span class='error_goto'> if (unlikely(!gen)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return (PyObject *) gen;}/* function exit code */__pyx_L1_error:;<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.kmc2.genexpr", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = NULL;<span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}static PyObject *__pyx_gb_8ccluster_4kmc2_2generator(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
{PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("genexpr", 0);__pyx_L3_first_run:;<span class='error_goto'>if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 260, __pyx_L1_error)</span>if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_X)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("X"); <span class='error_goto'>__PYX_ERR(0, 260, __pyx_L1_error)</span> }if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_X)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_X)) {__pyx_t_1 = __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_X; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_2 = 0;__pyx_t_3 = NULL;} else {__pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_X);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 260, __pyx_L1_error)</span>}for (;;) {if (likely(!__pyx_t_3)) {if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 260, __pyx_L1_error)</span>#else__pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);#endif} else {if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 260, __pyx_L1_error)</span>#else__pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);#endif}} else {__pyx_t_4 = __pyx_t_3(__pyx_t_1);if (unlikely(!__pyx_t_4)) {PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();if (exc_type) {if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();else <span class='error_goto'>__PYX_ERR(0, 260, __pyx_L1_error)</span>}break;}<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);}<span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_xi);<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_xi, __pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);__pyx_t_4 = 0;__pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_cur_scope-&gt;__pyx_v_xi, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 260, __pyx_L1_error)</span>if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_cntrs)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("cntrs"); <span class='error_goto'>__PYX_ERR(0, 260, __pyx_L1_error)</span> }__pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_cntrs, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_8ccluster_emd_cp(1, __pyx_t_5, __pyx_t_6, 0, NULL));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_5, 1);__pyx_t_5.memview = NULL; __pyx_t_5.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;__pyx_r = __pyx_t_4;__pyx_t_4 = 0;<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_1);__pyx_cur_scope-&gt;__pyx_t_0 = __pyx_t_1;__pyx_cur_scope-&gt;__pyx_t_1 = __pyx_t_2;__pyx_cur_scope-&gt;__pyx_t_2 = __pyx_t_3;<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();<span class='pyx_c_api'>__Pyx_Coroutine_ResetAndClearException</span>(__pyx_generator);/* return from generator, yielding value */__pyx_generator-&gt;resume_label = 1;return __pyx_r;__pyx_L6_resume_from_yield:;__pyx_t_1 = __pyx_cur_scope-&gt;__pyx_t_0;__pyx_cur_scope-&gt;__pyx_t_0 = 0;<span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);__pyx_t_2 = __pyx_cur_scope-&gt;__pyx_t_1;__pyx_t_3 = __pyx_cur_scope-&gt;__pyx_t_2;<span class='error_goto'>if (unlikely(!__pyx_sent_value)) __PYX_ERR(0, 260, __pyx_L1_error)</span>}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);/* function exit code */<span class='py_c_api'>PyErr_SetNone</span>(PyExc_StopIteration);goto __pyx_L0;__pyx_L1_error:;<span class='pyx_c_api'>__Pyx_Generator_Replace_StopIteration</span>(0);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_5, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("genexpr", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_L0:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r); __pyx_r = 0;#if !CYTHON_USE_EXC_INFO_STACK<span class='pyx_c_api'>__Pyx_Coroutine_ResetAndClearException</span>(__pyx_generator);#endif__pyx_generator-&gt;resume_label = -1;<span class='pyx_c_api'>__Pyx_Coroutine_clear</span>((PyObject*)__pyx_generator);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_fromiter);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = __pyx_pf_8ccluster_4kmc2_genexpr(((PyObject*)__pyx_cur_scope));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_5);__pyx_t_6 = 0;__pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_cur_scope-&gt;__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_count, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 260, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_v_di = __pyx_t_2;__pyx_t_2 = 0;struct __pyx_obj_8ccluster___pyx_scope_struct_1_genexpr {PyObject_HEADstruct __pyx_obj_8ccluster___pyx_scope_struct__kmc2 *__pyx_outer_scope;PyObject *__pyx_v_xi;PyObject *__pyx_t_0;Py_ssize_t __pyx_t_1;PyObject *(*__pyx_t_2)(PyObject *);};</pre><pre class="cython line score-0">&#xA0;<span class="">0261</span>: </pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0262</span>:         <span class="n">q</span> <span class="o">=</span> <span class="n">di</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">di</span><span class="p">)</span> <span class="o">+</span> <span class="n">weights</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>  <span class="c"># Only the potentials</span></pre>
<pre class='cython code score-51 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 262, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 262, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {__pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);if (likely(__pyx_t_5)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_v_di};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 262, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;}__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_di, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 262, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 262, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 262, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {__pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);if (likely(__pyx_t_5)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_v_weights};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 262, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;}__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_weights, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 262, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 262, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_v_q = __pyx_t_2;__pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0263</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0264</span>:         <span class="k">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_v_q);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 264, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0265</span>:         <span class="k">print</span><span class="p">(</span><span class="n">di</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_v_di);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 265, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0266</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0267</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0268</span>:         <span class="n">q</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>/*else*/ {<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 268, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 268, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {__pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);if (likely(__pyx_t_1)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_weights};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 268, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;}__pyx_v_q = __pyx_t_2;__pyx_t_2 = 0;}__pyx_L8:;</pre><pre class="cython line score-0">&#xA0;<span class="">0269</span>:     <span class="c"># Renormalize the proposal distribution</span></pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0270</span>:     <span class="n">q</span> <span class="o">=</span> <span class="n">q</span> <span class="o">/</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">q</span><span class="p">)</span></pre>
<pre class='cython code score-23 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 270, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 270, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {__pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);if (likely(__pyx_t_4)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_q};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 270, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;}__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_q, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 270, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_q, __pyx_t_1);__pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0271</span>: </pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0272</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-51 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_k, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 272, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 272, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {__pyx_t_1 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_3 = 0;__pyx_t_12 = NULL;} else {__pyx_t_3 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 272, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 272, __pyx_L1_error)</span>}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;for (;;) {if (likely(!__pyx_t_12)) {if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 272, __pyx_L1_error)</span>#else__pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 272, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);#endif} else {if (__pyx_t_3 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 272, __pyx_L1_error)</span>#else__pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 272, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);#endif}} else {__pyx_t_2 = __pyx_t_12(__pyx_t_1);if (unlikely(!__pyx_t_2)) {PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();if (exc_type) {if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();else <span class='error_goto'>__PYX_ERR(0, 272, __pyx_L1_error)</span>}break;}<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_2);__pyx_t_2 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0273</span>:         <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 273, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0274</span>:         <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span></pre>
<pre class='cython code score-20 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 274, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 274, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {__pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);if (likely(__pyx_t_4)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_4, };__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_10, 0+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 274, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t1, __pyx_t_2);__pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0275</span>:         <span class="c"># Draw the candidate indices</span></pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0276</span>:         <span class="n">cand_ind</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">chain_length</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span></pre>
<pre class='cython code score-51 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_random_state, __pyx_n_s_choice);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_cur_scope-&gt;__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);__pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_size, __pyx_v_chain_length) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 276, __pyx_L1_error)</span>if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_p, __pyx_v_q) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 276, __pyx_L1_error)</span>__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_intp);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 276, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_empty_tuple, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cand_ind, __pyx_t_2);__pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0277</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0278</span>:         <span class="c"># Extract the proposal probabilities</span></pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0279</span>:         <span class="n">q_cand</span> <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">cand_ind</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_q, __pyx_v_cand_ind);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 279, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 279, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 279, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 279, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {__pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);if (likely(__pyx_t_6)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_5};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 279, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;}__pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 279, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_q_cand, 1);__pyx_v_q_cand = __pyx_t_13;__pyx_t_13.memview = NULL;__pyx_t_13.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0280</span>:         <span class="c">#print(X[cand_ind].flatten())</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0281</span>:         <span class="c">#x_view[:] = numpy.empty(cand_ind.shape[0], dtype=type(defff))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0282</span>:         <span class="c">#print(cand_ind)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0283</span>:         <span class="c">#print(&#39;asdfasdfasdfasdfasdfasdf&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0284</span>:         <span class="c">#print(&#39;asdfasdfljasdfl;kjasl;kfd&#39;)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0285</span>:         <span class="c">#print(X[cand_ind[0]])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0286</span>:         <span class="c">#x_view[:] = [X[X] for X in cand_ind]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0287</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0288</span>:         <span class="c"># Compute pairwise distances</span></pre>
<pre class="cython line score-84" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0289</span>:         <span class="n">dist</span> <span class="o">=</span> <span class="p">[[</span><span class="n">emd_cp</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="n">cand_ind</span><span class="p">[</span><span class="n">yi</span><span class="p">]])</span> <span class="k">for</span> <span class="n">yi</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cand_ind</span><span class="p">))]</span> <span class="k">for</span> <span class="n">xi</span> <span class="ow">in</span> <span class="n">cntrs</span><span class="p">[</span><span class="mf">0</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">)]]</span></pre>
<pre class='cython code score-84 '>{ /* enter inner scope */__pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 289, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 289, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_cur_scope-&gt;__pyx_v_cntrs, 0, 0, NULL, &amp;__pyx_t_4, NULL, 1, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 289, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_5)) {__pyx_t_4 = __pyx_t_5; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_14 = 0;__pyx_t_15 = NULL;} else {__pyx_t_14 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 289, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 289, __pyx_L13_error)</span>}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;for (;;) {if (likely(!__pyx_t_15)) {if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_14++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 289, __pyx_L13_error)</span>#else__pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 289, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);#endif} else {if (__pyx_t_14 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_14++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 289, __pyx_L13_error)</span>#else__pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 289, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);#endif}} else {__pyx_t_5 = __pyx_t_15(__pyx_t_4);if (unlikely(!__pyx_t_5)) {PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();if (exc_type) {if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();else <span class='error_goto'>__PYX_ERR(0, 289, __pyx_L13_error)</span>}break;}<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr1__pyx_v_xi, __pyx_t_5);__pyx_t_5 = 0;{ /* enter inner scope */__pyx_t_5 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 289, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_16 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_cand_ind);<span class='error_goto'> if (unlikely(__pyx_t_16 == ((Py_ssize_t)-1))) __PYX_ERR(0, 289, __pyx_L13_error)</span>__pyx_t_17 = __pyx_t_16;for (__pyx_t_18 = 0; __pyx_t_18 &lt; __pyx_t_17; __pyx_t_18+=1) {__pyx_8genexpr2__pyx_v_yi = __pyx_t_18;__pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_8genexpr1__pyx_v_xi, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 289, __pyx_L13_error)</span>__pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_cand_ind, __pyx_8genexpr2__pyx_v_yi, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 289, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_cur_scope-&gt;__pyx_v_X, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 289, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_20 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_11, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(0, 289, __pyx_L13_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;__pyx_t_11 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_8ccluster_emd_cp(1, __pyx_t_19, __pyx_t_20, 0, NULL));<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 289, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_19, 1);__pyx_t_19.memview = NULL; __pyx_t_19.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_20, 1);__pyx_t_20.memview = NULL; __pyx_t_20.data = NULL;<span class='error_goto'>if (unlikely(__Pyx_ListComp_Append(__pyx_t_5, (PyObject*)__pyx_t_11))) __PYX_ERR(0, 289, __pyx_L13_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;}} /* exit inner scope */if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_2, (PyObject*)__pyx_t_5))) <span class='error_goto'>__PYX_ERR(0, 289, __pyx_L13_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_xi); __pyx_8genexpr1__pyx_v_xi = 0;goto __pyx_L18_exit_scope;__pyx_L13_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_xi); __pyx_8genexpr1__pyx_v_xi = 0;goto __pyx_L1_error;__pyx_L18_exit_scope:;} /* exit inner scope */<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dist, ((PyObject*)__pyx_t_2));__pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0290</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0291</span>:         <span class="c"># Compute potentials</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0292</span>:         <span class="c"># p_cand = numpy.min(dist, axis=1)*weights[cand_ind]</span></pre>
<pre class="cython line score-77" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0293</span>:         <span class="n">p_cand</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">double</span><span class="p">)</span><span class="o">*</span><span class="n">weights</span><span class="p">[</span><span class="n">cand_ind</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></pre>
<pre class='cython code score-77 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 293, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 293, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {__pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);if (likely(__pyx_t_5)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_v_dist};__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 293, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;}__pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 293, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 293, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 293, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {__pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);if (likely(__pyx_t_4)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_5};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 293, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;}__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_weights, __pyx_v_cand_ind);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 293, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 293, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 293, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 293, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {__pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);if (likely(__pyx_t_5)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_6};__pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 293, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;}__pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 293, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;__pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 293, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_p_cand, 1);__pyx_v_p_cand = __pyx_t_13;__pyx_t_13.memview = NULL;__pyx_t_13.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0294</span>:         <span class="c"># p_cand = dist[0]*weights[cand_ind]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0295</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0296</span>:         <span class="c"># Compute acceptance probabilities</span></pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0297</span>:         <span class="n">rand_a</span> <span class="o">=</span> <span class="n">random_state</span><span class="o">.</span><span class="n">random_sample</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">chain_length</span><span class="p">))</span></pre>
<pre class='cython code score-16 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_random_state, __pyx_n_s_random_sample);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 297, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 297, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_size, __pyx_v_chain_length) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 297, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_empty_tuple, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 297, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;__pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 297, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rand_a, 1);__pyx_v_rand_a = __pyx_t_13;__pyx_t_13.memview = NULL;__pyx_t_13.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0298</span>:         <span class="k">with</span> <span class="n">cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">),</span> <span class="n">cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">),</span> <span class="n">cython</span><span class="o">.</span><span class="n">cdivision</span><span class="p">(</span><span class="bp">True</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0299</span>:             <span class="c"># Markov chain</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0300</span>:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">q_cand</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>__pyx_t_14 = (__pyx_v_q_cand.shape[0]);__pyx_t_16 = __pyx_t_14;for (__pyx_t_21 = 0; __pyx_t_21 &lt; __pyx_t_16; __pyx_t_21+=1) {__pyx_v_j = __pyx_t_21;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0301</span>:                 <span class="n">cand_prob</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_cand</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">q_cand</span><span class="p">[</span><span class="n">j</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>__pyx_t_22 = __pyx_v_j;__pyx_t_23 = __pyx_v_j;__pyx_v_cand_prob = ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_p_cand.data) + __pyx_t_22)) ))) / (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_q_cand.data) + __pyx_t_23)) ))));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0302</span>:                 <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mf">0</span> <span class="ow">or</span> <span class="n">curr_prob</span> <span class="o">==</span> <span class="mf">0.0</span> <span class="ow">or</span> <span class="n">cand_prob</span><span class="o">/</span><span class="n">curr_prob</span> <span class="o">&gt;</span> <span class="n">rand_a</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>__pyx_t_8 = (__pyx_v_j == 0);if (!__pyx_t_8) {} else {__pyx_t_9 = __pyx_t_8;goto __pyx_L22_bool_binop_done;}__pyx_t_8 = (__pyx_v_curr_prob == 0.0);if (!__pyx_t_8) {} else {__pyx_t_9 = __pyx_t_8;goto __pyx_L22_bool_binop_done;}__pyx_t_23 = __pyx_v_j;__pyx_t_8 = ((__pyx_v_cand_prob / __pyx_v_curr_prob) &gt; (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_rand_a.data) + __pyx_t_23)) ))));__pyx_t_9 = __pyx_t_8;__pyx_L22_bool_binop_done:;if (__pyx_t_9) {}}</pre><pre class="cython line score-0">&#xA0;<span class="">0303</span>:                     <span class="c"># Init new chain             Metropolis-Hastings step</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0304</span>:                     <span class="n">curr_ind</span> <span class="o">=</span> <span class="n">j</span></pre>
<pre class='cython code score-0 '>__pyx_v_curr_ind = __pyx_v_j;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0305</span>:                     <span class="n">curr_prob</span> <span class="o">=</span> <span class="n">cand_prob</span></pre>
<pre class='cython code score-0 '>__pyx_v_curr_prob = __pyx_v_cand_prob;</pre><pre class="cython line score-0">&#xA0;<span class="">0306</span>:         <span class="c"># centers[i+1, :] = rel_row.todense().flatten() if sparse else rel_row</span></pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0307</span>:         <span class="n">cntrs</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">cand_ind</span><span class="p">[</span><span class="n">curr_ind</span><span class="p">]]</span></pre>
<pre class='cython code score-14 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_cand_ind, __pyx_v_curr_ind, __pyx_t_5numpy_intp_t, 1, PyInt_FromSsize_t, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 307, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_cur_scope-&gt;__pyx_v_X, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 307, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 307, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_cur_scope-&gt;__pyx_v_cntrs, __pyx_t_2, __pyx_t_11) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 307, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0308</span>:         <span class="n">t2</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span></pre>
<pre class='cython code score-20 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 308, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 308, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {__pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);if (likely(__pyx_t_2)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_2, };__pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_10, 0+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 308, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2, __pyx_t_11);__pyx_t_11 = 0;</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0309</span>:         <span class="n">t</span> <span class="o">=</span> <span class="n">t2</span><span class="o">-</span><span class="n">t1</span></pre>
<pre class='cython code score-6 '>__pyx_t_11 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_t2, __pyx_v_t1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 309, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t, __pyx_t_11);__pyx_t_11 = 0;</pre><pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0310</span>:         <span class="k">print</span><span class="p">(</span><span class="s">&#39;~&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mf">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span><span class="o">//</span><span class="mf">60</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; minutes until finished. &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mf">100</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mf">1</span><span class="p">)))[:</span><span class="mf">4</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;</span><span class="si">% d</span><span class="s">one     &#39;</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\r</span><span class="s">&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-71 '>__pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_k, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 310, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);__pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_11, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 310, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;__pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_t, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 310, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_FloorDivideObjC</span>(__pyx_t_11, __pyx_int_60, 60, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 310, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;__pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 310, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_u__2, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 310, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;__pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlace</span>(__pyx_t_4, __pyx_kp_u_minutes_until_finished);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 310, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_k, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 310, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_i, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 310, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_MultiplyCObj</span>(__pyx_int_100, __pyx_t_2, 0x64, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 310, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 310, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='py_c_api'>PySequence_GetSlice</span>(__pyx_t_2, 0, 4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 310, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlaceSafe</span>(__pyx_t_11, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 310, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlace</span>(__pyx_t_2, __pyx_kp_u_done);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 310, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 310, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);__pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 310, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_end, __pyx_kp_u__3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L1_error)</span>__pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 310, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0311</span>:     <span class="k">return</span> <span class="n">cntrs</span></pre>
<pre class='cython code score-2 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_cntrs);__pyx_r = __pyx_cur_scope-&gt;__pyx_v_cntrs;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0312</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0313</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0314</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0315</span>: <span class="c">#################################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0316</span>: <span class="c"># My code below.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0317</span>: <span class="c">#################################################################################################</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0318</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0319</span>: <span class="c"># Taken from stack overflow. Fast list combination generator for C(n, k)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0320</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0321</span>: </pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0322</span>: <span class="k">def</span> <span class="nf">nump2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-61 '>/* Python wrapper */static PyObject *__pyx_pw_8ccluster_3nump2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/static PyMethodDef __pyx_mdef_8ccluster_3nump2 = {"nump2", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8ccluster_3nump2, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};static PyObject *__pyx_pw_8ccluster_3nump2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {PyObject *__pyx_v_n = 0;PyObject *__pyx_v_k = 0;#if !CYTHON_METH_FASTCALLCYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);#endifCYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);PyObject *__pyx_r = 0;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("nump2 (wrapper)", 0);{#if CYTHON_USE_MODULE_STATEPyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n,&amp;__pyx_n_s_k,0};#elsestatic PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n,&amp;__pyx_n_s_k,0};#endifPyObject* values[2] = {0,0};if (__pyx_kwds) {Py_ssize_t kw_args;switch (__pyx_nargs) {case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);CYTHON_FALLTHROUGH;case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);CYTHON_FALLTHROUGH;case  0: break;default: goto __pyx_L5_argtuple_error;}kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);switch (__pyx_nargs) {case  0:if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 322, __pyx_L3_error)</span>else goto __pyx_L5_argtuple_error;CYTHON_FALLTHROUGH;case  1:if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_k)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 322, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("nump2", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 322, __pyx_L3_error)</span>}}if (unlikely(kw_args &gt; 0)) {const Py_ssize_t kwd_pos_args = __pyx_nargs;if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "nump2") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 322, __pyx_L3_error)</span>}} else if (unlikely(__pyx_nargs != 2)) {goto __pyx_L5_argtuple_error;} else {values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);}__pyx_v_n = values[0];__pyx_v_k = values[1];}goto __pyx_L4_argument_unpacking_done;__pyx_L5_argtuple_error:;<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("nump2", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 322, __pyx_L3_error)</span>__pyx_L3_error:;<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.nump2", __pyx_clineno, __pyx_lineno, __pyx_filename);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return NULL;__pyx_L4_argument_unpacking_done:;__pyx_r = __pyx_pf_8ccluster_2nump2(__pyx_self, __pyx_v_n, __pyx_v_k);int __pyx_lineno = 0;const char *__pyx_filename = NULL;int __pyx_clineno = 0;/* function exit code */<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}static PyObject *__pyx_pf_8ccluster_2nump2(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_n, PyObject *__pyx_v_k) {PyObject *__pyx_v_a = NULL;PyObject *__pyx_v_j = NULL;PyObject *__pyx_v_reps = NULL;PyObject *__pyx_v_ind = NULL;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("nump2", 0);/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.nump2", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = NULL;__pyx_L0:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_a);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_reps);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ind);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}__pyx_tuple__42 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_n, __pyx_n_s_k, __pyx_n_s_a, __pyx_n_s_j, __pyx_n_s_reps, __pyx_n_s_ind);<span class='error_goto'> if (unlikely(!__pyx_tuple__42)) __PYX_ERR(0, 322, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__42);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__42);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8ccluster_3nump2, 0, __pyx_n_s_nump2, NULL, __pyx_n_s_ccluster, __pyx_d, ((PyObject *)__pyx_codeobj__43));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 322, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_nump2, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 322, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_codeobj__43 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__42, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ccluster_pyx, __pyx_n_s_nump2, 322, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__43)) __PYX_ERR(0, 322, __pyx_L1_error)</span></pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0323</span>:     <span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="o">+</span><span class="mf">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span></pre>
<pre class='cython code score-45 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 323, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 323, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_n, __pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 323, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 323, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_k);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_3);__pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);__pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 323, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 323, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 323, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 323, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_v_a = __pyx_t_5;__pyx_t_5 = 0;</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0324</span>:     <span class="n">a</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-31 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 324, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 324, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_n, __pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 324, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 324, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = NULL;__pyx_t_6 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_1)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_6 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_2};__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 324, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_a, 0, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 324, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;</pre><pre class="cython line score-58" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0325</span>:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-58 '>__pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 325, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_int_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_k);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_range, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 325, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {__pyx_t_5 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_7 = 0;__pyx_t_8 = NULL;} else {__pyx_t_7 = -1; __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 325, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 325, __pyx_L1_error)</span>}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;for (;;) {if (likely(!__pyx_t_8)) {if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_5, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L1_error)</span>#else__pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 325, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);#endif} else {if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_5)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_5, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L1_error)</span>#else__pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 325, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);#endif}} else {__pyx_t_3 = __pyx_t_8(__pyx_t_5);if (unlikely(!__pyx_t_3)) {PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();if (exc_type) {if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();else <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L1_error)</span>}break;}<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_j, __pyx_t_3);__pyx_t_3 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0326</span>:         <span class="n">reps</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="o">+</span><span class="n">j</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-24 '>__pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_n, __pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 326, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 326, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_j, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 326, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_a, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 326, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 326, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_reps, __pyx_t_3);__pyx_t_3 = 0;</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0327</span>:         <span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">reps</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-27 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 327, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_repeat);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 327, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 327, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_a);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_a);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_a);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_reps);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_reps);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_reps);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 327, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 327, __pyx_L1_error)</span>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 327, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_a, __pyx_t_4);__pyx_t_4 = 0;</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0328</span>:         <span class="n">ind</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">reps</span><span class="p">)</span></pre>
<pre class='cython code score-23 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 328, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 328, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_accumulate);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 328, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = NULL;__pyx_t_6 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_6 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_reps};__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 328, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ind, __pyx_t_4);__pyx_t_4 = 0;</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0329</span>:         <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">ind</span><span class="p">[:</span><span class="o">-</span><span class="mf">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1</span><span class="o">-</span><span class="n">reps</span><span class="p">[</span><span class="mf">1</span><span class="p">:]</span></pre>
<pre class='cython code score-32 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_reps, 1, 0, NULL, NULL, &amp;__pyx_slice__4, 1, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 329, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_t_4, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 329, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_slice__4 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__4)) __PYX_ERR(0, 329, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__4);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_ind, 0, -1L, NULL, NULL, &amp;__pyx_slice__5, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 329, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 329, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_j);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_j);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_j);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4);__pyx_t_4 = 0;if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_a, __pyx_t_3, __pyx_t_2) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 329, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_slice__5 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__5)) __PYX_ERR(0, 329, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__5);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0330</span>:         <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span></pre>
<pre class='cython code score-15 '>__pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 330, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_j);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_j);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_j);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_0);if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_a, __pyx_t_2, __pyx_v_j) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 330, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0331</span>:         <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">])</span></pre>
<pre class='cython code score-31 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 331, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 331, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_accumulate);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 331, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_a, __pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 331, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_1 = NULL;__pyx_t_6 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_1)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_6 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_4};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 331, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_a, __pyx_v_j, __pyx_t_2) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 331, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0332</span>:     <span class="k">return</span> <span class="n">a</span><span class="o">.</span><span class="n">T</span></pre>
<pre class='cython code score-3 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_a, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 332, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_r = __pyx_t_5;__pyx_t_5 = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0333</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0334</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0335</span>: <span class="c"># Taken from stack overflow. Fast list combination generator for C(n, k)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0336</span>: <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0337</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0338</span>: <span class="c"># </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0339</span>: <span class="c"># See if a card appears twice in the hand/table combo. Can be faster.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0340</span>: <span class="c"># </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0341</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0342</span>: <span class="c"># @cython.profile(True)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0343</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0344</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0345</span>: <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">npy_bool</span> <span class="nf">contains_duplicates</span><span class="p">(</span><span class="n">int16</span><span class="p">[:]</span> <span class="n">XX</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static npy_bool __pyx_f_8ccluster_contains_duplicates(__Pyx_memviewslice __pyx_v_XX) {unsigned int __pyx_v_count;unsigned int __pyx_v_length;unsigned int __pyx_v_countt;npy_bool __pyx_r;/* function exit code */__pyx_L0:;return __pyx_r;}</pre><pre class="cython line score-0">&#xA0;<span class="">0346</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">count</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0347</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">length</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0348</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">countt</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>__pyx_v_countt = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0349</span>:     <span class="n">length</span> <span class="o">=</span> <span class="mf">7</span></pre>
<pre class='cython code score-0 '>__pyx_v_length = 7;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0350</span>:     <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = __pyx_v_length;__pyx_t_2 = __pyx_t_1;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {__pyx_v_count = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0351</span>:         <span class="k">for</span> <span class="n">countt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="o">+</span><span class="mf">1</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_length;__pyx_t_5 = __pyx_t_4;for (__pyx_t_6 = (__pyx_v_count + 1); __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {__pyx_v_countt = __pyx_t_6;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0352</span>:             <span class="k">if</span><span class="p">(</span><span class="n">XX</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">==</span> <span class="n">XX</span><span class="p">[</span><span class="n">countt</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>__pyx_t_7 = __pyx_v_count;__pyx_t_8 = __pyx_v_countt;__pyx_t_9 = ((*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_XX.data + __pyx_t_7 * __pyx_v_XX.strides[0]) ))) == (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_XX.data + __pyx_t_8 * __pyx_v_XX.strides[0]) ))));if (__pyx_t_9) {}}}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0353</span>:                 <span class="k">return</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>__pyx_r = 1;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0354</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0355</span>:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>__pyx_r = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0356</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0357</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0358</span>: <span class="c"># </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0359</span>: <span class="c"># See if a card appears twice in the hand/table combo. Can be faster.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0360</span>: <span class="c"># </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0361</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0362</span>: <span class="c"># @cython.profile(True)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0363</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0364</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0365</span>: <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">npy_bool</span> <span class="nf">contains_duplicates_turn</span><span class="p">(</span><span class="n">int16</span><span class="p">[:]</span> <span class="n">XX</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static npy_bool __pyx_f_8ccluster_contains_duplicates_turn(__Pyx_memviewslice __pyx_v_XX) {unsigned int __pyx_v_count;unsigned int __pyx_v_length;unsigned int __pyx_v_countt;npy_bool __pyx_r;/* function exit code */__pyx_L0:;return __pyx_r;}</pre><pre class="cython line score-0">&#xA0;<span class="">0366</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">count</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0367</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">length</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0368</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">countt</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>__pyx_v_countt = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0369</span>:     <span class="n">length</span> <span class="o">=</span> <span class="mf">6</span></pre>
<pre class='cython code score-0 '>__pyx_v_length = 6;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0370</span>:     <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = __pyx_v_length;__pyx_t_2 = __pyx_t_1;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {__pyx_v_count = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0371</span>:         <span class="k">for</span> <span class="n">countt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="o">+</span><span class="mf">1</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_length;__pyx_t_5 = __pyx_t_4;for (__pyx_t_6 = (__pyx_v_count + 1); __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {__pyx_v_countt = __pyx_t_6;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0372</span>:             <span class="k">if</span><span class="p">(</span><span class="n">XX</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">==</span> <span class="n">XX</span><span class="p">[</span><span class="n">countt</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>__pyx_t_7 = __pyx_v_count;__pyx_t_8 = __pyx_v_countt;__pyx_t_9 = ((*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_XX.data + __pyx_t_7 * __pyx_v_XX.strides[0]) ))) == (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_XX.data + __pyx_t_8 * __pyx_v_XX.strides[0]) ))));if (__pyx_t_9) {}}}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0373</span>:                 <span class="k">return</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>__pyx_r = 1;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0374</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0375</span>:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>__pyx_r = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0376</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0377</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0378</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0379</span>: <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">npy_bool</span> <span class="nf">contains_duplicates_flop</span><span class="p">(</span><span class="n">int16</span><span class="p">[:]</span> <span class="n">XX</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static npy_bool __pyx_f_8ccluster_contains_duplicates_flop(__Pyx_memviewslice __pyx_v_XX) {unsigned int __pyx_v_count;unsigned int __pyx_v_length;unsigned int __pyx_v_countt;npy_bool __pyx_r;/* function exit code */__pyx_L0:;return __pyx_r;}</pre><pre class="cython line score-0">&#xA0;<span class="">0380</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">count</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0381</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">length</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0382</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">countt</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>__pyx_v_countt = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0383</span>:     <span class="n">length</span> <span class="o">=</span> <span class="mf">5</span></pre>
<pre class='cython code score-0 '>__pyx_v_length = 5;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0384</span>:     <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = __pyx_v_length;__pyx_t_2 = __pyx_t_1;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {__pyx_v_count = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0385</span>:         <span class="k">for</span> <span class="n">countt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="o">+</span><span class="mf">1</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_length;__pyx_t_5 = __pyx_t_4;for (__pyx_t_6 = (__pyx_v_count + 1); __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {__pyx_v_countt = __pyx_t_6;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0386</span>:             <span class="k">if</span><span class="p">(</span><span class="n">XX</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">==</span> <span class="n">XX</span><span class="p">[</span><span class="n">countt</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>__pyx_t_7 = __pyx_v_count;__pyx_t_8 = __pyx_v_countt;__pyx_t_9 = ((*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_XX.data + __pyx_t_7 * __pyx_v_XX.strides[0]) ))) == (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_XX.data + __pyx_t_8 * __pyx_v_XX.strides[0]) ))));if (__pyx_t_9) {}}}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0387</span>:                 <span class="k">return</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>__pyx_r = 1;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0388</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0389</span>:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>__pyx_r = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0390</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0391</span>: <span class="c"># </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0392</span>: <span class="c"># Check if the hand/board combo (XX) contains a given card (comp)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0393</span>: <span class="c"># </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0394</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0395</span>: <span class="c"># @cython.profile(True)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0396</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0397</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0398</span>: <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">npy_bool</span> <span class="nf">contains</span><span class="p">(</span><span class="n">int16</span><span class="p">[:]</span> <span class="n">XX</span><span class="p">,</span> <span class="nb">int</span> <span class="n">comp</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static npy_bool __pyx_f_8ccluster_contains(__Pyx_memviewslice __pyx_v_XX, int __pyx_v_comp) {unsigned int __pyx_v_count;unsigned int __pyx_v_length;npy_bool __pyx_r;/* function exit code */__pyx_L0:;return __pyx_r;}</pre><pre class="cython line score-0">&#xA0;<span class="">0399</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">count</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0400</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">length</span> <span class="o">=</span> <span class="mf">7</span></pre>
<pre class='cython code score-0 '>__pyx_v_length = 7;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0401</span>:     <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = __pyx_v_length;__pyx_t_2 = __pyx_t_1;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {__pyx_v_count = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0402</span>:         <span class="k">if</span><span class="p">(</span><span class="n">XX</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">==</span> <span class="n">comp</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_count;__pyx_t_5 = ((*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_XX.data + __pyx_t_4 * __pyx_v_XX.strides[0]) ))) == __pyx_v_comp);if (__pyx_t_5) {}}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0403</span>:             <span class="k">return</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>__pyx_r = 1;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0404</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0405</span>:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>__pyx_r = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0406</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0407</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0408</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0409</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0410</span>: <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">npy_bool</span> <span class="nf">contains_flop</span><span class="p">(</span><span class="n">int16</span><span class="p">[:]</span> <span class="n">XX</span><span class="p">,</span> <span class="nb">int</span> <span class="n">comp</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static npy_bool __pyx_f_8ccluster_contains_flop(__Pyx_memviewslice __pyx_v_XX, int __pyx_v_comp) {unsigned int __pyx_v_count;unsigned int __pyx_v_length;npy_bool __pyx_r;/* function exit code */__pyx_L0:;return __pyx_r;}</pre><pre class="cython line score-0">&#xA0;<span class="">0411</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">count</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0412</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">length</span> <span class="o">=</span> <span class="mf">5</span></pre>
<pre class='cython code score-0 '>__pyx_v_length = 5;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0413</span>:     <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = __pyx_v_length;__pyx_t_2 = __pyx_t_1;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {__pyx_v_count = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0414</span>:         <span class="k">if</span><span class="p">(</span><span class="n">XX</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">==</span> <span class="n">comp</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_count;__pyx_t_5 = ((*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_XX.data + __pyx_t_4 * __pyx_v_XX.strides[0]) ))) == __pyx_v_comp);if (__pyx_t_5) {}}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0415</span>:             <span class="k">return</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>__pyx_r = 1;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0416</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0417</span>:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>__pyx_r = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0418</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0419</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0420</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0421</span>: <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">npy_bool</span> <span class="nf">contains_turn</span><span class="p">(</span><span class="n">int16</span><span class="p">[:]</span> <span class="n">XX</span><span class="p">,</span> <span class="nb">int</span> <span class="n">comp</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static npy_bool __pyx_f_8ccluster_contains_turn(__Pyx_memviewslice __pyx_v_XX, int __pyx_v_comp) {unsigned int __pyx_v_count;unsigned int __pyx_v_length;npy_bool __pyx_r;/* function exit code */__pyx_L0:;return __pyx_r;}</pre><pre class="cython line score-0">&#xA0;<span class="">0422</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">count</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0423</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">length</span> <span class="o">=</span> <span class="mf">6</span></pre>
<pre class='cython code score-0 '>__pyx_v_length = 6;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0424</span>:     <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = __pyx_v_length;__pyx_t_2 = __pyx_t_1;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {__pyx_v_count = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0425</span>:         <span class="k">if</span><span class="p">(</span><span class="n">XX</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">==</span> <span class="n">comp</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_count;__pyx_t_5 = ((*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_XX.data + __pyx_t_4 * __pyx_v_XX.strides[0]) ))) == __pyx_v_comp);if (__pyx_t_5) {}}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0426</span>:             <span class="k">return</span> <span class="bp">True</span></pre>
<pre class='cython code score-0 '>__pyx_r = 1;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0427</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0428</span>:     <span class="k">return</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>__pyx_r = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0429</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0430</span>: <span class="c"># </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0431</span>: <span class="c"># Get the Expected Hand Strength for a given hand/board river combination.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0432</span>: <span class="c"># Returns a &#39;tally&#39; array for the total number of ties, wins, and losses.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0433</span>: <span class="c"># This is an exact calculation so I leave the result as an integer ratio </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0434</span>: <span class="c"># in order to avoid precision loss later down the line.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0435</span>: <span class="c">#  </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0436</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0437</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0438</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0439</span>: <span class="c"># @cython.profile(True)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0440</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0441</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0442</span>: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">get_ehs_fast</span><span class="p">(</span><span class="n">int16</span><span class="p">[:]</span> <span class="n">j</span><span class="p">,</span> <span class="n">int16</span><span class="p">[:]</span> <span class="n">twl_tiewinloss</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_8ccluster_get_ehs_fast(__Pyx_memviewslice __pyx_v_j, __Pyx_memviewslice __pyx_v_twl_tiewinloss) {int __pyx_v_T_CARDS;int __pyx_v_N_CARDS;__pyx_t_8ccluster_int16 __pyx_v_x[45];__pyx_t_8ccluster_int16 __pyx_v_i;__pyx_t_8ccluster_int16 __pyx_v_k;int __pyx_v_hero;int __pyx_v_v;int __pyx_v_c;unsigned PY_LONG_LONG __pyx_v_mask;unsigned int __pyx_v_seven;unsigned PY_LONG_LONG __pyx_v_one;/* function exit code */}</pre><pre class="cython line score-0">&#xA0;<span class="">0443</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0444</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">T_CARDS</span> <span class="o">=</span> <span class="mf">5</span></pre>
<pre class='cython code score-0 '>__pyx_v_T_CARDS = 5;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0445</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">N_CARDS</span> <span class="o">=</span> <span class="mf">16</span></pre>
<pre class='cython code score-0 '>__pyx_v_N_CARDS = 16;</pre><pre class="cython line score-0">&#xA0;<span class="">0446</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0447</span>:     <span class="k">cdef</span> <span class="kt">int16</span> <span class="kt">x</span>[45]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0448</span>:     <span class="k">cdef</span> <span class="kt">int16</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">k</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0449</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">hero</span><span class="p">,</span> <span class="nf">v</span><span class="p">,</span> <span class="nf">c</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0450</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">mask</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>__pyx_v_mask = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0451</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">seven</span> <span class="o">=</span> <span class="mf">7</span></pre>
<pre class='cython code score-0 '>__pyx_v_seven = 7;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0452</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">one</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>__pyx_v_one = 1;</pre><pre class="cython line score-0">&#xA0;<span class="">0453</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">key</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0454</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0455</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0456</span>:     <span class="n">c</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>__pyx_v_c = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0457</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_CARDS</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = __pyx_v_N_CARDS;__pyx_t_2 = __pyx_t_1;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {__pyx_v_i = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0458</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">contains</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_4 = (!(__pyx_f_8ccluster_contains(__pyx_v_j, __pyx_v_i) != 0));if (__pyx_t_4) {}}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0459</span>:             <span class="n">x</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>(__pyx_v_x[__pyx_v_c]) = __pyx_v_i;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0460</span>:             <span class="n">c</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>__pyx_v_c = (__pyx_v_c + 1);</pre><pre class="cython line score-0">&#xA0;<span class="">0461</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0462</span>:     <span class="n">mask</span> <span class="o">|=</span> <span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_t_5 = 2;__pyx_v_mask = (__pyx_v_mask | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_j.data + __pyx_t_5 * __pyx_v_j.strides[0]) )))));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0463</span>:     <span class="n">mask</span> <span class="o">|=</span> <span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="p">[</span><span class="mf">3</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_t_5 = 3;__pyx_v_mask = (__pyx_v_mask | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_j.data + __pyx_t_5 * __pyx_v_j.strides[0]) )))));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0464</span>:     <span class="n">mask</span> <span class="o">|=</span> <span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="p">[</span><span class="mf">4</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_t_5 = 4;__pyx_v_mask = (__pyx_v_mask | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_j.data + __pyx_t_5 * __pyx_v_j.strides[0]) )))));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0465</span>:     <span class="n">mask</span> <span class="o">|=</span> <span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="p">[</span><span class="mf">5</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_t_5 = 5;__pyx_v_mask = (__pyx_v_mask | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_j.data + __pyx_t_5 * __pyx_v_j.strides[0]) )))));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0466</span>:     <span class="n">mask</span> <span class="o">|=</span> <span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="p">[</span><span class="mf">6</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_t_5 = 6;__pyx_v_mask = (__pyx_v_mask | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_j.data + __pyx_t_5 * __pyx_v_j.strides[0]) )))));</pre><pre class="cython line score-0">&#xA0;<span class="">0467</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0468</span>:     <span class="n">hero</span> <span class="o">=</span> <span class="n">cy_evaluate</span><span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">|</span> <span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">|</span> <span class="n">mask</span><span class="p">,</span> <span class="n">seven</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_t_5 = 0;__pyx_t_6 = 1;__pyx_v_hero = __pyx_f_8ccluster_cy_evaluate((((__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_j.data + __pyx_t_5 * __pyx_v_j.strides[0]) )))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_j.data + __pyx_t_6 * __pyx_v_j.strides[0]) ))))) | __pyx_v_mask), __pyx_v_seven);</pre><pre class="cython line score-0">&#xA0;<span class="">0469</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0470</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="n">N_CARDS</span> <span class="o">-</span> <span class="n">T_CARDS</span> <span class="o">-</span> <span class="mf">3</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_7 = ((__pyx_v_N_CARDS - __pyx_v_T_CARDS) - 3);__pyx_t_8 = __pyx_t_7;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_8; __pyx_t_3+=1) {__pyx_v_i = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0471</span>:         <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">,</span> <span class="n">N_CARDS</span> <span class="o">-</span> <span class="n">T_CARDS</span> <span class="o">-</span> <span class="mf">2</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_9 = ((__pyx_v_N_CARDS - __pyx_v_T_CARDS) - 2);__pyx_t_10 = __pyx_t_9;for (__pyx_t_11 = (__pyx_v_i + 1); __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {__pyx_v_k = __pyx_t_11;</pre><pre class="cython line score-0">&#xA0;<span class="">0472</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0473</span>:             <span class="n">v</span> <span class="o">=</span> <span class="n">cy_evaluate</span><span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">|</span> <span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">|</span> <span class="n">mask</span><span class="p">,</span> <span class="n">seven</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_v_v = __pyx_f_8ccluster_cy_evaluate((((__pyx_v_one &lt;&lt; (__pyx_v_x[__pyx_v_i])) | (__pyx_v_one &lt;&lt; (__pyx_v_x[__pyx_v_k]))) | __pyx_v_mask), __pyx_v_seven);</pre><pre class="cython line score-0">&#xA0;<span class="">0474</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0475</span>:             <span class="k">if</span><span class="p">(</span><span class="n">hero</span> <span class="o">&gt;</span> <span class="n">v</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_4 = (__pyx_v_hero &gt; __pyx_v_v);if (__pyx_t_4) {goto __pyx_L10;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0476</span>:                 <span class="n">twl_tiewinloss</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>__pyx_t_6 = 1;*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_twl_tiewinloss.data + __pyx_t_6 * __pyx_v_twl_tiewinloss.strides[0]) )) += 1;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0477</span>:             <span class="k">elif</span><span class="p">(</span><span class="n">v</span> <span class="o">&gt;</span> <span class="n">hero</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_4 = (__pyx_v_v &gt; __pyx_v_hero);if (__pyx_t_4) {goto __pyx_L10;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0478</span>:                 <span class="n">twl_tiewinloss</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>__pyx_t_6 = 2;*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_twl_tiewinloss.data + __pyx_t_6 * __pyx_v_twl_tiewinloss.strides[0]) )) += 1;</pre><pre class="cython line score-0">&#xA0;<span class="">0479</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0480</span>:                 <span class="n">twl_tiewinloss</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_t_6 = 0;*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_twl_tiewinloss.data + __pyx_t_6 * __pyx_v_twl_tiewinloss.strides[0]) )) += 1;}__pyx_L10:;}}</pre><pre class="cython line score-0">&#xA0;<span class="">0481</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0482</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0483</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0484</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0485</span>: <span class="k">cdef</span> <span class="kt">float32</span> <span class="nf">emd_c</span><span class="p">(</span><span class="nb">int</span> <span class="n">p</span><span class="p">,</span> <span class="n">float32</span><span class="p">[:]</span> <span class="n">u_values</span><span class="p">,</span> <span class="n">float32</span><span class="p">[:]</span> <span class="n">v_values</span><span class="p">,</span> <span class="n">float32</span><span class="p">[:]</span> <span class="n">all_values</span><span class="p">,</span><span class="n">float32</span><span class="p">[:]</span> <span class="n">all_valuesa</span><span class="p">,</span> <span class="n">float32</span><span class="p">[:]</span> <span class="n">all_valuesaa</span><span class="p">,</span> <span class="n">float32</span><span class="p">[:]</span> <span class="n">deltas</span><span class="p">,</span> <span class="n">u_weights</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">v_weights</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static __pyx_t_8ccluster_float32 __pyx_f_8ccluster_emd_c(CYTHON_UNUSED int __pyx_v_p, __Pyx_memviewslice __pyx_v_u_values, __Pyx_memviewslice __pyx_v_v_values, __Pyx_memviewslice __pyx_v_all_values, __Pyx_memviewslice __pyx_v_all_valuesa, __Pyx_memviewslice __pyx_v_all_valuesaa, __Pyx_memviewslice __pyx_v_deltas, struct __pyx_opt_args_8ccluster_emd_c *__pyx_optional_args) {int __pyx_v_i;int __pyx_v_all_len;__pyx_t_8ccluster_float32 __pyx_r;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("emd_c", 0);if (__pyx_optional_args) {}/* function exit code */__pyx_L1_error:;<span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("ccluster.emd_c", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);__pyx_r = 0;__pyx_L0:;<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}struct __pyx_opt_args_8ccluster_emd_c {int __pyx_n;PyObject *u_weights;PyObject *v_weights;};</pre><pre class="cython line score-0">&#xA0;<span class="">0486</span>:     <span class="s">r&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0487</span>: <span class="s">    Compute, between two one-dimensional distributions :math:`u` and</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0488</span>: <span class="s">    :math:`v`, whose respective CDFs are :math:`U` and :math:`V`, the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0489</span>: <span class="s">    statistical distance that is defined as:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0490</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0491</span>: <span class="s">    .. math::</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0492</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0493</span>: <span class="s">        l_p(u, v) = \left( \int_{-\infty}^{+\infty} |U-V|^p \right)^{1/p}</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0494</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0495</span>: <span class="s">    p is a positive parameter; p = 1 gives the Wasserstein distance, p = 2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0496</span>: <span class="s">    gives the energy distance.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0497</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0498</span>: <span class="s">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0499</span>: <span class="s">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0500</span>: <span class="s">    u_values, v_values : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0501</span>: <span class="s">        Values observed in the (empirical) distribution.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0502</span>: <span class="s">    u_weights, v_weights : array_like, optional</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0503</span>: <span class="s">        Weight for each value. If unspecified, each value is assigned the same</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0504</span>: <span class="s">        weight.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0505</span>: <span class="s">        `u_weights` (resp. `v_weights`) must have the same length as</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0506</span>: <span class="s">        `u_values` (resp. `v_values`). If the weight sum differs from 1, it</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0507</span>: <span class="s">        must still be positive and finite so that the weights can be normalized</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0508</span>: <span class="s">        to sum to 1.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0509</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0510</span>: <span class="s">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0511</span>: <span class="s">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0512</span>: <span class="s">    distance : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0513</span>: <span class="s">        The computed distance between the distributions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0514</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0515</span>: <span class="s">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0516</span>: <span class="s">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0517</span>: <span class="s">    The input distributions can be empirical, therefore coming from samples</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0518</span>: <span class="s">    whose values are effectively inputs of the function, or they can be seen as</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0519</span>: <span class="s">    generalized functions, in which case they are weighted sums of Dirac delta</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0520</span>: <span class="s">    functions located at the specified values.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0521</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0522</span>: <span class="s">    References</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0523</span>: <span class="s">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0524</span>: <span class="s">    .. [1] Bellemare, Danihelka, Dabney, Mohamed, Lakshminarayanan, Hoyer,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0525</span>: <span class="s">           Munos &quot;The Cramer Distance as a Solution to Biased Wasserstein</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0526</span>: <span class="s">           Gradients&quot; (2017). :arXiv:`1705.10743`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0527</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0528</span>: <span class="s">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0529</span>:     <span class="c">#u_values, u_weights = _validate_distribution(u_values, u_weights)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0530</span>:     <span class="c">#v_values, v_weights = _validate_distribution(v_values, v_weights)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0531</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0532</span>:     <span class="n">insertion_sort_inplace_cython_float32</span><span class="p">(</span><span class="n">u_values</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_f_8ccluster_insertion_sort_inplace_cython_float32(__pyx_v_u_values);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0533</span>:     <span class="n">insertion_sort_inplace_cython_float32</span><span class="p">(</span><span class="n">v_values</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_f_8ccluster_insertion_sort_inplace_cython_float32(__pyx_v_v_values);</pre><pre class="cython line score-0">&#xA0;<span class="">0534</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0535</span>:     <span class="c"># u_sorter = numpy.argsort(u_values)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0536</span>:     <span class="c"># v_sorter = numpy.argsort(v_values)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0537</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0538</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0539</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">all_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">u_values</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">v_values</span><span class="p">)</span></pre>
<pre class='cython code score-4 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_u_values); __pyx_t_2 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_v_values); __pyx_v_all_len = (__pyx_t_1 + __pyx_t_2);</pre><pre class="cython line score-0">&#xA0;<span class="">0540</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0541</span>:     <span class="c">#cdef float32[:] all_values = numpy.empty(all_len, dtype = numpy.float32)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0542</span>:     <span class="c">#cdef float32[:] all_valuesa = numpy.empty(all_len-1, dtype = numpy.float32)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0543</span>:     <span class="c">#cdef float32[:] all_valuesaa = numpy.empty(all_len-1, dtype = numpy.float32)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0544</span>:     <span class="c">#cdef float32[:] deltas = numpy.empty(all_len-1, dtype = numpy.float32)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0545</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0546</span>:     <span class="c"># all_values[:len(u_values)] = u_values</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0547</span>:     <span class="c"># all_values[len(u_values):] = v_values</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0548</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0549</span>:     <span class="n">insertion_sort_inplace_cython_float32</span><span class="p">(</span><span class="n">all_values</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_f_8ccluster_insertion_sort_inplace_cython_float32(__pyx_v_all_values);</pre><pre class="cython line score-0">&#xA0;<span class="">0550</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0551</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u_values</span><span class="p">)):</span></pre>
<pre class='cython code score-2 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_u_values); __pyx_t_1 = __pyx_t_2;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_1; __pyx_t_3+=1) {__pyx_v_i = __pyx_t_3;</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0552</span>:         <span class="n">all_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">u_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-4 '>__pyx_t_4 = __pyx_v_i;__pyx_t_5 = -1;if (__pyx_t_4 &lt; 0) {__pyx_t_4 += __pyx_v_u_values.shape[0];if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;} else if (unlikely(__pyx_t_4 &gt;= __pyx_v_u_values.shape[0])) __pyx_t_5 = 0;if (unlikely(__pyx_t_5 != -1)) {<span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);<span class='error_goto'>__PYX_ERR(0, 552, __pyx_L1_error)</span>}__pyx_t_6 = __pyx_v_i;__pyx_t_5 = -1;if (__pyx_t_6 &lt; 0) {__pyx_t_6 += __pyx_v_all_values.shape[0];if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_5 = 0;} else if (unlikely(__pyx_t_6 &gt;= __pyx_v_all_values.shape[0])) __pyx_t_5 = 0;if (unlikely(__pyx_t_5 != -1)) {<span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);<span class='error_goto'>__PYX_ERR(0, 552, __pyx_L1_error)</span>}*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_all_values.data + __pyx_t_6 * __pyx_v_all_values.strides[0]) )) = (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_u_values.data + __pyx_t_4 * __pyx_v_u_values.strides[0]) )));}</pre><pre class="cython line score-0">&#xA0;<span class="">0553</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0554</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">u_values</span><span class="p">),</span> <span class="n">all_len</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>__pyx_t_3 = __pyx_v_all_len;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_u_values); __pyx_t_5 = __pyx_t_3;for (__pyx_t_7 = __pyx_t_2; __pyx_t_7 &lt; __pyx_t_5; __pyx_t_7+=1) {__pyx_v_i = __pyx_t_7;</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0555</span>:         <span class="n">all_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v_values</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">u_values</span><span class="p">)]</span></pre>
<pre class='cython code score-6 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_u_values); __pyx_t_4 = (__pyx_v_i - __pyx_t_1);__pyx_t_8 = -1;if (__pyx_t_4 &lt; 0) {__pyx_t_4 += __pyx_v_v_values.shape[0];if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_8 = 0;} else if (unlikely(__pyx_t_4 &gt;= __pyx_v_v_values.shape[0])) __pyx_t_8 = 0;if (unlikely(__pyx_t_8 != -1)) {<span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);<span class='error_goto'>__PYX_ERR(0, 555, __pyx_L1_error)</span>}__pyx_t_6 = __pyx_v_i;__pyx_t_8 = -1;if (__pyx_t_6 &lt; 0) {__pyx_t_6 += __pyx_v_all_values.shape[0];if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_8 = 0;} else if (unlikely(__pyx_t_6 &gt;= __pyx_v_all_values.shape[0])) __pyx_t_8 = 0;if (unlikely(__pyx_t_8 != -1)) {<span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_8);<span class='error_goto'>__PYX_ERR(0, 555, __pyx_L1_error)</span>}*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_all_values.data + __pyx_t_6 * __pyx_v_all_values.strides[0]) )) = (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_v_values.data + __pyx_t_4 * __pyx_v_v_values.strides[0]) )));}</pre><pre class="cython line score-0">&#xA0;<span class="">0556</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0557</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">all_len</span><span class="o">-</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_9 = (__pyx_v_all_len - 1);__pyx_t_10 = __pyx_t_9;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_10; __pyx_t_3+=1) {__pyx_v_i = __pyx_t_3;</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0558</span>:         <span class="n">deltas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_values</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">all_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-6 '>__pyx_t_4 = (__pyx_v_i + 1);__pyx_t_5 = -1;if (__pyx_t_4 &lt; 0) {__pyx_t_4 += __pyx_v_all_values.shape[0];if (unlikely(__pyx_t_4 &lt; 0)) __pyx_t_5 = 0;} else if (unlikely(__pyx_t_4 &gt;= __pyx_v_all_values.shape[0])) __pyx_t_5 = 0;if (unlikely(__pyx_t_5 != -1)) {<span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);<span class='error_goto'>__PYX_ERR(0, 558, __pyx_L1_error)</span>}__pyx_t_6 = __pyx_v_i;__pyx_t_5 = -1;if (__pyx_t_6 &lt; 0) {__pyx_t_6 += __pyx_v_all_values.shape[0];if (unlikely(__pyx_t_6 &lt; 0)) __pyx_t_5 = 0;} else if (unlikely(__pyx_t_6 &gt;= __pyx_v_all_values.shape[0])) __pyx_t_5 = 0;if (unlikely(__pyx_t_5 != -1)) {<span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);<span class='error_goto'>__PYX_ERR(0, 558, __pyx_L1_error)</span>}__pyx_t_11 = __pyx_v_i;__pyx_t_5 = -1;if (__pyx_t_11 &lt; 0) {__pyx_t_11 += __pyx_v_deltas.shape[0];if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_5 = 0;} else if (unlikely(__pyx_t_11 &gt;= __pyx_v_deltas.shape[0])) __pyx_t_5 = 0;if (unlikely(__pyx_t_5 != -1)) {<span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_5);<span class='error_goto'>__PYX_ERR(0, 558, __pyx_L1_error)</span>}*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_deltas.data + __pyx_t_11 * __pyx_v_deltas.strides[0]) )) = ((*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_all_values.data + __pyx_t_4 * __pyx_v_all_values.strides[0]) ))) - (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_all_values.data + __pyx_t_6 * __pyx_v_all_values.strides[0]) ))));}</pre><pre class="cython line score-0">&#xA0;<span class="">0559</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0560</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0561</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0562</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0563</span>:     <span class="k">return</span> <span class="n">all_ind</span><span class="p">(</span><span class="n">u_values</span><span class="p">,</span> <span class="n">v_values</span><span class="p">,</span> <span class="n">all_values</span><span class="p">,</span> <span class="n">all_valuesa</span><span class="p">,</span> <span class="n">all_valuesaa</span><span class="p">,</span> <span class="n">deltas</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_f_8ccluster_all_ind(__pyx_v_u_values, __pyx_v_v_values, __pyx_v_all_values, __pyx_v_all_valuesa, __pyx_v_all_valuesaa, __pyx_v_deltas);goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0564</span>: </pre>
<pre class="cython line score-122" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0565</span>: <span class="k">cpdef</span> <span class="kt">float32</span> <span class="nf">emd_cp</span><span class="p">(</span><span class="nb">int</span> <span class="n">p</span><span class="p">,</span> <span class="n">float32</span><span class="p">[:]</span> <span class="n">u_values</span><span class="p">,</span> <span class="n">float32</span><span class="p">[:]</span> <span class="n">v_values</span><span class="p">,</span> <span class="n">u_weights</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">v_weights</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre>
<pre class='cython code score-122 '>static PyObject *__pyx_pw_8ccluster_5emd_cp(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/static __pyx_t_8ccluster_float32 __pyx_f_8ccluster_emd_cp(CYTHON_UNUSED int __pyx_v_p, __Pyx_memviewslice __pyx_v_u_values, __Pyx_memviewslice __pyx_v_v_values, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_8ccluster_emd_cp *__pyx_optional_args) {PyObject *__pyx_v_all_len = NULL;__Pyx_memviewslice __pyx_v_all_values = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_all_valuesa = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_all_valuesaa = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_deltas = { 0, 0, { 0 }, { 0 }, { 0 } };PyObject *__pyx_v_i = NULL;__pyx_t_8ccluster_float32 __pyx_r;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("emd_cp", 0);if (__pyx_optional_args) {}/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);<span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("ccluster.emd_cp", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);__pyx_r = 0;__pyx_L0:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_all_len);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_all_values, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_all_valuesa, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_all_valuesaa, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deltas, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}/* Python wrapper */static PyObject *__pyx_pw_8ccluster_5emd_cp(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8ccluster_4emd_cp, "\n    Compute, between two one-dimensional distributions :math:`u` and\n    :math:`v`, whose respective CDFs are :math:`U` and :math:`V`, the\n    statistical distance that is defined as:\n\n    .. math::\n\n        l_p(u, v) = \\left( \\int_{-\\infty}^{+\\infty} |U-V|^p \\right)^{1/p}\n\n    p is a positive parameter; p = 1 gives the Wasserstein distance, p = 2\n    gives the energy distance.\n\n    Parameters\n    ----------\n    u_values, v_values : array_like\n        Values observed in the (empirical) distribution.\n    u_weights, v_weights : array_like, optional\n        Weight for each value. If unspecified, each value is assigned the same\n        weight.\n        `u_weights` (resp. `v_weights`) must have the same length as\n        `u_values` (resp. `v_values`). If the weight sum differs from 1, it\n        must still be positive and finite so that the weights can be normalized\n        to sum to 1.\n\n    Returns\n    -------\n    distance : float\n        The computed distance between the distributions.\n\n    Notes\n    -----\n    The input distributions can be empirical, therefore coming from samples\n    whose values are effectively inputs of the function, or they can be seen as\n    generalized functions, in which case they are weighted sums of Dirac delta\n    functions located at the specified values.\n\n    References\n    ----------\n    .. [1] Bellemare, Danihelka, Dabney, Mohamed, Lakshminarayanan, Hoyer,\n           Munos \"The Cramer Distance as a Solution to Biased Wasserstein\n           Gradients\" (2017). :arXiv:`1705.10743`.\n\n    ");static PyMethodDef __pyx_mdef_8ccluster_5emd_cp = {"emd_cp", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8ccluster_5emd_cp, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8ccluster_4emd_cp};static PyObject *__pyx_pw_8ccluster_5emd_cp(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {int __pyx_v_p;__Pyx_memviewslice __pyx_v_u_values = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_v_values = { 0, 0, { 0 }, { 0 }, { 0 } };PyObject *__pyx_v_u_weights = 0;PyObject *__pyx_v_v_weights = 0;#if !CYTHON_METH_FASTCALLCYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);#endifCYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);PyObject *__pyx_r = 0;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("emd_cp (wrapper)", 0);{#if CYTHON_USE_MODULE_STATEPyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_p,&amp;__pyx_n_s_u_values,&amp;__pyx_n_s_v_values,&amp;__pyx_n_s_u_weights,&amp;__pyx_n_s_v_weights,0};#elsestatic PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_p,&amp;__pyx_n_s_u_values,&amp;__pyx_n_s_v_values,&amp;__pyx_n_s_u_weights,&amp;__pyx_n_s_v_weights,0};#endifPyObject* values[5] = {0,0,0,0,0};values[3] = ((PyObject *)Py_None);values[4] = ((PyObject *)Py_None);if (__pyx_kwds) {Py_ssize_t kw_args;switch (__pyx_nargs) {case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);CYTHON_FALLTHROUGH;case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);CYTHON_FALLTHROUGH;case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);CYTHON_FALLTHROUGH;case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);CYTHON_FALLTHROUGH;case  0: break;default: goto __pyx_L5_argtuple_error;}kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);switch (__pyx_nargs) {case  0:if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_p)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 565, __pyx_L3_error)</span>else goto __pyx_L5_argtuple_error;CYTHON_FALLTHROUGH;case  1:if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_u_values)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 565, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emd_cp", 0, 3, 5, 1); <span class='error_goto'>__PYX_ERR(0, 565, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  2:if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v_values)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 565, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emd_cp", 0, 3, 5, 2); <span class='error_goto'>__PYX_ERR(0, 565, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  3:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_u_weights);if (value) { values[3] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 565, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  4:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v_weights);if (value) { values[4] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 565, __pyx_L3_error)</span>}}if (unlikely(kw_args &gt; 0)) {const Py_ssize_t kwd_pos_args = __pyx_nargs;if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "emd_cp") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 565, __pyx_L3_error)</span>}} else {switch (__pyx_nargs) {case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);CYTHON_FALLTHROUGH;case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);break;default: goto __pyx_L5_argtuple_error;}}__pyx_v_p = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_p == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 565, __pyx_L3_error)</span>__pyx_v_u_values = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_u_values.memview)) __PYX_ERR(0, 565, __pyx_L3_error)</span>__pyx_v_v_values = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_v_values.memview)) __PYX_ERR(0, 565, __pyx_L3_error)</span>__pyx_v_u_weights = values[3];__pyx_v_v_weights = values[4];}goto __pyx_L4_argument_unpacking_done;__pyx_L5_argtuple_error:;<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emd_cp", 0, 3, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 565, __pyx_L3_error)</span>__pyx_L3_error:;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_u_values, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_values, 1);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.emd_cp", __pyx_clineno, __pyx_lineno, __pyx_filename);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return NULL;__pyx_L4_argument_unpacking_done:;__pyx_r = __pyx_pf_8ccluster_4emd_cp(__pyx_self, __pyx_v_p, __pyx_v_u_values, __pyx_v_v_values, __pyx_v_u_weights, __pyx_v_v_weights);/* function exit code */__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_u_values, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_values, 1);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}static PyObject *__pyx_pf_8ccluster_4emd_cp(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_p, __Pyx_memviewslice __pyx_v_u_values, __Pyx_memviewslice __pyx_v_v_values, PyObject *__pyx_v_u_weights, PyObject *__pyx_v_v_weights) {PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("emd_cp", 0);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);if (unlikely(!__pyx_v_u_values.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("u_values"); <span class='error_goto'>__PYX_ERR(0, 565, __pyx_L1_error)</span> }if (unlikely(!__pyx_v_v_values.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("v_values"); <span class='error_goto'>__PYX_ERR(0, 565, __pyx_L1_error)</span> }__pyx_t_2.__pyx_n = 2;__pyx_t_2.u_weights = __pyx_v_u_weights;__pyx_t_2.v_weights = __pyx_v_v_weights;__pyx_t_1 = __pyx_f_8ccluster_emd_cp(__pyx_v_p, __pyx_v_u_values, __pyx_v_v_values, 0, &amp;__pyx_t_2); __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 565, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_r = __pyx_t_3;__pyx_t_3 = 0;goto __pyx_L0;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.emd_cp", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = NULL;__pyx_L0:;<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}__pyx_tuple__44 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_p, __pyx_n_s_u_values, __pyx_n_s_v_values, __pyx_n_s_u_weights, __pyx_n_s_v_weights);<span class='error_goto'> if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 565, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__44);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__44);__pyx_codeobj__45 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__44, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ccluster_pyx, __pyx_n_s_emd_cp, 565, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__45)) __PYX_ERR(0, 565, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8ccluster_5emd_cp, 0, __pyx_n_s_emd_cp, NULL, __pyx_n_s_ccluster, __pyx_d, ((PyObject *)__pyx_codeobj__45));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 565, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__46);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_emd_cp, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 565, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_tuple__46 = <span class='py_c_api'>PyTuple_Pack</span>(2, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__46)) __PYX_ERR(0, 565, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__46);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__46);struct __pyx_opt_args_8ccluster_emd_cp {int __pyx_n;PyObject *u_weights;PyObject *v_weights;};</pre><pre class="cython line score-0">&#xA0;<span class="">0566</span>:     <span class="s">r&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0567</span>: <span class="s">    Compute, between two one-dimensional distributions :math:`u` and</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0568</span>: <span class="s">    :math:`v`, whose respective CDFs are :math:`U` and :math:`V`, the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0569</span>: <span class="s">    statistical distance that is defined as:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0570</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0571</span>: <span class="s">    .. math::</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0572</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0573</span>: <span class="s">        l_p(u, v) = \left( \int_{-\infty}^{+\infty} |U-V|^p \right)^{1/p}</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0574</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0575</span>: <span class="s">    p is a positive parameter; p = 1 gives the Wasserstein distance, p = 2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0576</span>: <span class="s">    gives the energy distance.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0577</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0578</span>: <span class="s">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0579</span>: <span class="s">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0580</span>: <span class="s">    u_values, v_values : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0581</span>: <span class="s">        Values observed in the (empirical) distribution.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0582</span>: <span class="s">    u_weights, v_weights : array_like, optional</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0583</span>: <span class="s">        Weight for each value. If unspecified, each value is assigned the same</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0584</span>: <span class="s">        weight.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0585</span>: <span class="s">        `u_weights` (resp. `v_weights`) must have the same length as</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0586</span>: <span class="s">        `u_values` (resp. `v_values`). If the weight sum differs from 1, it</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0587</span>: <span class="s">        must still be positive and finite so that the weights can be normalized</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0588</span>: <span class="s">        to sum to 1.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0589</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0590</span>: <span class="s">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0591</span>: <span class="s">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0592</span>: <span class="s">    distance : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0593</span>: <span class="s">        The computed distance between the distributions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0594</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0595</span>: <span class="s">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0596</span>: <span class="s">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0597</span>: <span class="s">    The input distributions can be empirical, therefore coming from samples</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0598</span>: <span class="s">    whose values are effectively inputs of the function, or they can be seen as</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0599</span>: <span class="s">    generalized functions, in which case they are weighted sums of Dirac delta</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0600</span>: <span class="s">    functions located at the specified values.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0601</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0602</span>: <span class="s">    References</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0603</span>: <span class="s">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0604</span>: <span class="s">    .. [1] Bellemare, Danihelka, Dabney, Mohamed, Lakshminarayanan, Hoyer,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0605</span>: <span class="s">           Munos &quot;The Cramer Distance as a Solution to Biased Wasserstein</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0606</span>: <span class="s">           Gradients&quot; (2017). :arXiv:`1705.10743`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0607</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0608</span>: <span class="s">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0609</span>:     <span class="c">#u_values, u_weights = _validate_distribution(u_values, u_weights)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0610</span>:     <span class="c">#v_values, v_weights = _validate_distribution(v_values, v_weights)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0611</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0612</span>:     <span class="n">insertion_sort_inplace_cython_float32</span><span class="p">(</span><span class="n">u_values</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_f_8ccluster_insertion_sort_inplace_cython_float32(__pyx_v_u_values);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0613</span>:     <span class="n">insertion_sort_inplace_cython_float32</span><span class="p">(</span><span class="n">v_values</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_f_8ccluster_insertion_sort_inplace_cython_float32(__pyx_v_v_values);</pre><pre class="cython line score-0">&#xA0;<span class="">0614</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0615</span>:     <span class="c"># u_sorter = numpy.argsort(u_values)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0616</span>:     <span class="c"># v_sorter = numpy.argsort(v_values)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0617</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0618</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0619</span>:     <span class="n">all_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">u_values</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">v_values</span><span class="p">)</span></pre>
<pre class='cython code score-9 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_u_values); __pyx_t_2 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_v_values); __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_t_1 + __pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 619, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_v_all_len = __pyx_t_3;__pyx_t_3 = 0;</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0620</span>:     <span class="k">cdef</span> <span class="kt">float32</span>[<span class="p">:]</span> <span class="n">all_values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">all_len</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-31 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 620, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 620, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 620, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_all_len);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_all_len);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_all_len);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 620, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 620, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 620, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 620, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;__pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 620, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_7, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 620, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;__pyx_v_all_values = __pyx_t_8;__pyx_t_8.memview = NULL;__pyx_t_8.data = NULL;</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0621</span>:     <span class="k">cdef</span> <span class="kt">float32</span>[<span class="p">:]</span> <span class="n">all_valuesa</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">all_len</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-32 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 621, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 621, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;__pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_all_len, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 621, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);__pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 621, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_7);__pyx_t_7 = 0;__pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 621, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 621, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 621, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 621, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 621, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;__pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 621, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_v_all_valuesa = __pyx_t_8;__pyx_t_8.memview = NULL;__pyx_t_8.data = NULL;</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0622</span>:     <span class="k">cdef</span> <span class="kt">float32</span>[<span class="p">:]</span> <span class="n">all_valuesaa</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">all_len</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-32 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 622, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 622, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_all_len, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 622, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 622, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_6);__pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 622, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 622, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 622, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 622, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_3, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 622, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 622, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_v_all_valuesaa = __pyx_t_8;__pyx_t_8.memview = NULL;__pyx_t_8.data = NULL;</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0623</span>:     <span class="k">cdef</span> <span class="kt">float32</span>[<span class="p">:]</span> <span class="n">deltas</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">all_len</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-32 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 623, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 623, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_all_len, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 623, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 623, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);__pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 623, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 623, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 623, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 623, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 623, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 623, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_v_deltas = __pyx_t_8;__pyx_t_8.memview = NULL;__pyx_t_8.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0624</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0625</span>:     <span class="n">all_values</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">u_values</span><span class="p">)]</span> <span class="o">=</span> <span class="n">u_values</span></pre>
<pre class='cython code score-2 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_u_values); __pyx_t_8.data = __pyx_v_all_values.data;__pyx_t_8.memview = __pyx_v_all_values.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_8, 1);__pyx_t_9 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_8,
    __pyx_v_all_values.shape[0], __pyx_v_all_values.strides[0], __pyx_v_all_values.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_9,
    0,
    __pyx_t_2,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 625, __pyx_L1_error)</span>
}

if (unlikely((__pyx_memoryview_copy_contents(__pyx_v_u_values, __pyx_t_8, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 625, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);__pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0626</span>:     <span class="n">all_values</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">u_values</span><span class="p">):]</span> <span class="o">=</span> <span class="n">v_values</span></pre>
<pre class='cython code score-2 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_u_values); __pyx_t_8.data = __pyx_v_all_values.data;__pyx_t_8.memview = __pyx_v_all_values.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_8, 1);__pyx_t_9 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_8,
    __pyx_v_all_values.shape[0], __pyx_v_all_values.strides[0], __pyx_v_all_values.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_9,
    __pyx_t_2,
    0,
    0,
    1,
    0,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 626, __pyx_L1_error)</span>
}

if (unlikely((__pyx_memoryview_copy_contents(__pyx_v_v_values, __pyx_t_8, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 626, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);__pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0627</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0628</span>:     <span class="n">insertion_sort_inplace_cython_float32</span><span class="p">(</span><span class="n">all_values</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_f_8ccluster_insertion_sort_inplace_cython_float32(__pyx_v_all_values);</pre><pre class="cython line score-0">&#xA0;<span class="">0629</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0630</span>: </pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0631</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">all_len</span><span class="o">-</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-51 '>__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_all_len, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 631, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 631, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {__pyx_t_5 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_2 = 0;__pyx_t_10 = NULL;} else {__pyx_t_2 = -1; __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 631, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 631, __pyx_L1_error)</span>}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;for (;;) {if (likely(!__pyx_t_10)) {if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_5, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 631, __pyx_L1_error)</span>#else__pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 631, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);#endif} else {if (__pyx_t_2 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_5)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_5, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 631, __pyx_L1_error)</span>#else__pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 631, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);#endif}} else {__pyx_t_4 = __pyx_t_10(__pyx_t_5);if (unlikely(!__pyx_t_4)) {PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();if (exc_type) {if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();else <span class='error_goto'>__PYX_ERR(0, 631, __pyx_L1_error)</span>}break;}<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_4);__pyx_t_4 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0632</span>:         <span class="n">deltas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_values</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">all_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-30 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 632, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_4); if (unlikely((__pyx_t_1 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 632, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_11 = __pyx_t_1;__pyx_t_9 = -1;if (__pyx_t_11 &lt; 0) {__pyx_t_11 += __pyx_v_all_values.shape[0];if (unlikely(__pyx_t_11 &lt; 0)) __pyx_t_9 = 0;} else if (unlikely(__pyx_t_11 &gt;= __pyx_v_all_values.shape[0])) __pyx_t_9 = 0;if (unlikely(__pyx_t_9 != -1)) {<span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);<span class='error_goto'>__PYX_ERR(0, 632, __pyx_L1_error)</span>}__pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_i); if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 632, __pyx_L1_error)</span>__pyx_t_13 = __pyx_t_12;__pyx_t_9 = -1;if (__pyx_t_13 &lt; 0) {__pyx_t_13 += __pyx_v_all_values.shape[0];if (unlikely(__pyx_t_13 &lt; 0)) __pyx_t_9 = 0;} else if (unlikely(__pyx_t_13 &gt;= __pyx_v_all_values.shape[0])) __pyx_t_9 = 0;if (unlikely(__pyx_t_9 != -1)) {<span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);<span class='error_goto'>__PYX_ERR(0, 632, __pyx_L1_error)</span>}__pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_i); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 632, __pyx_L1_error)</span>__pyx_t_15 = __pyx_t_14;__pyx_t_9 = -1;if (__pyx_t_15 &lt; 0) {__pyx_t_15 += __pyx_v_deltas.shape[0];if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_9 = 0;} else if (unlikely(__pyx_t_15 &gt;= __pyx_v_deltas.shape[0])) __pyx_t_9 = 0;if (unlikely(__pyx_t_9 != -1)) {<span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_9);<span class='error_goto'>__PYX_ERR(0, 632, __pyx_L1_error)</span>}*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_deltas.data + __pyx_t_15 * __pyx_v_deltas.strides[0]) )) = ((*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_all_values.data + __pyx_t_11 * __pyx_v_all_values.strides[0]) ))) - (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_all_values.data + __pyx_t_13 * __pyx_v_all_values.strides[0]) ))));</pre><pre class="cython line score-0">&#xA0;<span class="">0633</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0634</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0635</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0636</span>:     <span class="k">return</span> <span class="n">all_ind</span><span class="p">(</span><span class="n">u_values</span><span class="p">,</span> <span class="n">v_values</span><span class="p">,</span> <span class="n">all_values</span><span class="p">,</span> <span class="n">all_valuesa</span><span class="p">,</span> <span class="n">all_valuesaa</span><span class="p">,</span> <span class="n">deltas</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_f_8ccluster_all_ind(__pyx_v_u_values, __pyx_v_v_values, __pyx_v_all_values, __pyx_v_all_valuesa, __pyx_v_all_valuesaa, __pyx_v_deltas);goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0637</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0638</span>: </pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0639</span>: <span class="k">def</span> <span class="nf">_validate_distribution</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span></pre>
<pre class='cython code score-61 '>/* Python wrapper */static PyObject *__pyx_pw_8ccluster_7_validate_distribution(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8ccluster_6_validate_distribution, "\n    Validate the values and weights from a distribution input of `cdf_distance`\n    and return them as ndarray objects.\n\n    Parameters\n    ----------\n    values : array_like\n        Values observed in the (empirical) distribution.\n    weights : array_like\n        Weight for each value.\n\n    Returns\n    -------\n    values : ndarray\n        Values as ndarray.\n    weights : ndarray\n        Weights as ndarray.\n\n    ");static PyMethodDef __pyx_mdef_8ccluster_7_validate_distribution = {"_validate_distribution", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8ccluster_7_validate_distribution, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8ccluster_6_validate_distribution};static PyObject *__pyx_pw_8ccluster_7_validate_distribution(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {PyObject *__pyx_v_values = 0;PyObject *__pyx_v_weights = 0;#if !CYTHON_METH_FASTCALLCYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);#endifCYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);PyObject *__pyx_r = 0;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("_validate_distribution (wrapper)", 0);{#if CYTHON_USE_MODULE_STATEPyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_values,&amp;__pyx_n_s_weights,0};#elsestatic PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_values,&amp;__pyx_n_s_weights,0};#endifPyObject* values[2] = {0,0};if (__pyx_kwds) {Py_ssize_t kw_args;switch (__pyx_nargs) {case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);CYTHON_FALLTHROUGH;case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);CYTHON_FALLTHROUGH;case  0: break;default: goto __pyx_L5_argtuple_error;}kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);switch (__pyx_nargs) {case  0:if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_values)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L3_error)</span>else goto __pyx_L5_argtuple_error;CYTHON_FALLTHROUGH;case  1:if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_weights)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_validate_distribution", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L3_error)</span>}}if (unlikely(kw_args &gt; 0)) {const Py_ssize_t kwd_pos_args = __pyx_nargs;if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_validate_distribution") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L3_error)</span>}} else if (unlikely(__pyx_nargs != 2)) {goto __pyx_L5_argtuple_error;} else {values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);}__pyx_v_values = values[0];__pyx_v_weights = values[1];}goto __pyx_L4_argument_unpacking_done;__pyx_L5_argtuple_error:;<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_validate_distribution", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L3_error)</span>__pyx_L3_error:;<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster._validate_distribution", __pyx_clineno, __pyx_lineno, __pyx_filename);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return NULL;__pyx_L4_argument_unpacking_done:;__pyx_r = __pyx_pf_8ccluster_6_validate_distribution(__pyx_self, __pyx_v_values, __pyx_v_weights);int __pyx_lineno = 0;const char *__pyx_filename = NULL;int __pyx_clineno = 0;/* function exit code */<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}static PyObject *__pyx_pf_8ccluster_6_validate_distribution(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_values, PyObject *__pyx_v_weights) {PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("_validate_distribution", 0);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_values);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_weights);/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster._validate_distribution", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = NULL;__pyx_L0:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_values);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_weights);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}__pyx_tuple__47 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_values, __pyx_n_s_weights);<span class='error_goto'> if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 639, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__47);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__47);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8ccluster_7_validate_distribution, 0, __pyx_n_s_validate_distribution, NULL, __pyx_n_s_ccluster, __pyx_d, ((PyObject *)__pyx_codeobj__48));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 639, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_validate_distribution, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_codeobj__48 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__47, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ccluster_pyx, __pyx_n_s_validate_distribution, 639, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__48)) __PYX_ERR(0, 639, __pyx_L1_error)</span></pre><pre class="cython line score-0">&#xA0;<span class="">0640</span>:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0641</span>: <span class="sd">    Validate the values and weights from a distribution input of `cdf_distance`</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0642</span>: <span class="sd">    and return them as ndarray objects.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0643</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0644</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0645</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0646</span>: <span class="sd">    values : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0647</span>: <span class="sd">        Values observed in the (empirical) distribution.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0648</span>: <span class="sd">    weights : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0649</span>: <span class="sd">        Weight for each value.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0650</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0651</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0652</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0653</span>: <span class="sd">    values : ndarray</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0654</span>: <span class="sd">        Values as ndarray.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0655</span>: <span class="sd">    weights : ndarray</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0656</span>: <span class="sd">        Weights as ndarray.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0657</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0658</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0659</span>:     <span class="c"># Validate the value array.</span></pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0660</span>:     <span class="n">values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 660, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 660, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 660, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_values);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_values);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_values);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 660, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 660, __pyx_L1_error)</span>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 660, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_values, __pyx_t_4);__pyx_t_4 = 0;</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0661</span>:     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>__pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_values);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 661, __pyx_L1_error)</span>__pyx_t_6 = (__pyx_t_5 == 0);if (unlikely(__pyx_t_6)) {}</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0662</span>:         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Distribution can&#39;t be empty.&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 662, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>__pyx_tuple__6 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Distribution_can_t_be_empty);<span class='error_goto'> if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 662, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__6);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__6);</pre><pre class="cython line score-0">&#xA0;<span class="">0663</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0664</span>:     <span class="c"># Validate the weight array, if specified.</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0665</span>:     <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_6 = (__pyx_v_weights != Py_None);if (__pyx_t_6) {}</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0666</span>:         <span class="n">weights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span></pre>
<pre class='cython code score-25 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 666, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 666, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 666, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_weights);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_weights);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_weights);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 666, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 666, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 666, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_weights, __pyx_t_2);__pyx_t_2 = 0;</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0667</span>:         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">):</span></pre>
<pre class='cython code score-10 '>__pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_weights);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 667, __pyx_L1_error)</span>__pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_values);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 667, __pyx_L1_error)</span>__pyx_t_6 = (__pyx_t_5 != __pyx_t_7);if (unlikely(__pyx_t_6)) {}</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0668</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Value and weight array-likes for the same &#39;</span></pre>
<pre class='cython code score-10 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 668, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>__PYX_ERR(0, 668, __pyx_L1_error)</span>__pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Value_and_weight_array_likes_for);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 668, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);</pre><pre class="cython line score-0">&#xA0;<span class="">0669</span>:                              <span class="s">&#39;empirical distribution must be of the same size.&#39;</span><span class="p">)</span></pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0670</span>:         <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">weights</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">):</span></pre>
<pre class='cython code score-28 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 670, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_any);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 670, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_weights, __pyx_int_0, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 670, __pyx_L1_error)</span>__pyx_t_3 = NULL;__pyx_t_8 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);__pyx_t_8 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_1};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 670, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;}__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (unlikely(__pyx_t_6)) {}</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0671</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;All weights must be non-negative.&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 671, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>__PYX_ERR(0, 671, __pyx_L1_error)</span>__pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_All_weights_must_be_non_negative);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 671, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0672</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="mf">0</span> <span class="o">&lt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">numpy</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span></pre>
<pre class='cython code score-42 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 672, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 672, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = NULL;__pyx_t_8 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {__pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);if (likely(__pyx_t_4)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);__pyx_t_8 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_weights};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 672, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;}__pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_int_0, __pyx_t_2, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 672, __pyx_L1_error)</span>if (<span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1)) {<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 672, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_inf);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 672, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 672, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 672, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_9 = (!__pyx_t_6);if (unlikely(__pyx_t_9)) {}</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0673</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Weight array-like sum must be positive and &#39;</span></pre>
<pre class='cython code score-10 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 673, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>__PYX_ERR(0, 673, __pyx_L1_error)</span>__pyx_tuple__9 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Weight_array_like_sum_must_be_po);<span class='error_goto'> if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 673, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__9);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__9);</pre><pre class="cython line score-0">&#xA0;<span class="">0674</span>:                              <span class="s">&#39;finite. Set as None for an equal distribution of &#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0675</span>:                              <span class="s">&#39;weight.&#39;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0676</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0677</span>:         <span class="k">return</span> <span class="n">values</span><span class="p">,</span> <span class="n">weights</span></pre>
<pre class='cython code score-10 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 677, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_values);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_values);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_values);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_weights);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_weights);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_weights);__pyx_r = __pyx_t_1;__pyx_t_1 = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0678</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0679</span>:     <span class="k">return</span> <span class="n">values</span><span class="p">,</span> <span class="bp">None</span></pre>
<pre class='cython code score-10 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 679, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_values);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_values);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_values);<span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);<span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, Py_None);__pyx_r = __pyx_t_1;__pyx_t_1 = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0680</span>: </pre>
<pre class="cython line score-122" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0681</span>: <span class="k">cpdef</span> <span class="nf">emd</span><span class="p">(</span><span class="nb">int</span> <span class="n">p</span><span class="p">,</span> <span class="n">u_values</span><span class="p">,</span> <span class="n">v_values</span><span class="p">,</span> <span class="n">u_weights</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">v_weights</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre>
<pre class='cython code score-122 '>static PyObject *__pyx_pw_8ccluster_9emd(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/static PyObject *__pyx_f_8ccluster_emd(CYTHON_UNUSED int __pyx_v_p, PyObject *__pyx_v_u_values, PyObject *__pyx_v_v_values, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_8ccluster_emd *__pyx_optional_args) {PyObject *__pyx_v_u_weights = ((PyObject *)Py_None);PyObject *__pyx_v_v_weights = ((PyObject *)Py_None);PyObject *__pyx_v_u_sorter = NULL;PyObject *__pyx_v_v_sorter = NULL;PyObject *__pyx_v_all_values = NULL;PyObject *__pyx_v_deltas = NULL;PyObject *__pyx_v_u_cdf_indices = NULL;PyObject *__pyx_v_v_cdf_indices = NULL;PyObject *__pyx_v_u_cdf = NULL;PyObject *__pyx_v_u_sorted_cumweights = NULL;PyObject *__pyx_v_v_cdf = NULL;PyObject *__pyx_v_v_sorted_cumweights = NULL;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("emd", 0);if (__pyx_optional_args) {if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {__pyx_v_u_weights = __pyx_optional_args-&gt;u_weights;if (__pyx_optional_args-&gt;__pyx_n &gt; 1) {__pyx_v_v_weights = __pyx_optional_args-&gt;v_weights;}}}<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_u_values);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_v_values);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_u_weights);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_v_weights);/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.emd", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = 0;__pyx_L0:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_u_sorter);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v_sorter);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_all_values);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_deltas);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_u_cdf_indices);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v_cdf_indices);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_u_cdf);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_u_sorted_cumweights);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v_cdf);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v_sorted_cumweights);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_u_values);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v_values);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_u_weights);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v_weights);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}/* Python wrapper */static PyObject *__pyx_pw_8ccluster_9emd(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8ccluster_8emd, "\n    Compute, between two one-dimensional distributions :math:`u` and\n    :math:`v`, whose respective CDFs are :math:`U` and :math:`V`, the\n    statistical distance that is defined as:\n\n    .. math::\n\n        l_p(u, v) = \\left( \\int_{-\\infty}^{+\\infty} |U-V|^p \\right)^{1/p}\n\n    p is a positive parameter; p = 1 gives the Wasserstein distance, p = 2\n    gives the energy distance.\n\n    Parameters\n    ----------\n    u_values, v_values : array_like\n        Values observed in the (empirical) distribution.\n    u_weights, v_weights : array_like, optional\n        Weight for each value. If unspecified, each value is assigned the same\n        weight.\n        `u_weights` (resp. `v_weights`) must have the same length as\n        `u_values` (resp. `v_values`). If the weight sum differs from 1, it\n        must still be positive and finite so that the weights can be normalized\n        to sum to 1.\n\n    Returns\n    -------\n    distance : float\n        The computed distance between the distributions.\n\n    Notes\n    -----\n    The input distributions can be empirical, therefore coming from samples\n    whose values are effectively inputs of the function, or they can be seen as\n    generalized functions, in which case they are weighted sums of Dirac delta\n    functions located at the specified values.\n\n    References\n    ----------\n    .. [1] Bellemare, Danihelka, Dabney, Mohamed, Lakshminarayanan, Hoyer,\n           Munos \"The Cramer Distance as a Solution to Biased Wasserstein\n           Gradients\" (2017). :arXiv:`1705.10743`.\n\n    ");static PyMethodDef __pyx_mdef_8ccluster_9emd = {"emd", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8ccluster_9emd, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8ccluster_8emd};static PyObject *__pyx_pw_8ccluster_9emd(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {int __pyx_v_p;PyObject *__pyx_v_u_values = 0;PyObject *__pyx_v_v_values = 0;PyObject *__pyx_v_u_weights = 0;PyObject *__pyx_v_v_weights = 0;#if !CYTHON_METH_FASTCALLCYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);#endifCYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);PyObject *__pyx_r = 0;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("emd (wrapper)", 0);{#if CYTHON_USE_MODULE_STATEPyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_p,&amp;__pyx_n_s_u_values,&amp;__pyx_n_s_v_values,&amp;__pyx_n_s_u_weights,&amp;__pyx_n_s_v_weights,0};#elsestatic PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_p,&amp;__pyx_n_s_u_values,&amp;__pyx_n_s_v_values,&amp;__pyx_n_s_u_weights,&amp;__pyx_n_s_v_weights,0};#endifPyObject* values[5] = {0,0,0,0,0};values[3] = ((PyObject *)Py_None);values[4] = ((PyObject *)Py_None);if (__pyx_kwds) {Py_ssize_t kw_args;switch (__pyx_nargs) {case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);CYTHON_FALLTHROUGH;case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);CYTHON_FALLTHROUGH;case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);CYTHON_FALLTHROUGH;case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);CYTHON_FALLTHROUGH;case  0: break;default: goto __pyx_L5_argtuple_error;}kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);switch (__pyx_nargs) {case  0:if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_p)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 681, __pyx_L3_error)</span>else goto __pyx_L5_argtuple_error;CYTHON_FALLTHROUGH;case  1:if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_u_values)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 681, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emd", 0, 3, 5, 1); <span class='error_goto'>__PYX_ERR(0, 681, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  2:if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v_values)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 681, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emd", 0, 3, 5, 2); <span class='error_goto'>__PYX_ERR(0, 681, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  3:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_u_weights);if (value) { values[3] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 681, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  4:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v_weights);if (value) { values[4] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 681, __pyx_L3_error)</span>}}if (unlikely(kw_args &gt; 0)) {const Py_ssize_t kwd_pos_args = __pyx_nargs;if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "emd") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 681, __pyx_L3_error)</span>}} else {switch (__pyx_nargs) {case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);CYTHON_FALLTHROUGH;case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);break;default: goto __pyx_L5_argtuple_error;}}__pyx_v_p = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_p == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 681, __pyx_L3_error)</span>__pyx_v_u_values = values[1];__pyx_v_v_values = values[2];__pyx_v_u_weights = values[3];__pyx_v_v_weights = values[4];}goto __pyx_L4_argument_unpacking_done;__pyx_L5_argtuple_error:;<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emd", 0, 3, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 681, __pyx_L3_error)</span>__pyx_L3_error:;<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.emd", __pyx_clineno, __pyx_lineno, __pyx_filename);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return NULL;__pyx_L4_argument_unpacking_done:;__pyx_r = __pyx_pf_8ccluster_8emd(__pyx_self, __pyx_v_p, __pyx_v_u_values, __pyx_v_v_values, __pyx_v_u_weights, __pyx_v_v_weights);/* function exit code */<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}static PyObject *__pyx_pf_8ccluster_8emd(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_p, PyObject *__pyx_v_u_values, PyObject *__pyx_v_v_values, PyObject *__pyx_v_u_weights, PyObject *__pyx_v_v_weights) {PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("emd", 0);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);__pyx_t_2.__pyx_n = 2;__pyx_t_2.u_weights = __pyx_v_u_weights;__pyx_t_2.v_weights = __pyx_v_v_weights;__pyx_t_1 = __pyx_f_8ccluster_emd(__pyx_v_p, __pyx_v_u_values, __pyx_v_v_values, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 681, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_r = __pyx_t_1;__pyx_t_1 = 0;goto __pyx_L0;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.emd", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = NULL;__pyx_L0:;<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}__pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8ccluster_9emd, 0, __pyx_n_s_emd, NULL, __pyx_n_s_ccluster, __pyx_d, ((PyObject *)__pyx_codeobj__49));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 681, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__46);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_emd, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 681, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_codeobj__49 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__44, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ccluster_pyx, __pyx_n_s_emd, 681, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__49)) __PYX_ERR(0, 681, __pyx_L1_error)</span>struct __pyx_opt_args_8ccluster_emd {int __pyx_n;PyObject *u_weights;PyObject *v_weights;};</pre><pre class="cython line score-0">&#xA0;<span class="">0682</span>:     <span class="s">r&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0683</span>: <span class="s">    Compute, between two one-dimensional distributions :math:`u` and</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0684</span>: <span class="s">    :math:`v`, whose respective CDFs are :math:`U` and :math:`V`, the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0685</span>: <span class="s">    statistical distance that is defined as:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0686</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0687</span>: <span class="s">    .. math::</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0688</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0689</span>: <span class="s">        l_p(u, v) = \left( \int_{-\infty}^{+\infty} |U-V|^p \right)^{1/p}</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0690</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0691</span>: <span class="s">    p is a positive parameter; p = 1 gives the Wasserstein distance, p = 2</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0692</span>: <span class="s">    gives the energy distance.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0693</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0694</span>: <span class="s">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0695</span>: <span class="s">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0696</span>: <span class="s">    u_values, v_values : array_like</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0697</span>: <span class="s">        Values observed in the (empirical) distribution.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0698</span>: <span class="s">    u_weights, v_weights : array_like, optional</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0699</span>: <span class="s">        Weight for each value. If unspecified, each value is assigned the same</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0700</span>: <span class="s">        weight.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0701</span>: <span class="s">        `u_weights` (resp. `v_weights`) must have the same length as</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0702</span>: <span class="s">        `u_values` (resp. `v_values`). If the weight sum differs from 1, it</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0703</span>: <span class="s">        must still be positive and finite so that the weights can be normalized</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0704</span>: <span class="s">        to sum to 1.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0705</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0706</span>: <span class="s">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0707</span>: <span class="s">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0708</span>: <span class="s">    distance : float</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0709</span>: <span class="s">        The computed distance between the distributions.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0710</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0711</span>: <span class="s">    Notes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0712</span>: <span class="s">    -----</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0713</span>: <span class="s">    The input distributions can be empirical, therefore coming from samples</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0714</span>: <span class="s">    whose values are effectively inputs of the function, or they can be seen as</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0715</span>: <span class="s">    generalized functions, in which case they are weighted sums of Dirac delta</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0716</span>: <span class="s">    functions located at the specified values.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0717</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0718</span>: <span class="s">    References</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0719</span>: <span class="s">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0720</span>: <span class="s">    .. [1] Bellemare, Danihelka, Dabney, Mohamed, Lakshminarayanan, Hoyer,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0721</span>: <span class="s">           Munos &quot;The Cramer Distance as a Solution to Biased Wasserstein</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0722</span>: <span class="s">           Gradients&quot; (2017). :arXiv:`1705.10743`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0723</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0724</span>: <span class="s">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0725</span>:     <span class="n">u_values</span><span class="p">,</span> <span class="n">u_weights</span> <span class="o">=</span> <span class="n">_validate_distribution</span><span class="p">(</span><span class="n">u_values</span><span class="p">,</span> <span class="n">u_weights</span><span class="p">)</span></pre>
<pre class='cython code score-64 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_validate_distribution);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 725, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_u_values, __pyx_v_u_weights};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 725, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {PyObject* sequence = __pyx_t_1;Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);if (unlikely(size != 2)) {if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);<span class='error_goto'>__PYX_ERR(0, 725, __pyx_L1_error)</span>}#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFSif (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {__pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); } else {__pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); }<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);#else__pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 725, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 725, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);#endif<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;} else {Py_ssize_t index = -1;__pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 725, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_5);index = 0; __pyx_t_2 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);index = 1; __pyx_t_3 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_6(__pyx_t_5), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 725, __pyx_L1_error)</span>__pyx_t_6 = NULL;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;goto __pyx_L4_unpacking_done;__pyx_L3_unpacking_failed:;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_6 = NULL;if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);<span class='error_goto'>__PYX_ERR(0, 725, __pyx_L1_error)</span>__pyx_L4_unpacking_done:;}<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_u_values, __pyx_t_2);__pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_u_weights, __pyx_t_3);__pyx_t_3 = 0;</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0726</span>:     <span class="n">v_values</span><span class="p">,</span> <span class="n">v_weights</span> <span class="o">=</span> <span class="n">_validate_distribution</span><span class="p">(</span><span class="n">v_values</span><span class="p">,</span> <span class="n">v_weights</span><span class="p">)</span></pre>
<pre class='cython code score-64 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_validate_distribution);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 726, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_2)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_v_v_values, __pyx_v_v_weights};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 726, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {PyObject* sequence = __pyx_t_1;Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);if (unlikely(size != 2)) {if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);<span class='error_goto'>__PYX_ERR(0, 726, __pyx_L1_error)</span>}#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFSif (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {__pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); } else {__pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); }<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);#else__pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 726, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 726, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);#endif<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;} else {Py_ssize_t index = -1;__pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 726, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_5);index = 0; __pyx_t_3 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_3)) goto __pyx_L5_unpacking_failed;<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);index = 1; __pyx_t_2 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_2)) goto __pyx_L5_unpacking_failed;<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_6(__pyx_t_5), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 726, __pyx_L1_error)</span>__pyx_t_6 = NULL;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;goto __pyx_L6_unpacking_done;__pyx_L5_unpacking_failed:;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_6 = NULL;if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);<span class='error_goto'>__PYX_ERR(0, 726, __pyx_L1_error)</span>__pyx_L6_unpacking_done:;}<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_v_values, __pyx_t_3);__pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_v_weights, __pyx_t_2);__pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0727</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0728</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0729</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0730</span>:     <span class="n">u_sorter</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">u_values</span><span class="p">)</span></pre>
<pre class='cython code score-19 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 730, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_argsort);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 730, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_2)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_u_values};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 730, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}__pyx_v_u_sorter = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0731</span>:     <span class="n">v_sorter</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">v_values</span><span class="p">)</span></pre>
<pre class='cython code score-19 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 731, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_argsort);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 731, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_v_values};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 731, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}__pyx_v_v_sorter = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0732</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0733</span>:     <span class="n">all_values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">u_values</span><span class="p">,</span> <span class="n">v_values</span><span class="p">))</span></pre>
<pre class='cython code score-29 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 733, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_concatenate);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 733, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 733, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_u_values);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_u_values);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_u_values);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_v_values);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_v_values);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_v_values);__pyx_t_5 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_5)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_2};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 733, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}__pyx_v_all_values = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0734</span>:     <span class="n">all_values</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">&#39;mergesort&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-14 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_all_values, __pyx_n_s_sort);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 734, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 734, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_kind, __pyx_n_u_mergesort) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 734, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 734, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0735</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0736</span>:     <span class="c"># Compute the differences between pairs of successive values of u and v.</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0737</span>:     <span class="n">deltas</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">all_values</span><span class="p">)</span></pre>
<pre class='cython code score-19 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 737, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_diff);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 737, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_all_values};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 737, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;}__pyx_v_deltas = __pyx_t_2;__pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0738</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0739</span>:     <span class="c"># Get the respective positions of the values of u and v among the values of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0740</span>:     <span class="c"># both distributions.</span></pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0741</span>:     <span class="n">u_cdf_indices</span> <span class="o">=</span> <span class="n">u_values</span><span class="p">[</span><span class="n">u_sorter</span><span class="p">]</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">all_values</span><span class="p">[:</span><span class="o">-</span><span class="mf">1</span><span class="p">],</span> <span class="s">&#39;right&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-22 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_u_values, __pyx_v_u_sorter);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 741, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_searchsorted);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 741, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_all_values, 0, -1L, NULL, NULL, &amp;__pyx_slice__5, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 741, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_5 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_5)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_t_1, __pyx_n_u_right};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 741, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}__pyx_v_u_cdf_indices = __pyx_t_2;__pyx_t_2 = 0;</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0742</span>:     <span class="n">v_cdf_indices</span> <span class="o">=</span> <span class="n">v_values</span><span class="p">[</span><span class="n">v_sorter</span><span class="p">]</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">all_values</span><span class="p">[:</span><span class="o">-</span><span class="mf">1</span><span class="p">],</span> <span class="s">&#39;right&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-22 '>__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_v_values, __pyx_v_v_sorter);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 742, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_searchsorted);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 742, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_all_values, 0, -1L, NULL, NULL, &amp;__pyx_slice__5, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 742, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_5 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {__pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);if (likely(__pyx_t_5)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_t_3, __pyx_n_u_right};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 742, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;}__pyx_v_v_cdf_indices = __pyx_t_2;__pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0743</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0744</span>:     <span class="k">print</span><span class="p">(</span><span class="n">u_cdf_indices</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_v_u_cdf_indices);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 744, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0745</span>:     <span class="k">print</span><span class="p">(</span><span class="n">v_cdf_indices</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_v_v_cdf_indices);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 745, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0746</span>:     <span class="k">print</span><span class="p">(</span><span class="n">deltas</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_v_deltas);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 746, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0747</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0748</span>:     <span class="c"># Calculate the CDFs of u and v using their weights, if specified.</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0749</span>:     <span class="k">if</span> <span class="n">u_weights</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_7 = (__pyx_v_u_weights == Py_None);if (__pyx_t_7) {goto __pyx_L7;}</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0750</span>:         <span class="n">u_cdf</span> <span class="o">=</span> <span class="n">u_cdf_indices</span> <span class="o">/</span> <span class="n">u_values</span><span class="o">.</span><span class="n">size</span></pre>
<pre class='cython code score-5 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_u_values, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 750, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_u_cdf_indices, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 750, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_u_cdf = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0751</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0752</span>:         <span class="n">u_sorted_cumweights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="mf">0</span><span class="p">],</span></pre>
<pre class='cython code score-34 '>/*else*/ {<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 752, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_concatenate);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 752, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 752, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);<span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_int_0);__pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 752, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_5);__pyx_t_2 = 0;__pyx_t_5 = 0;__pyx_t_5 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_5)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_9};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 752, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}__pyx_v_u_sorted_cumweights = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0753</span>:                                               <span class="n">numpy</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">u_weights</span><span class="p">[</span><span class="n">u_sorter</span><span class="p">])))</span></pre>
<pre class='cython code score-22 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 753, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 753, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_u_weights, __pyx_v_u_sorter);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 753, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_10 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {__pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);if (likely(__pyx_t_10)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_8};__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 753, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;}</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0754</span>:         <span class="n">u_cdf</span> <span class="o">=</span> <span class="n">u_sorted_cumweights</span><span class="p">[</span><span class="n">u_cdf_indices</span><span class="p">]</span> <span class="o">/</span> <span class="n">u_sorted_cumweights</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-8 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_u_sorted_cumweights, __pyx_v_u_cdf_indices);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 754, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_u_sorted_cumweights, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 754, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 754, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_v_u_cdf = __pyx_t_9;__pyx_t_9 = 0;}__pyx_L7:;</pre><pre class="cython line score-0">&#xA0;<span class="">0755</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0756</span>:     <span class="k">if</span> <span class="n">v_weights</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_7 = (__pyx_v_v_weights == Py_None);if (__pyx_t_7) {goto __pyx_L8;}</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0757</span>:         <span class="n">v_cdf</span> <span class="o">=</span> <span class="n">v_cdf_indices</span> <span class="o">/</span> <span class="n">v_values</span><span class="o">.</span><span class="n">size</span></pre>
<pre class='cython code score-5 '>__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_v_values, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 757, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_v_cdf_indices, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 757, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_v_v_cdf = __pyx_t_3;__pyx_t_3 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0758</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0759</span>:         <span class="n">v_sorted_cumweights</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="mf">0</span><span class="p">],</span></pre>
<pre class='cython code score-34 '>/*else*/ {<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 759, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_concatenate);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 759, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_9 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 759, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);<span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_int_0);__pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 759, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_9);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_5);__pyx_t_9 = 0;__pyx_t_5 = 0;__pyx_t_5 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {__pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);if (likely(__pyx_t_5)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_8};__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 759, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;}__pyx_v_v_sorted_cumweights = __pyx_t_3;__pyx_t_3 = 0;</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0760</span>:                                               <span class="n">numpy</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">v_weights</span><span class="p">[</span><span class="n">v_sorter</span><span class="p">])))</span></pre>
<pre class='cython code score-22 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 760, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 760, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_v_weights, __pyx_v_v_sorter);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 760, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_10 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {__pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);if (likely(__pyx_t_10)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_2};__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 760, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;}</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0761</span>:         <span class="n">v_cdf</span> <span class="o">=</span> <span class="n">v_sorted_cumweights</span><span class="p">[</span><span class="n">v_cdf_indices</span><span class="p">]</span> <span class="o">/</span> <span class="n">v_sorted_cumweights</span><span class="p">[</span><span class="o">-</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-8 '>__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_v_sorted_cumweights, __pyx_v_v_cdf_indices);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 761, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_v_sorted_cumweights, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 761, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 761, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_v_v_cdf = __pyx_t_8;__pyx_t_8 = 0;}__pyx_L8:;</pre><pre class="cython line score-0">&#xA0;<span class="">0762</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0763</span>:     <span class="c"># Compute the value of the integral based on the CDFs.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0764</span>:     <span class="c"># If p = 1 or p = 2, we avoid using numpy.power, which introduces an overhead</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0765</span>:     <span class="c"># of about 15%.</span></pre>
<pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0766</span>:     <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">u_cdf</span> <span class="o">-</span> <span class="n">v_cdf</span><span class="p">),</span> <span class="n">deltas</span><span class="p">))</span></pre>
<pre class='cython code score-66 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 766, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 766, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 766, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_multiply);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 766, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 766, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_abs);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 766, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_u_cdf, __pyx_v_v_cdf);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 766, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_11 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {__pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);if (likely(__pyx_t_11)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_t_2};__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 766, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;}__pyx_t_10 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {__pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);if (likely(__pyx_t_10)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_10, __pyx_t_5, __pyx_v_deltas};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 766, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;}__pyx_t_9 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_9)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_t_1};__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 766, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}__pyx_r = __pyx_t_8;__pyx_t_8 = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0767</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0768</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0769</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0770</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0771</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0772</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0773</span>: <span class="c"># @cython.profile(True)</span></pre>
<pre class="cython line score-107" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0774</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython code score-107 '>/* Python wrapper */static PyObject *__pyx_pw_8ccluster_11do_calc(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/static PyMethodDef __pyx_mdef_8ccluster_11do_calc = {"do_calc", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8ccluster_11do_calc, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};static PyObject *__pyx_pw_8ccluster_11do_calc(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {__pyx_t_5numpy_int64_t __pyx_v_os;__Pyx_memviewslice __pyx_v_x = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_y = { 0, 0, { 0 }, { 0 }, { 0 } };int __pyx_v_dupes;#if !CYTHON_METH_FASTCALLCYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);#endifCYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);PyObject *__pyx_r = 0;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("do_calc (wrapper)", 0);{#if CYTHON_USE_MODULE_STATEPyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_os,&amp;__pyx_n_s_x,&amp;__pyx_n_s_y,&amp;__pyx_n_s_dupes,0};#elsestatic PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_os,&amp;__pyx_n_s_x,&amp;__pyx_n_s_y,&amp;__pyx_n_s_dupes,0};#endifPyObject* values[4] = {0,0,0,0};if (__pyx_kwds) {Py_ssize_t kw_args;switch (__pyx_nargs) {case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);CYTHON_FALLTHROUGH;case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);CYTHON_FALLTHROUGH;case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);CYTHON_FALLTHROUGH;case  0: break;default: goto __pyx_L5_argtuple_error;}kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);switch (__pyx_nargs) {case  0:if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_os)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 774, __pyx_L3_error)</span>else goto __pyx_L5_argtuple_error;CYTHON_FALLTHROUGH;case  1:if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 774, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("do_calc", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 774, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  2:if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 774, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("do_calc", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 774, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  3:if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dupes)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 774, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("do_calc", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 774, __pyx_L3_error)</span>}}if (unlikely(kw_args &gt; 0)) {const Py_ssize_t kwd_pos_args = __pyx_nargs;if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "do_calc") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 774, __pyx_L3_error)</span>}} else if (unlikely(__pyx_nargs != 4)) {goto __pyx_L5_argtuple_error;} else {values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);}__pyx_v_os = __Pyx_PyInt_As_npy_int64(values[0]); if (unlikely((__pyx_v_os == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 776, __pyx_L3_error)</span>__pyx_v_x = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_x.memview)) __PYX_ERR(0, 776, __pyx_L3_error)</span>__pyx_v_y = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_y.memview)) __PYX_ERR(0, 776, __pyx_L3_error)</span>__pyx_v_dupes = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]); if (unlikely((__pyx_v_dupes == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 776, __pyx_L3_error)</span>}goto __pyx_L4_argument_unpacking_done;__pyx_L5_argtuple_error:;<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("do_calc", 1, 4, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 774, __pyx_L3_error)</span>__pyx_L3_error:;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_x, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_y, 1);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.do_calc", __pyx_clineno, __pyx_lineno, __pyx_filename);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return NULL;__pyx_L4_argument_unpacking_done:;__pyx_r = __pyx_pf_8ccluster_10do_calc(__pyx_self, __pyx_v_os, __pyx_v_x, __pyx_v_y, __pyx_v_dupes);int __pyx_lineno = 0;const char *__pyx_filename = NULL;int __pyx_clineno = 0;/* function exit code */__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_x, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_y, 1);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}static PyObject *__pyx_pf_8ccluster_10do_calc(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_5numpy_int64_t __pyx_v_os, __Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y, int __pyx_v_dupes) {CYTHON_UNUSED unsigned PY_LONG_LONG __pyx_v_total;__pyx_t_5numpy_int64_t __pyx_v_i;__pyx_t_5numpy_int64_t __pyx_v_j;double __pyx_v_t1;double __pyx_v_t2;double __pyx_v_t;__pyx_t_5numpy_int64_t __pyx_v_x_shape;__pyx_t_5numpy_int64_t __pyx_v_y_shape;PyObject *__pyx_v_cd = NULL;PyObject *__pyx_v_z_memmap = NULL;PyObject *__pyx_v_z_f_memmap = NULL;__Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_z_f_view = { 0, 0, { 0 }, { 0 }, { 0 } };PyArrayObject *__pyx_v_oh = 0;__Pyx_memviewslice __pyx_v_oh_view = { 0, 0, { 0 }, { 0 }, { 0 } };unsigned PY_LONG_LONG __pyx_v_one;CYTHON_UNUSED unsigned PY_LONG_LONG __pyx_v_key;__Pyx_LocalBuf_ND __pyx_pybuffernd_oh;__Pyx_Buffer __pyx_pybuffer_oh;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("do_calc", 0);__pyx_pybuffer_oh.pybuffer.buf = NULL;__pyx_pybuffer_oh.refcount = 0;__pyx_pybuffernd_oh.data = NULL;__pyx_pybuffernd_oh.rcbuffer = &amp;__pyx_pybuffer_oh;/* function exit code */__pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);goto __pyx_L0;__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_5, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_17, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_29, 1);{ PyObject *__pyx_type, *__pyx_value, *__pyx_tb;<span class='pyx_c_api'>__Pyx_PyThreadState_declare__Pyx_PyThreadState_assign__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.do_calc", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = NULL;goto __pyx_L2;__pyx_L0:;<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);__pyx_L2:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cd);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_z_memmap);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_z_f_memmap);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_view, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_f_view, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_oh);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_oh_view, 1);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}__pyx_tuple__50 = <span class='py_c_api'>PyTuple_Pack</span>(22, __pyx_n_s_os, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_dupes, __pyx_n_s_total, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_c, __pyx_n_s_t1, __pyx_n_s_t2, __pyx_n_s_t, __pyx_n_s_x_shape, __pyx_n_s_y_shape, __pyx_n_s_cd, __pyx_n_s_z_memmap, __pyx_n_s_z_f_memmap, __pyx_n_s_z_view, __pyx_n_s_z_f_view, __pyx_n_s_oh, __pyx_n_s_oh_view, __pyx_n_s_one, __pyx_n_s_key);<span class='error_goto'> if (unlikely(!__pyx_tuple__50)) __PYX_ERR(0, 774, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__50);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__50);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8ccluster_11do_calc, 0, __pyx_n_s_do_calc, NULL, __pyx_n_s_ccluster, __pyx_d, ((PyObject *)__pyx_codeobj__51));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 774, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_do_calc, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 774, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_codeobj__51 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 22, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__50, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ccluster_pyx, __pyx_n_s_do_calc, 774, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__51)) __PYX_ERR(0, 774, __pyx_L1_error)</span></pre><pre class="cython line score-0">&#xA0;<span class="">0775</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0776</span>: <span class="k">def</span> <span class="nf">do_calc</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">int64_t</span> <span class="n">os</span><span class="p">,</span> <span class="n">int16</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">x</span><span class="p">,</span> <span class="n">int16</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">y</span><span class="p">,</span> <span class="nb">int</span> <span class="n">dupes</span><span class="p">):</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0777</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="kt">int</span> <span class="nf">total</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>__pyx_v_total = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0778</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">int64_t</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">c</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0779</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">t1</span><span class="p">,</span> <span class="nf">t2</span><span class="p">,</span> <span class="nf">t</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0780</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">int64_t</span> <span class="nf">x_shape</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_v_x_shape = (__pyx_v_x.shape[0]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0781</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">int64_t</span> <span class="nf">y_shape</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_v_y_shape = (__pyx_v_y.shape[0]);</pre><pre class="cython line score-0">&#xA0;<span class="">0782</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0783</span>:     <span class="n">cd</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-1 '><span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);__pyx_v_cd = __pyx_int_0;</pre><pre class="cython line score-0">&#xA0;<span class="">0784</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0785</span>:     <span class="c"># cdef numpy.ndarray[int16, ndim=2] z = numpy.empty((x_shape * y_shape, x.shape[1] + y.shape[1] + 3), dtype=numpy.int16)</span></pre>
<pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0786</span>:     <span class="n">z_memmap</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">memmap</span><span class="p">(</span><span class="s">&#39;results/river.npy&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s">&#39;r+&#39;</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int16</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_shape</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_shape</span> <span class="o">-</span> <span class="n">dupes</span><span class="p">),</span> <span class="mf">3</span><span class="p">),</span> <span class="n">offset</span> <span class="o">=</span> <span class="n">os</span> <span class="p">)</span></pre>
<pre class='cython code score-52 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 786, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 786, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 786, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_mode, __pyx_kp_u_r) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 786, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 786, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 786, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 786, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = __Pyx_PyInt_From_npy_int64((__pyx_v_x_shape * (__pyx_v_y_shape - __pyx_v_dupes)));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 786, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 786, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_3);__pyx_t_4 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_shape, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 786, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = __Pyx_PyInt_From_npy_int64(__pyx_v_os);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 786, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_offset, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 786, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__10, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 786, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_v_z_memmap = __pyx_t_3;__pyx_t_3 = 0;__pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_results_river_npy);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 786, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);</pre><pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0787</span>:     <span class="n">z_f_memmap</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">memmap</span><span class="p">(</span><span class="s">&#39;results/river_f.npy&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s">&#39;r+&#39;</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_shape</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_shape</span> <span class="o">-</span> <span class="n">dupes</span><span class="p">),</span> <span class="mf">1</span><span class="p">),</span> <span class="n">offset</span> <span class="o">=</span> <span class="n">os</span><span class="o">//</span><span class="mf">3</span> <span class="o">*</span> <span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-52 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 787, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 787, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 787, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_mode, __pyx_kp_u_r) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 787, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 787, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 787, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 787, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = __Pyx_PyInt_From_npy_int64((__pyx_v_x_shape * (__pyx_v_y_shape - __pyx_v_dupes)));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 787, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 787, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_1);__pyx_t_4 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_shape, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 787, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = __Pyx_PyInt_From_npy_int64((__Pyx_div___pyx_t_5numpy_int64_t(__pyx_v_os, 3) * 2));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 787, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_offset, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 787, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__11, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 787, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_v_z_f_memmap = __pyx_t_2;__pyx_t_2 = 0;__pyx_tuple__11 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_results_river_f_npy);<span class='error_goto'> if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 787, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__11);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__11);</pre><pre class="cython line score-0">&#xA0;<span class="">0788</span>:     <span class="c">#mp_memmap = numpy.memmap(&#39;results/map.npy&#39;, mode = &#39;r+&#39;, dtype = numpy.ulonglong, shape = (x_shape * (y_shape - dupes), 1), offset = os//3 * 2)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0789</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0790</span>:     <span class="k">cdef</span> <span class="kt">int16</span> [<span class="p">:,</span> <span class="p">:]</span> <span class="n">z_view</span> <span class="o">=</span> <span class="n">z_memmap</span></pre>
<pre class='cython code score-0 '>__pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_v_z_memmap, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 790, __pyx_L1_error)</span>__pyx_v_z_view = __pyx_t_5;__pyx_t_5.memview = NULL;__pyx_t_5.data = NULL;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0791</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">float32_t</span> [<span class="p">:,</span> <span class="p">:]</span> <span class="n">z_f_view</span> <span class="o">=</span> <span class="n">z_f_memmap</span></pre>
<pre class='cython code score-0 '>__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_5numpy_float32_t(__pyx_v_z_f_memmap, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 791, __pyx_L1_error)</span>__pyx_v_z_f_view = __pyx_t_6;__pyx_t_6.memview = NULL;__pyx_t_6.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0792</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0793</span>:     <span class="c">#cdef unsigned long long [:, :] mp_view = mp_memmap</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0794</span>: </pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0795</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="nf">int16</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">oh</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mf">7</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span></pre>
<pre class='cython code score-30 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 795, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 795, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 795, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 795, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 795, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 795, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__12, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 795, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 795, __pyx_L1_error)</span>__pyx_t_7 = ((PyArrayObject *)__pyx_t_4);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_int16, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_v_oh = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 795, __pyx_L1_error)</span>} else {__pyx_pybuffernd_oh.diminfo[0].strides = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_oh.diminfo[0].shape = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.shape[0];}}__pyx_t_7 = 0;__pyx_v_oh = ((PyArrayObject *)__pyx_t_4);__pyx_t_4 = 0;__pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_7);<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 795, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0796</span>:     <span class="k">cdef</span> <span class="kt">int16</span>[<span class="p">:]</span> <span class="n">oh_view</span> <span class="o">=</span> <span class="n">oh</span><span class="p">[:]</span></pre>
<pre class='cython code score-8 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_oh), __pyx_slice__13);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 796, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 796, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_v_oh_view = __pyx_t_8;__pyx_t_8.memview = NULL;__pyx_t_8.data = NULL;__pyx_slice__13 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__13)) __PYX_ERR(0, 796, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__13);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__13);</pre><pre class="cython line score-0">&#xA0;<span class="">0797</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0798</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">one</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>__pyx_v_one = 1;</pre><pre class="cython line score-0">&#xA0;<span class="">0799</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">key</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0800</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x_shape</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_9 = __pyx_v_x_shape;__pyx_t_10 = __pyx_t_9;for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {__pyx_v_i = __pyx_t_11;</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0801</span>:         <span class="n">t1</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span></pre>
<pre class='cython code score-30 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 801, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 801, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = NULL;__pyx_t_12 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_2)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_12 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_2, };__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_12, 0+__pyx_t_12);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 801, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}__pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_13 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 801, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_v_t1 = __pyx_t_13;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0802</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>__pyx_t_14 = (__pyx_v_y.shape[0]);__pyx_t_15 = __pyx_t_14;for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {__pyx_v_j = __pyx_t_16;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0803</span>:             <span class="n">oh_view</span><span class="p">[:</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_t_8.data = __pyx_v_x.data;__pyx_t_8.memview = __pyx_v_x.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_8, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_x.strides[0];
        __pyx_t_8.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_8.shape[0] = __pyx_v_x.shape[1];
__pyx_t_8.strides[0] = __pyx_v_x.strides[1];
    __pyx_t_8.suboffsets[0] = -1;

__pyx_t_17.data = __pyx_v_oh_view.data;__pyx_t_17.memview = __pyx_v_oh_view.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_17, 1);__pyx_t_12 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_17,
    __pyx_v_oh_view.shape[0], __pyx_v_oh_view.strides[0], __pyx_v_oh_view.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_12,
    0,
    2,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 803, __pyx_L1_error)</span>
}

if (unlikely((__pyx_memoryview_copy_contents(__pyx_t_8, __pyx_t_17, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 803, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_17, 1);__pyx_t_17.memview = NULL; __pyx_t_17.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);__pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0804</span>:             <span class="n">oh_view</span><span class="p">[</span><span class="mf">2</span><span class="p">:]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_t_8.data = __pyx_v_y.data;__pyx_t_8.memview = __pyx_v_y.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_8, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_j;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_y.strides[0];
        __pyx_t_8.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_8.shape[0] = __pyx_v_y.shape[1];
__pyx_t_8.strides[0] = __pyx_v_y.strides[1];
    __pyx_t_8.suboffsets[0] = -1;

__pyx_t_17.data = __pyx_v_oh_view.data;__pyx_t_17.memview = __pyx_v_oh_view.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_17, 1);__pyx_t_12 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_17,
    __pyx_v_oh_view.shape[0], __pyx_v_oh_view.strides[0], __pyx_v_oh_view.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_12,
    2,
    0,
    0,
    1,
    0,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L1_error)</span>
}

if (unlikely((__pyx_memoryview_copy_contents(__pyx_t_8, __pyx_t_17, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_17, 1);__pyx_t_17.memview = NULL; __pyx_t_17.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);__pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0805</span>:             <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="n">contains_duplicates</span><span class="p">(</span><span class="n">oh_view</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>__pyx_t_18 = (!(__pyx_f_8ccluster_contains_duplicates(__pyx_v_oh_view) != 0));if (__pyx_t_18) {}}</pre><pre class="cython line score-0">&#xA0;<span class="">0806</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0807</span>:                 <span class="n">get_ehs_fast</span><span class="p">(</span><span class="n">oh_view</span><span class="p">,</span> <span class="n">z_view</span><span class="p">[</span><span class="n">cd</span><span class="p">])</span></pre>
<pre class='cython code score-7 '>__pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_cd); if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 807, __pyx_L1_error)</span>__pyx_t_8.data = __pyx_v_z_view.data;__pyx_t_8.memview = __pyx_v_z_view.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_8, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_t_19;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_z_view.strides[0];
        __pyx_t_8.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_8.shape[0] = __pyx_v_z_view.shape[1];
__pyx_t_8.strides[0] = __pyx_v_z_view.strides[1];
    __pyx_t_8.suboffsets[0] = -1;

__pyx_f_8ccluster_get_ehs_fast(__pyx_v_oh_view, __pyx_t_8);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);__pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0808</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0809</span>:                 <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_view</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_view</span><span class="p">[</span><span class="mf">1</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_view</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_view</span><span class="p">[</span><span class="mf">3</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_view</span><span class="p">[</span><span class="mf">4</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_view</span><span class="p">[</span><span class="mf">5</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_view</span><span class="p">[</span><span class="mf">6</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>__pyx_t_20 = 0;__pyx_t_21 = 1;__pyx_t_22 = 2;__pyx_t_23 = 3;__pyx_t_24 = 4;__pyx_t_25 = 5;__pyx_t_26 = 6;__pyx_v_key = (((((((__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_20 * __pyx_v_oh_view.strides[0]) )))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_21 * __pyx_v_oh_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_22 * __pyx_v_oh_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_23 * __pyx_v_oh_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_24 * __pyx_v_oh_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_25 * __pyx_v_oh_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_26 * __pyx_v_oh_view.strides[0]) )))));</pre><pre class="cython line score-0">&#xA0;<span class="">0810</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0811</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0812</span>:                 <span class="n">z_f_view</span><span class="p">[</span><span class="n">cd</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">z_view</span><span class="p">[</span><span class="n">cd</span><span class="p">][</span><span class="mf">1</span><span class="p">]</span><span class="o">+.</span><span class="mf">5</span><span class="o">*</span><span class="n">z_view</span><span class="p">[</span><span class="n">cd</span><span class="p">][</span><span class="mf">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">z_view</span><span class="p">[</span><span class="n">cd</span><span class="p">][</span><span class="mf">1</span><span class="p">]</span><span class="o">+</span><span class="n">z_view</span><span class="p">[</span><span class="n">cd</span><span class="p">][</span><span class="mf">0</span><span class="p">]</span><span class="o">+</span><span class="n">z_view</span><span class="p">[</span><span class="n">cd</span><span class="p">][</span><span class="mf">2</span><span class="p">])</span></pre>
<pre class='cython code score-47 '>__pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_cd); if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 812, __pyx_L1_error)</span>__pyx_t_26 = __pyx_t_19;__pyx_t_25 = 1;__pyx_t_27 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_cd); if (unlikely((__pyx_t_27 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 812, __pyx_L1_error)</span>__pyx_t_24 = __pyx_t_27;__pyx_t_23 = 0;__pyx_t_13 = ((*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_26 * __pyx_v_z_view.strides[0]) ) + __pyx_t_25 * __pyx_v_z_view.strides[1]) ))) + (.5 * (*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_24 * __pyx_v_z_view.strides[0]) ) + __pyx_t_23 * __pyx_v_z_view.strides[1]) )))));__pyx_t_27 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_cd); if (unlikely((__pyx_t_27 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 812, __pyx_L1_error)</span>__pyx_t_23 = __pyx_t_27;__pyx_t_24 = 1;__pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_cd); if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 812, __pyx_L1_error)</span>__pyx_t_25 = __pyx_t_19;__pyx_t_26 = 0;__pyx_t_28 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_cd); if (unlikely((__pyx_t_28 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 812, __pyx_L1_error)</span>__pyx_t_22 = __pyx_t_28;__pyx_t_21 = 2;__pyx_t_12 = (((*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_23 * __pyx_v_z_view.strides[0]) ) + __pyx_t_24 * __pyx_v_z_view.strides[1]) ))) + (*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_25 * __pyx_v_z_view.strides[0]) ) + __pyx_t_26 * __pyx_v_z_view.strides[1]) )))) + (*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_22 * __pyx_v_z_view.strides[0]) ) + __pyx_t_21 * __pyx_v_z_view.strides[1]) ))));if (unlikely(__pyx_t_12 == 0)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");<span class='error_goto'>__PYX_ERR(0, 812, __pyx_L1_error)</span>}__pyx_t_28 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_cd); if (unlikely((__pyx_t_28 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 812, __pyx_L1_error)</span>__pyx_t_29.data = __pyx_v_z_f_view.data;__pyx_t_29.memview = __pyx_v_z_f_view.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_29, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_t_28;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_z_f_view.strides[0];
        __pyx_t_29.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_29.shape[0] = __pyx_v_z_f_view.shape[1];
__pyx_t_29.strides[0] = __pyx_v_z_f_view.strides[1];
    __pyx_t_29.suboffsets[0] = -1;

{__pyx_t_5numpy_float32_t __pyx_temp_scalar = (__pyx_t_13 / ((double)__pyx_t_12));{Py_ssize_t __pyx_temp_extent_0 = __pyx_t_29.shape[0];Py_ssize_t __pyx_temp_stride_0 = __pyx_t_29.strides[0];char *__pyx_temp_pointer_0;Py_ssize_t __pyx_temp_idx_0;__pyx_temp_pointer_0 = __pyx_t_29.data;for (__pyx_temp_idx_0 = 0; __pyx_temp_idx_0 &lt; __pyx_temp_extent_0; __pyx_temp_idx_0++) {*((__pyx_t_5numpy_float32_t *) __pyx_temp_pointer_0) = __pyx_temp_scalar;__pyx_temp_pointer_0 += __pyx_temp_stride_0;}}}__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_29, 1);__pyx_t_29.memview = NULL; __pyx_t_29.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0813</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0814</span>:                 <span class="c">#mp_view[cd] = key</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0815</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0816</span>:                 <span class="n">cd</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-3 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_cd, __pyx_int_1, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 816, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_cd, __pyx_t_4);__pyx_t_4 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0817</span>: </pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0818</span>:         <span class="n">t2</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span></pre>
<pre class='cython code score-30 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 818, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 818, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = NULL;__pyx_t_12 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_12 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_3, };__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_12, 0+__pyx_t_12);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 818, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}__pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_13 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 818, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_v_t2 = __pyx_t_13;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0819</span>:         <span class="n">t</span> <span class="o">=</span> <span class="n">t2</span><span class="o">-</span><span class="n">t1</span></pre>
<pre class='cython code score-0 '>__pyx_v_t = (__pyx_v_t2 - __pyx_v_t1);</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0820</span>:         <span class="k">print</span><span class="p">(</span><span class="s">&#39;~&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="n">x_shape</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span><span class="o">//</span><span class="mf">60</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; minutes until finished. &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mf">100</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">x_shape</span><span class="p">))[:</span><span class="mf">4</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;</span><span class="si">% d</span><span class="s">one     &#39;</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\r</span><span class="s">&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-61 '>__pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(floor((__pyx_v_t * (__pyx_v_x_shape - __pyx_v_i)) / 60.0));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 820, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 820, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_u__2, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 820, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlace</span>(__pyx_t_4, __pyx_kp_u_minutes_until_finished);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 820, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;if (unlikely(__pyx_v_x_shape == 0)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");<span class='error_goto'>__PYX_ERR(0, 820, __pyx_L1_error)</span>}__pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((100.0 * (((double)__pyx_v_i) / ((double)__pyx_v_x_shape))));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 820, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 820, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='py_c_api'>PySequence_GetSlice</span>(__pyx_t_3, 0, 4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 820, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlaceSafe</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 820, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlace</span>(__pyx_t_3, __pyx_kp_u_done);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 820, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 820, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);__pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 820, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_end, __pyx_kp_u__3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 820, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 820, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}</pre><pre class="cython line score-0">&#xA0;<span class="">0821</span>:     <span class="c"># mp_memmap.flush()</span></pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0822</span>:     <span class="n">z_f_memmap</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></pre>
<pre class='cython code score-17 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z_f_memmap, __pyx_n_s_flush);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 822, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = NULL;__pyx_t_12 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);__pyx_t_12 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_3, };__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_12, 0+__pyx_t_12);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 822, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0823</span>:     <span class="n">z_memmap</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></pre>
<pre class='cython code score-17 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z_memmap, __pyx_n_s_flush);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 823, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = NULL;__pyx_t_12 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);__pyx_t_12 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_3, };__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_12, 0+__pyx_t_12);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 823, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0824</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0825</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0826</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0827</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0828</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0829</span>: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">insertion_sort_inplace_cython_float32</span><span class="p">(</span><span class="n">float32</span><span class="p">[:]</span> <span class="n">A</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_8ccluster_insertion_sort_inplace_cython_float32(__Pyx_memviewslice __pyx_v_A) {int __pyx_v_i;int __pyx_v_j;__pyx_t_5numpy_float32_t __pyx_v_key;int __pyx_v_length_A;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("insertion_sort_inplace_cython_float32", 0);/* function exit code */<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();}</pre><pre class="cython line score-0">&#xA0;<span class="">0830</span>:     <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0831</span>:         <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0832</span>:         <span class="n">numpy</span><span class="o">.</span><span class="n">float32_t</span> <span class="n">key</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0833</span>:         <span class="nb">int</span> <span class="n">length_A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_v_length_A = (__pyx_v_A.shape[0]);</pre><pre class="cython line score-0">&#xA0;<span class="">0834</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0835</span>:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">length_A</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = __pyx_v_length_A;__pyx_t_2 = __pyx_t_1;for (__pyx_t_3 = 1; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {__pyx_v_j = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0836</span>:         <span class="n">key</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_j;__pyx_v_key = (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_4 * __pyx_v_A.strides[0]) )));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0837</span>:         <span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>__pyx_v_i = (__pyx_v_j - 1);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0838</span>:         <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">key</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>while (1) {__pyx_t_4 = __pyx_v_i;__pyx_t_5 = ((__pyx_v_i &gt;= 0) &amp; ((*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_4 * __pyx_v_A.strides[0]) ))) &gt; __pyx_v_key));if (!__pyx_t_5) break;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0839</span>:             <span class="n">A</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_i;__pyx_t_6 = (__pyx_v_i + 1);*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_6 * __pyx_v_A.strides[0]) )) = (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_4 * __pyx_v_A.strides[0]) )));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0840</span>:             <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>__pyx_v_i = (__pyx_v_i - 1);}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0841</span>:         <span class="n">A</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span></pre>
<pre class='cython code score-0 '>__pyx_t_4 = (__pyx_v_i + 1);*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_4 * __pyx_v_A.strides[0]) )) = __pyx_v_key;}</pre><pre class="cython line score-0">&#xA0;<span class="">0842</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0843</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0844</span>: <span class="c">#set elents in A to the index they appear in B</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0845</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0846</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0847</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0848</span>: <span class="k">cdef</span> <span class="kt">float32</span> <span class="nf">all_ind</span><span class="p">(</span><span class="n">float32</span><span class="p">[:]</span> <span class="n">A</span><span class="p">,</span> <span class="n">float32</span><span class="p">[:]</span> <span class="n">AA</span><span class="p">,</span> <span class="n">float32</span><span class="p">[:]</span> <span class="n">B</span><span class="p">,</span> <span class="n">float32</span><span class="p">[:]</span> <span class="n">BB</span><span class="p">,</span> <span class="n">float32</span><span class="p">[:]</span> <span class="n">BBB</span><span class="p">,</span> <span class="n">float32</span><span class="p">[:]</span> <span class="n">deltas</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>static __pyx_t_8ccluster_float32 __pyx_f_8ccluster_all_ind(__Pyx_memviewslice __pyx_v_A, __Pyx_memviewslice __pyx_v_AA, __Pyx_memviewslice __pyx_v_B, __Pyx_memviewslice __pyx_v_BB, __Pyx_memviewslice __pyx_v_BBB, __Pyx_memviewslice __pyx_v_deltas) {__pyx_t_8ccluster_int32 __pyx_v_i;__pyx_t_8ccluster_int32 __pyx_v_j;__pyx_t_5numpy_float32_t __pyx_v_key;__pyx_t_5numpy_float32_t __pyx_v_pd;__pyx_t_8ccluster_int32 __pyx_v_length_A;__pyx_t_8ccluster_int32 __pyx_v_length_AA;__pyx_t_8ccluster_int32 __pyx_v_length_B;__pyx_t_8ccluster_float32 __pyx_r;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("all_ind", 0);/* function exit code */__pyx_L1_error:;<span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("ccluster.all_ind", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);__pyx_r = 0;__pyx_L0:;<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}</pre><pre class="cython line score-0">&#xA0;<span class="">0849</span>:     <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0850</span>:         <span class="n">int32</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0851</span>:         <span class="n">numpy</span><span class="o">.</span><span class="n">float32_t</span> <span class="n">key</span><span class="p">,</span> <span class="n">keyy</span><span class="p">,</span> <span class="n">pd</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0852</span>:         <span class="n">int32</span> <span class="n">length_A</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_A); __pyx_v_length_A = __pyx_t_1;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0853</span>:         <span class="n">int32</span> <span class="n">length_AA</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">AA</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_AA); __pyx_v_length_AA = __pyx_t_1;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0854</span>:         <span class="n">int32</span> <span class="n">length_B</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_B); __pyx_v_length_B = __pyx_t_1;</pre><pre class="cython line score-0">&#xA0;<span class="">0855</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0856</span>:     <span class="n">pd</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>__pyx_v_pd = 0.0;</pre><pre class="cython line score-0">&#xA0;<span class="">0857</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0858</span>:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length_B</span> <span class="o">-</span> <span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_2 = (__pyx_v_length_B - 1);__pyx_t_3 = __pyx_t_2;for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {__pyx_v_j = __pyx_t_4;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0859</span>:         <span class="n">key</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_t_5 = __pyx_v_j;__pyx_v_key = (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_B.data + __pyx_t_5 * __pyx_v_B.strides[0]) )));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0860</span>:         <span class="n">i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>__pyx_v_i = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0861</span>:         <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">length_A</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">key</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>while (1) {__pyx_t_5 = __pyx_v_i;__pyx_t_6 = ((__pyx_v_i &lt; __pyx_v_length_A) &amp; ((*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_5 * __pyx_v_A.strides[0]) ))) &lt;= __pyx_v_key));if (!__pyx_t_6) break;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0862</span>:             <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>__pyx_v_i = (__pyx_v_i + 1);}</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0863</span>:         <span class="n">BB</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">/</span><span class="n">length_A</span></pre>
<pre class='cython code score-5 '>if (unlikely(__pyx_v_length_A == 0)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");<span class='error_goto'>__PYX_ERR(0, 863, __pyx_L1_error)</span>}__pyx_t_5 = __pyx_v_j;*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_BB.data + __pyx_t_5 * __pyx_v_BB.strides[0]) )) = (((double)__pyx_v_i) / ((double)__pyx_v_length_A));</pre><pre class="cython line score-0">&#xA0;<span class="">0864</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0865</span>:         <span class="n">i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>__pyx_v_i = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0866</span>:         <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">length_AA</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">AA</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">key</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>while (1) {__pyx_t_5 = __pyx_v_i;__pyx_t_6 = ((__pyx_v_i &lt; __pyx_v_length_AA) &amp; ((*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_AA.data + __pyx_t_5 * __pyx_v_AA.strides[0]) ))) &lt;= __pyx_v_key));if (!__pyx_t_6) break;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0867</span>:             <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>__pyx_v_i = (__pyx_v_i + 1);}</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0868</span>:         <span class="n">BBB</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">/</span><span class="n">length_AA</span></pre>
<pre class='cython code score-5 '>if (unlikely(__pyx_v_length_AA == 0)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");<span class='error_goto'>__PYX_ERR(0, 868, __pyx_L1_error)</span>}__pyx_t_5 = __pyx_v_j;*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_BBB.data + __pyx_t_5 * __pyx_v_BBB.strides[0]) )) = (((double)__pyx_v_i) / ((double)__pyx_v_length_AA));}</pre><pre class="cython line score-0">&#xA0;<span class="">0869</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0870</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length_B</span><span class="o">-</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_2 = (__pyx_v_length_B - 1);__pyx_t_3 = __pyx_t_2;for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {__pyx_v_i = __pyx_t_4;</pre><pre class="cython line score-0">&#xA0;<span class="">0871</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0872</span>:         <span class="k">if</span><span class="p">(</span><span class="n">BB</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">BBB</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>__pyx_t_5 = __pyx_v_i;__pyx_t_7 = __pyx_v_i;__pyx_t_6 = ((*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_BB.data + __pyx_t_5 * __pyx_v_BB.strides[0]) ))) &gt;= (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_BBB.data + __pyx_t_7 * __pyx_v_BBB.strides[0]) ))));if (__pyx_t_6) {goto __pyx_L11;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0873</span>:             <span class="n">pd</span> <span class="o">+=</span> <span class="p">(</span><span class="n">BB</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">BBB</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">deltas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_t_7 = __pyx_v_i;__pyx_t_5 = __pyx_v_i;__pyx_t_8 = __pyx_v_i;__pyx_v_pd = (__pyx_v_pd + (((*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_BB.data + __pyx_t_7 * __pyx_v_BB.strides[0]) ))) - (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_BBB.data + __pyx_t_5 * __pyx_v_BBB.strides[0]) )))) * (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_deltas.data + __pyx_t_8 * __pyx_v_deltas.strides[0]) )))));</pre><pre class="cython line score-0">&#xA0;<span class="">0874</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0875</span>:             <span class="n">pd</span> <span class="o">+=</span> <span class="p">(</span><span class="n">BBB</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">BB</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">deltas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_t_8 = __pyx_v_i;__pyx_t_5 = __pyx_v_i;__pyx_t_7 = __pyx_v_i;__pyx_v_pd = (__pyx_v_pd + (((*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_BBB.data + __pyx_t_8 * __pyx_v_BBB.strides[0]) ))) - (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_BB.data + __pyx_t_5 * __pyx_v_BB.strides[0]) )))) * (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_deltas.data + __pyx_t_7 * __pyx_v_deltas.strides[0]) )))));}__pyx_L11:;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0876</span>:     <span class="k">return</span> <span class="n">pd</span></pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_v_pd;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0877</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0878</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0879</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0880</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0881</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0882</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0883</span>: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">insertion_sort_inplace_cython_int16</span><span class="p">(</span><span class="n">int16</span><span class="p">[:]</span> <span class="n">A</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_8ccluster_insertion_sort_inplace_cython_int16(__Pyx_memviewslice __pyx_v_A) {int __pyx_v_i;int __pyx_v_j;__pyx_t_8ccluster_int16 __pyx_v_key;int __pyx_v_length_A;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("insertion_sort_inplace_cython_int16", 0);/* function exit code */<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();}</pre><pre class="cython line score-0">&#xA0;<span class="">0884</span>:     <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0885</span>:         <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0886</span>:         <span class="n">int16</span> <span class="n">key</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0887</span>:         <span class="nb">int</span> <span class="n">length_A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_v_length_A = (__pyx_v_A.shape[0]);</pre><pre class="cython line score-0">&#xA0;<span class="">0888</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0889</span>:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">length_A</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = __pyx_v_length_A;__pyx_t_2 = __pyx_t_1;for (__pyx_t_3 = 1; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {__pyx_v_j = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0890</span>:         <span class="n">key</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_j;__pyx_v_key = (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_4 * __pyx_v_A.strides[0]) )));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0891</span>:         <span class="n">i</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>__pyx_v_i = (__pyx_v_j - 1);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0892</span>:         <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">key</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>while (1) {__pyx_t_4 = __pyx_v_i;__pyx_t_5 = ((__pyx_v_i &gt;= 0) &amp; ((*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_4 * __pyx_v_A.strides[0]) ))) &gt; __pyx_v_key));if (!__pyx_t_5) break;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0893</span>:             <span class="n">A</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_i;__pyx_t_6 = (__pyx_v_i + 1);*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_6 * __pyx_v_A.strides[0]) )) = (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_4 * __pyx_v_A.strides[0]) )));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0894</span>:             <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>__pyx_v_i = (__pyx_v_i - 1);}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0895</span>:         <span class="n">A</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span></pre>
<pre class='cython code score-0 '>__pyx_t_4 = (__pyx_v_i + 1);*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_4 * __pyx_v_A.strides[0]) )) = __pyx_v_key;}</pre><pre class="cython line score-0">&#xA0;<span class="">0896</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0897</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0898</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0899</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0900</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0901</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0902</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">initializedcheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0903</span>: <span class="k">cdef</span> <span class="nf">prob_dist_fun</span><span class="p">(</span><span class="n">int16</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">x</span><span class="p">,</span> <span class="n">int16</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">y</span><span class="p">,</span> <span class="n">float32</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">dist</span><span class="p">,</span> <span class="n">float32</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">cntrs</span><span class="p">,</span> <span class="nb">int</span><span class="p">[:]</span> <span class="n">lbs</span><span class="p">,</span> <span class="n">int64</span> <span class="n">dupes</span><span class="p">,</span> <span class="n">mp</span><span class="p">,</span> <span class="n">boolean</span> <span class="n">turn</span><span class="p">,</span> <span class="n">int64</span> <span class="n">os</span><span class="p">):</span> <span class="c">#single byte offset. multiply by #cols and #bytes in data type</span></pre>
<pre class='cython code score-41 '>static PyObject *__pyx_f_8ccluster_prob_dist_fun(__Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y, __Pyx_memviewslice __pyx_v_dist, __Pyx_memviewslice __pyx_v_cntrs, __Pyx_memviewslice __pyx_v_lbs, __pyx_t_8ccluster_int64 __pyx_v_dupes, PyObject *__pyx_v_mp, __pyx_t_8ccluster_boolean __pyx_v_turn, __pyx_t_8ccluster_int64 __pyx_v_os) {int __pyx_v_T_CARDS;int __pyx_v_N_CARDS;PyArrayObject *__pyx_v_oh = 0;PyArrayObject *__pyx_v_oh_z = 0;PyArrayObject *__pyx_v_oh_z_tmp = 0;PyArrayObject *__pyx_v_prob_dist = 0;__Pyx_memviewslice __pyx_v_oh_view = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_oh_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_oh_z_view_tmp = { 0, 0, { 0 }, { 0 }, { 0 } };int __pyx_v_c;int __pyx_v_i;int __pyx_v_j;int __pyx_v_k;long __pyx_v_t;PyArrayObject *__pyx_v_mp_z = 0;PyObject *__pyx_v_yy = NULL;CYTHON_UNUSED PyObject *__pyx_v_ndupes = NULL;__Pyx_memviewslice __pyx_v_mp_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_prob_dist_memview = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_prob_dist_sing_memview = { 0, 0, { 0 }, { 0 }, { 0 } };PyObject *__pyx_v_cd = NULL;__Pyx_memviewslice __pyx_v_all_values = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_all_valuesa = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_all_valuesaa = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_deltaaa = { 0, 0, { 0 }, { 0 }, { 0 } };unsigned PY_LONG_LONG __pyx_v_one;unsigned PY_LONG_LONG __pyx_v_key;PyObject *__pyx_v_t1 = NULL;PyObject *__pyx_v_t2 = NULL;__Pyx_LocalBuf_ND __pyx_pybuffernd_mp_z;__Pyx_Buffer __pyx_pybuffer_mp_z;__Pyx_LocalBuf_ND __pyx_pybuffernd_oh;__Pyx_Buffer __pyx_pybuffer_oh;__Pyx_LocalBuf_ND __pyx_pybuffernd_oh_z;__Pyx_Buffer __pyx_pybuffer_oh_z;__Pyx_LocalBuf_ND __pyx_pybuffernd_oh_z_tmp;__Pyx_Buffer __pyx_pybuffer_oh_z_tmp;__Pyx_LocalBuf_ND __pyx_pybuffernd_prob_dist;__Pyx_Buffer __pyx_pybuffer_prob_dist;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("prob_dist_fun", 0);__pyx_pybuffer_oh.pybuffer.buf = NULL;__pyx_pybuffer_oh.refcount = 0;__pyx_pybuffernd_oh.data = NULL;__pyx_pybuffernd_oh.rcbuffer = &amp;__pyx_pybuffer_oh;__pyx_pybuffer_oh_z.pybuffer.buf = NULL;__pyx_pybuffer_oh_z.refcount = 0;__pyx_pybuffernd_oh_z.data = NULL;__pyx_pybuffernd_oh_z.rcbuffer = &amp;__pyx_pybuffer_oh_z;__pyx_pybuffer_oh_z_tmp.pybuffer.buf = NULL;__pyx_pybuffer_oh_z_tmp.refcount = 0;__pyx_pybuffernd_oh_z_tmp.data = NULL;__pyx_pybuffernd_oh_z_tmp.rcbuffer = &amp;__pyx_pybuffer_oh_z_tmp;__pyx_pybuffer_prob_dist.pybuffer.buf = NULL;__pyx_pybuffer_prob_dist.refcount = 0;__pyx_pybuffernd_prob_dist.data = NULL;__pyx_pybuffernd_prob_dist.rcbuffer = &amp;__pyx_pybuffer_prob_dist;__pyx_pybuffer_mp_z.pybuffer.buf = NULL;__pyx_pybuffer_mp_z.refcount = 0;__pyx_pybuffernd_mp_z.data = NULL;__pyx_pybuffernd_mp_z.rcbuffer = &amp;__pyx_pybuffer_mp_z;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_10, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_12, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_13, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_20, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_25, 1);{ PyObject *__pyx_type, *__pyx_value, *__pyx_tb;<span class='pyx_c_api'>__Pyx_PyThreadState_declare__Pyx_PyThreadState_assign__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_mp_z.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh_z.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh_z_tmp.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.prob_dist_fun", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = 0;goto __pyx_L2;__pyx_L0:;<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_mp_z.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh_z.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh_z_tmp.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer);__pyx_L2:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_oh);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_oh_z);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_oh_z_tmp);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_prob_dist);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_oh_view, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_oh_z_view, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_oh_z_view_tmp, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_mp_z);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_yy);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ndupes);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_mp_z_view, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_prob_dist_memview, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_prob_dist_sing_memview, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cd);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_all_values, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_all_valuesa, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_all_valuesaa, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deltaaa, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}</pre><pre class="cython line score-0">&#xA0;<span class="">0904</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0905</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">T_CARDS</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0906</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">N_CARDS</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0907</span>:     <span class="k">if</span> <span class="n">turn</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = (__pyx_v_turn != 0);if (__pyx_t_1) {goto __pyx_L3;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0908</span>:         <span class="n">T_CARDS</span> <span class="o">=</span> <span class="mf">5</span></pre>
<pre class='cython code score-0 '>__pyx_v_T_CARDS = 5;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0909</span>:         <span class="n">N_CARDS</span> <span class="o">=</span> <span class="mf">16</span></pre>
<pre class='cython code score-0 '>__pyx_v_N_CARDS = 16;</pre><pre class="cython line score-0">&#xA0;<span class="">0910</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0911</span>:         <span class="n">T_CARDS</span> <span class="o">=</span> <span class="mf">4</span></pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_v_T_CARDS = 4;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0912</span>:         <span class="n">N_CARDS</span> <span class="o">=</span> <span class="mf">16</span></pre>
<pre class='cython code score-0 '>__pyx_v_N_CARDS = 16;}__pyx_L3:;</pre><pre class="cython line score-0">&#xA0;<span class="">0913</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0914</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0915</span>:     <span class="c">#cdef int16[:, :] x = nump2(N_CARDS, 2)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0916</span>:     <span class="c">#cdef int16[:, :] y = nump2(N_CARDS, T_CARDS)</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0917</span>:     <span class="k">print</span><span class="p">(</span><span class="n">T_CARDS</span><span class="p">)</span></pre>
<pre class='cython code score-6 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_T_CARDS);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 917, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 917, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0918</span>: </pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0919</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="nf">int16</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">oh</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">T_CARDS</span><span class="o">+</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span></pre>
<pre class='cython code score-34 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_T_CARDS + 1));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 919, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);__pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 919, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 919, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 919, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 919, __pyx_L1_error)</span>__pyx_t_7 = ((PyArrayObject *)__pyx_t_6);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_int16, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_v_oh = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 919, __pyx_L1_error)</span>} else {__pyx_pybuffernd_oh.diminfo[0].strides = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_oh.diminfo[0].shape = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.shape[0];}}__pyx_t_7 = 0;__pyx_v_oh = ((PyArrayObject *)__pyx_t_6);__pyx_t_6 = 0;</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0920</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="nf">int16</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">oh_z</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">T_CARDS</span><span class="o">+</span><span class="mf">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span></pre>
<pre class='cython code score-34 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 920, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 920, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_T_CARDS + 2));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 920, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 920, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6);__pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 920, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 920, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 920, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 920, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 920, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 920, __pyx_L1_error)</span>__pyx_t_8 = ((PyArrayObject *)__pyx_t_5);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_oh_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_8, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_int16, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_v_oh_z = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_oh_z.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 920, __pyx_L1_error)</span>} else {__pyx_pybuffernd_oh_z.diminfo[0].strides = __pyx_pybuffernd_oh_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_oh_z.diminfo[0].shape = __pyx_pybuffernd_oh_z.rcbuffer-&gt;pybuffer.shape[0];}}__pyx_t_8 = 0;__pyx_v_oh_z = ((PyArrayObject *)__pyx_t_5);__pyx_t_5 = 0;</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0921</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="nf">int16</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">oh_z_tmp</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">T_CARDS</span> <span class="o">+</span> <span class="mf">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span></pre>
<pre class='cython code score-34 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 921, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 921, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_T_CARDS + 2));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 921, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 921, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);__pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 921, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 921, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 921, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 921, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 921, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 921, __pyx_L1_error)</span>__pyx_t_9 = ((PyArrayObject *)__pyx_t_2);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_oh_z_tmp.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_9, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_int16, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_v_oh_z_tmp = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_oh_z_tmp.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 921, __pyx_L1_error)</span>} else {__pyx_pybuffernd_oh_z_tmp.diminfo[0].strides = __pyx_pybuffernd_oh_z_tmp.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_oh_z_tmp.diminfo[0].shape = __pyx_pybuffernd_oh_z_tmp.rcbuffer-&gt;pybuffer.shape[0];}}__pyx_t_9 = 0;__pyx_v_oh_z_tmp = ((PyArrayObject *)__pyx_t_2);__pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0922</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0923</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0924</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="nf">float32</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">prob_dist</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0925</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0926</span>:     <span class="k">cdef</span> <span class="kt">int16</span>[<span class="p">:]</span> <span class="n">oh_view</span> <span class="o">=</span> <span class="n">oh</span><span class="p">[:]</span></pre>
<pre class='cython code score-3 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_oh), __pyx_slice__13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 926, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 926, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_oh_view = __pyx_t_10;__pyx_t_10.memview = NULL;__pyx_t_10.data = NULL;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0927</span>:     <span class="k">cdef</span> <span class="kt">int16</span>[<span class="p">:]</span> <span class="n">oh_z_view</span> <span class="o">=</span> <span class="n">oh_z</span><span class="p">[:]</span></pre>
<pre class='cython code score-3 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_oh_z), __pyx_slice__13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 927, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 927, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_oh_z_view = __pyx_t_10;__pyx_t_10.memview = NULL;__pyx_t_10.data = NULL;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0928</span>:     <span class="k">cdef</span> <span class="kt">int16</span>[<span class="p">:]</span> <span class="n">oh_z_view_tmp</span> <span class="o">=</span> <span class="n">oh_z_tmp</span><span class="p">[:]</span></pre>
<pre class='cython code score-3 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_oh_z_tmp), __pyx_slice__13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 928, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 928, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_oh_z_view_tmp = __pyx_t_10;__pyx_t_10.memview = NULL;__pyx_t_10.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0929</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0930</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">c</span><span class="p">,</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">tt</span><span class="p">,</span> <span class="nf">k</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0931</span>:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">t</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0932</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0933</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> [<span class="p">:,</span> <span class="p">:]</span> <span class="n">mp_turn_view</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0934</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="nf">float32</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">mp_z</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0935</span>: </pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0936</span>:     <span class="n">yy</span> <span class="o">=</span> <span class="n">nump2</span><span class="p">(</span><span class="n">N_CARDS</span><span class="p">,</span> <span class="n">T_CARDS</span><span class="p">)</span></pre>
<pre class='cython code score-22 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_nump2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 936, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N_CARDS);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 936, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_T_CARDS);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_3 = NULL;__pyx_t_11 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);__pyx_t_11 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_t_4, __pyx_t_6};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_11, 2+__pyx_t_11);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 936, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;}__pyx_v_yy = __pyx_t_2;__pyx_t_2 = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0937</span>:     <span class="k">if</span><span class="p">(</span><span class="n">turn</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = (__pyx_v_turn != 0);if (__pyx_t_1) {goto __pyx_L4;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0938</span>:         <span class="n">ndupes</span> <span class="o">=</span> <span class="n">num_dupes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_v_yy, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 938, __pyx_L1_error)</span>__pyx_t_2 = __pyx_f_8ccluster_num_dupes(__pyx_v_x, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 938, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_12, 1);__pyx_t_12.memview = NULL; __pyx_t_12.data = NULL;__pyx_v_ndupes = __pyx_t_2;__pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0939</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0940</span>:         <span class="n">ndupes</span> <span class="o">=</span> <span class="n">num_dupes_turn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">yy</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_v_yy, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 940, __pyx_L1_error)</span>__pyx_t_2 = __pyx_f_8ccluster_num_dupes_turn(__pyx_v_x, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 940, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_12, 1);__pyx_t_12.memview = NULL; __pyx_t_12.data = NULL;__pyx_v_ndupes = __pyx_t_2;__pyx_t_2 = 0;}__pyx_L4:;</pre><pre class="cython line score-0">&#xA0;<span class="">0941</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0942</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0943</span>: </pre>
<pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0944</span>:     <span class="n">mp_z</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-54 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 944, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_13.data = __pyx_v_dist.data;__pyx_t_13.memview = __pyx_v_dist.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_13, 1);{
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_dist.strides[0];
        __pyx_t_13.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_13.shape[0] = __pyx_v_dist.shape[1];
__pyx_t_13.strides[0] = __pyx_v_dist.strides[1];
    __pyx_t_13.suboffsets[0] = -1;

__pyx_t_14 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_t_13); __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_13, 1);__pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;__pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 944, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_2);__pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 944, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 944, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 944, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 944, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 944, __pyx_L1_error)</span>__pyx_t_15 = ((PyArrayObject *)__pyx_t_3);{__Pyx_BufFmt_StackElem __pyx_stack[1];<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_mp_z.rcbuffer-&gt;pybuffer);__pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_mp_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_15, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_float32, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);if (unlikely(__pyx_t_11 &lt; 0)) {<span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_16, &amp;__pyx_t_17, &amp;__pyx_t_18);if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_mp_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_mp_z, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_float32, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {Py_XDECREF(__pyx_t_16); Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_18);<span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();} else {<span class='py_c_api'>PyErr_Restore</span>(__pyx_t_16, __pyx_t_17, __pyx_t_18);}__pyx_t_16 = __pyx_t_17 = __pyx_t_18 = 0;}__pyx_pybuffernd_mp_z.diminfo[0].strides = __pyx_pybuffernd_mp_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_mp_z.diminfo[0].shape = __pyx_pybuffernd_mp_z.rcbuffer-&gt;pybuffer.shape[0];if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 944, __pyx_L1_error)</span>}__pyx_t_15 = 0;__pyx_v_mp_z = ((PyArrayObject *)__pyx_t_3);__pyx_t_3 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0945</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0946</span>:     <span class="k">cdef</span> <span class="kt">float32</span>[<span class="p">:]</span> <span class="n">mp_z_view</span> <span class="o">=</span> <span class="n">mp_z</span><span class="p">[:]</span></pre>
<pre class='cython code score-3 '>__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_mp_z), __pyx_slice__13);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 946, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 946, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_v_mp_z_view = __pyx_t_13;__pyx_t_13.memview = NULL;__pyx_t_13.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0947</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0948</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0949</span>:     <span class="k">print</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span></pre>
<pre class='cython code score-4 '>__pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_dist, 2, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_8ccluster_float32, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_8ccluster_float32, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 949, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 949, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0950</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0951</span>:     <span class="c"># for each possible remaining card, we will store the subsequent index of the river cluster to which it responds.</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0952</span>:     <span class="k">if</span> <span class="n">turn</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = (__pyx_v_turn != 0);if (__pyx_t_1) {goto __pyx_L5;}</pre><pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0953</span>:         <span class="n">prob_dist</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">memmap</span><span class="p">(</span><span class="s">&#39;results/prob_dist_TURN.npy&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s">&#39;r+&#39;</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dupes</span><span class="p">),</span> <span class="n">N_CARDS</span> <span class="o">-</span> <span class="n">T_CARDS</span> <span class="o">-</span> <span class="mf">1</span><span class="p">),</span> <span class="n">offset</span> <span class="o">=</span> <span class="n">os</span> <span class="o">*</span> <span class="mf">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">N_CARDS</span> <span class="o">-</span> <span class="n">T_CARDS</span><span class="o">-</span><span class="mf">1</span><span class="p">))[:]</span> <span class="c"># 10 col</span></pre>
<pre class='cython code score-74 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 953, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 953, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 953, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_mode, __pyx_kp_u_r) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 953, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 953, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 953, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 953, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = __Pyx_PyInt_From_npy_int64(((__pyx_v_x.shape[0]) * ((__pyx_v_y.shape[0]) - __pyx_v_dupes)));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 953, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(((__pyx_v_N_CARDS - __pyx_v_T_CARDS) - 1));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 953, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 953, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_6);__pyx_t_5 = 0;__pyx_t_6 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_shape, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 953, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = __Pyx_PyInt_From_npy_int64(((__pyx_v_os * 4) * ((__pyx_v_N_CARDS - __pyx_v_T_CARDS) - 1)));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 953, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_offset, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 953, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__14, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 953, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_4, 0, 0, NULL, NULL, &amp;__pyx_slice__13, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 953, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 953, __pyx_L1_error)</span>__pyx_t_19 = ((PyArrayObject *)__pyx_t_2);{__Pyx_BufFmt_StackElem __pyx_stack[1];<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer);__pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_19, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_float32, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);if (unlikely(__pyx_t_11 &lt; 0)) {<span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_18, &amp;__pyx_t_17, &amp;__pyx_t_16);if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_prob_dist, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_float32, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {Py_XDECREF(__pyx_t_18); Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_16);<span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();} else {<span class='py_c_api'>PyErr_Restore</span>(__pyx_t_18, __pyx_t_17, __pyx_t_16);}__pyx_t_18 = __pyx_t_17 = __pyx_t_16 = 0;}__pyx_pybuffernd_prob_dist.diminfo[0].strides = __pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_prob_dist.diminfo[0].shape = __pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_prob_dist.diminfo[1].strides = __pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_prob_dist.diminfo[1].shape = __pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer.shape[1];if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 953, __pyx_L1_error)</span>}__pyx_t_19 = 0;__pyx_v_prob_dist = ((PyArrayObject *)__pyx_t_2);__pyx_t_2 = 0;__pyx_tuple__14 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_results_prob_dist_TURN_npy);<span class='error_goto'> if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 953, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__14);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__14);</pre><pre class="cython line score-0">&#xA0;<span class="">0954</span>:     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0955</span>:         <span class="n">prob_dist</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">memmap</span><span class="p">(</span><span class="s">&#39;results/prob_dist_FLOP.npy&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s">&#39;r+&#39;</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dupes</span><span class="p">),</span> <span class="n">N_CARDS</span> <span class="o">-</span> <span class="n">T_CARDS</span> <span class="o">-</span> <span class="mf">1</span><span class="p">),</span> <span class="n">offset</span> <span class="o">=</span> <span class="n">os</span> <span class="o">*</span> <span class="mf">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">N_CARDS</span> <span class="o">-</span> <span class="n">T_CARDS</span><span class="o">-</span><span class="mf">1</span><span class="p">))[:]</span> <span class="c"># 11 col -- both will need to change according to proper histogram schematics..</span></pre>
<pre class='cython code score-74 '>/*else*/ {<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 955, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_mode, __pyx_kp_u_r) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 955, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 955, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 955, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = __Pyx_PyInt_From_npy_int64(((__pyx_v_x.shape[0]) * ((__pyx_v_y.shape[0]) - __pyx_v_dupes)));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 955, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(((__pyx_v_N_CARDS - __pyx_v_T_CARDS) - 1));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 955, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_6);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_3);__pyx_t_6 = 0;__pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_shape, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 955, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = __Pyx_PyInt_From_npy_int64(((__pyx_v_os * 4) * ((__pyx_v_N_CARDS - __pyx_v_T_CARDS) - 1)));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_offset, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 955, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__15, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 955, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice__13, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 955, __pyx_L1_error)</span>__pyx_t_19 = ((PyArrayObject *)__pyx_t_2);{__Pyx_BufFmt_StackElem __pyx_stack[1];<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer);__pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_19, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_float32, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);if (unlikely(__pyx_t_11 &lt; 0)) {<span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_16, &amp;__pyx_t_17, &amp;__pyx_t_18);if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_prob_dist, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_float32, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {Py_XDECREF(__pyx_t_16); Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_18);<span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();} else {<span class='py_c_api'>PyErr_Restore</span>(__pyx_t_16, __pyx_t_17, __pyx_t_18);}__pyx_t_16 = __pyx_t_17 = __pyx_t_18 = 0;}__pyx_pybuffernd_prob_dist.diminfo[0].strides = __pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_prob_dist.diminfo[0].shape = __pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_prob_dist.diminfo[1].strides = __pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_prob_dist.diminfo[1].shape = __pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer.shape[1];if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 955, __pyx_L1_error)</span>}__pyx_t_19 = 0;__pyx_v_prob_dist = ((PyArrayObject *)__pyx_t_2);__pyx_t_2 = 0;}__pyx_L5:;__pyx_tuple__15 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_results_prob_dist_FLOP_npy);<span class='error_goto'> if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 955, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__15);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__15);</pre><pre class="cython line score-0">&#xA0;<span class="">0956</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0957</span>:     <span class="k">cdef</span> <span class="kt">float32</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">prob_dist_memview</span> <span class="o">=</span> <span class="n">prob_dist</span><span class="p">[:]</span></pre>
<pre class='cython code score-3 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_prob_dist), __pyx_slice__13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 957, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_20 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_float32(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(0, 957, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_prob_dist_memview = __pyx_t_20;__pyx_t_20.memview = NULL;__pyx_t_20.data = NULL;</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0958</span>:     <span class="k">cdef</span> <span class="kt">float32</span>[<span class="p">:]</span> <span class="n">prob_dist_sing_memview</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">N_CARDS</span><span class="o">-</span><span class="n">T_CARDS</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)[:]</span></pre>
<pre class='cython code score-35 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 958, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 958, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(((__pyx_v_N_CARDS - __pyx_v_T_CARDS) - 1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 958, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 958, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);__pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 958, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 958, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 958, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 958, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 958, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_6, 0, 0, NULL, NULL, &amp;__pyx_slice__13, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 958, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 958, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_prob_dist_sing_memview = __pyx_t_13;__pyx_t_13.memview = NULL;__pyx_t_13.data = NULL;</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0959</span>:     <span class="n">cd</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-1 '><span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);__pyx_v_cd = __pyx_int_0;</pre><pre class="cython line score-0">&#xA0;<span class="">0960</span>: </pre>
<pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0961</span>:     <span class="k">cdef</span> <span class="kt">float32</span>[<span class="p">:]</span> <span class="n">all_values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">N_CARDS</span><span class="o">-</span><span class="n">T_CARDS</span><span class="o">-</span><span class="mf">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-37 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 961, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 961, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_13.data = __pyx_v_dist.data;__pyx_t_13.memview = __pyx_v_dist.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_13, 1);{
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_dist.strides[0];
        __pyx_t_13.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_13.shape[0] = __pyx_v_dist.shape[1];
__pyx_t_13.strides[0] = __pyx_v_dist.strides[1];
    __pyx_t_13.suboffsets[0] = -1;

__pyx_t_14 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_t_13); __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_13, 1);__pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;__pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>((((__pyx_v_N_CARDS - __pyx_v_T_CARDS) - 1) + __pyx_t_14));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 961, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 961, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);__pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 961, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 961, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 961, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 961, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 961, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 961, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_v_all_values = __pyx_t_13;__pyx_t_13.memview = NULL;__pyx_t_13.data = NULL;</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0962</span>:     <span class="k">cdef</span> <span class="kt">float32</span>[<span class="p">:]</span> <span class="n">all_valuesa</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">N_CARDS</span><span class="o">-</span><span class="n">T_CARDS</span><span class="o">-</span><span class="mf">2</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-37 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 962, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 962, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_13.data = __pyx_v_dist.data;__pyx_t_13.memview = __pyx_v_dist.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_13, 1);{
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_dist.strides[0];
        __pyx_t_13.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_13.shape[0] = __pyx_v_dist.shape[1];
__pyx_t_13.strides[0] = __pyx_v_dist.strides[1];
    __pyx_t_13.suboffsets[0] = -1;

__pyx_t_14 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_t_13); __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_13, 1);__pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;__pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>((((__pyx_v_N_CARDS - __pyx_v_T_CARDS) - 2) + __pyx_t_14));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 962, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 962, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);__pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 962, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 962, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 962, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 962, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 962, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 962, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_v_all_valuesa = __pyx_t_13;__pyx_t_13.memview = NULL;__pyx_t_13.data = NULL;</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0963</span>:     <span class="k">cdef</span> <span class="kt">float32</span>[<span class="p">:]</span> <span class="n">all_valuesaa</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">N_CARDS</span><span class="o">-</span><span class="n">T_CARDS</span><span class="o">-</span><span class="mf">2</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-37 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 963, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 963, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_13.data = __pyx_v_dist.data;__pyx_t_13.memview = __pyx_v_dist.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_13, 1);{
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_dist.strides[0];
        __pyx_t_13.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_13.shape[0] = __pyx_v_dist.shape[1];
__pyx_t_13.strides[0] = __pyx_v_dist.strides[1];
    __pyx_t_13.suboffsets[0] = -1;

__pyx_t_14 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_t_13); __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_13, 1);__pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;__pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>((((__pyx_v_N_CARDS - __pyx_v_T_CARDS) - 2) + __pyx_t_14));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 963, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 963, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);__pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 963, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 963, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 963, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 963, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 963, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 963, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_v_all_valuesaa = __pyx_t_13;__pyx_t_13.memview = NULL;__pyx_t_13.data = NULL;</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0964</span>:     <span class="k">cdef</span> <span class="kt">float32</span>[<span class="p">:]</span> <span class="n">deltaaa</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">N_CARDS</span><span class="o">-</span><span class="n">T_CARDS</span><span class="o">-</span><span class="mf">2</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">dist</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></pre>
<pre class='cython code score-37 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 964, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 964, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_13.data = __pyx_v_dist.data;__pyx_t_13.memview = __pyx_v_dist.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_13, 1);{
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_dist.strides[0];
        __pyx_t_13.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_13.shape[0] = __pyx_v_dist.shape[1];
__pyx_t_13.strides[0] = __pyx_v_dist.strides[1];
    __pyx_t_13.suboffsets[0] = -1;

__pyx_t_14 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_t_13); __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_13, 1);__pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;__pyx_t_6 = <span class='py_c_api'>PyInt_FromSsize_t</span>((((__pyx_v_N_CARDS - __pyx_v_T_CARDS) - 2) + __pyx_t_14));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 964, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 964, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6);__pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 964, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 964, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 964, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 964, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 964, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_13 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_13.memview)) __PYX_ERR(0, 964, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_deltaaa = __pyx_t_13;__pyx_t_13.memview = NULL;__pyx_t_13.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0965</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0966</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0967</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">one</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>__pyx_v_one = 1;</pre><pre class="cython line score-0">&#xA0;<span class="">0968</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">key</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0969</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0970</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>__pyx_t_14 = (__pyx_v_x.shape[0]);__pyx_t_21 = __pyx_t_14;for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_21; __pyx_t_11+=1) {__pyx_v_i = __pyx_t_11;</pre><pre class="cython line score-0">&#xA0;<span class="">0971</span>:         <span class="c"># load current portion of dataset to memory using the offset. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0972</span>:         <span class="c"># fluff_view[:, :] = numpy.memmap(&#39;results/fluffy.npy&#39;, mode = &#39;c&#39;, dtype = numpy.float32, shape = (y_shape_river[0], 1), offset = i * y_shape_river[0] * 8)[:]</span></pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0973</span>:         <span class="n">t1</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span></pre>
<pre class='cython code score-20 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 973, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 973, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = NULL;__pyx_t_22 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {__pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);if (likely(__pyx_t_6)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);__pyx_t_22 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_6, };__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_22, 0+__pyx_t_22);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 973, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t1, __pyx_t_2);__pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0974</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0975</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>__pyx_t_23 = (__pyx_v_y.shape[0]);__pyx_t_24 = __pyx_t_23;for (__pyx_t_22 = 0; __pyx_t_22 &lt; __pyx_t_24; __pyx_t_22+=1) {__pyx_v_j = __pyx_t_22;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0976</span>:             <span class="n">oh_view</span><span class="p">[:</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">][:]</span></pre>
<pre class='cython code score-0 '>__pyx_t_10.data = __pyx_v_x.data;__pyx_t_10.memview = __pyx_v_x.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_10, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_x.strides[0];
        __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_10.shape[0] = __pyx_v_x.shape[1];
__pyx_t_10.strides[0] = __pyx_v_x.strides[1];
    __pyx_t_10.suboffsets[0] = -1;

__pyx_t_25.data = __pyx_v_oh_view.data;__pyx_t_25.memview = __pyx_v_oh_view.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_25, 1);__pyx_t_26 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_25,
    __pyx_v_oh_view.shape[0], __pyx_v_oh_view.strides[0], __pyx_v_oh_view.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_26,
    0,
    2,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 976, __pyx_L1_error)</span>
}

if (unlikely((__pyx_memoryview_copy_contents(__pyx_t_10, __pyx_t_25, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 976, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_25, 1);__pyx_t_25.memview = NULL; __pyx_t_25.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_10, 1);__pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0977</span>:             <span class="n">oh_view</span><span class="p">[</span><span class="mf">2</span><span class="p">:]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">][:]</span></pre>
<pre class='cython code score-0 '>__pyx_t_10.data = __pyx_v_y.data;__pyx_t_10.memview = __pyx_v_y.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_10, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_j;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_y.strides[0];
        __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_10.shape[0] = __pyx_v_y.shape[1];
__pyx_t_10.strides[0] = __pyx_v_y.strides[1];
    __pyx_t_10.suboffsets[0] = -1;

__pyx_t_25.data = __pyx_v_oh_view.data;__pyx_t_25.memview = __pyx_v_oh_view.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_25, 1);__pyx_t_26 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_25,
    __pyx_v_oh_view.shape[0], __pyx_v_oh_view.strides[0], __pyx_v_oh_view.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_26,
    2,
    0,
    0,
    1,
    0,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 977, __pyx_L1_error)</span>
}

if (unlikely((__pyx_memoryview_copy_contents(__pyx_t_10, __pyx_t_25, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 977, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_25, 1);__pyx_t_25.memview = NULL; __pyx_t_25.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_10, 1);__pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0978</span>:             <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="p">((</span><span class="n">turn</span> <span class="ow">and</span> <span class="n">contains_duplicates_turn</span><span class="p">(</span><span class="n">oh_view</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">turn</span> <span class="ow">and</span> <span class="n">contains_duplicates_flop</span><span class="p">(</span><span class="n">oh_view</span><span class="p">)))):</span></pre>
<pre class='cython code score-0 '>__pyx_t_27 = (__pyx_v_turn != 0);if (!__pyx_t_27) {goto __pyx_L12_next_or;} else {}__pyx_t_27 = (__pyx_f_8ccluster_contains_duplicates_turn(__pyx_v_oh_view) != 0);if (!__pyx_t_27) {} else {__pyx_t_1 = __pyx_t_27;goto __pyx_L11_bool_binop_done;}__pyx_L12_next_or:;__pyx_t_27 = (!(__pyx_v_turn != 0));if (__pyx_t_27) {} else {__pyx_t_1 = __pyx_t_27;goto __pyx_L11_bool_binop_done;}__pyx_t_27 = (__pyx_f_8ccluster_contains_duplicates_flop(__pyx_v_oh_view) != 0);__pyx_t_1 = __pyx_t_27;__pyx_L11_bool_binop_done:;__pyx_t_27 = (!__pyx_t_1);if (__pyx_t_27) {}}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0979</span>:                 <span class="n">oh_z_view</span><span class="p">[:</span><span class="n">T_CARDS</span><span class="o">+</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">oh_view</span></pre>
<pre class='cython code score-0 '>__pyx_t_10.data = __pyx_v_oh_z_view.data;__pyx_t_10.memview = __pyx_v_oh_z_view.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_10, 1);__pyx_t_26 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_10,
    __pyx_v_oh_z_view.shape[0], __pyx_v_oh_z_view.strides[0], __pyx_v_oh_z_view.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_26,
    0,
    (__pyx_v_T_CARDS + 1),
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 979, __pyx_L1_error)</span>
}

if (unlikely((__pyx_memoryview_copy_contents(__pyx_v_oh_view, __pyx_t_10, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 979, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_10, 1);__pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0980</span>:                 <span class="n">oh_z_view_tmp</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">oh_z_view</span></pre>
<pre class='cython code score-0 '>if (unlikely((__pyx_memoryview_copy_contents(__pyx_v_oh_z_view, __pyx_v_oh_z_view_tmp, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 980, __pyx_L1_error)</span></pre><pre class="cython line score-0">&#xA0;<span class="">0981</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0982</span>:                 <span class="n">prob_dist_sing_memview</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">prob_dist_memview</span><span class="p">[</span><span class="n">cd</span><span class="p">][:]</span></pre>
<pre class='cython code score-7 '>__pyx_t_28 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_cd); if (unlikely((__pyx_t_28 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 982, __pyx_L1_error)</span>__pyx_t_13.data = __pyx_v_prob_dist_memview.data;__pyx_t_13.memview = __pyx_v_prob_dist_memview.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_13, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_t_28;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_prob_dist_memview.strides[0];
        __pyx_t_13.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_13.shape[0] = __pyx_v_prob_dist_memview.shape[1];
__pyx_t_13.strides[0] = __pyx_v_prob_dist_memview.strides[1];
    __pyx_t_13.suboffsets[0] = -1;

if (unlikely((__pyx_memoryview_copy_contents(__pyx_t_13, __pyx_v_prob_dist_sing_memview, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 982, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_13, 1);__pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0983</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0984</span>:                 <span class="n">c</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>__pyx_v_c = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0985</span>:                 <span class="c"># print(cd)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0986</span>:                 <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_CARDS</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_26 = __pyx_v_N_CARDS;__pyx_t_29 = __pyx_t_26;for (__pyx_t_30 = 0; __pyx_t_30 &lt; __pyx_t_29; __pyx_t_30+=1) {__pyx_v_k = __pyx_t_30;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0987</span>:                     <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="p">((</span><span class="n">turn</span> <span class="ow">and</span> <span class="n">contains_turn</span><span class="p">(</span><span class="n">oh_view</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">turn</span> <span class="ow">and</span> <span class="n">contains_flop</span><span class="p">(</span><span class="n">oh_view</span><span class="p">,</span> <span class="n">k</span><span class="p">)))):</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = (__pyx_v_turn != 0);if (!__pyx_t_1) {goto __pyx_L19_next_or;} else {}__pyx_t_1 = (__pyx_f_8ccluster_contains_turn(__pyx_v_oh_view, __pyx_v_k) != 0);if (!__pyx_t_1) {} else {__pyx_t_27 = __pyx_t_1;goto __pyx_L18_bool_binop_done;}__pyx_L19_next_or:;__pyx_t_1 = (!(__pyx_v_turn != 0));if (__pyx_t_1) {} else {__pyx_t_27 = __pyx_t_1;goto __pyx_L18_bool_binop_done;}__pyx_t_1 = (__pyx_f_8ccluster_contains_flop(__pyx_v_oh_view, __pyx_v_k) != 0);__pyx_t_27 = __pyx_t_1;__pyx_L18_bool_binop_done:;__pyx_t_1 = (!__pyx_t_27);if (__pyx_t_1) {}}</pre><pre class="cython line score-0">&#xA0;<span class="">0988</span>:                         <span class="c">## for each datapoint (float value for winning), find the best center given </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0989</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0990</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0991</span>:                         <span class="n">oh_z_view</span><span class="p">[</span><span class="n">T_CARDS</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span></pre>
<pre class='cython code score-0 '>__pyx_t_31 = (__pyx_v_T_CARDS + 1);*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_31 * __pyx_v_oh_z_view.strides[0]) )) = __pyx_v_k;</pre><pre class="cython line score-0">&#xA0;<span class="">0992</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0993</span>:                         <span class="c"># print()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0994</span>:                         <span class="c"># print()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0995</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0996</span>:                         <span class="c"># must sort table cards before using the mapping.. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0997</span>:                         <span class="c">#insertion_sort_inplace_cython_int16(oh_z_view[2:])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0998</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0999</span>:                         <span class="c"># print([oh_z_view[xxx] for xxx in range(T_CARDS+2)])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1000</span>:                         <span class="c"># print([oh_z_view_tmp[xxx] for xxx in range(T_CARDS+2)])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1001</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1002</span>:                         <span class="k">if</span><span class="p">(</span><span class="n">turn</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_1 = (__pyx_v_turn != 0);if (__pyx_t_1) {goto __pyx_L22;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1003</span>:                             <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_z_view</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span>  <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_z_view</span><span class="p">[</span><span class="mf">1</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_z_view</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span>  <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_z_view</span><span class="p">[</span><span class="mf">3</span><span class="p">])</span>  <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_z_view</span><span class="p">[</span><span class="mf">4</span><span class="p">])</span>  <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_z_view</span><span class="p">[</span><span class="mf">5</span><span class="p">])</span>  <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_z_view</span><span class="p">[</span><span class="mf">6</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>__pyx_t_31 = 0;__pyx_t_32 = 1;__pyx_t_33 = 2;__pyx_t_34 = 3;__pyx_t_35 = 4;__pyx_t_36 = 5;__pyx_t_37 = 6;__pyx_v_key = (((((((__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_31 * __pyx_v_oh_z_view.strides[0]) )))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_32 * __pyx_v_oh_z_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_33 * __pyx_v_oh_z_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_34 * __pyx_v_oh_z_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_35 * __pyx_v_oh_z_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_36 * __pyx_v_oh_z_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_37 * __pyx_v_oh_z_view.strides[0]) )))));</pre><pre class="cython line score-0">&#xA0;<span class="">1004</span>:                         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1005</span>:                             <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_z_view</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span>  <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_z_view</span><span class="p">[</span><span class="mf">1</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_z_view</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span>  <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_z_view</span><span class="p">[</span><span class="mf">3</span><span class="p">])</span>  <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_z_view</span><span class="p">[</span><span class="mf">4</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_z_view</span><span class="p">[</span><span class="mf">5</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_t_37 = 0;__pyx_t_36 = 1;__pyx_t_35 = 2;__pyx_t_34 = 3;__pyx_t_33 = 4;__pyx_t_32 = 5;__pyx_v_key = ((((((__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_37 * __pyx_v_oh_z_view.strides[0]) )))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_36 * __pyx_v_oh_z_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_35 * __pyx_v_oh_z_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_34 * __pyx_v_oh_z_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_33 * __pyx_v_oh_z_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_32 * __pyx_v_oh_z_view.strides[0]) )))));}__pyx_L22:;</pre><pre class="cython line score-0">&#xA0;<span class="">1006</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1007</span>:                         <span class="c"># offset key returned by os. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1008</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1009</span>:                         <span class="c"># prob_dist_memview[cd][c] = emd_c(1, dist[mp[key]], cntrs[lbs[mp[key]]])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1010</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1011</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1012</span>:                         <span class="c">#reward distance from losing.. temp logic until i understand paper</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1013</span>:                         <span class="n">prob_dist_sing_memview</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">emd_c</span><span class="p">(</span><span class="mf">1</span><span class="p">,</span> <span class="n">mp_z_view</span><span class="p">,</span> <span class="n">cntrs</span><span class="p">[</span><span class="n">lbs</span><span class="p">[</span><span class="n">mp</span><span class="p">[</span><span class="n">key</span><span class="p">]]],</span> <span class="n">all_values</span><span class="p">,</span> <span class="n">all_valuesa</span><span class="p">,</span> <span class="n">all_valuesaa</span><span class="p">,</span> <span class="n">deltaaa</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_mp, __pyx_v_key, unsigned PY_LONG_LONG, 0, __Pyx_PyInt_From_unsigned_PY_LONG_LONG, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1013, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_28 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_2); if (unlikely((__pyx_t_28 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1013, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_32 = __pyx_t_28;__pyx_t_13.data = __pyx_v_cntrs.data;__pyx_t_13.memview = __pyx_v_cntrs.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_13, 1);{
    Py_ssize_t __pyx_tmp_idx = (*((int *) ( /* dim=0 */ (__pyx_v_lbs.data + __pyx_t_32 * __pyx_v_lbs.strides[0]) )));
    Py_ssize_t __pyx_tmp_stride = __pyx_v_cntrs.strides[0];
        __pyx_t_13.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_13.shape[0] = __pyx_v_cntrs.shape[1];
__pyx_t_13.strides[0] = __pyx_v_cntrs.strides[1];
    __pyx_t_13.suboffsets[0] = -1;

__pyx_t_32 = __pyx_v_c;*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_prob_dist_sing_memview.data + __pyx_t_32 * __pyx_v_prob_dist_sing_memview.strides[0]) )) = __pyx_f_8ccluster_emd_c(1, __pyx_v_mp_z_view, __pyx_t_13, __pyx_v_all_values, __pyx_v_all_valuesa, __pyx_v_all_valuesaa, __pyx_v_deltaaa, NULL);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_13, 1);__pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1014</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1015</span>:                         <span class="c">#print([dist[mp[key]][jjj] for jjj in range(len(dist[mp[key]]))])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1016</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1017</span>:                         <span class="c">#print([cntrs[lbs[mp[key]]][jjj] for jjj in range(len(cntrs[lbs[mp[key]]]))])</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1018</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1019</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1020</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1021</span>:                         <span class="c">#oh_z_view[:] = oh_z_view_tmp</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1022</span>:                         <span class="n">c</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>__pyx_v_c = (__pyx_v_c + 1);</pre><pre class="cython line score-0">&#xA0;<span class="">1023</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1024</span>:                 <span class="n">insertion_sort_inplace_cython_float32</span><span class="p">(</span><span class="n">prob_dist_sing_memview</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_f_8ccluster_insertion_sort_inplace_cython_float32(__pyx_v_prob_dist_sing_memview);</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1025</span>:                 <span class="n">prob_dist_memview</span><span class="p">[</span><span class="n">cd</span><span class="p">]</span> <span class="o">=</span> <span class="n">prob_dist_sing_memview</span><span class="p">[:]</span></pre>
<pre class='cython code score-7 '>__pyx_t_28 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_cd); if (unlikely((__pyx_t_28 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1025, __pyx_L1_error)</span>__pyx_t_13.data = __pyx_v_prob_dist_memview.data;__pyx_t_13.memview = __pyx_v_prob_dist_memview.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_13, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_t_28;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_prob_dist_memview.strides[0];
        __pyx_t_13.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_13.shape[0] = __pyx_v_prob_dist_memview.shape[1];
__pyx_t_13.strides[0] = __pyx_v_prob_dist_memview.strides[1];
    __pyx_t_13.suboffsets[0] = -1;

if (unlikely((__pyx_memoryview_copy_contents(__pyx_v_prob_dist_sing_memview, __pyx_t_13, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1025, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_13, 1);__pyx_t_13.memview = NULL; __pyx_t_13.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1026</span>:                 <span class="c">#print([prob_dist_memview[cd][jjj] for jjj in range(len(prob_dist_memview[cd]))])</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1027</span>:                 <span class="n">cd</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-3 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_cd, __pyx_int_1, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1027, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_cd, __pyx_t_2);__pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1028</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1029</span>:         <span class="n">t2</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span></pre>
<pre class='cython code score-20 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1029, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1029, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = NULL;__pyx_t_22 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {__pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);if (likely(__pyx_t_4)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);__pyx_t_22 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_4, };__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_22, 0+__pyx_t_22);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1029, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2, __pyx_t_2);__pyx_t_2 = 0;</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1030</span>:         <span class="n">t</span> <span class="o">=</span> <span class="n">t2</span><span class="o">-</span><span class="n">t1</span></pre>
<pre class='cython code score-13 '>__pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_t2, __pyx_v_t1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1030, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_38 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_2); if (unlikely((__pyx_t_38 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1030, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_t = __pyx_t_38;</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1031</span>:         <span class="k">print</span><span class="p">(</span><span class="s">&#39;~&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span><span class="o">//</span><span class="mf">60</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; minutes until finished. &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mf">100</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]))[:</span><span class="mf">4</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;</span><span class="si">% d</span><span class="s">one     &#39;</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\r</span><span class="s">&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-61 '>__pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__Pyx_div_Py_ssize_t((__pyx_v_t * ((__pyx_v_x.shape[0]) - __pyx_v_i)), 60));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1031, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1031, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_u__2, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1031, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlace</span>(__pyx_t_2, __pyx_kp_u_minutes_until_finished);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1031, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (unlikely((__pyx_v_x.shape[0]) == 0)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");<span class='error_goto'>__PYX_ERR(0, 1031, __pyx_L1_error)</span>}__pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((100.0 * (((double)__pyx_v_i) / ((double)(__pyx_v_x.shape[0])))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1031, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1031, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PySequence_GetSlice</span>(__pyx_t_4, 0, 4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1031, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlaceSafe</span>(__pyx_t_6, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1031, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlace</span>(__pyx_t_4, __pyx_kp_u_done);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1031, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1031, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);__pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1031, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_end, __pyx_kp_u__3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1031, __pyx_L1_error)</span>__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1031, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;}</pre><pre class="cython line score-0">&#xA0;<span class="">1032</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1033</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1034</span>:     <span class="k">return</span> <span class="n">dupes</span></pre>
<pre class='cython code score-1 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);__pyx_t_6 = __Pyx_PyInt_From_npy_int64(__pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1034, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_r = __pyx_t_6;__pyx_t_6 = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">1035</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1036</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1037</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1038</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-137" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1039</span>: <span class="k">cpdef</span> <span class="nf">flop_ehs</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">threads</span><span class="p">,</span> <span class="n">dupes</span><span class="p">,</span> <span class="n">new_file</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span></pre>
<pre class='cython code score-137 '>static PyObject *__pyx_pw_8ccluster_13flop_ehs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/static PyObject *__pyx_f_8ccluster_flop_ehs(PyObject *__pyx_v_n, PyObject *__pyx_v_k, PyObject *__pyx_v_threads, PyObject *__pyx_v_dupes, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_8ccluster_flop_ehs *__pyx_optional_args) {PyObject *__pyx_v_new_file = ((PyObject *)Py_False);PyObject *__pyx_v_adjcntrs = NULL;PyObject *__pyx_v_lbls = NULL;PyArrayObject *__pyx_v_cntrs = 0;__Pyx_memviewslice __pyx_v_lbs = { 0, 0, { 0 }, { 0 }, { 0 } };PyObject *__pyx_v_mp = NULL;PyArrayObject *__pyx_v_oh = 0;__Pyx_memviewslice __pyx_v_oh_view = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_x = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_y = { 0, 0, { 0 }, { 0 }, { 0 } };PyObject *__pyx_v_flop_dist = NULL;unsigned PY_LONG_LONG __pyx_v_one;int __pyx_v_cd;PyObject *__pyx_v_i = NULL;CYTHON_UNUSED PyObject *__pyx_v_t1 = NULL;Py_ssize_t __pyx_v_j;PyArrayObject *__pyx_v_dist = 0;CYTHON_UNUSED __Pyx_memviewslice __pyx_v_dist_view = { 0, 0, { 0 }, { 0 }, { 0 } };PyObject *__pyx_v_chunksize = NULL;CYTHON_UNUSED PyObject *__pyx_v_executor = NULL;CYTHON_UNUSED PyObject *__pyx_v_futures = NULL;PyObject *__pyx_v_strt = NULL;PyObject *__pyx_v_stp = NULL;__Pyx_LocalBuf_ND __pyx_pybuffernd_cntrs;__Pyx_Buffer __pyx_pybuffer_cntrs;__Pyx_LocalBuf_ND __pyx_pybuffernd_dist;__Pyx_Buffer __pyx_pybuffer_dist;__Pyx_LocalBuf_ND __pyx_pybuffernd_oh;__Pyx_Buffer __pyx_pybuffer_oh;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("flop_ehs", 0);if (__pyx_optional_args) {if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {__pyx_v_new_file = __pyx_optional_args-&gt;new_file;}}<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dupes);__pyx_pybuffer_cntrs.pybuffer.buf = NULL;__pyx_pybuffer_cntrs.refcount = 0;__pyx_pybuffernd_cntrs.data = NULL;__pyx_pybuffernd_cntrs.rcbuffer = &amp;__pyx_pybuffer_cntrs;__pyx_pybuffer_oh.pybuffer.buf = NULL;__pyx_pybuffer_oh.refcount = 0;__pyx_pybuffernd_oh.data = NULL;__pyx_pybuffernd_oh.rcbuffer = &amp;__pyx_pybuffer_oh;__pyx_pybuffer_dist.pybuffer.buf = NULL;__pyx_pybuffer_dist.refcount = 0;__pyx_pybuffernd_dist.data = NULL;__pyx_pybuffernd_dist.rcbuffer = &amp;__pyx_pybuffer_dist;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_4, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_10, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_18, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_26, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_31, 1);{ PyObject *__pyx_type, *__pyx_value, *__pyx_tb;<span class='pyx_c_api'>__Pyx_PyThreadState_declare__Pyx_PyThreadState_assign__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_cntrs.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.flop_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = 0;goto __pyx_L2;__pyx_L0:;<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_cntrs.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);__pyx_L2:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_adjcntrs);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lbls);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_cntrs);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_lbs, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mp);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_oh);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_oh_view, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_x, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_y, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_flop_dist);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_dist);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_dist_view, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_chunksize);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_executor);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_futures);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_strt);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_stp);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dupes);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}/* Python wrapper */static PyObject *__pyx_pw_8ccluster_13flop_ehs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/static PyMethodDef __pyx_mdef_8ccluster_13flop_ehs = {"flop_ehs", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8ccluster_13flop_ehs, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};static PyObject *__pyx_pw_8ccluster_13flop_ehs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {PyObject *__pyx_v_n = 0;PyObject *__pyx_v_k = 0;PyObject *__pyx_v_threads = 0;PyObject *__pyx_v_dupes = 0;PyObject *__pyx_v_new_file = 0;#if !CYTHON_METH_FASTCALLCYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);#endifCYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);PyObject *__pyx_r = 0;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("flop_ehs (wrapper)", 0);{#if CYTHON_USE_MODULE_STATEPyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n,&amp;__pyx_n_s_k,&amp;__pyx_n_s_threads,&amp;__pyx_n_s_dupes,&amp;__pyx_n_s_new_file,0};#elsestatic PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n,&amp;__pyx_n_s_k,&amp;__pyx_n_s_threads,&amp;__pyx_n_s_dupes,&amp;__pyx_n_s_new_file,0};#endifPyObject* values[5] = {0,0,0,0,0};values[4] = ((PyObject *)Py_False);if (__pyx_kwds) {Py_ssize_t kw_args;switch (__pyx_nargs) {case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);CYTHON_FALLTHROUGH;case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);CYTHON_FALLTHROUGH;case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);CYTHON_FALLTHROUGH;case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);CYTHON_FALLTHROUGH;case  0: break;default: goto __pyx_L5_argtuple_error;}kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);switch (__pyx_nargs) {case  0:if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1039, __pyx_L3_error)</span>else goto __pyx_L5_argtuple_error;CYTHON_FALLTHROUGH;case  1:if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_k)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1039, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flop_ehs", 0, 4, 5, 1); <span class='error_goto'>__PYX_ERR(0, 1039, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  2:if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_threads)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1039, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flop_ehs", 0, 4, 5, 2); <span class='error_goto'>__PYX_ERR(0, 1039, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  3:if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dupes)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1039, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flop_ehs", 0, 4, 5, 3); <span class='error_goto'>__PYX_ERR(0, 1039, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  4:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_new_file);if (value) { values[4] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1039, __pyx_L3_error)</span>}}if (unlikely(kw_args &gt; 0)) {const Py_ssize_t kwd_pos_args = __pyx_nargs;if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "flop_ehs") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1039, __pyx_L3_error)</span>}} else {switch (__pyx_nargs) {case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);CYTHON_FALLTHROUGH;case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);break;default: goto __pyx_L5_argtuple_error;}}__pyx_v_n = values[0];__pyx_v_k = values[1];__pyx_v_threads = values[2];__pyx_v_dupes = values[3];__pyx_v_new_file = values[4];}goto __pyx_L4_argument_unpacking_done;__pyx_L5_argtuple_error:;<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flop_ehs", 0, 4, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1039, __pyx_L3_error)</span>__pyx_L3_error:;<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.flop_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return NULL;__pyx_L4_argument_unpacking_done:;__pyx_r = __pyx_pf_8ccluster_12flop_ehs(__pyx_self, __pyx_v_n, __pyx_v_k, __pyx_v_threads, __pyx_v_dupes, __pyx_v_new_file);/* function exit code */<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}static PyObject *__pyx_pf_8ccluster_12flop_ehs(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_n, PyObject *__pyx_v_k, PyObject *__pyx_v_threads, PyObject *__pyx_v_dupes, PyObject *__pyx_v_new_file) {PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("flop_ehs", 0);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);__pyx_t_2.__pyx_n = 1;__pyx_t_2.new_file = __pyx_v_new_file;__pyx_t_1 = __pyx_f_8ccluster_flop_ehs(__pyx_v_n, __pyx_v_k, __pyx_v_threads, __pyx_v_dupes, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1039, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_r = __pyx_t_1;__pyx_t_1 = 0;goto __pyx_L0;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.flop_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = NULL;__pyx_L0:;<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}__pyx_tuple__52 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_n, __pyx_n_s_k, __pyx_n_s_threads, __pyx_n_s_dupes, __pyx_n_s_new_file);<span class='error_goto'> if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 1039, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__52);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__52);__pyx_codeobj__53 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__52, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ccluster_pyx, __pyx_n_s_flop_ehs, 1039, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__53)) __PYX_ERR(0, 1039, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8ccluster_13flop_ehs, 0, __pyx_n_s_flop_ehs, NULL, __pyx_n_s_ccluster, __pyx_d, ((PyObject *)__pyx_codeobj__53));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1039, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__54);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_flop_ehs, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1039, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_tuple__54 = <span class='py_c_api'>PyTuple_Pack</span>(1, Py_False);<span class='error_goto'> if (unlikely(!__pyx_tuple__54)) __PYX_ERR(0, 1039, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__54);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__54);struct __pyx_opt_args_8ccluster_flop_ehs {int __pyx_n;PyObject *new_file;};</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1040</span>:     <span class="n">adjcntrs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;results/adjcntrs_TURN.npy&#39;</span><span class="p">,</span> <span class="n">mmap_mode</span> <span class="o">=</span> <span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-21 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1040, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_load);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1040, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1040, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_mmap_mode, __pyx_n_u_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1040, __pyx_L1_error)</span>__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__16, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1040, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_v_adjcntrs = __pyx_t_3;__pyx_t_3 = 0;__pyx_tuple__16 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_results_adjcntrs_TURN_npy);<span class='error_goto'> if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 1040, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__16);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__16);</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1041</span>:     <span class="n">lbls</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;results/lbls_TURN.npy&#39;</span><span class="p">,</span> <span class="n">mmap_mode</span> <span class="o">=</span> <span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-21 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1041, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_load);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1041, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1041, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_mmap_mode, __pyx_n_u_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1041, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__17, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1041, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_v_lbls = __pyx_t_2;__pyx_t_2 = 0;__pyx_tuple__17 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_results_lbls_TURN_npy);<span class='error_goto'> if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 1041, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__17);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__17);</pre><pre class="cython line score-0">&#xA0;<span class="">1042</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1043</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="nf">float32</span><span class="p">,</span> <span class="nf">ndim</span> <span class="o">=</span> <span class="mf">2</span><span class="p">]</span> <span class="n">cntrs</span> <span class="o">=</span> <span class="n">adjcntrs</span></pre>
<pre class='cython code score-6 '>if (!(likely(((__pyx_v_adjcntrs) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_adjcntrs, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1043, __pyx_L1_error)</span>__pyx_t_2 = __pyx_v_adjcntrs;<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_cntrs.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_2), &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_float32, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {__pyx_v_cntrs = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_cntrs.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 1043, __pyx_L1_error)</span>} else {__pyx_pybuffernd_cntrs.diminfo[0].strides = __pyx_pybuffernd_cntrs.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_cntrs.diminfo[0].shape = __pyx_pybuffernd_cntrs.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_cntrs.diminfo[1].strides = __pyx_pybuffernd_cntrs.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_cntrs.diminfo[1].shape = __pyx_pybuffernd_cntrs.rcbuffer-&gt;pybuffer.shape[1];}}__pyx_v_cntrs = ((PyArrayObject *)__pyx_t_2);__pyx_t_2 = 0;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1044</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:]</span> <span class="n">lbs</span> <span class="o">=</span> <span class="n">lbls</span></pre>
<pre class='cython code score-2 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_v_lbls, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 1044, __pyx_L1_error)</span>__pyx_v_lbs = __pyx_t_4;__pyx_t_4.memview = NULL;__pyx_t_4.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1045</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1046</span>:     <span class="n">mp</span> <span class="o">=</span> <span class="p">{}</span></pre>
<pre class='cython code score-2 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1046, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_v_mp = ((PyObject*)__pyx_t_2);__pyx_t_2 = 0;</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1047</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="nf">int16</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">oh</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span></pre>
<pre class='cython code score-34 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1047, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1047, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_k, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1047, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1047, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);__pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1047, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1047, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1047, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1047, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1047, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1047, __pyx_L1_error)</span>__pyx_t_7 = ((PyArrayObject *)__pyx_t_6);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_int16, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_v_oh = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 1047, __pyx_L1_error)</span>} else {__pyx_pybuffernd_oh.diminfo[0].strides = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_oh.diminfo[0].shape = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.shape[0];}}__pyx_t_7 = 0;__pyx_v_oh = ((PyArrayObject *)__pyx_t_6);__pyx_t_6 = 0;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1048</span>:     <span class="k">cdef</span> <span class="kt">int16</span>[<span class="p">:]</span> <span class="n">oh_view</span> <span class="o">=</span> <span class="n">oh</span><span class="p">[:]</span></pre>
<pre class='cython code score-3 '>__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_oh), __pyx_slice__13);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1048, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1048, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_v_oh_view = __pyx_t_8;__pyx_t_8.memview = NULL;__pyx_t_8.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1049</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1050</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1051</span>:     <span class="k">cdef</span> <span class="kt">int16</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">x</span> <span class="o">=</span> <span class="n">nump2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-17 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_nump2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1051, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_1 = NULL;__pyx_t_9 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_1)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_9 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_v_n, __pyx_int_2};__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_9, 2+__pyx_t_9);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1051, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}__pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1051, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_v_x = __pyx_t_10;__pyx_t_10.memview = NULL;__pyx_t_10.data = NULL;</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1052</span>:     <span class="k">cdef</span> <span class="kt">int16</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">y</span> <span class="o">=</span> <span class="n">nump2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-20 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_nump2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1052, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_k, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1052, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = NULL;__pyx_t_9 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_9 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_n, __pyx_t_1};__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_9, 2+__pyx_t_9);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1052, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}__pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1052, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_v_y = __pyx_t_10;__pyx_t_10.memview = NULL;__pyx_t_10.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1053</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1054</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1055</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1056</span>:     <span class="n">dupes</span> <span class="o">=</span> <span class="n">num_dupes_turn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>__pyx_t_6 = __pyx_f_8ccluster_num_dupes_turn(__pyx_v_x, __pyx_v_y);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1056, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_dupes, __pyx_t_6);__pyx_t_6 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1057</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1058</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1059</span>:     <span class="k">if</span><span class="p">(</span><span class="n">new_file</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>__pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_new_file); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1059, __pyx_L1_error)</span>if (__pyx_t_11) {}</pre><pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1060</span>:         <span class="n">flop_dist</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">memmap</span><span class="p">(</span><span class="s">&#39;results/prob_dist_FLOP.npy&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s">&#39;w+&#39;</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dupes</span><span class="p">),</span> <span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="o">-</span><span class="mf">2</span><span class="p">))</span></pre>
<pre class='cython code score-71 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1060, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1060, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1060, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_mode, __pyx_kp_u_w) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1060, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1060, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1060, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1060, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_x.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1060, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_y.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1060, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1060, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1060, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_n, __pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1060, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_5, __pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1060, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1060, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_3);__pyx_t_1 = 0;__pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_shape, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1060, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__15, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1060, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_v_flop_dist = __pyx_t_5;__pyx_t_5 = 0;</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1061</span>:         <span class="n">flop_dist</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></pre>
<pre class='cython code score-17 '>__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_flop_dist, __pyx_n_s_flush);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1061, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_2 = NULL;__pyx_t_9 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {__pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);if (likely(__pyx_t_2)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);__pyx_t_9 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_2, };__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_9, 0+__pyx_t_9);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1061, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1062</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1063</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1064</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">one</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>__pyx_v_one = 1;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1065</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">cd</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>__pyx_v_cd = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1066</span>: </pre>
<pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1067</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-54 '>__pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_x.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1067, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1067, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_6)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_6)) {__pyx_t_5 = __pyx_t_6; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_12 = 0;__pyx_t_13 = NULL;} else {__pyx_t_12 = -1; __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1067, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1067, __pyx_L1_error)</span>}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;for (;;) {if (likely(!__pyx_t_13)) {if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {if (__pyx_t_12 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_5, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_12++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1067, __pyx_L1_error)</span>#else__pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1067, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);#endif} else {if (__pyx_t_12 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_5)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_5, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_12++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1067, __pyx_L1_error)</span>#else__pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1067, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);#endif}} else {__pyx_t_6 = __pyx_t_13(__pyx_t_5);if (unlikely(!__pyx_t_6)) {PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();if (exc_type) {if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();else <span class='error_goto'>__PYX_ERR(0, 1067, __pyx_L1_error)</span>}break;}<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_6);__pyx_t_6 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1068</span>:         <span class="c"># load current portion of dataset to memory using the offset. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1069</span>:         <span class="c"># fluff_view[:, :] = numpy.memmap(&#39;results/fluffy.npy&#39;, mode = &#39;c&#39;, dtype = numpy.float32, shape = (y_shape_river[0], 1), offset = i * y_shape_river[0] * 8)[:]</span></pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1070</span>:         <span class="n">t1</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span></pre>
<pre class='cython code score-20 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1070, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1070, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = NULL;__pyx_t_9 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_2)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_9 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_2, };__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_9, 0+__pyx_t_9);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1070, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t1, __pyx_t_6);__pyx_t_6 = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1071</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>__pyx_t_14 = (__pyx_v_y.shape[0]);__pyx_t_15 = __pyx_t_14;for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {__pyx_v_j = __pyx_t_16;</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1072</span>:             <span class="n">oh_view</span><span class="p">[:</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>__pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_i); if (unlikely((__pyx_t_17 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1072, __pyx_L1_error)</span>__pyx_t_8.data = __pyx_v_x.data;__pyx_t_8.memview = __pyx_v_x.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_8, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_t_17;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_x.strides[0];
        __pyx_t_8.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_8.shape[0] = __pyx_v_x.shape[1];
__pyx_t_8.strides[0] = __pyx_v_x.strides[1];
    __pyx_t_8.suboffsets[0] = -1;

__pyx_t_18.data = __pyx_v_oh_view.data;__pyx_t_18.memview = __pyx_v_oh_view.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_18, 1);__pyx_t_9 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_18,
    __pyx_v_oh_view.shape[0], __pyx_v_oh_view.strides[0], __pyx_v_oh_view.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_9,
    0,
    2,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 1072, __pyx_L1_error)</span>
}

if (unlikely((__pyx_memoryview_copy_contents(__pyx_t_8, __pyx_t_18, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1072, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_18, 1);__pyx_t_18.memview = NULL; __pyx_t_18.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);__pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1073</span>:             <span class="n">oh_view</span><span class="p">[</span><span class="mf">2</span><span class="p">:]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_t_8.data = __pyx_v_y.data;__pyx_t_8.memview = __pyx_v_y.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_8, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_j;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_y.strides[0];
        __pyx_t_8.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_8.shape[0] = __pyx_v_y.shape[1];
__pyx_t_8.strides[0] = __pyx_v_y.strides[1];
    __pyx_t_8.suboffsets[0] = -1;

__pyx_t_18.data = __pyx_v_oh_view.data;__pyx_t_18.memview = __pyx_v_oh_view.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_18, 1);__pyx_t_9 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_18,
    __pyx_v_oh_view.shape[0], __pyx_v_oh_view.strides[0], __pyx_v_oh_view.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_9,
    2,
    0,
    0,
    1,
    0,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 1073, __pyx_L1_error)</span>
}

if (unlikely((__pyx_memoryview_copy_contents(__pyx_t_8, __pyx_t_18, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1073, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_18, 1);__pyx_t_18.memview = NULL; __pyx_t_18.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);__pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1074</span>:             <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="n">contains_duplicates_turn</span><span class="p">(</span><span class="n">oh_view</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>__pyx_t_11 = (!(__pyx_f_8ccluster_contains_duplicates_turn(__pyx_v_oh_view) != 0));if (__pyx_t_11) {}}</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1075</span>:                 <span class="n">mp</span><span class="p">[(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_view</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_view</span><span class="p">[</span><span class="mf">1</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span><span class="n">oh_view</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span><span class="n">oh_view</span><span class="p">[</span><span class="mf">3</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span><span class="n">oh_view</span><span class="p">[</span><span class="mf">4</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span><span class="n">oh_view</span><span class="p">[</span><span class="mf">5</span><span class="p">])]</span> <span class="o">=</span> <span class="n">cd</span></pre>
<pre class='cython code score-11 '>__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_cd);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1075, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_19 = 0;__pyx_t_20 = 1;__pyx_t_21 = 2;__pyx_t_22 = 3;__pyx_t_23 = 4;__pyx_t_24 = 5;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_PY_LONG_LONG</span>(((((((__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_19 * __pyx_v_oh_view.strides[0]) )))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_20 * __pyx_v_oh_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_21 * __pyx_v_oh_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_22 * __pyx_v_oh_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_23 * __pyx_v_oh_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_24 * __pyx_v_oh_view.strides[0]) ))))));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1075, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);if (unlikely((<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_mp, __pyx_t_3, __pyx_t_6) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1075, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1076</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1077</span>:                 <span class="n">cd</span><span class="o">+=</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>__pyx_v_cd = (__pyx_v_cd + 1);</pre><pre class="cython line score-0">&#xA0;<span class="">1078</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1079</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1080</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1081</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1082</span>: </pre>
<pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1083</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="nf">float32</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">dist</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">memmap</span><span class="p">(</span><span class="s">&#39;results/prob_dist_TURN.npy&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dupes</span><span class="p">),</span> <span class="n">n</span> <span class="o">-</span> <span class="n">k</span> <span class="o">-</span> <span class="mf">1</span><span class="p">))</span></pre>
<pre class='cython code score-74 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1083, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1083, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1083, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_mode, __pyx_n_u_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1083, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1083, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1083, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1083, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_x.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1083, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_y.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1083, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1083, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1083, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_n, __pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1083, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1083, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1083, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_2);__pyx_t_3 = 0;__pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_shape, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1083, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_tuple__14, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1083, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1083, __pyx_L1_error)</span>__pyx_t_25 = ((PyArrayObject *)__pyx_t_1);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_25, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_float32, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {__pyx_v_dist = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 1083, __pyx_L1_error)</span>} else {__pyx_pybuffernd_dist.diminfo[0].strides = __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_dist.diminfo[0].shape = __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_dist.diminfo[1].strides = __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_dist.diminfo[1].shape = __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.shape[1];}}__pyx_t_25 = 0;__pyx_v_dist = ((PyArrayObject *)__pyx_t_1);__pyx_t_1 = 0;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1084</span>:     <span class="k">cdef</span> <span class="kt">float32</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">dist_view</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[:]</span></pre>
<pre class='cython code score-3 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_dist), __pyx_slice__13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1084, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_26 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_float32(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_26.memview)) __PYX_ERR(0, 1084, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_v_dist_view = __pyx_t_26;__pyx_t_26.memview = NULL;__pyx_t_26.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1085</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1086</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1087</span>:     <span class="n">y</span> <span class="o">=</span> <span class="n">nump2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="o">-</span><span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-20 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_nump2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1087, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_k, __pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1087, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_2 = NULL;__pyx_t_9 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {__pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);if (likely(__pyx_t_2)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);__pyx_t_9 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_v_n, __pyx_t_6};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_9, 2+__pyx_t_9);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1087, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;}__pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1087, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_y, 1);__pyx_v_y = __pyx_t_10;__pyx_t_10.memview = NULL;__pyx_t_10.data = NULL;</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1088</span>:     <span class="n">dupes</span> <span class="o">=</span> <span class="n">num_dupes_flop</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>__pyx_t_1 = __pyx_f_8ccluster_num_dupes_flop(__pyx_v_x, __pyx_v_y);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1088, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_dupes, __pyx_t_1);__pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1089</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1090</span>:     <span class="n">chunksize</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="n">threads</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-16 '>__pyx_t_12 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_x); __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1090, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_threads, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1090, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = <span class='py_c_api'>PyNumber_FloorDivide</span>(__pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1090, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_v_chunksize = __pyx_t_6;__pyx_t_6 = 0;</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1091</span>:     <span class="k">print</span><span class="p">(</span><span class="s">&#39;Starting FLOP EHS&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_tuple__18, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1091, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_tuple__18 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Starting_FLOP_EHS);<span class='error_goto'> if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 1091, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__18);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__18);</pre><pre class="cython line score-84" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1092</span>:     <span class="k">with</span> <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">ProcessPoolExecutor</span><span class="p">()</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span></pre>
<pre class='cython code score-84 '>/*with:*/ {<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_concurrent);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1092, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_futures);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ProcessPoolExecutor);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1092, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = NULL;__pyx_t_9 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {__pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);if (likely(__pyx_t_1)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);__pyx_t_9 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_1, };__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_9, 0+__pyx_t_9);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1092, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;}__pyx_t_27 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_6, __pyx_n_s_exit);<span class='error_goto'> if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 1092, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_27);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_6, __pyx_n_s_enter);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L9_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = NULL;__pyx_t_9 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {__pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);if (likely(__pyx_t_2)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);__pyx_t_9 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_2, };__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_9, 0+__pyx_t_9);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1092, __pyx_L9_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;}__pyx_t_1 = __pyx_t_5;__pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;/*try:*/ {{/*try:*/ {__pyx_v_executor = __pyx_t_1;__pyx_t_1 = 0;}<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_28); __pyx_t_28 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_29); __pyx_t_29 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_30); __pyx_t_30 = 0;goto __pyx_L18_try_end;__pyx_L13_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_10, 1);__pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_18, 1);__pyx_t_18.memview = NULL; __pyx_t_18.data = NULL;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_26, 1);__pyx_t_26.memview = NULL; __pyx_t_26.data = NULL;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_31, 1);__pyx_t_31.memview = NULL; __pyx_t_31.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_4, 1);__pyx_t_4.memview = NULL; __pyx_t_4.data = NULL;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);__pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;/*except:*/ {<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.flop_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_1, &amp;__pyx_t_2, &amp;__pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1092, __pyx_L15_except_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_t_1, __pyx_t_2, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1092, __pyx_L15_except_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_34 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_27, __pyx_t_6, NULL);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_34)) __PYX_ERR(0, 1092, __pyx_L15_except_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_34);__pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_34);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_34); __pyx_t_34 = 0;if (__pyx_t_11 &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1092, __pyx_L15_except_error)</span>__pyx_t_35 = (!__pyx_t_11);if (unlikely(__pyx_t_35)) {<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);<span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_t_1, __pyx_t_2, __pyx_t_5);__pyx_t_1 = 0; __pyx_t_2 = 0; __pyx_t_5 = 0; <span class='error_goto'>__PYX_ERR(0, 1092, __pyx_L15_except_error)</span>}<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;goto __pyx_L14_exception_handled;}__pyx_L15_except_error:;<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_28);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_29);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_30);<span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_28, __pyx_t_29, __pyx_t_30);goto __pyx_L1_error;__pyx_L14_exception_handled:;<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_28);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_29);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_30);<span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_28, __pyx_t_29, __pyx_t_30);__pyx_L18_try_end:;}}/*finally:*/ {/*normal exit:*/{if (__pyx_t_27) {__pyx_t_30 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_27, __pyx_tuple__20, NULL);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 1092, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_30);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_30); __pyx_t_30 = 0;}goto __pyx_L12;}__pyx_L12:;}goto __pyx_L24;__pyx_L9_error:;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_27); __pyx_t_27 = 0;goto __pyx_L1_error;__pyx_L24:;}__pyx_tuple__20 = <span class='py_c_api'>PyTuple_Pack</span>(3, Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 1092, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__20);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__20);</pre><pre class="cython line score-0">&#xA0;<span class="">1093</span>:         <span class="c"># change threads to appropriate number of workers for your system</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1094</span>:         <span class="n">futures</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>__pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1094, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_v_futures = ((PyObject*)__pyx_t_1);__pyx_t_1 = 0;</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1095</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">threads</span><span class="o">-</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-51 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_threads, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1095, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1095, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_6)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_6)) {__pyx_t_1 = __pyx_t_6; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_12 = 0;__pyx_t_13 = NULL;} else {__pyx_t_12 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1095, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1095, __pyx_L13_error)</span>}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;for (;;) {if (likely(!__pyx_t_13)) {if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {if (__pyx_t_12 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_12++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1095, __pyx_L13_error)</span>#else__pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1095, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);#endif} else {if (__pyx_t_12 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_12++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1095, __pyx_L13_error)</span>#else__pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1095, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);#endif}} else {__pyx_t_6 = __pyx_t_13(__pyx_t_1);if (unlikely(!__pyx_t_6)) {PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();if (exc_type) {if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();else <span class='error_goto'>__PYX_ERR(0, 1095, __pyx_L13_error)</span>}break;}<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_6);__pyx_t_6 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1096</span>:             <span class="n">strt</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">chunksize</span></pre>
<pre class='cython code score-6 '>__pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_v_chunksize);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1096, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_strt, __pyx_t_6);__pyx_t_6 = 0;</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1097</span>:             <span class="n">stp</span> <span class="o">=</span> <span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">chunksize</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="p">(</span><span class="n">threads</span> <span class="o">-</span> <span class="mf">2</span><span class="p">)</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_threads, __pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1097, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_i, __pyx_t_5, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1097, __pyx_L13_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1097, __pyx_L13_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (__pyx_t_11) {__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1097, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_v_chunksize);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1097, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_6 = __pyx_t_5;__pyx_t_5 = 0;} else {__pyx_t_14 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_x); __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1097, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = __pyx_t_5;__pyx_t_5 = 0;}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_stp, __pyx_t_6);__pyx_t_6 = 0;</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1098</span>:             <span class="k">print</span><span class="p">(</span><span class="n">strt</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="s">&#39; &#39;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>__pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1098, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_strt);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_strt);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_strt);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1098, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_end, __pyx_kp_u__19) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1098, __pyx_L13_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1098, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1099</span>:             <span class="k">print</span><span class="p">(</span><span class="n">stp</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_v_stp);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1099, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1100</span>:             <span class="n">prob_dist_fun</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">strt</span><span class="p">:</span><span class="n">stp</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">cntrs</span><span class="p">,</span> <span class="n">lbs</span><span class="p">,</span> <span class="n">dupes</span><span class="p">,</span> <span class="n">mp</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="n">strt</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">-</span><span class="n">dupes</span><span class="p">))</span></pre>
<pre class='cython code score-43 '>__pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_strt); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1100, __pyx_L13_error)</span>__pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_stp); if (unlikely((__pyx_t_15 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1100, __pyx_L13_error)</span>__pyx_t_10.data = __pyx_v_x.data;__pyx_t_10.memview = __pyx_v_x.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_10, 1);__pyx_t_9 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_10,
    __pyx_v_x.shape[0], __pyx_v_x.strides[0], __pyx_v_x.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_9,
    __pyx_t_14,
    __pyx_t_15,
    0,
    1,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 1100, __pyx_L13_error)</span>
}

__pyx_t_10.shape[1] = __pyx_v_x.shape[1];
__pyx_t_10.strides[1] = __pyx_v_x.strides[1];
    __pyx_t_10.suboffsets[1] = -1;

__pyx_t_26 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_float32(((PyObject *)__pyx_v_dist), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_26.memview)) __PYX_ERR(0, 1100, __pyx_L13_error)</span>__pyx_t_31 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_float32(((PyObject *)__pyx_v_cntrs), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_31.memview)) __PYX_ERR(0, 1100, __pyx_L13_error)</span>__pyx_t_32 = __Pyx_PyInt_As_npy_int64(__pyx_v_dupes); if (unlikely((__pyx_t_32 == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1100, __pyx_L13_error)</span>__pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_y.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1100, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_2, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1100, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_strt, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1100, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_33 = __Pyx_PyInt_As_npy_int64(__pyx_t_2); if (unlikely((__pyx_t_33 == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1100, __pyx_L13_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = __pyx_f_8ccluster_prob_dist_fun(__pyx_t_10, __pyx_v_y, __pyx_t_26, __pyx_t_31, __pyx_v_lbs, __pyx_t_32, __pyx_v_mp, 0, __pyx_t_33);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1100, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_10, 1);__pyx_t_10.memview = NULL; __pyx_t_10.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_26, 1);__pyx_t_26.memview = NULL; __pyx_t_26.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_31, 1);__pyx_t_31.memview = NULL; __pyx_t_31.data = NULL;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1101</span>:             <span class="c">#futures.append(executor.submit(prob_dist_fun, x[strt:stp], y, adjcntrs, lbls, dupes, mp, False, strt * (y.shape[0]-dupes)))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1102</span>:         <span class="c">#concurrent.futures.wait(futures)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1103</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1104</span>:         <span class="c">#output = [f.result() for f in futures]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1105</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1106</span>:     <span class="k">return</span> <span class="n">dupes</span></pre>
<pre class='cython code score-2 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dupes);__pyx_r = __pyx_v_dupes;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">1107</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1108</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1109</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-129" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1110</span>: <span class="k">cpdef</span> <span class="nf">turn_ehs</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">threads</span><span class="p">,</span> <span class="n">dupes</span><span class="p">,</span> <span class="n">new_file</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span></pre>
<pre class='cython code score-129 '>static PyObject *__pyx_pw_8ccluster_15turn_ehs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/static PyObject *__pyx_f_8ccluster_turn_ehs(PyObject *__pyx_v_n, PyObject *__pyx_v_k, PyObject *__pyx_v_threads, PyObject *__pyx_v_dupes, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_8ccluster_turn_ehs *__pyx_optional_args) {PyObject *__pyx_v_new_file = ((PyObject *)Py_False);PyObject *__pyx_v_adjcntrs = NULL;PyObject *__pyx_v_lbls = NULL;__Pyx_memviewslice __pyx_v_cntrs = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_lbs = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_x = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_y = { 0, 0, { 0 }, { 0 }, { 0 } };unsigned PY_LONG_LONG __pyx_v_one;unsigned PY_LONG_LONG __pyx_v_keyy;int __pyx_v_cd;PyObject *__pyx_v_mp = NULL;PyArrayObject *__pyx_v_oh = 0;__Pyx_memviewslice __pyx_v_oh_view = { 0, 0, { 0 }, { 0 }, { 0 } };PyObject *__pyx_v_i = NULL;CYTHON_UNUSED PyObject *__pyx_v_t1 = NULL;Py_ssize_t __pyx_v_j;PyArrayObject *__pyx_v_dist = 0;CYTHON_UNUSED __Pyx_memviewslice __pyx_v_dist_view = { 0, 0, { 0 }, { 0 }, { 0 } };PyObject *__pyx_v_prob_dist = NULL;PyObject *__pyx_v_chunksize = NULL;CYTHON_UNUSED PyObject *__pyx_v_executor = NULL;PyObject *__pyx_v_futures = NULL;PyObject *__pyx_v_strt = NULL;PyObject *__pyx_v_stp = NULL;CYTHON_UNUSED PyObject *__pyx_v_output = NULL;PyObject *__pyx_8genexpr3__pyx_v_f = NULL;__Pyx_LocalBuf_ND __pyx_pybuffernd_dist;__Pyx_Buffer __pyx_pybuffer_dist;__Pyx_LocalBuf_ND __pyx_pybuffernd_oh;__Pyx_Buffer __pyx_pybuffer_oh;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("turn_ehs", 0);if (__pyx_optional_args) {if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {__pyx_v_new_file = __pyx_optional_args-&gt;new_file;}}<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dupes);__pyx_pybuffer_oh.pybuffer.buf = NULL;__pyx_pybuffer_oh.refcount = 0;__pyx_pybuffernd_oh.data = NULL;__pyx_pybuffernd_oh.rcbuffer = &amp;__pyx_pybuffer_oh;__pyx_pybuffer_dist.pybuffer.buf = NULL;__pyx_pybuffer_dist.refcount = 0;__pyx_pybuffernd_dist.data = NULL;__pyx_pybuffernd_dist.rcbuffer = &amp;__pyx_pybuffer_dist;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_4, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_5, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_11, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_18, 1);{ PyObject *__pyx_type, *__pyx_value, *__pyx_tb;<span class='pyx_c_api'>__Pyx_PyThreadState_declare__Pyx_PyThreadState_assign__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.turn_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = 0;goto __pyx_L2;__pyx_L0:;<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);__pyx_L2:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_adjcntrs);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lbls);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_cntrs, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_lbs, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_x, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_y, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mp);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_oh);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_oh_view, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_dist);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_dist_view, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_prob_dist);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_chunksize);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_executor);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_futures);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_strt);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_stp);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_output);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr3__pyx_v_f);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dupes);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}/* Python wrapper */static PyObject *__pyx_pw_8ccluster_15turn_ehs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/static PyMethodDef __pyx_mdef_8ccluster_15turn_ehs = {"turn_ehs", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8ccluster_15turn_ehs, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};static PyObject *__pyx_pw_8ccluster_15turn_ehs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {PyObject *__pyx_v_n = 0;PyObject *__pyx_v_k = 0;PyObject *__pyx_v_threads = 0;PyObject *__pyx_v_dupes = 0;PyObject *__pyx_v_new_file = 0;#if !CYTHON_METH_FASTCALLCYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);#endifCYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);PyObject *__pyx_r = 0;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("turn_ehs (wrapper)", 0);{#if CYTHON_USE_MODULE_STATEPyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n,&amp;__pyx_n_s_k,&amp;__pyx_n_s_threads,&amp;__pyx_n_s_dupes,&amp;__pyx_n_s_new_file,0};#elsestatic PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n,&amp;__pyx_n_s_k,&amp;__pyx_n_s_threads,&amp;__pyx_n_s_dupes,&amp;__pyx_n_s_new_file,0};#endifPyObject* values[5] = {0,0,0,0,0};values[4] = ((PyObject *)Py_False);if (__pyx_kwds) {Py_ssize_t kw_args;switch (__pyx_nargs) {case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);CYTHON_FALLTHROUGH;case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);CYTHON_FALLTHROUGH;case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);CYTHON_FALLTHROUGH;case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);CYTHON_FALLTHROUGH;case  0: break;default: goto __pyx_L5_argtuple_error;}kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);switch (__pyx_nargs) {case  0:if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1110, __pyx_L3_error)</span>else goto __pyx_L5_argtuple_error;CYTHON_FALLTHROUGH;case  1:if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_k)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1110, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("turn_ehs", 0, 4, 5, 1); <span class='error_goto'>__PYX_ERR(0, 1110, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  2:if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_threads)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1110, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("turn_ehs", 0, 4, 5, 2); <span class='error_goto'>__PYX_ERR(0, 1110, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  3:if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dupes)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1110, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("turn_ehs", 0, 4, 5, 3); <span class='error_goto'>__PYX_ERR(0, 1110, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  4:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_new_file);if (value) { values[4] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1110, __pyx_L3_error)</span>}}if (unlikely(kw_args &gt; 0)) {const Py_ssize_t kwd_pos_args = __pyx_nargs;if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "turn_ehs") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1110, __pyx_L3_error)</span>}} else {switch (__pyx_nargs) {case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);CYTHON_FALLTHROUGH;case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);break;default: goto __pyx_L5_argtuple_error;}}__pyx_v_n = values[0];__pyx_v_k = values[1];__pyx_v_threads = values[2];__pyx_v_dupes = values[3];__pyx_v_new_file = values[4];}goto __pyx_L4_argument_unpacking_done;__pyx_L5_argtuple_error:;<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("turn_ehs", 0, 4, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1110, __pyx_L3_error)</span>__pyx_L3_error:;<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.turn_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return NULL;__pyx_L4_argument_unpacking_done:;__pyx_r = __pyx_pf_8ccluster_14turn_ehs(__pyx_self, __pyx_v_n, __pyx_v_k, __pyx_v_threads, __pyx_v_dupes, __pyx_v_new_file);/* function exit code */<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}static PyObject *__pyx_pf_8ccluster_14turn_ehs(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_n, PyObject *__pyx_v_k, PyObject *__pyx_v_threads, PyObject *__pyx_v_dupes, PyObject *__pyx_v_new_file) {PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("turn_ehs", 0);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);__pyx_t_2.__pyx_n = 1;__pyx_t_2.new_file = __pyx_v_new_file;__pyx_t_1 = __pyx_f_8ccluster_turn_ehs(__pyx_v_n, __pyx_v_k, __pyx_v_threads, __pyx_v_dupes, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1110, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_r = __pyx_t_1;__pyx_t_1 = 0;goto __pyx_L0;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.turn_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = NULL;__pyx_L0:;<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}__pyx_codeobj__55 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__52, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ccluster_pyx, __pyx_n_s_turn_ehs, 1110, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__55)) __PYX_ERR(0, 1110, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8ccluster_15turn_ehs, 0, __pyx_n_s_turn_ehs, NULL, __pyx_n_s_ccluster, __pyx_d, ((PyObject *)__pyx_codeobj__55));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1110, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__56);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_turn_ehs, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1110, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_tuple__56 = <span class='py_c_api'>PyTuple_Pack</span>(1, Py_False);<span class='error_goto'> if (unlikely(!__pyx_tuple__56)) __PYX_ERR(0, 1110, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__56);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__56);struct __pyx_opt_args_8ccluster_turn_ehs {int __pyx_n;PyObject *new_file;};</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1111</span>:     <span class="n">adjcntrs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;results/adjcntrs.npy&#39;</span><span class="p">,</span> <span class="n">mmap_mode</span> <span class="o">=</span> <span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-21 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1111, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_load);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1111, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1111, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_mmap_mode, __pyx_n_u_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1111, __pyx_L1_error)</span>__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__21, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1111, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_v_adjcntrs = __pyx_t_3;__pyx_t_3 = 0;__pyx_tuple__21 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_results_adjcntrs_npy);<span class='error_goto'> if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 1111, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__21);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__21);</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1112</span>:     <span class="n">lbls</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;results/lbls.npy&#39;</span><span class="p">,</span> <span class="n">mmap_mode</span> <span class="o">=</span> <span class="s">&#39;c&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-21 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1112, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_load);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1112, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1112, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_mmap_mode, __pyx_n_u_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1112, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__22, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1112, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_v_lbls = __pyx_t_2;__pyx_t_2 = 0;__pyx_tuple__22 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_results_lbls_npy);<span class='error_goto'> if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 1112, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__22);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__22);</pre><pre class="cython line score-0">&#xA0;<span class="">1113</span>:     <span class="c">#print(adjcntrs)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1114</span>:     <span class="c">#print(lbls)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1115</span>:     <span class="c">#print(min(lbls))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1116</span>:     <span class="c">#print(max(lbls))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1117</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1118</span>:     <span class="k">cdef</span> <span class="kt">float32</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">cntrs</span> <span class="o">=</span> <span class="n">adjcntrs</span></pre>
<pre class='cython code score-0 '>__pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_float32(__pyx_v_adjcntrs, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 1118, __pyx_L1_error)</span>__pyx_v_cntrs = __pyx_t_4;__pyx_t_4.memview = NULL;__pyx_t_4.data = NULL;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1119</span>:     <span class="k">cdef</span> <span class="kt">int</span>[<span class="p">:]</span> <span class="n">lbs</span> <span class="o">=</span> <span class="n">lbls</span></pre>
<pre class='cython code score-2 '>__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_v_lbls, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1119, __pyx_L1_error)</span>__pyx_v_lbs = __pyx_t_5;__pyx_t_5.memview = NULL;__pyx_t_5.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1120</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1121</span>:     <span class="k">cdef</span> <span class="kt">int16</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">x</span> <span class="o">=</span> <span class="n">nump2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-17 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_nump2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1121, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = NULL;__pyx_t_6 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_1)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_6 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_v_n, __pyx_int_2};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1121, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}__pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1121, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_x = __pyx_t_7;__pyx_t_7.memview = NULL;__pyx_t_7.data = NULL;</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1122</span>:     <span class="k">cdef</span> <span class="kt">int16</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">y</span> <span class="o">=</span> <span class="n">nump2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span></pre>
<pre class='cython code score-17 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_nump2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1122, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = NULL;__pyx_t_6 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_1)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_6 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_v_n, __pyx_v_k};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1122, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}__pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1122, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_y = __pyx_t_7;__pyx_t_7.memview = NULL;__pyx_t_7.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1123</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1124</span>:     <span class="n">dupes</span> <span class="o">=</span> <span class="n">num_dupes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>__pyx_t_2 = __pyx_f_8ccluster_num_dupes(__pyx_v_x, __pyx_v_y);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1124, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_dupes, __pyx_t_2);__pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1125</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1126</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">one</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>__pyx_v_one = 1;</pre><pre class="cython line score-0">&#xA0;<span class="">1127</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">keyy</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1128</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">cd</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>__pyx_v_cd = 0;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1129</span>:     <span class="n">mp</span> <span class="o">=</span> <span class="p">{}</span></pre>
<pre class='cython code score-2 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1129, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_v_mp = ((PyObject*)__pyx_t_2);__pyx_t_2 = 0;</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1130</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="nf">int16</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">oh</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mf">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span></pre>
<pre class='cython code score-34 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1130, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1130, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_k, __pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1130, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1130, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);__pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1130, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1130, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1130, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1130, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1130, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_9) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_9, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1130, __pyx_L1_error)</span>__pyx_t_10 = ((PyArrayObject *)__pyx_t_9);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_10, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_int16, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_v_oh = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 1130, __pyx_L1_error)</span>} else {__pyx_pybuffernd_oh.diminfo[0].strides = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_oh.diminfo[0].shape = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.shape[0];}}__pyx_t_10 = 0;__pyx_v_oh = ((PyArrayObject *)__pyx_t_9);__pyx_t_9 = 0;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1131</span>:     <span class="k">cdef</span> <span class="kt">int16</span>[<span class="p">:]</span> <span class="n">oh_view</span> <span class="o">=</span> <span class="n">oh</span><span class="p">[:]</span></pre>
<pre class='cython code score-3 '>__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_oh), __pyx_slice__13);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1131, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(__pyx_t_9, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 1131, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_v_oh_view = __pyx_t_11;__pyx_t_11.memview = NULL;__pyx_t_11.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1132</span>: </pre>
<pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1133</span>:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-54 '>__pyx_t_9 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_x.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1133, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1133, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {__pyx_t_9 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_12 = 0;__pyx_t_13 = NULL;} else {__pyx_t_12 = -1; __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1133, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1133, __pyx_L1_error)</span>}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;for (;;) {if (likely(!__pyx_t_13)) {if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9))) {if (__pyx_t_12 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_9)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_9, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_12++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1133, __pyx_L1_error)</span>#else__pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1133, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);#endif} else {if (__pyx_t_12 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_9)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_9, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_12++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1133, __pyx_L1_error)</span>#else__pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1133, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);#endif}} else {__pyx_t_2 = __pyx_t_13(__pyx_t_9);if (unlikely(!__pyx_t_2)) {PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();if (exc_type) {if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();else <span class='error_goto'>__PYX_ERR(0, 1133, __pyx_L1_error)</span>}break;}<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_2);__pyx_t_2 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1134</span>:         <span class="c"># load current portion of dataset to memory using the offset. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1135</span>:         <span class="c"># fluff_view[:, :] = numpy.memmap(&#39;results/fluffy.npy&#39;, mode = &#39;c&#39;, dtype = numpy.float32, shape = (y_shape_river[0], 1), offset = i * y_shape_river[0] * 8)[:]</span></pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1136</span>:         <span class="n">t1</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span></pre>
<pre class='cython code score-20 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1136, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1136, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = NULL;__pyx_t_6 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_1)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_6 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_1, };__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1136, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t1, __pyx_t_2);__pyx_t_2 = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1137</span>:         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>__pyx_t_14 = (__pyx_v_y.shape[0]);__pyx_t_15 = __pyx_t_14;for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {__pyx_v_j = __pyx_t_16;</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1138</span>:             <span class="n">oh_view</span><span class="p">[:</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>__pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_i); if (unlikely((__pyx_t_17 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1138, __pyx_L1_error)</span>__pyx_t_11.data = __pyx_v_x.data;__pyx_t_11.memview = __pyx_v_x.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_11, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_t_17;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_x.strides[0];
        __pyx_t_11.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_11.shape[0] = __pyx_v_x.shape[1];
__pyx_t_11.strides[0] = __pyx_v_x.strides[1];
    __pyx_t_11.suboffsets[0] = -1;

__pyx_t_18.data = __pyx_v_oh_view.data;__pyx_t_18.memview = __pyx_v_oh_view.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_18, 1);__pyx_t_6 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_18,
    __pyx_v_oh_view.shape[0], __pyx_v_oh_view.strides[0], __pyx_v_oh_view.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_6,
    0,
    2,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 1138, __pyx_L1_error)</span>
}

if (unlikely((__pyx_memoryview_copy_contents(__pyx_t_11, __pyx_t_18, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1138, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_18, 1);__pyx_t_18.memview = NULL; __pyx_t_18.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_11, 1);__pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1139</span>:             <span class="n">oh_view</span><span class="p">[</span><span class="mf">2</span><span class="p">:]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_t_11.data = __pyx_v_y.data;__pyx_t_11.memview = __pyx_v_y.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_11, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_j;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_y.strides[0];
        __pyx_t_11.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_11.shape[0] = __pyx_v_y.shape[1];
__pyx_t_11.strides[0] = __pyx_v_y.strides[1];
    __pyx_t_11.suboffsets[0] = -1;

__pyx_t_18.data = __pyx_v_oh_view.data;__pyx_t_18.memview = __pyx_v_oh_view.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_18, 1);__pyx_t_6 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_18,
    __pyx_v_oh_view.shape[0], __pyx_v_oh_view.strides[0], __pyx_v_oh_view.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_6,
    2,
    0,
    0,
    1,
    0,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 1139, __pyx_L1_error)</span>
}

if (unlikely((__pyx_memoryview_copy_contents(__pyx_t_11, __pyx_t_18, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1139, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_18, 1);__pyx_t_18.memview = NULL; __pyx_t_18.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_11, 1);__pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1140</span>:             <span class="k">if</span><span class="p">(</span><span class="ow">not</span> <span class="n">contains_duplicates</span><span class="p">(</span><span class="n">oh_view</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>__pyx_t_19 = (!(__pyx_f_8ccluster_contains_duplicates(__pyx_v_oh_view) != 0));if (__pyx_t_19) {}}</pre><pre class="cython line score-0">&#xA0;<span class="">1141</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1142</span>:                 <span class="n">keyy</span> <span class="o">=</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_view</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span> <span class="n">oh_view</span><span class="p">[</span><span class="mf">1</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span><span class="n">oh_view</span><span class="p">[</span><span class="mf">2</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span><span class="n">oh_view</span><span class="p">[</span><span class="mf">3</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span><span class="n">oh_view</span><span class="p">[</span><span class="mf">4</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span><span class="n">oh_view</span><span class="p">[</span><span class="mf">5</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">one</span> <span class="o">&lt;&lt;</span><span class="n">oh_view</span><span class="p">[</span><span class="mf">6</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>__pyx_t_20 = 0;__pyx_t_21 = 1;__pyx_t_22 = 2;__pyx_t_23 = 3;__pyx_t_24 = 4;__pyx_t_25 = 5;__pyx_t_26 = 6;__pyx_v_keyy = (((((((__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_20 * __pyx_v_oh_view.strides[0]) )))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_21 * __pyx_v_oh_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_22 * __pyx_v_oh_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_23 * __pyx_v_oh_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_24 * __pyx_v_oh_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_25 * __pyx_v_oh_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_26 * __pyx_v_oh_view.strides[0]) )))));</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1143</span>:                 <span class="n">mp</span><span class="p">[</span><span class="n">keyy</span><span class="p">]</span> <span class="o">=</span> <span class="n">cd</span></pre>
<pre class='cython code score-11 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_cd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1143, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_PY_LONG_LONG</span>(__pyx_v_keyy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1143, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);if (unlikely((<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_mp, __pyx_t_3, __pyx_t_2) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1143, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1144</span>:                 <span class="n">cd</span><span class="o">+=</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>__pyx_v_cd = (__pyx_v_cd + 1);</pre><pre class="cython line score-0">&#xA0;<span class="">1145</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1146</span>: </pre>
<pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1147</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="nf">float32</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">2</span><span class="p">]</span> <span class="n">dist</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">memmap</span><span class="p">(</span><span class="s">&#39;results/river_f.npy&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dupes</span><span class="p">),</span> <span class="mf">1</span><span class="p">))</span></pre>
<pre class='cython code score-67 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1147, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1147, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1147, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_mode, __pyx_n_u_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1147, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1147, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1147, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1147, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_x.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1147, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_y.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1147, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_8 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1147, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1147, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1147, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_int_1);__pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_shape, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1147, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__11, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1147, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_8) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_8, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1147, __pyx_L1_error)</span>__pyx_t_27 = ((PyArrayObject *)__pyx_t_8);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_27, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_float32, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {__pyx_v_dist = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 1147, __pyx_L1_error)</span>} else {__pyx_pybuffernd_dist.diminfo[0].strides = __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_dist.diminfo[0].shape = __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_dist.diminfo[1].strides = __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_dist.diminfo[1].shape = __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.shape[1];}}__pyx_t_27 = 0;__pyx_v_dist = ((PyArrayObject *)__pyx_t_8);__pyx_t_8 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1148</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1149</span>:     <span class="k">cdef</span> <span class="kt">float32</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">dist_view</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[:]</span></pre>
<pre class='cython code score-3 '>__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_dist), __pyx_slice__13);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1149, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_float32(__pyx_t_8, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 1149, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_v_dist_view = __pyx_t_4;__pyx_t_4.memview = NULL;__pyx_t_4.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1150</span>:     <span class="c">#numpy.ndarray[float32, ndim=2]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1151</span>:     <span class="c"># begin turn considerations</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1152</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1153</span>:     <span class="n">x</span> <span class="o">=</span> <span class="n">nump2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-17 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_nump2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1153, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_2 = NULL;__pyx_t_6 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {__pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);if (likely(__pyx_t_2)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);__pyx_t_6 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_v_n, __pyx_int_2};__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1153, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;}__pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_t_8, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1153, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_x, 1);__pyx_v_x = __pyx_t_7;__pyx_t_7.memview = NULL;__pyx_t_7.data = NULL;</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1154</span>:     <span class="n">y</span> <span class="o">=</span> <span class="n">nump2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-20 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_nump2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1154, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_k, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1154, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = NULL;__pyx_t_6 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);__pyx_t_6 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_n, __pyx_t_2};__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1154, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;}__pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_t_8, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1154, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_y, 1);__pyx_v_y = __pyx_t_7;__pyx_t_7.memview = NULL;__pyx_t_7.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1155</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1156</span>:     <span class="n">dupes</span> <span class="o">=</span> <span class="n">num_dupes_turn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>__pyx_t_8 = __pyx_f_8ccluster_num_dupes_turn(__pyx_v_x, __pyx_v_y);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1156, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_dupes, __pyx_t_8);__pyx_t_8 = 0;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1157</span>:     <span class="k">print</span><span class="p">(</span><span class="n">dupes</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1157, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1158</span>:     <span class="k">if</span><span class="p">(</span><span class="n">new_file</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>__pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_new_file); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1158, __pyx_L1_error)</span>if (__pyx_t_19) {}</pre><pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1159</span>:         <span class="n">prob_dist</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">memmap</span><span class="p">(</span><span class="s">&#39;results/prob_dist_TURN.npy&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s">&#39;w+&#39;</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dupes</span><span class="p">),</span> <span class="n">n</span> <span class="o">-</span> <span class="n">k</span> <span class="o">-</span> <span class="mf">1</span><span class="p">))</span></pre>
<pre class='cython code score-71 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1159, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1159, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1159, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_mode, __pyx_kp_u_w) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1159, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1159, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1159, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1159, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_x.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1159, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_y.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1159, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_2, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1159, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1159, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_n, __pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1159, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1159, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1159, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_3);__pyx_t_2 = 0;__pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_shape, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1159, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__14, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1159, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_v_prob_dist = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1160</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1161</span>:         <span class="n">prob_dist</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></pre>
<pre class='cython code score-17 '>__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_prob_dist, __pyx_n_s_flush);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1161, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_9 = NULL;__pyx_t_6 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {__pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);if (likely(__pyx_t_9)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);__pyx_t_6 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_9, };__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1161, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1162</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1163</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1164</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1165</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1166</span>:     <span class="n">chunksize</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="n">threads</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-16 '>__pyx_t_12 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_x); __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1166, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_threads, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1166, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_9 = <span class='py_c_api'>PyNumber_FloorDivide</span>(__pyx_t_1, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1166, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_v_chunksize = __pyx_t_9;__pyx_t_9 = 0;</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1167</span>:     <span class="k">print</span><span class="p">(</span><span class="s">&#39;Starting TURN EHS&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_tuple__23, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1167, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_tuple__23 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Starting_TURN_EHS);<span class='error_goto'> if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 1167, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__23);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__23);</pre><pre class="cython line score-79" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1168</span>:     <span class="k">with</span> <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">ProcessPoolExecutor</span><span class="p">()</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span></pre>
<pre class='cython code score-79 '>/*with:*/ {<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_concurrent);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1168, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_futures);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1168, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ProcessPoolExecutor);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1168, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = NULL;__pyx_t_6 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {__pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);if (likely(__pyx_t_1)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);__pyx_t_6 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_1, };__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1168, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;}__pyx_t_28 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_9, __pyx_n_s_exit);<span class='error_goto'> if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 1168, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_28);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_9, __pyx_n_s_enter);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1168, __pyx_L9_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = NULL;__pyx_t_6 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);__pyx_t_6 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_3, };__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1168, __pyx_L9_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;}__pyx_t_1 = __pyx_t_8;__pyx_t_8 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;/*try:*/ {{/*try:*/ {__pyx_v_executor = __pyx_t_1;__pyx_t_1 = 0;}<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_29); __pyx_t_29 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_30); __pyx_t_30 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_31); __pyx_t_31 = 0;goto __pyx_L18_try_end;__pyx_L13_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_11, 1);__pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_18, 1);__pyx_t_18.memview = NULL; __pyx_t_18.data = NULL;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_4, 1);__pyx_t_4.memview = NULL; __pyx_t_4.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_5, 1);__pyx_t_5.memview = NULL; __pyx_t_5.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);__pyx_t_7.memview = NULL; __pyx_t_7.data = NULL;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;/*except:*/ {<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.turn_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_1, &amp;__pyx_t_3, &amp;__pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1168, __pyx_L15_except_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_9 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_t_1, __pyx_t_3, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1168, __pyx_L15_except_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_34 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_28, __pyx_t_9, NULL);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_28); __pyx_t_28 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_34)) __PYX_ERR(0, 1168, __pyx_L15_except_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_34);__pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_34);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_34); __pyx_t_34 = 0;if (__pyx_t_19 &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1168, __pyx_L15_except_error)</span>__pyx_t_35 = (!__pyx_t_19);if (unlikely(__pyx_t_35)) {<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);<span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_t_1, __pyx_t_3, __pyx_t_8);__pyx_t_1 = 0; __pyx_t_3 = 0; __pyx_t_8 = 0; <span class='error_goto'>__PYX_ERR(0, 1168, __pyx_L15_except_error)</span>}<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;goto __pyx_L14_exception_handled;}__pyx_L15_except_error:;<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_29);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_30);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_31);<span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_29, __pyx_t_30, __pyx_t_31);goto __pyx_L1_error;__pyx_L14_exception_handled:;<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_29);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_30);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_31);<span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_29, __pyx_t_30, __pyx_t_31);__pyx_L18_try_end:;}}/*finally:*/ {/*normal exit:*/{if (__pyx_t_28) {__pyx_t_31 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_28, __pyx_tuple__20, NULL);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_28); __pyx_t_28 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_31)) __PYX_ERR(0, 1168, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_31);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_31); __pyx_t_31 = 0;}goto __pyx_L12;}__pyx_L12:;}goto __pyx_L30;__pyx_L9_error:;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_28); __pyx_t_28 = 0;goto __pyx_L1_error;__pyx_L30:;}</pre><pre class="cython line score-0">&#xA0;<span class="">1169</span>:         <span class="c"># change threads to appropriate number of workers for your system</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1170</span>:         <span class="n">futures</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>__pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1170, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_v_futures = ((PyObject*)__pyx_t_1);__pyx_t_1 = 0;</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1171</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">threads</span><span class="o">-</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-51 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_threads, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1171, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1171, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_9)) {__pyx_t_1 = __pyx_t_9; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_12 = 0;__pyx_t_13 = NULL;} else {__pyx_t_12 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1171, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1171, __pyx_L13_error)</span>}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;for (;;) {if (likely(!__pyx_t_13)) {if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {if (__pyx_t_12 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_12++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1171, __pyx_L13_error)</span>#else__pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1171, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);#endif} else {if (__pyx_t_12 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_12++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1171, __pyx_L13_error)</span>#else__pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1171, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);#endif}} else {__pyx_t_9 = __pyx_t_13(__pyx_t_1);if (unlikely(!__pyx_t_9)) {PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();if (exc_type) {if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();else <span class='error_goto'>__PYX_ERR(0, 1171, __pyx_L13_error)</span>}break;}<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_9);__pyx_t_9 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1172</span>:             <span class="n">strt</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">chunksize</span></pre>
<pre class='cython code score-6 '>__pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_v_chunksize);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1172, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_strt, __pyx_t_9);__pyx_t_9 = 0;</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1173</span>:             <span class="n">stp</span> <span class="o">=</span> <span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">chunksize</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="p">(</span><span class="n">threads</span> <span class="o">-</span> <span class="mf">2</span><span class="p">)</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-27 '>__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_threads, __pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1173, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_i, __pyx_t_8, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1173, __pyx_L13_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_19 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1173, __pyx_L13_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (__pyx_t_19) {__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1173, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_v_chunksize);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1173, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_9 = __pyx_t_8;__pyx_t_8 = 0;} else {__pyx_t_14 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_x); __pyx_t_8 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1173, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_9 = __pyx_t_8;__pyx_t_8 = 0;}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_stp, __pyx_t_9);__pyx_t_9 = 0;</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1174</span>:             <span class="k">print</span><span class="p">(</span><span class="n">strt</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="s">&#39; &#39;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>__pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1174, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_strt);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_strt);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_v_strt);__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1174, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_end, __pyx_kp_u__19) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1174, __pyx_L13_error)</span>__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_t_9, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1174, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1175</span>:             <span class="k">print</span><span class="p">(</span><span class="n">stp</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_v_stp);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1175, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1176</span>:             <span class="n">prob_dist_fun</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">strt</span><span class="p">:</span><span class="n">stp</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="n">dist</span><span class="p">[:],</span> <span class="n">cntrs</span><span class="p">,</span> <span class="n">lbs</span><span class="p">,</span> <span class="n">dupes</span><span class="p">,</span> <span class="n">mp</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="n">strt</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">-</span><span class="n">dupes</span><span class="p">))</span></pre>
<pre class='cython code score-46 '>__pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_strt); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1176, __pyx_L13_error)</span>__pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_stp); if (unlikely((__pyx_t_15 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1176, __pyx_L13_error)</span>__pyx_t_7.data = __pyx_v_x.data;__pyx_t_7.memview = __pyx_v_x.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_7, 1);__pyx_t_6 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_7,
    __pyx_v_x.shape[0], __pyx_v_x.strides[0], __pyx_v_x.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_6,
    __pyx_t_14,
    __pyx_t_15,
    0,
    1,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 1176, __pyx_L13_error)</span>
}

__pyx_t_7.shape[1] = __pyx_v_x.shape[1];
__pyx_t_7.strides[1] = __pyx_v_x.strides[1];
    __pyx_t_7.suboffsets[1] = -1;

__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_dist), __pyx_slice__13);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1176, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_float32(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 1176, __pyx_L13_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_32 = __Pyx_PyInt_As_npy_int64(__pyx_v_dupes); if (unlikely((__pyx_t_32 == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1176, __pyx_L13_error)</span>__pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_y.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1176, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_8 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1176, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_strt, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1176, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_33 = __Pyx_PyInt_As_npy_int64(__pyx_t_3); if (unlikely((__pyx_t_33 == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1176, __pyx_L13_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = __pyx_f_8ccluster_prob_dist_fun(__pyx_t_7, __pyx_v_y, __pyx_t_4, __pyx_v_cntrs, __pyx_v_lbs, __pyx_t_32, __pyx_v_mp, 1, __pyx_t_33);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1176, __pyx_L13_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);__pyx_t_7.memview = NULL; __pyx_t_7.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_4, 1);__pyx_t_4.memview = NULL; __pyx_t_4.data = NULL;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1177</span>:             <span class="c">#futures.append(executor.submit(prob_dist_fun, x[strt:stp], y, adjcntrs, lbls, dupes, mp, True, strt * (y.shape[0]-dupes)))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1178</span>:         <span class="c">#concurrent.futures.wait(futures)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1179</span>: </pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1180</span>:         <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">result</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">futures</span><span class="p">]</span></pre>
<pre class='cython code score-33 '>{ /* enter inner scope */__pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1180, __pyx_L23_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = __pyx_v_futures; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_12 = 0;for (;;) {if (__pyx_t_12 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_12++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1180, __pyx_L23_error)</span>#else__pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1180, __pyx_L23_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);#endif<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr3__pyx_v_f, __pyx_t_8);__pyx_t_8 = 0;__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_8genexpr3__pyx_v_f, __pyx_n_s_result);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1180, __pyx_L23_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_2 = NULL;__pyx_t_6 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {__pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);if (likely(__pyx_t_2)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);__pyx_t_6 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_2, };__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1180, __pyx_L23_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;}if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_8))) <span class='error_goto'>__PYX_ERR(0, 1180, __pyx_L23_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr3__pyx_v_f); __pyx_8genexpr3__pyx_v_f = 0;goto __pyx_L26_exit_scope;__pyx_L23_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr3__pyx_v_f); __pyx_8genexpr3__pyx_v_f = 0;goto __pyx_L13_error;__pyx_L26_exit_scope:;} /* exit inner scope */__pyx_v_output = ((PyObject*)__pyx_t_1);__pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1181</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1182</span>:     <span class="k">return</span> <span class="n">dupes</span></pre>
<pre class='cython code score-2 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dupes);__pyx_r = __pyx_v_dupes;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">1183</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1184</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1185</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1186</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1187</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1188</span>: <span class="k">cdef</span> <span class="nf">num_dupes_flop</span><span class="p">(</span><span class="n">int16</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">x</span><span class="p">,</span> <span class="n">int16</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">y</span><span class="p">):</span></pre>
<pre class='cython code score-16 '>static PyObject *__pyx_f_8ccluster_num_dupes_flop(__Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y) {CYTHON_UNUSED unsigned PY_LONG_LONG __pyx_v_total;__pyx_t_5numpy_int64_t __pyx_v_j;CYTHON_UNUSED __pyx_t_5numpy_int64_t __pyx_v_x_shape;__pyx_t_5numpy_int64_t __pyx_v_y_shape;PyObject *__pyx_v_cd = NULL;PyArrayObject *__pyx_v_oh = 0;CYTHON_UNUSED __Pyx_memviewslice __pyx_v_oh_view = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_LocalBuf_ND __pyx_pybuffernd_oh;__Pyx_Buffer __pyx_pybuffer_oh;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("num_dupes_flop", 0);__pyx_pybuffer_oh.pybuffer.buf = NULL;__pyx_pybuffer_oh.refcount = 0;__pyx_pybuffernd_oh.data = NULL;__pyx_pybuffernd_oh.rcbuffer = &amp;__pyx_pybuffer_oh;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);{ PyObject *__pyx_type, *__pyx_value, *__pyx_tb;<span class='pyx_c_api'>__Pyx_PyThreadState_declare__Pyx_PyThreadState_assign__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.num_dupes_flop", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = 0;goto __pyx_L2;__pyx_L0:;<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);__pyx_L2:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cd);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_oh);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_oh_view, 1);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1189</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="kt">int</span> <span class="nf">total</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>__pyx_v_total = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1190</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">int64_t</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">c</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1191</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">t1</span><span class="p">,</span> <span class="nf">t2</span><span class="p">,</span> <span class="nf">t</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1192</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">int64_t</span> <span class="nf">x_shape</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_v_x_shape = (__pyx_v_x.shape[0]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1193</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">int64_t</span> <span class="nf">y_shape</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_v_y_shape = (__pyx_v_y.shape[0]);</pre><pre class="cython line score-0">&#xA0;<span class="">1194</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1195</span>:     <span class="k">cdef</span> <span class="kt">mapp</span>[<span class="kt">unsigned</span> <span class="kt">long</span> <span class="nf">long</span><span class="p">,</span> <span class="kt">int</span>] <span class="nf">mp</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1196</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1197</span>:     <span class="n">cd</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-1 '><span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);__pyx_v_cd = __pyx_int_0;</pre><pre class="cython line score-0">&#xA0;<span class="">1198</span>: </pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1199</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="nf">int16</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">oh</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mf">5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span></pre>
<pre class='cython code score-30 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1199, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1199, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1199, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1199, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1199, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1199, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__24, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1199, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1199, __pyx_L1_error)</span>__pyx_t_5 = ((PyArrayObject *)__pyx_t_4);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_5, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_int16, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_v_oh = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 1199, __pyx_L1_error)</span>} else {__pyx_pybuffernd_oh.diminfo[0].strides = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_oh.diminfo[0].shape = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.shape[0];}}__pyx_t_5 = 0;__pyx_v_oh = ((PyArrayObject *)__pyx_t_4);__pyx_t_4 = 0;__pyx_tuple__24 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_5);<span class='error_goto'> if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 1199, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__24);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__24);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1200</span>:     <span class="k">cdef</span> <span class="kt">int16</span> [<span class="p">:]</span> <span class="n">oh_view</span> <span class="o">=</span> <span class="n">oh</span></pre>
<pre class='cython code score-0 '>__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(((PyObject *)__pyx_v_oh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1200, __pyx_L1_error)</span>__pyx_v_oh_view = __pyx_t_6;__pyx_t_6.memview = NULL;__pyx_t_6.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1201</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1202</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1203</span>:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y_shape</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_7 = __pyx_v_y_shape;__pyx_t_8 = __pyx_t_7;for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {__pyx_v_j = __pyx_t_9;</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1204</span>:         <span class="n">oh</span><span class="p">[:</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">][:]</span></pre>
<pre class='cython code score-11 '>__pyx_t_6.data = __pyx_v_x.data;__pyx_t_6.memview = __pyx_v_x.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_6, 1);{
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_x.strides[0];
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_x.shape[1];
__pyx_t_6.strides[0] = __pyx_v_x.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_6, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_8ccluster_int16, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_8ccluster_int16, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1204, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_oh), __pyx_slice__25, __pyx_t_4) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1204, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_slice__25 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_2, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__25)) __PYX_ERR(0, 1204, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__25);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__25);</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1205</span>:         <span class="n">oh</span><span class="p">[</span><span class="mf">2</span><span class="p">:]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">][:]</span></pre>
<pre class='cython code score-11 '>__pyx_t_6.data = __pyx_v_y.data;__pyx_t_6.memview = __pyx_v_y.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_6, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_j;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_y.strides[0];
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_y.shape[1];
__pyx_t_6.strides[0] = __pyx_v_y.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_6, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_8ccluster_int16, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_8ccluster_int16, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1205, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_oh), __pyx_slice__26, __pyx_t_4) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1205, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_slice__26 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_2, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__26)) __PYX_ERR(0, 1205, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__26);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__26);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1206</span>:         <span class="k">if</span><span class="p">(</span><span class="n">contains_duplicates_flop</span><span class="p">(</span><span class="n">oh</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(((PyObject *)__pyx_v_oh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1206, __pyx_L1_error)</span>__pyx_t_10 = (__pyx_f_8ccluster_contains_duplicates_flop(__pyx_t_6) != 0);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;if (__pyx_t_10) {}}</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1207</span>:             <span class="n">cd</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-3 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_cd, __pyx_int_1, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1207, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_cd, __pyx_t_4);__pyx_t_4 = 0;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1208</span>:     <span class="k">return</span> <span class="n">cd</span></pre>
<pre class='cython code score-2 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cd);__pyx_r = __pyx_v_cd;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">1209</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1210</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1211</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1212</span>: <span class="k">cdef</span> <span class="nf">num_dupes_turn</span><span class="p">(</span><span class="n">int16</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">x</span><span class="p">,</span> <span class="n">int16</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">y</span><span class="p">):</span></pre>
<pre class='cython code score-16 '>static PyObject *__pyx_f_8ccluster_num_dupes_turn(__Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y) {CYTHON_UNUSED unsigned PY_LONG_LONG __pyx_v_total;__pyx_t_5numpy_int64_t __pyx_v_j;CYTHON_UNUSED __pyx_t_5numpy_int64_t __pyx_v_x_shape;__pyx_t_5numpy_int64_t __pyx_v_y_shape;PyObject *__pyx_v_cd = NULL;PyArrayObject *__pyx_v_oh = 0;CYTHON_UNUSED __Pyx_memviewslice __pyx_v_oh_view = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_LocalBuf_ND __pyx_pybuffernd_oh;__Pyx_Buffer __pyx_pybuffer_oh;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("num_dupes_turn", 0);__pyx_pybuffer_oh.pybuffer.buf = NULL;__pyx_pybuffer_oh.refcount = 0;__pyx_pybuffernd_oh.data = NULL;__pyx_pybuffernd_oh.rcbuffer = &amp;__pyx_pybuffer_oh;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);{ PyObject *__pyx_type, *__pyx_value, *__pyx_tb;<span class='pyx_c_api'>__Pyx_PyThreadState_declare__Pyx_PyThreadState_assign__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.num_dupes_turn", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = 0;goto __pyx_L2;__pyx_L0:;<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);__pyx_L2:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cd);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_oh);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_oh_view, 1);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1213</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="kt">int</span> <span class="nf">total</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>__pyx_v_total = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1214</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">int64_t</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">c</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1215</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">t1</span><span class="p">,</span> <span class="nf">t2</span><span class="p">,</span> <span class="nf">t</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1216</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">int64_t</span> <span class="nf">x_shape</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_v_x_shape = (__pyx_v_x.shape[0]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1217</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">int64_t</span> <span class="nf">y_shape</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_v_y_shape = (__pyx_v_y.shape[0]);</pre><pre class="cython line score-0">&#xA0;<span class="">1218</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1219</span>:     <span class="k">cdef</span> <span class="kt">mapp</span>[<span class="kt">unsigned</span> <span class="kt">long</span> <span class="nf">long</span><span class="p">,</span> <span class="kt">int</span>] <span class="nf">mp</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1220</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1221</span>:     <span class="n">cd</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-1 '><span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);__pyx_v_cd = __pyx_int_0;</pre><pre class="cython line score-0">&#xA0;<span class="">1222</span>: </pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1223</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="nf">int16</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">oh</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mf">6</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span></pre>
<pre class='cython code score-30 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1223, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1223, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1223, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1223, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1223, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1223, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__27, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1223, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1223, __pyx_L1_error)</span>__pyx_t_5 = ((PyArrayObject *)__pyx_t_4);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_5, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_int16, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_v_oh = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 1223, __pyx_L1_error)</span>} else {__pyx_pybuffernd_oh.diminfo[0].strides = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_oh.diminfo[0].shape = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.shape[0];}}__pyx_t_5 = 0;__pyx_v_oh = ((PyArrayObject *)__pyx_t_4);__pyx_t_4 = 0;__pyx_tuple__27 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_6);<span class='error_goto'> if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 1223, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__27);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__27);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1224</span>:     <span class="k">cdef</span> <span class="kt">int16</span> [<span class="p">:]</span> <span class="n">oh_view</span> <span class="o">=</span> <span class="n">oh</span></pre>
<pre class='cython code score-0 '>__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(((PyObject *)__pyx_v_oh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1224, __pyx_L1_error)</span>__pyx_v_oh_view = __pyx_t_6;__pyx_t_6.memview = NULL;__pyx_t_6.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1225</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1226</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1227</span>:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y_shape</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_7 = __pyx_v_y_shape;__pyx_t_8 = __pyx_t_7;for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {__pyx_v_j = __pyx_t_9;</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1228</span>:         <span class="n">oh</span><span class="p">[:</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-6 '>__pyx_t_6.data = __pyx_v_x.data;__pyx_t_6.memview = __pyx_v_x.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_6, 1);{
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_x.strides[0];
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_x.shape[1];
__pyx_t_6.strides[0] = __pyx_v_x.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_6, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_8ccluster_int16, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_8ccluster_int16, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1228, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_oh), __pyx_slice__25, __pyx_t_4) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1228, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1229</span>:         <span class="n">oh</span><span class="p">[</span><span class="mf">2</span><span class="p">:]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-6 '>__pyx_t_6.data = __pyx_v_y.data;__pyx_t_6.memview = __pyx_v_y.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_6, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_j;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_y.strides[0];
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_y.shape[1];
__pyx_t_6.strides[0] = __pyx_v_y.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_6, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_8ccluster_int16, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_8ccluster_int16, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1229, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_oh), __pyx_slice__26, __pyx_t_4) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1229, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1230</span>:         <span class="k">if</span><span class="p">(</span><span class="n">contains_duplicates_turn</span><span class="p">(</span><span class="n">oh</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(((PyObject *)__pyx_v_oh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1230, __pyx_L1_error)</span>__pyx_t_10 = (__pyx_f_8ccluster_contains_duplicates_turn(__pyx_t_6) != 0);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;if (__pyx_t_10) {}}</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1231</span>:             <span class="n">cd</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-3 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_cd, __pyx_int_1, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1231, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_cd, __pyx_t_4);__pyx_t_4 = 0;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1232</span>:     <span class="k">return</span> <span class="n">cd</span></pre>
<pre class='cython code score-2 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cd);__pyx_r = __pyx_v_cd;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">1233</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1234</span>: <span class="c"># @cython.profile(True)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1235</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1236</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1237</span>: <span class="k">cdef</span> <span class="nf">num_dupes</span><span class="p">(</span><span class="n">int16</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">x</span><span class="p">,</span> <span class="n">int16</span><span class="p">[:,</span> <span class="p">:]</span> <span class="n">y</span><span class="p">):</span></pre>
<pre class='cython code score-16 '>static PyObject *__pyx_f_8ccluster_num_dupes(__Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y) {CYTHON_UNUSED unsigned PY_LONG_LONG __pyx_v_total;__pyx_t_5numpy_int64_t __pyx_v_j;CYTHON_UNUSED __pyx_t_5numpy_int64_t __pyx_v_x_shape;__pyx_t_5numpy_int64_t __pyx_v_y_shape;PyObject *__pyx_v_cd = NULL;PyArrayObject *__pyx_v_oh = 0;CYTHON_UNUSED __Pyx_memviewslice __pyx_v_oh_view = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_LocalBuf_ND __pyx_pybuffernd_oh;__Pyx_Buffer __pyx_pybuffer_oh;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("num_dupes", 0);__pyx_pybuffer_oh.pybuffer.buf = NULL;__pyx_pybuffer_oh.refcount = 0;__pyx_pybuffernd_oh.data = NULL;__pyx_pybuffernd_oh.rcbuffer = &amp;__pyx_pybuffer_oh;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);{ PyObject *__pyx_type, *__pyx_value, *__pyx_tb;<span class='pyx_c_api'>__Pyx_PyThreadState_declare__Pyx_PyThreadState_assign__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.num_dupes", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = 0;goto __pyx_L2;__pyx_L0:;<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);__pyx_L2:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cd);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_oh);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_oh_view, 1);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1238</span>:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="kt">int</span> <span class="nf">total</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>__pyx_v_total = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1239</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">int64_t</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">c</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1240</span>:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">t1</span><span class="p">,</span> <span class="nf">t2</span><span class="p">,</span> <span class="nf">t</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1241</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">int64_t</span> <span class="nf">x_shape</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_v_x_shape = (__pyx_v_x.shape[0]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1242</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">int64_t</span> <span class="nf">y_shape</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>__pyx_v_y_shape = (__pyx_v_y.shape[0]);</pre><pre class="cython line score-0">&#xA0;<span class="">1243</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1244</span>:     <span class="k">cdef</span> <span class="kt">mapp</span>[<span class="kt">unsigned</span> <span class="kt">long</span> <span class="nf">long</span><span class="p">,</span> <span class="kt">int</span>] <span class="nf">mp</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1245</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1246</span>:     <span class="n">cd</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-1 '><span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);__pyx_v_cd = __pyx_int_0;</pre><pre class="cython line score-0">&#xA0;<span class="">1247</span>: </pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1248</span>:     <span class="k">cdef</span> <span class="kt">numpy</span>.<span class="kt">ndarray</span>[<span class="nf">int16</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">oh</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mf">7</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span></pre>
<pre class='cython code score-25 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1248, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1248, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1248, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1248, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1248, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1248, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__12, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1248, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1248, __pyx_L1_error)</span>__pyx_t_5 = ((PyArrayObject *)__pyx_t_4);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_5, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_int16, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_v_oh = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 1248, __pyx_L1_error)</span>} else {__pyx_pybuffernd_oh.diminfo[0].strides = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_oh.diminfo[0].shape = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.shape[0];}}__pyx_t_5 = 0;__pyx_v_oh = ((PyArrayObject *)__pyx_t_4);__pyx_t_4 = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1249</span>:     <span class="k">cdef</span> <span class="kt">int16</span> [<span class="p">:]</span> <span class="n">oh_view</span> <span class="o">=</span> <span class="n">oh</span></pre>
<pre class='cython code score-0 '>__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(((PyObject *)__pyx_v_oh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1249, __pyx_L1_error)</span>__pyx_v_oh_view = __pyx_t_6;__pyx_t_6.memview = NULL;__pyx_t_6.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1250</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1251</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1252</span>:     <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y_shape</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>__pyx_t_7 = __pyx_v_y_shape;__pyx_t_8 = __pyx_t_7;for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {__pyx_v_j = __pyx_t_9;</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1253</span>:         <span class="n">oh</span><span class="p">[:</span><span class="mf">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-6 '>__pyx_t_6.data = __pyx_v_x.data;__pyx_t_6.memview = __pyx_v_x.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_6, 1);{
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_x.strides[0];
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_x.shape[1];
__pyx_t_6.strides[0] = __pyx_v_x.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_6, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_8ccluster_int16, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_8ccluster_int16, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1253, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_oh), __pyx_slice__25, __pyx_t_4) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1253, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1254</span>:         <span class="n">oh</span><span class="p">[</span><span class="mf">2</span><span class="p">:]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></pre>
<pre class='cython code score-6 '>__pyx_t_6.data = __pyx_v_y.data;__pyx_t_6.memview = __pyx_v_y.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_6, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_j;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_y.strides[0];
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_y.shape[1];
__pyx_t_6.strides[0] = __pyx_v_y.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_6, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_8ccluster_int16, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_8ccluster_int16, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1254, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_oh), __pyx_slice__26, __pyx_t_4) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1254, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1255</span>:         <span class="k">if</span><span class="p">(</span><span class="n">contains_duplicates</span><span class="p">(</span><span class="n">oh</span><span class="p">)):</span></pre>
<pre class='cython code score-0 '>__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(((PyObject *)__pyx_v_oh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1255, __pyx_L1_error)</span>__pyx_t_10 = (__pyx_f_8ccluster_contains_duplicates(__pyx_t_6) != 0);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;if (__pyx_t_10) {}}</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1256</span>:             <span class="n">cd</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-3 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_cd, __pyx_int_1, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1256, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_cd, __pyx_t_4);__pyx_t_4 = 0;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1257</span>:     <span class="k">return</span> <span class="n">cd</span></pre>
<pre class='cython code score-2 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cd);__pyx_r = __pyx_v_cd;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">1258</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1259</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">boundscheck</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class='cython code score-47 '>/* Python wrapper */static PyObject *__pyx_pw_8ccluster_17river_ehs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/static PyMethodDef __pyx_mdef_8ccluster_17river_ehs = {"river_ehs", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8ccluster_17river_ehs, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};static PyObject *__pyx_pw_8ccluster_17river_ehs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {PyObject *__pyx_v_n = 0;PyObject *__pyx_v_k = 0;PyObject *__pyx_v_threads = 0;PyObject *__pyx_v_new_file = 0;#if !CYTHON_METH_FASTCALLCYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);#endifCYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);PyObject *__pyx_r = 0;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("river_ehs (wrapper)", 0);{#if CYTHON_USE_MODULE_STATEPyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n,&amp;__pyx_n_s_k,&amp;__pyx_n_s_threads,&amp;__pyx_n_s_new_file,0};#elsestatic PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n,&amp;__pyx_n_s_k,&amp;__pyx_n_s_threads,&amp;__pyx_n_s_new_file,0};#endifPyObject* values[4] = {0,0,0,0};/* function exit code */<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}static PyObject *__pyx_pf_8ccluster_16river_ehs(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_n, PyObject *__pyx_v_k, PyObject *__pyx_v_threads, PyObject *__pyx_v_new_file) {PyObject *__pyx_v_x = NULL;PyObject *__pyx_v_y = NULL;PyObject *__pyx_v_dupes = NULL;PyObject *__pyx_v_z = NULL;PyObject *__pyx_v_z_f = NULL;PyObject *__pyx_v_chunksize = NULL;PyObject *__pyx_v_executor = NULL;PyObject *__pyx_v_futures = NULL;PyObject *__pyx_v_i = NULL;PyObject *__pyx_v_strt = NULL;PyObject *__pyx_v_stp = NULL;CYTHON_UNUSED PyObject *__pyx_v_output = NULL;PyObject *__pyx_8genexpr4__pyx_v_f = NULL;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("river_ehs", 0);/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_5, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.river_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = NULL;__pyx_L0:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dupes);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_z);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_z_f);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_chunksize);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_executor);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_futures);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_strt);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_stp);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_output);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr4__pyx_v_f);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}__pyx_tuple__57 = <span class='py_c_api'>PyTuple_Pack</span>(17, __pyx_n_s_n, __pyx_n_s_k, __pyx_n_s_threads, __pyx_n_s_new_file, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_dupes, __pyx_n_s_z, __pyx_n_s_z_f, __pyx_n_s_chunksize, __pyx_n_s_executor, __pyx_n_s_futures, __pyx_n_s_i, __pyx_n_s_strt, __pyx_n_s_stp, __pyx_n_s_output, __pyx_n_s_f);<span class='error_goto'> if (unlikely(!__pyx_tuple__57)) __PYX_ERR(0, 1259, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__57);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__57);__pyx_codeobj__58 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 17, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__57, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ccluster_pyx, __pyx_n_s_river_ehs, 1259, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__58)) __PYX_ERR(0, 1259, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8ccluster_17river_ehs, 0, __pyx_n_s_river_ehs, NULL, __pyx_n_s_ccluster, __pyx_d, ((PyObject *)__pyx_codeobj__58));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1259, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__59);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_river_ehs, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1259, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_tuple__59 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)Py_False));<span class='error_goto'> if (unlikely(!__pyx_tuple__59)) __PYX_ERR(0, 1259, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__59);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__59);</pre><pre class="cython line score-0">&#xA0;<span class="">1260</span>: <span class="nd">@cython</span><span class="o">.</span><span class="n">wraparound</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></pre>
<pre class="cython line score-56" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1261</span>: <span class="k">def</span> <span class="nf">river_ehs</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">threads</span><span class="p">,</span> <span class="n">new_file</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span></pre>
<pre class='cython code score-56 '>values[3] = ((PyObject *)((PyObject *)Py_False));if (__pyx_kwds) {Py_ssize_t kw_args;switch (__pyx_nargs) {case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);CYTHON_FALLTHROUGH;case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);CYTHON_FALLTHROUGH;case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);CYTHON_FALLTHROUGH;case  0: break;default: goto __pyx_L5_argtuple_error;}kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);switch (__pyx_nargs) {case  0:if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1259, __pyx_L3_error)</span>else goto __pyx_L5_argtuple_error;CYTHON_FALLTHROUGH;case  1:if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_k)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1259, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("river_ehs", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 1259, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  2:if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_threads)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1259, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("river_ehs", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 1259, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  3:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_new_file);if (value) { values[3] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1259, __pyx_L3_error)</span>}}if (unlikely(kw_args &gt; 0)) {const Py_ssize_t kwd_pos_args = __pyx_nargs;if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "river_ehs") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1259, __pyx_L3_error)</span>}} else {switch (__pyx_nargs) {case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);break;default: goto __pyx_L5_argtuple_error;}}__pyx_v_n = values[0];__pyx_v_k = values[1];__pyx_v_threads = values[2];__pyx_v_new_file = values[3];}goto __pyx_L4_argument_unpacking_done;__pyx_L5_argtuple_error:;<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("river_ehs", 0, 3, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1259, __pyx_L3_error)</span>__pyx_L3_error:;<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.river_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return NULL;__pyx_L4_argument_unpacking_done:;__pyx_r = __pyx_pf_8ccluster_16river_ehs(__pyx_self, __pyx_v_n, __pyx_v_k, __pyx_v_threads, __pyx_v_new_file);</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1262</span>:     <span class="n">x</span> <span class="o">=</span> <span class="n">nump2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mf">2</span><span class="p">)</span></pre>
<pre class='cython code score-16 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_nump2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1262, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_n, __pyx_int_2};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1262, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}__pyx_v_x = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1263</span>:     <span class="n">y</span> <span class="o">=</span> <span class="n">nump2</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span></pre>
<pre class='cython code score-16 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_nump2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1263, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_n, __pyx_v_k};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1263, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}__pyx_v_y = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1264</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1265</span>:     <span class="n">dupes</span> <span class="o">=</span> <span class="n">num_dupes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>__pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_v_x, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1265, __pyx_L1_error)</span>__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_v_y, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1265, __pyx_L1_error)</span>__pyx_t_1 = __pyx_f_8ccluster_num_dupes(__pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1265, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_5, 1);__pyx_t_5.memview = NULL; __pyx_t_5.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;__pyx_v_dupes = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1266</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1267</span>:     <span class="k">print</span><span class="p">(</span><span class="n">dupes</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1267, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1268</span>:     <span class="k">if</span><span class="p">(</span><span class="n">new_file</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>__pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_new_file); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1268, __pyx_L1_error)</span>if (__pyx_t_7) {}</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1269</span>:         <span class="n">z</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">memmap</span><span class="p">(</span><span class="s">&#39;results/river.npy&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s">&#39;w+&#39;</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int16</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">((</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dupes</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="mf">3</span><span class="p">))</span></pre>
<pre class='cython code score-64 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1269, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1269, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1269, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_mode, __pyx_kp_u_w) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1269, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1269, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1269, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_8, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1269, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1269, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_x, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1269, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1269, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_8, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1269, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1269, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_int_3);__pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_shape, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__10, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1269, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_v_z = __pyx_t_9;__pyx_t_9 = 0;</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1270</span>:         <span class="n">z_f</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">memmap</span><span class="p">(</span><span class="s">&#39;results/river_f.npy&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s">&#39;w+&#39;</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">((</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dupes</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="mf">1</span><span class="p">))</span></pre>
<pre class='cython code score-64 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1270, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1270, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1270, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_mode, __pyx_kp_u_w) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1270, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1270, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1270, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1270, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1270, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1270, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_2, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1270, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_x, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1270, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1270, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1270, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1270, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_int_1);__pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_shape, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1270, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__11, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1270, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_v_z_f = __pyx_t_8;__pyx_t_8 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1271</span>:         <span class="c">#mp = numpy.memmap(&#39;results/map.npy&#39;, mode = &#39;w+&#39;, dtype = numpy.ulonglong, shape = ((y.shape[0] - dupes) * x.shape[0], 1))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1272</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1273</span>:         <span class="n">z</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></pre>
<pre class='cython code score-17 '>__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_flush);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1273, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_1 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {__pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);if (likely(__pyx_t_1)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_1, };__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1273, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1274</span>:         <span class="n">z_f</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></pre>
<pre class='cython code score-17 '>__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z_f, __pyx_n_s_flush);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1274, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_1 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {__pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);if (likely(__pyx_t_1)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_1, };__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1274, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1275</span>:         <span class="c">#mp.flush()</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1276</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1277</span>:     <span class="n">chunksize</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">//</span> <span class="p">(</span><span class="n">threads</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>__pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_x);<span class='error_goto'> if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1277, __pyx_L1_error)</span>__pyx_t_8 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1277, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_threads, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1277, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_1 = <span class='py_c_api'>PyNumber_FloorDivide</span>(__pyx_t_8, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1277, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_v_chunksize = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1278</span>:     <span class="k">print</span><span class="p">(</span><span class="s">&#39;Starting river EHS&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-8 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_tuple__28, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1278, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_tuple__28 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Starting_river_EHS);<span class='error_goto'> if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 1278, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__28);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__28);</pre><pre class="cython line score-81" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1279</span>:     <span class="k">with</span> <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">ProcessPoolExecutor</span><span class="p">()</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span></pre>
<pre class='cython code score-81 '>/*with:*/ {<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_concurrent);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1279, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_futures);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1279, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_ProcessPoolExecutor);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1279, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {__pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);if (likely(__pyx_t_8)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_8, };__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1279, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;}__pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_1, __pyx_n_s_exit);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1279, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_1, __pyx_n_s_enter);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1279, __pyx_L4_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_2 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {__pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);if (likely(__pyx_t_2)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_2, };__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1279, __pyx_L4_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;}__pyx_t_8 = __pyx_t_9;__pyx_t_9 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;/*try:*/ {{/*try:*/ {__pyx_v_executor = __pyx_t_8;__pyx_t_8 = 0;}<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;goto __pyx_L13_try_end;__pyx_L8_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17); __pyx_t_17 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18); __pyx_t_18 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_5, 1);__pyx_t_5.memview = NULL; __pyx_t_5.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;/*except:*/ {<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.river_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_8, &amp;__pyx_t_2, &amp;__pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1279, __pyx_L10_except_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_3 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_t_8, __pyx_t_2, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1279, __pyx_L10_except_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_3, NULL);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1279, __pyx_L10_except_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);__pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_20);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;if (__pyx_t_7 &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1279, __pyx_L10_except_error)</span>__pyx_t_21 = (!__pyx_t_7);if (unlikely(__pyx_t_21)) {<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);<span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_t_8, __pyx_t_2, __pyx_t_9);__pyx_t_8 = 0; __pyx_t_2 = 0; __pyx_t_9 = 0; <span class='error_goto'>__PYX_ERR(0, 1279, __pyx_L10_except_error)</span>}<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;goto __pyx_L9_exception_handled;}__pyx_L10_except_error:;<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_12);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_13);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_14);<span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_12, __pyx_t_13, __pyx_t_14);goto __pyx_L1_error;__pyx_L9_exception_handled:;<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_12);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_13);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_14);<span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_12, __pyx_t_13, __pyx_t_14);__pyx_L13_try_end:;}}/*finally:*/ {/*normal exit:*/{if (__pyx_t_11) {__pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_tuple__20, NULL);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1279, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;}goto __pyx_L7;}__pyx_L7:;}goto __pyx_L25;__pyx_L4_error:;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;goto __pyx_L1_error;__pyx_L25:;}</pre><pre class="cython line score-0">&#xA0;<span class="">1280</span>:         <span class="c"># change threads to appropriate number of workers for your system</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1281</span>:         <span class="n">futures</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>__pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1281, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_v_futures = ((PyObject*)__pyx_t_8);__pyx_t_8 = 0;</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1282</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">threads</span><span class="o">-</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-51 '>__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_threads, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1282, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1282, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {__pyx_t_8 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_10 = 0;__pyx_t_15 = NULL;} else {__pyx_t_10 = -1; __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1282, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1282, __pyx_L8_error)</span>}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;for (;;) {if (likely(!__pyx_t_15)) {if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8))) {if (__pyx_t_10 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_8)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_8, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_10++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1282, __pyx_L8_error)</span>#else__pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1282, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);#endif} else {if (__pyx_t_10 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_8)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_8, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_10++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1282, __pyx_L8_error)</span>#else__pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1282, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);#endif}} else {__pyx_t_1 = __pyx_t_15(__pyx_t_8);if (unlikely(!__pyx_t_1)) {PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();if (exc_type) {if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();else <span class='error_goto'>__PYX_ERR(0, 1282, __pyx_L8_error)</span>}break;}<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);__pyx_t_1 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1283</span>:             <span class="n">strt</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">chunksize</span></pre>
<pre class='cython code score-6 '>__pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_v_chunksize);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1283, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_strt, __pyx_t_1);__pyx_t_1 = 0;</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1284</span>:             <span class="n">stp</span> <span class="o">=</span> <span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">chunksize</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="p">(</span><span class="n">threads</span> <span class="o">-</span> <span class="mf">2</span><span class="p">)</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_threads, __pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1284, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_i, __pyx_t_9, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1284, __pyx_L8_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1284, __pyx_L8_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (__pyx_t_7) {__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1284, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_v_chunksize);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1284, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_1 = __pyx_t_9;__pyx_t_9 = 0;} else {__pyx_t_16 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_x);<span class='error_goto'> if (unlikely(__pyx_t_16 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1284, __pyx_L8_error)</span>__pyx_t_9 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_16);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1284, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_1 = __pyx_t_9;__pyx_t_9 = 0;}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_stp, __pyx_t_1);__pyx_t_1 = 0;</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1285</span>:             <span class="k">print</span><span class="p">(</span><span class="n">strt</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="s">&#39; &#39;</span><span class="p">)</span></pre>
<pre class='cython code score-19 '>__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1285, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_strt);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_strt);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_strt);__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1285, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_end, __pyx_kp_u__19) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1285, __pyx_L8_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_t_1, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1285, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1286</span>:             <span class="k">print</span><span class="p">(</span><span class="n">stp</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_v_stp);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1286, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1287</span>:             <span class="n">futures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">do_calc</span><span class="p">,</span> <span class="n">strt</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">-</span><span class="n">dupes</span><span class="p">)</span> <span class="o">*</span> <span class="mf">3</span> <span class="o">*</span> <span class="mf">2</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">strt</span><span class="p">:</span><span class="n">stp</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="n">dupes</span><span class="p">))</span></pre>
<pre class='cython code score-49 '>__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_executor, __pyx_n_s_submit);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1287, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_do_calc);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1287, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1287, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_17 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1287, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_17, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1287, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;__pyx_t_17 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_strt, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1287, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_MultiplyObjC</span>(__pyx_t_17, __pyx_int_3, 3, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1287, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;__pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyInt_MultiplyObjC</span>(__pyx_t_3, __pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1287, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_x, 0, 0, &amp;__pyx_v_strt, &amp;__pyx_v_stp, NULL, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1287, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_18 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {__pyx_t_18 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);if (likely(__pyx_t_18)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_18);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[6] = {__pyx_t_18, __pyx_t_1, __pyx_t_17, __pyx_t_3, __pyx_v_y, __pyx_v_dupes};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_4, 5+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18); __pyx_t_18 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1287, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;}__pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_futures, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_19 == ((int)-1))) __PYX_ERR(0, 1287, __pyx_L8_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1288</span>:         <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">futures</span><span class="p">)</span></pre>
<pre class='cython code score-23 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_concurrent);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1288, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_futures);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1288, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_wait);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1288, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_9 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_9)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_v_futures};__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1288, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1289</span>: </pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1290</span>:         <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">result</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">futures</span><span class="p">]</span></pre>
<pre class='cython code score-33 '>{ /* enter inner scope */__pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1290, __pyx_L18_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_2 = __pyx_v_futures; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_10 = 0;for (;;) {if (__pyx_t_10 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_10++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1290, __pyx_L18_error)</span>#else__pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1290, __pyx_L18_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);#endif<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr4__pyx_v_f, __pyx_t_9);__pyx_t_9 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_8genexpr4__pyx_v_f, __pyx_n_s_result);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1290, __pyx_L18_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_17 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_17 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_17)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_17, };__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17); __pyx_t_17 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1290, __pyx_L18_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_8, (PyObject*)__pyx_t_9))) <span class='error_goto'>__PYX_ERR(0, 1290, __pyx_L18_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr4__pyx_v_f); __pyx_8genexpr4__pyx_v_f = 0;goto __pyx_L21_exit_scope;__pyx_L18_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr4__pyx_v_f); __pyx_8genexpr4__pyx_v_f = 0;goto __pyx_L8_error;__pyx_L21_exit_scope:;} /* exit inner scope */__pyx_v_output = ((PyObject*)__pyx_t_8);__pyx_t_8 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1291</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1292</span>:     <span class="k">return</span> <span class="n">dupes</span></pre>
<pre class='cython code score-2 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dupes);__pyx_r = __pyx_v_dupes;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">1293</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1294</span>: </pre>
</div></body></html>
