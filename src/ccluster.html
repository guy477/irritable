<!DOCTYPE html>
<!-- Generated by Cython 3.0.0a11 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: ccluster.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { color: #000000; margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 3.0.0a11</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="ccluster.cpp">ccluster.cpp</a></p>
<div class="cython"><pre class="cython line score-0">&#xA0;<span class="">0001</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0002</span>: #!/usr/bin/env python3</pre>
<pre class='cython code score-8 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0003</span>: #cython: language_level=3</pre>
<pre class="cython line score-0">&#xA0;<span class="">0004</span>: # -*- coding: utf-8 -*-</pre>
<pre class="cython line score-0">&#xA0;<span class="">0005</span>: # distutils: language = c++</pre>
<pre class="cython line score-0">&#xA0;<span class="">0006</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0007</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0008</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0009</span>: import time</pre>
<pre class='cython code score-8 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_time, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 9, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_time, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 9, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0010</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0011</span>: import random</pre>
<pre class='cython code score-8 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_random, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_random, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 11, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0012</span>: import concurrent.futures</pre>
<pre class='cython code score-13 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_concurrent_futures, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 12, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_concurrent, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 12, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_tuple__34 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_concurrent, __pyx_n_s_futures);<span class='error_goto'> if (unlikely(!__pyx_tuple__34)) __PYX_ERR(0, 12, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__34);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__34);</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0013</span>: import concurrent.futures</pre>
<pre class='cython code score-8 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_concurrent_futures, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 13, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_concurrent, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0014</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0015</span>: import numpy</pre>
<pre class='cython code score-8 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_numpy, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_numpy, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0016</span>: cimport numpy</pre>
<pre class="cython line score-0">&#xA0;<span class="">0017</span>: cimport cython</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0018</span>: numpy.import_array()</pre>
<pre class='cython code score-0 '>__pyx_t_3 = __pyx_f_5numpy_import_array();<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 18, __pyx_L1_error)</span></pre><pre class="cython line score-0">&#xA0;<span class="">0019</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0020</span>: from cython.parallel cimport prange</pre>
<pre class="cython line score-0">&#xA0;<span class="">0021</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0022</span>: from libcpp.map cimport map as mapp</pre>
<pre class="cython line score-0">&#xA0;<span class="">0023</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0024</span>: from libc.stdlib cimport calloc, free</pre>
<pre class="cython line score-0">&#xA0;<span class="">0025</span>: from libc.stdio cimport FILE, fopen, fwrite, fscanf, fclose, fprintf</pre>
<pre class="cython line score-0">&#xA0;<span class="">0026</span>: # cython: profile=True</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0027</span>: from sklearn.metrics.pairwise import euclidean_distances</pre>
<pre class='cython code score-19 '>__pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 27, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_euclidean_distances);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_euclidean_distances);<span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_euclidean_distances);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sklearn_metrics_pairwise, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 27, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_4, __pyx_n_s_euclidean_distances);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 27, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_euclidean_distances, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 27, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0028</span>: from scipy.spatial.distance import pdist, squareform</pre>
<pre class='cython code score-29 '>__pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 28, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_pdist);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_pdist);<span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_n_s_pdist);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_squareform);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_squareform);<span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_n_s_squareform);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_spatial_distance, __pyx_t_4, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 28, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_pdist);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 28, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_pdist, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 28, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_squareform);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 28, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_squareform, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 28, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0029</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0030</span>: from sklearn.utils import check_array</pre>
<pre class='cython code score-19 '>__pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 30, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_check_array);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_check_array);<span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_check_array);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sklearn_utils, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 30, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_4, __pyx_n_s_check_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 30, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_check_array, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0031</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0032</span>: """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0033</span>: Wraper for C EMD implementation</pre>
<pre class="cython line score-0">&#xA0;<span class="">0034</span>: """</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0035</span>: from scipy.spatial.distance import cdist</pre>
<pre class='cython code score-19 '>__pyx_t_4 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 35, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_cdist);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_cdist);<span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_n_s_cdist);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_spatial_distance, __pyx_t_4, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 35, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_cdist);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 35, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_cdist, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0036</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0037</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0038</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0039</span>: ctypedef numpy.uint8_t uint8</pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_uint8_t __pyx_t_8ccluster_uint8;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0040</span>: ctypedef numpy.uint16_t uint16</pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_uint16_t __pyx_t_8ccluster_uint16;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0041</span>: ctypedef numpy.int16_t int16</pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_int16_t __pyx_t_8ccluster_int16;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0042</span>: ctypedef numpy.int32_t int32</pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_int32_t __pyx_t_8ccluster_int32;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0043</span>: ctypedef numpy.float32_t float32</pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_float32_t __pyx_t_8ccluster_float32;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0044</span>: ctypedef numpy.float64_t float64</pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_float64_t __pyx_t_8ccluster_float64;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0045</span>: ctypedef numpy.int64_t int64</pre>
<pre class='cython code score-0 '>typedef __pyx_t_5numpy_int64_t __pyx_t_8ccluster_int64;</pre><pre class="cython line score-0">&#xA0;<span class="">0046</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0047</span>: ctypedef numpy.npy_bool boolean</pre>
<pre class="cython line score-0">&#xA0;<span class="">0048</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0049</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0050</span>: #################################################################################################</pre>
<pre class="cython line score-0">&#xA0;<span class="">0051</span>: # The below code is taken from eval7 - https://pypi.org/project/eval7/</pre>
<pre class="cython line score-0">&#xA0;<span class="">0052</span>: #################################################################################################</pre>
<pre class="cython line score-0">&#xA0;<span class="">0053</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0054</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0055</span>: cdef extern from "arrays.h":</pre>
<pre class="cython line score-0">&#xA0;<span class="">0056</span>:     unsigned short N_BITS_TABLE[8192]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0057</span>:     unsigned short STRAIGHT_TABLE[8192]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0058</span>:     unsigned int TOP_FIVE_CARDS_TABLE[8192]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0059</span>:     unsigned short TOP_CARD_TABLE[8192]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0060</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0061</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0062</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0063</span>: cdef int CLUB_OFFSET = 0</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_CLUB_OFFSET = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0064</span>: cdef int DIAMOND_OFFSET = 13</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_DIAMOND_OFFSET = 13;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0065</span>: cdef int HEART_OFFSET = 26</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HEART_OFFSET = 26;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0066</span>: cdef int SPADE_OFFSET = 39</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_SPADE_OFFSET = 39;</pre><pre class="cython line score-0">&#xA0;<span class="">0067</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0068</span>: cdef int HANDTYPE_SHIFT = 24</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_SHIFT = 24;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0069</span>: cdef int TOP_CARD_SHIFT = 16</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_TOP_CARD_SHIFT = 16;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0070</span>: cdef int SECOND_CARD_SHIFT = 12</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_SECOND_CARD_SHIFT = 12;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0071</span>: cdef int THIRD_CARD_SHIFT = 8</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_THIRD_CARD_SHIFT = 8;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0072</span>: cdef int CARD_WIDTH = 4</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_CARD_WIDTH = 4;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0073</span>: cdef unsigned int TOP_CARD_MASK = 0x000F0000</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_TOP_CARD_MASK = 0x000F0000;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0074</span>: cdef unsigned int SECOND_CARD_MASK = 0x0000F000</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_SECOND_CARD_MASK = 0x0000F000;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0075</span>: cdef unsigned int FIFTH_CARD_MASK = 0x0000000F</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_FIFTH_CARD_MASK = 0x0000000F;</pre><pre class="cython line score-0">&#xA0;<span class="">0076</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0077</span>: cdef unsigned int HANDTYPE_VALUE_STRAIGHTFLUSH = ((&lt;unsigned int&gt;8) &lt;&lt; HANDTYPE_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_VALUE_STRAIGHTFLUSH = (((unsigned int)8) &lt;&lt; __pyx_v_8ccluster_HANDTYPE_SHIFT);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0078</span>: cdef unsigned int HANDTYPE_VALUE_FOUR_OF_A_KIND = ((&lt;unsigned int&gt;7) &lt;&lt; HANDTYPE_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_VALUE_FOUR_OF_A_KIND = (((unsigned int)7) &lt;&lt; __pyx_v_8ccluster_HANDTYPE_SHIFT);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0079</span>: cdef unsigned int HANDTYPE_VALUE_FULLHOUSE = ((&lt;unsigned int&gt;6) &lt;&lt; HANDTYPE_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_VALUE_FULLHOUSE = (((unsigned int)6) &lt;&lt; __pyx_v_8ccluster_HANDTYPE_SHIFT);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0080</span>: cdef unsigned int HANDTYPE_VALUE_FLUSH = ((&lt;unsigned int&gt;5) &lt;&lt; HANDTYPE_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_VALUE_FLUSH = (((unsigned int)5) &lt;&lt; __pyx_v_8ccluster_HANDTYPE_SHIFT);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0081</span>: cdef unsigned int HANDTYPE_VALUE_STRAIGHT = ((&lt;unsigned int&gt;4) &lt;&lt; HANDTYPE_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_VALUE_STRAIGHT = (((unsigned int)4) &lt;&lt; __pyx_v_8ccluster_HANDTYPE_SHIFT);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0082</span>: cdef unsigned int HANDTYPE_VALUE_TRIPS = ((&lt;unsigned int&gt;3) &lt;&lt; HANDTYPE_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_VALUE_TRIPS = (((unsigned int)3) &lt;&lt; __pyx_v_8ccluster_HANDTYPE_SHIFT);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0083</span>: cdef unsigned int HANDTYPE_VALUE_TWOPAIR = ((&lt;unsigned int&gt;2) &lt;&lt; HANDTYPE_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_VALUE_TWOPAIR = (((unsigned int)2) &lt;&lt; __pyx_v_8ccluster_HANDTYPE_SHIFT);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0084</span>: cdef unsigned int HANDTYPE_VALUE_PAIR = ((&lt;unsigned int&gt;1) &lt;&lt; HANDTYPE_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_VALUE_PAIR = (((unsigned int)1) &lt;&lt; __pyx_v_8ccluster_HANDTYPE_SHIFT);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0085</span>: cdef unsigned int HANDTYPE_VALUE_HIGHCARD = ((&lt;unsigned int&gt;0) &lt;&lt; HANDTYPE_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_v_8ccluster_HANDTYPE_VALUE_HIGHCARD = (((unsigned int)0) &lt;&lt; __pyx_v_8ccluster_HANDTYPE_SHIFT);</pre><pre class="cython line score-0">&#xA0;<span class="">0086</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0087</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0088</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0089</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0090</span>: cdef unsigned int cy_evaluate(unsigned long long cards, unsigned int num_cards) nogil:</pre>
<pre class='cython code score-0 '>static unsigned int __pyx_f_8ccluster_cy_evaluate(unsigned PY_LONG_LONG __pyx_v_cards, unsigned int __pyx_v_num_cards) {unsigned int __pyx_v_retval;unsigned int __pyx_v_four_mask;unsigned int __pyx_v_three_mask;unsigned int __pyx_v_two_mask;unsigned int __pyx_v_sc;unsigned int __pyx_v_sd;unsigned int __pyx_v_sh;unsigned int __pyx_v_ss;unsigned int __pyx_v_ranks;unsigned int __pyx_v_n_ranks;unsigned int __pyx_v_n_dups;unsigned int __pyx_v_st;unsigned int __pyx_v_t;unsigned int __pyx_v_kickers;unsigned int __pyx_v_second;unsigned int __pyx_v_tc;unsigned int __pyx_v_top;unsigned int __pyx_r;/* function exit code */__pyx_L0:;return __pyx_r;}</pre><pre class="cython line score-0">&#xA0;<span class="">0091</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0092</span>:     7-card evaluation function based on Keith Rule's port of PokerEval.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0093</span>:     Pure Python: 20000 calls in 0.176 seconds (113636 calls/sec)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0094</span>:     Cython: 20000 calls in 0.044 seconds (454545 calls/sec)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0095</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0096</span>:     cdef unsigned int retval = 0, four_mask, three_mask, two_mask</pre>
<pre class='cython code score-0 '>__pyx_v_retval = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0097</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0098</span>:     cdef unsigned int sc = &lt;unsigned int&gt;((cards &gt;&gt; (CLUB_OFFSET)) &amp; 0x1fffUL)</pre>
<pre class='cython code score-0 '>__pyx_v_sc = ((unsigned int)((__pyx_v_cards &gt;&gt; __pyx_v_8ccluster_CLUB_OFFSET) &amp; 0x1fffUL));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0099</span>:     cdef unsigned int sd = &lt;unsigned int&gt;((cards &gt;&gt; (DIAMOND_OFFSET)) &amp; 0x1fffUL)</pre>
<pre class='cython code score-0 '>__pyx_v_sd = ((unsigned int)((__pyx_v_cards &gt;&gt; __pyx_v_8ccluster_DIAMOND_OFFSET) &amp; 0x1fffUL));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0100</span>:     cdef unsigned int sh = &lt;unsigned int&gt;((cards &gt;&gt; (HEART_OFFSET)) &amp; 0x1fffUL)</pre>
<pre class='cython code score-0 '>__pyx_v_sh = ((unsigned int)((__pyx_v_cards &gt;&gt; __pyx_v_8ccluster_HEART_OFFSET) &amp; 0x1fffUL));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0101</span>:     cdef unsigned int ss = &lt;unsigned int&gt;((cards &gt;&gt; (SPADE_OFFSET)) &amp; 0x1fffUL)</pre>
<pre class='cython code score-0 '>__pyx_v_ss = ((unsigned int)((__pyx_v_cards &gt;&gt; __pyx_v_8ccluster_SPADE_OFFSET) &amp; 0x1fffUL));</pre><pre class="cython line score-0">&#xA0;<span class="">0102</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0103</span>:     cdef unsigned int ranks = sc | sd | sh | ss</pre>
<pre class='cython code score-0 '>__pyx_v_ranks = (((__pyx_v_sc | __pyx_v_sd) | __pyx_v_sh) | __pyx_v_ss);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0104</span>:     cdef unsigned int n_ranks = N_BITS_TABLE[ranks]</pre>
<pre class='cython code score-0 '>__pyx_v_n_ranks = (N_BITS_TABLE[__pyx_v_ranks]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0105</span>:     cdef unsigned int n_dups = &lt;unsigned int&gt;(num_cards - n_ranks)</pre>
<pre class='cython code score-0 '>__pyx_v_n_dups = ((unsigned int)(__pyx_v_num_cards - __pyx_v_n_ranks));</pre><pre class="cython line score-0">&#xA0;<span class="">0106</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0107</span>:     cdef unsigned int st, t, kickers, second, tc, top</pre>
<pre class="cython line score-0">&#xA0;<span class="">0108</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0109</span>:     if n_ranks &gt;= 5:</pre>
<pre class='cython code score-0 '>__pyx_t_1 = (__pyx_v_n_ranks &gt;= 5);if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0110</span>:         if N_BITS_TABLE[ss] &gt;= 5:</pre>
<pre class='cython code score-0 '>__pyx_t_1 = ((N_BITS_TABLE[__pyx_v_ss]) &gt;= 5);if (__pyx_t_1) {goto __pyx_L4;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0111</span>:             if STRAIGHT_TABLE[ss] != 0:</pre>
<pre class='cython code score-0 '>__pyx_t_1 = ((STRAIGHT_TABLE[__pyx_v_ss]) != 0);if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0112</span>:                 return HANDTYPE_VALUE_STRAIGHTFLUSH + &lt;unsigned int&gt;(STRAIGHT_TABLE[ss] &lt;&lt; TOP_CARD_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_r = (__pyx_v_8ccluster_HANDTYPE_VALUE_STRAIGHTFLUSH + ((unsigned int)((STRAIGHT_TABLE[__pyx_v_ss]) &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT)));goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0113</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0114</span>:                 retval = HANDTYPE_VALUE_FLUSH + TOP_FIVE_CARDS_TABLE[ss]</pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_v_retval = (__pyx_v_8ccluster_HANDTYPE_VALUE_FLUSH + (TOP_FIVE_CARDS_TABLE[__pyx_v_ss]));}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0115</span>:         elif N_BITS_TABLE[sc] &gt;= 5:</pre>
<pre class='cython code score-0 '>__pyx_t_1 = ((N_BITS_TABLE[__pyx_v_sc]) &gt;= 5);if (__pyx_t_1) {goto __pyx_L4;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0116</span>:             if STRAIGHT_TABLE[sc] != 0:</pre>
<pre class='cython code score-0 '>__pyx_t_1 = ((STRAIGHT_TABLE[__pyx_v_sc]) != 0);if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0117</span>:                 return HANDTYPE_VALUE_STRAIGHTFLUSH + &lt;unsigned int&gt;(STRAIGHT_TABLE[sc] &lt;&lt; TOP_CARD_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_r = (__pyx_v_8ccluster_HANDTYPE_VALUE_STRAIGHTFLUSH + ((unsigned int)((STRAIGHT_TABLE[__pyx_v_sc]) &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT)));goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0118</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0119</span>:                 retval = HANDTYPE_VALUE_FLUSH + TOP_FIVE_CARDS_TABLE[sc]</pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_v_retval = (__pyx_v_8ccluster_HANDTYPE_VALUE_FLUSH + (TOP_FIVE_CARDS_TABLE[__pyx_v_sc]));}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0120</span>:         elif N_BITS_TABLE[sd] &gt;= 5:</pre>
<pre class='cython code score-0 '>__pyx_t_1 = ((N_BITS_TABLE[__pyx_v_sd]) &gt;= 5);if (__pyx_t_1) {goto __pyx_L4;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0121</span>:             if STRAIGHT_TABLE[sd] != 0:</pre>
<pre class='cython code score-0 '>__pyx_t_1 = ((STRAIGHT_TABLE[__pyx_v_sd]) != 0);if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0122</span>:                 return HANDTYPE_VALUE_STRAIGHTFLUSH + &lt;unsigned int&gt;(STRAIGHT_TABLE[sd] &lt;&lt; TOP_CARD_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_r = (__pyx_v_8ccluster_HANDTYPE_VALUE_STRAIGHTFLUSH + ((unsigned int)((STRAIGHT_TABLE[__pyx_v_sd]) &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT)));goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0123</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0124</span>:                 retval = HANDTYPE_VALUE_FLUSH + TOP_FIVE_CARDS_TABLE[sd]</pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_v_retval = (__pyx_v_8ccluster_HANDTYPE_VALUE_FLUSH + (TOP_FIVE_CARDS_TABLE[__pyx_v_sd]));}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0125</span>:         elif N_BITS_TABLE[sh] &gt;= 5:</pre>
<pre class='cython code score-0 '>__pyx_t_1 = ((N_BITS_TABLE[__pyx_v_sh]) &gt;= 5);if (__pyx_t_1) {goto __pyx_L4;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0126</span>:             if STRAIGHT_TABLE[sh] != 0:</pre>
<pre class='cython code score-0 '>__pyx_t_1 = ((STRAIGHT_TABLE[__pyx_v_sh]) != 0);if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0127</span>:                 return HANDTYPE_VALUE_STRAIGHTFLUSH + &lt;unsigned int&gt;(STRAIGHT_TABLE[sh] &lt;&lt; TOP_CARD_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_r = (__pyx_v_8ccluster_HANDTYPE_VALUE_STRAIGHTFLUSH + ((unsigned int)((STRAIGHT_TABLE[__pyx_v_sh]) &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT)));goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0128</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0129</span>:                 retval = HANDTYPE_VALUE_FLUSH + TOP_FIVE_CARDS_TABLE[sh]</pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_v_retval = (__pyx_v_8ccluster_HANDTYPE_VALUE_FLUSH + (TOP_FIVE_CARDS_TABLE[__pyx_v_sh]));}</pre><pre class="cython line score-0">&#xA0;<span class="">0130</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0131</span>:             st = STRAIGHT_TABLE[ranks]</pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_v_st = (STRAIGHT_TABLE[__pyx_v_ranks]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0132</span>:             if st != 0:</pre>
<pre class='cython code score-0 '>__pyx_t_1 = (__pyx_v_st != 0);if (__pyx_t_1) {}}__pyx_L4:;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0133</span>:                 retval = HANDTYPE_VALUE_STRAIGHT + (st &lt;&lt; TOP_CARD_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_v_retval = (__pyx_v_8ccluster_HANDTYPE_VALUE_STRAIGHT + (__pyx_v_st &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT));</pre><pre class="cython line score-0">&#xA0;<span class="">0134</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0135</span>:         if retval != 0 and n_dups &lt; 3:</pre>
<pre class='cython code score-0 '>__pyx_t_2 = (__pyx_v_retval != 0);if (__pyx_t_2) {} else {__pyx_t_1 = __pyx_t_2;goto __pyx_L11_bool_binop_done;}__pyx_t_2 = (__pyx_v_n_dups &lt; 3);__pyx_t_1 = __pyx_t_2;__pyx_L11_bool_binop_done:;if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0136</span>:             return retval</pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_v_retval;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0137</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0138</span>:     if n_dups == 0:</pre>
<pre class='cython code score-0 '>switch (__pyx_v_n_dups) {case 0:break;case 1:</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0139</span>:         return HANDTYPE_VALUE_HIGHCARD + TOP_FIVE_CARDS_TABLE[ranks]</pre>
<pre class='cython code score-0 '>__pyx_r = (__pyx_v_8ccluster_HANDTYPE_VALUE_HIGHCARD + (TOP_FIVE_CARDS_TABLE[__pyx_v_ranks]));goto __pyx_L0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0140</span>:     elif n_dups == 1:</pre>
<pre class='cython code score-0 '>break;case 2:</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0141</span>:         two_mask = ranks ^ (sc ^ sd ^ sh ^ ss)</pre>
<pre class='cython code score-0 '>__pyx_v_two_mask = (__pyx_v_ranks ^ (((__pyx_v_sc ^ __pyx_v_sd) ^ __pyx_v_sh) ^ __pyx_v_ss));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0142</span>:         retval = &lt;unsigned int&gt;(HANDTYPE_VALUE_PAIR + (TOP_CARD_TABLE[two_mask] &lt;&lt; TOP_CARD_SHIFT))</pre>
<pre class='cython code score-0 '>__pyx_v_retval = ((unsigned int)(__pyx_v_8ccluster_HANDTYPE_VALUE_PAIR + ((TOP_CARD_TABLE[__pyx_v_two_mask]) &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT)));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0143</span>:         t = ranks ^ two_mask</pre>
<pre class='cython code score-0 '>__pyx_v_t = (__pyx_v_ranks ^ __pyx_v_two_mask);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0144</span>:         kickers = (TOP_FIVE_CARDS_TABLE[t] &gt;&gt; CARD_WIDTH) &amp; ~FIFTH_CARD_MASK</pre>
<pre class='cython code score-0 '>__pyx_v_kickers = (((TOP_FIVE_CARDS_TABLE[__pyx_v_t]) &gt;&gt; __pyx_v_8ccluster_CARD_WIDTH) &amp; (~__pyx_v_8ccluster_FIFTH_CARD_MASK));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0145</span>:         retval += kickers</pre>
<pre class='cython code score-0 '>__pyx_v_retval = (__pyx_v_retval + __pyx_v_kickers);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0146</span>:         return retval</pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_v_retval;goto __pyx_L0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0147</span>:     elif n_dups == 2:</pre>
<pre class='cython code score-0 '>break;default:</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0148</span>:         two_mask = ranks ^ (sc ^ sd ^ sh ^ ss)</pre>
<pre class='cython code score-0 '>__pyx_v_two_mask = (__pyx_v_ranks ^ (((__pyx_v_sc ^ __pyx_v_sd) ^ __pyx_v_sh) ^ __pyx_v_ss));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0149</span>:         if two_mask != 0:</pre>
<pre class='cython code score-0 '>__pyx_t_1 = (__pyx_v_two_mask != 0);if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0150</span>:             t = ranks ^ two_mask</pre>
<pre class='cython code score-0 '>__pyx_v_t = (__pyx_v_ranks ^ __pyx_v_two_mask);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0151</span>:             retval = &lt;unsigned int&gt;(HANDTYPE_VALUE_TWOPAIR</pre>
<pre class='cython code score-0 '>__pyx_v_retval = ((unsigned int)((__pyx_v_8ccluster_HANDTYPE_VALUE_TWOPAIR + ((TOP_FIVE_CARDS_TABLE[__pyx_v_two_mask]) &amp; (__pyx_v_8ccluster_TOP_CARD_MASK | __pyx_v_8ccluster_SECOND_CARD_MASK))) + ((TOP_CARD_TABLE[__pyx_v_t]) &lt;&lt; __pyx_v_8ccluster_THIRD_CARD_SHIFT)));</pre><pre class="cython line score-0">&#xA0;<span class="">0152</span>:                 + (TOP_FIVE_CARDS_TABLE[two_mask]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0153</span>:                 &amp; (TOP_CARD_MASK | SECOND_CARD_MASK))</pre>
<pre class="cython line score-0">&#xA0;<span class="">0154</span>:                 + (TOP_CARD_TABLE[t] &lt;&lt; THIRD_CARD_SHIFT))</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0155</span>:             return retval</pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_v_retval;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0156</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0157</span>:             three_mask = ((sc &amp; sd) | (sh &amp; ss)) &amp; ((sc &amp; sh) | (sd &amp; ss))</pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_v_three_mask = (((__pyx_v_sc &amp; __pyx_v_sd) | (__pyx_v_sh &amp; __pyx_v_ss)) &amp; ((__pyx_v_sc &amp; __pyx_v_sh) | (__pyx_v_sd &amp; __pyx_v_ss)));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0158</span>:             retval = &lt;unsigned int&gt;(HANDTYPE_VALUE_TRIPS + (TOP_CARD_TABLE[three_mask] &lt;&lt; TOP_CARD_SHIFT))</pre>
<pre class='cython code score-0 '>__pyx_v_retval = ((unsigned int)(__pyx_v_8ccluster_HANDTYPE_VALUE_TRIPS + ((TOP_CARD_TABLE[__pyx_v_three_mask]) &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT)));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0159</span>:             t = ranks ^ three_mask</pre>
<pre class='cython code score-0 '>__pyx_v_t = (__pyx_v_ranks ^ __pyx_v_three_mask);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0160</span>:             second = TOP_CARD_TABLE[t]</pre>
<pre class='cython code score-0 '>__pyx_v_second = (TOP_CARD_TABLE[__pyx_v_t]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0161</span>:             retval += (second &lt;&lt; SECOND_CARD_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_v_retval = (__pyx_v_retval + (__pyx_v_second &lt;&lt; __pyx_v_8ccluster_SECOND_CARD_SHIFT));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0162</span>:             t ^= (1U &lt;&lt; &lt;int&gt;second)</pre>
<pre class='cython code score-0 '>__pyx_v_t = (__pyx_v_t ^ (1U &lt;&lt; ((int)__pyx_v_second)));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0163</span>:             retval += &lt;unsigned int&gt;(TOP_CARD_TABLE[t] &lt;&lt; THIRD_CARD_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_v_retval = (__pyx_v_retval + ((unsigned int)((TOP_CARD_TABLE[__pyx_v_t]) &lt;&lt; __pyx_v_8ccluster_THIRD_CARD_SHIFT)));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0164</span>:             return retval</pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_v_retval;goto __pyx_L0;}</pre><pre class="cython line score-0">&#xA0;<span class="">0165</span>:     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0166</span>:         four_mask = sh &amp; sd &amp; sc &amp; ss</pre>
<pre class='cython code score-0 '>__pyx_v_four_mask = (((__pyx_v_sh &amp; __pyx_v_sd) &amp; __pyx_v_sc) &amp; __pyx_v_ss);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0167</span>:         if four_mask != 0:</pre>
<pre class='cython code score-0 '>__pyx_t_1 = (__pyx_v_four_mask != 0);if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0168</span>:             tc = TOP_CARD_TABLE[four_mask]</pre>
<pre class='cython code score-0 '>__pyx_v_tc = (TOP_CARD_TABLE[__pyx_v_four_mask]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0169</span>:             retval = &lt;unsigned int&gt;(HANDTYPE_VALUE_FOUR_OF_A_KIND</pre>
<pre class='cython code score-0 '>__pyx_v_retval = ((unsigned int)((__pyx_v_8ccluster_HANDTYPE_VALUE_FOUR_OF_A_KIND + (__pyx_v_tc &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT)) + ((TOP_CARD_TABLE[(__pyx_v_ranks ^ (1U &lt;&lt; ((int)__pyx_v_tc)))]) &lt;&lt; __pyx_v_8ccluster_SECOND_CARD_SHIFT)));</pre><pre class="cython line score-0">&#xA0;<span class="">0170</span>:                 + (tc &lt;&lt; TOP_CARD_SHIFT)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0171</span>:                 + ((TOP_CARD_TABLE[ranks ^ (1U &lt;&lt; &lt;int&gt;tc)]) &lt;&lt; SECOND_CARD_SHIFT))</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0172</span>:             return retval</pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_v_retval;goto __pyx_L0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0173</span>:         two_mask = ranks ^ (sc ^ sd ^ sh ^ ss)</pre>
<pre class='cython code score-0 '>__pyx_v_two_mask = (__pyx_v_ranks ^ (((__pyx_v_sc ^ __pyx_v_sd) ^ __pyx_v_sh) ^ __pyx_v_ss));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0174</span>:         if N_BITS_TABLE[two_mask] != n_dups:</pre>
<pre class='cython code score-0 '>__pyx_t_1 = ((N_BITS_TABLE[__pyx_v_two_mask]) != __pyx_v_n_dups);if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0175</span>:             three_mask = ((sc &amp; sd) | (sh &amp; ss)) &amp; ((sc &amp; sh) | (sd &amp; ss))</pre>
<pre class='cython code score-0 '>__pyx_v_three_mask = (((__pyx_v_sc &amp; __pyx_v_sd) | (__pyx_v_sh &amp; __pyx_v_ss)) &amp; ((__pyx_v_sc &amp; __pyx_v_sh) | (__pyx_v_sd &amp; __pyx_v_ss)));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0176</span>:             retval = HANDTYPE_VALUE_FULLHOUSE</pre>
<pre class='cython code score-0 '>__pyx_v_retval = __pyx_v_8ccluster_HANDTYPE_VALUE_FULLHOUSE;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0177</span>:             tc = TOP_CARD_TABLE[three_mask]</pre>
<pre class='cython code score-0 '>__pyx_v_tc = (TOP_CARD_TABLE[__pyx_v_three_mask]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0178</span>:             retval += (tc &lt;&lt; TOP_CARD_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_v_retval = (__pyx_v_retval + (__pyx_v_tc &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0179</span>:             t = (two_mask | three_mask) ^ (1U &lt;&lt; &lt;int&gt;tc)</pre>
<pre class='cython code score-0 '>__pyx_v_t = ((__pyx_v_two_mask | __pyx_v_three_mask) ^ (1U &lt;&lt; ((int)__pyx_v_tc)));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0180</span>:             retval += &lt;unsigned int&gt;(TOP_CARD_TABLE[t] &lt;&lt; SECOND_CARD_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_v_retval = (__pyx_v_retval + ((unsigned int)((TOP_CARD_TABLE[__pyx_v_t]) &lt;&lt; __pyx_v_8ccluster_SECOND_CARD_SHIFT)));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0181</span>:             return retval</pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_v_retval;goto __pyx_L0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0182</span>:         if retval != 0:</pre>
<pre class='cython code score-0 '>__pyx_t_1 = (__pyx_v_retval != 0);if (__pyx_t_1) {}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0183</span>:             return retval</pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_v_retval;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0184</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0185</span>:             retval = HANDTYPE_VALUE_TWOPAIR</pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_v_retval = __pyx_v_8ccluster_HANDTYPE_VALUE_TWOPAIR;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0186</span>:             top = TOP_CARD_TABLE[two_mask]</pre>
<pre class='cython code score-0 '>__pyx_v_top = (TOP_CARD_TABLE[__pyx_v_two_mask]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0187</span>:             retval += (top &lt;&lt; TOP_CARD_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_v_retval = (__pyx_v_retval + (__pyx_v_top &lt;&lt; __pyx_v_8ccluster_TOP_CARD_SHIFT));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0188</span>:             second = TOP_CARD_TABLE[two_mask ^ (1 &lt;&lt; &lt;int&gt;top)]</pre>
<pre class='cython code score-0 '>__pyx_v_second = (TOP_CARD_TABLE[(__pyx_v_two_mask ^ (1 &lt;&lt; ((int)__pyx_v_top)))]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0189</span>:             retval += (second &lt;&lt; SECOND_CARD_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_v_retval = (__pyx_v_retval + (__pyx_v_second &lt;&lt; __pyx_v_8ccluster_SECOND_CARD_SHIFT));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0190</span>:             retval += &lt;unsigned int&gt;((TOP_CARD_TABLE[ranks ^ (1U &lt;&lt; &lt;int&gt;top) ^ (1 &lt;&lt; &lt;int&gt;second)]) &lt;&lt; THIRD_CARD_SHIFT)</pre>
<pre class='cython code score-0 '>__pyx_v_retval = (__pyx_v_retval + ((unsigned int)((TOP_CARD_TABLE[((__pyx_v_ranks ^ (1U &lt;&lt; ((int)__pyx_v_top))) ^ (1 &lt;&lt; ((int)__pyx_v_second)))]) &lt;&lt; __pyx_v_8ccluster_THIRD_CARD_SHIFT)));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0191</span>:             return retval</pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_v_retval;goto __pyx_L0;}break;}</pre><pre class="cython line score-0">&#xA0;<span class="">0192</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0193</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0194</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0195</span>: #####################</pre>
<pre class="cython line score-0">&#xA0;<span class="">0196</span>: #####################</pre>
<pre class="cython line score-0">&#xA0;<span class="">0197</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0198</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0199</span>: ######################</pre>
<pre class="cython line score-0">&#xA0;<span class="">0200</span>: # https://github.com/obachem/kmc2/blob/master/kmc2.pyx</pre>
<pre class="cython line score-0">&#xA0;<span class="">0201</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0202</span>: ######################</pre>
<pre class="cython line score-123" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0203</span>: def kmc2(X, k, chain_length=200, afkmc2=True, random_state=None, weights=None):</pre>
<pre class='cython code score-123 '>/* Python wrapper */static PyObject *__pyx_pw_8ccluster_1kmc2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8ccluster_kmc2, "Cython implementation of k-MC2 and AFK-MC2 seeding\n    \n    Args:\n      X: (n,d)-shaped numpy.ndarray with data points (or scipy CSR matrix)\n      k: number of cluster centers\n      chain_length: length of the MCMC chain\n      afkmc2: Whether to run AFK-MC2 (if True) or vanilla K-MC2 (if False)\n      random_state: numpy.random.RandomState instance or integer to be used as seed\n      weights: n-sized numpy.ndarray with weights of data points (default: uniform weights)\n    Returns:\n      (k, d)-shaped numpy.ndarray with cluster centers\n    ");static PyMethodDef __pyx_mdef_8ccluster_1kmc2 = {"kmc2", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8ccluster_1kmc2, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8ccluster_kmc2};static PyObject *__pyx_pw_8ccluster_1kmc2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {PyObject *__pyx_v_X = 0;PyObject *__pyx_v_k = 0;PyObject *__pyx_v_chain_length = 0;PyObject *__pyx_v_afkmc2 = 0;PyObject *__pyx_v_random_state = 0;PyObject *__pyx_v_weights = 0;#if !CYTHON_METH_FASTCALLCYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);#endifCYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);PyObject *__pyx_r = 0;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("kmc2 (wrapper)", 0);{#if CYTHON_USE_MODULE_STATEPyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X,&amp;__pyx_n_s_k,&amp;__pyx_n_s_chain_length,&amp;__pyx_n_s_afkmc2,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_weights,0};#elsestatic PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X,&amp;__pyx_n_s_k,&amp;__pyx_n_s_chain_length,&amp;__pyx_n_s_afkmc2,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_weights,0};#endifPyObject* values[6] = {0,0,0,0,0,0};values[2] = ((PyObject *)((PyObject *)__pyx_int_200));values[3] = ((PyObject *)((PyObject *)Py_True));values[4] = ((PyObject *)((PyObject *)Py_None));values[5] = ((PyObject *)((PyObject *)Py_None));if (__pyx_kwds) {Py_ssize_t kw_args;switch (__pyx_nargs) {case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);CYTHON_FALLTHROUGH;case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);CYTHON_FALLTHROUGH;case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);CYTHON_FALLTHROUGH;case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);CYTHON_FALLTHROUGH;case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);CYTHON_FALLTHROUGH;case  0: break;default: goto __pyx_L5_argtuple_error;}kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);switch (__pyx_nargs) {case  0:if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_X)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L3_error)</span>else goto __pyx_L5_argtuple_error;CYTHON_FALLTHROUGH;case  1:if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_k)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("kmc2", 0, 2, 6, 1); <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  2:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_chain_length);if (value) { values[2] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  3:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_afkmc2);if (value) { values[3] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  4:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);if (value) { values[4] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  5:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_weights);if (value) { values[5] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L3_error)</span>}}if (unlikely(kw_args &gt; 0)) {const Py_ssize_t kwd_pos_args = __pyx_nargs;if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "kmc2") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L3_error)</span>}} else {switch (__pyx_nargs) {case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);CYTHON_FALLTHROUGH;case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);CYTHON_FALLTHROUGH;case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);CYTHON_FALLTHROUGH;case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);break;default: goto __pyx_L5_argtuple_error;}}__pyx_v_X = values[0];__pyx_v_k = values[1];__pyx_v_chain_length = values[2];__pyx_v_afkmc2 = values[3];__pyx_v_random_state = values[4];__pyx_v_weights = values[5];}goto __pyx_L4_argument_unpacking_done;__pyx_L5_argtuple_error:;<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("kmc2", 0, 2, 6, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L3_error)</span>__pyx_L3_error:;<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.kmc2", __pyx_clineno, __pyx_lineno, __pyx_filename);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return NULL;__pyx_L4_argument_unpacking_done:;__pyx_r = __pyx_pf_8ccluster_kmc2(__pyx_self, __pyx_v_X, __pyx_v_k, __pyx_v_chain_length, __pyx_v_afkmc2, __pyx_v_random_state, __pyx_v_weights);/* function exit code */<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}static PyObject *__pyx_pf_8ccluster_kmc2(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_k, PyObject *__pyx_v_chain_length, PyObject *__pyx_v_afkmc2, PyObject *__pyx_v_random_state, PyObject *__pyx_v_weights) {__pyx_t_5numpy_intp_t __pyx_v_j;__pyx_t_5numpy_intp_t __pyx_v_curr_ind;double __pyx_v_cand_prob;double __pyx_v_curr_prob;__Pyx_memviewslice __pyx_v_q_cand = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_p_cand = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_rand_a = { 0, 0, { 0 }, { 0 }, { 0 } };CYTHON_UNUSED int __pyx_v_N_CARDS;__Pyx_memviewslice __pyx_v_ALL_X = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_all_values = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_all_valuesa = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_all_valuesaa = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_deltaaa = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_ALL_X_VIEW = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_XX = { 0, 0, { 0 }, { 0 }, { 0 } };CYTHON_UNUSED int __pyx_v_sparse;PyObject *__pyx_v_cntrs = NULL;__Pyx_memviewslice __pyx_v_ctr = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_ct = { 0, 0, { 0 }, { 0 }, { 0 } };PyObject *__pyx_v_q = NULL;PyObject *__pyx_v_i = NULL;PyObject *__pyx_v_t1 = NULL;PyObject *__pyx_v_cand_ind = NULL;PyObject *__pyx_v_dist = NULL;PyObject *__pyx_v_t2 = NULL;PyObject *__pyx_v_t = NULL;PyObject *__pyx_7genexpr__pyx_v_xi = NULL;Py_ssize_t __pyx_8genexpr1__pyx_v_yi;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("kmc2", 0);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_random_state);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_weights);/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_17, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_24, 1);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.kmc2", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = NULL;__pyx_L0:;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_q_cand, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_p_cand, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rand_a, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_ALL_X, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_all_values, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_all_valuesa, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_all_valuesaa, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deltaaa, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_ALL_X_VIEW, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_XX, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cntrs);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_ctr, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_ct, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_q);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cand_ind);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dist);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_t);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_7genexpr__pyx_v_xi);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_random_state);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_weights);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}__pyx_tuple__35 = <span class='py_c_api'>PyTuple_Pack</span>(34, __pyx_n_s_X, __pyx_n_s_k, __pyx_n_s_chain_length, __pyx_n_s_afkmc2, __pyx_n_s_random_state, __pyx_n_s_weights, __pyx_n_s_j, __pyx_n_s_curr_ind, __pyx_n_s_cand_prob, __pyx_n_s_curr_prob, __pyx_n_s_q_cand, __pyx_n_s_p_cand, __pyx_n_s_rand_a, __pyx_n_s_N_CARDS, __pyx_n_s_ALL_X, __pyx_n_s_all_values_2, __pyx_n_s_all_valuesa_2, __pyx_n_s_all_valuesaa_2, __pyx_n_s_deltaaa, __pyx_n_s_ALL_X_VIEW, __pyx_n_s_XX, __pyx_n_s_sparse, __pyx_n_s_cntrs, __pyx_n_s_ctr, __pyx_n_s_ct, __pyx_n_s_q, __pyx_n_s_i, __pyx_n_s_t1, __pyx_n_s_cand_ind, __pyx_n_s_dist, __pyx_n_s_t2, __pyx_n_s_t, __pyx_n_s_xi, __pyx_n_s_yi);<span class='error_goto'> if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 203, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__35);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__35);__pyx_codeobj__36 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(6, 0, 0, 34, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__35, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ccluster_pyx, __pyx_n_s_kmc2, 203, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__36)) __PYX_ERR(0, 203, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8ccluster_1kmc2, 0, __pyx_n_s_kmc2, NULL, __pyx_n_s_ccluster, __pyx_d, ((PyObject *)__pyx_codeobj__36));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 203, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__37);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_kmc2, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_tuple__37 = <span class='py_c_api'>PyTuple_Pack</span>(4, ((PyObject *)__pyx_int_200), ((PyObject *)Py_True), ((PyObject *)Py_None), ((PyObject *)Py_None));<span class='error_goto'> if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 203, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__37);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__37);</pre><pre class="cython line score-0">&#xA0;<span class="">0204</span>:     """Cython implementation of k-MC2 and AFK-MC2 seeding</pre>
<pre class="cython line score-0">&#xA0;<span class="">0205</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0206</span>:     Args:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0207</span>:       X: (n,d)-shaped numpy.ndarray with data points (or scipy CSR matrix)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0208</span>:       k: number of cluster centers</pre>
<pre class="cython line score-0">&#xA0;<span class="">0209</span>:       chain_length: length of the MCMC chain</pre>
<pre class="cython line score-0">&#xA0;<span class="">0210</span>:       afkmc2: Whether to run AFK-MC2 (if True) or vanilla K-MC2 (if False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0211</span>:       random_state: numpy.random.RandomState instance or integer to be used as seed</pre>
<pre class="cython line score-0">&#xA0;<span class="">0212</span>:       weights: n-sized numpy.ndarray with weights of data points (default: uniform weights)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0213</span>:     Returns:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0214</span>:       (k, d)-shaped numpy.ndarray with cluster centers</pre>
<pre class="cython line score-0">&#xA0;<span class="">0215</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0216</span>:     # Local cython variables</pre>
<pre class="cython line score-0">&#xA0;<span class="">0217</span>:     cdef numpy.intp_t j, curr_ind</pre>
<pre class="cython line score-0">&#xA0;<span class="">0218</span>:     cdef double cand_prob, curr_prob</pre>
<pre class="cython line score-0">&#xA0;<span class="">0219</span>:     cdef double[::1] q_cand, p_cand, rand_a</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0220</span>:     cdef int N_CARDS = 24</pre>
<pre class='cython code score-0 '>__pyx_v_N_CARDS = 24;</pre><pre class="cython line score-0">&#xA0;<span class="">0221</span>: </pre>
<pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0222</span>:     cdef float32[:] ALL_X = numpy.empty(X.shape[0], dtype = numpy.float32)</pre>
<pre class='cython code score-35 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 222, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 222, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 222, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 222, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 222, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);__pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 222, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 222, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 222, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 222, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 222, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 222, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_v_ALL_X = __pyx_t_6;__pyx_t_6.memview = NULL;__pyx_t_6.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0223</span>: </pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0224</span>:     cdef float32[:] all_values = numpy.empty(X.shape[1]*2, dtype = numpy.float32)</pre>
<pre class='cython code score-38 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 224, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 224, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 224, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 224, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_MultiplyObjC</span>(__pyx_t_1, __pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 224, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 224, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);__pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 224, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 224, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 224, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 224, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 224, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_v_all_values = __pyx_t_6;__pyx_t_6.memview = NULL;__pyx_t_6.data = NULL;</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0225</span>:     cdef float32[:] all_valuesa = numpy.empty(X.shape[1]*2 - 1 , dtype = numpy.float32)</pre>
<pre class='cython code score-41 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 225, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 225, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 225, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 225, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_MultiplyObjC</span>(__pyx_t_1, __pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 225, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_4, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 225, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 225, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);__pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 225, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 225, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 225, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 225, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 225, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 225, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_all_valuesa = __pyx_t_6;__pyx_t_6.memview = NULL;__pyx_t_6.data = NULL;</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0226</span>:     cdef float32[:] all_valuesaa = numpy.empty(X.shape[1]*2 - 1, dtype = numpy.float32)</pre>
<pre class='cython code score-41 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_MultiplyObjC</span>(__pyx_t_4, __pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_2, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);__pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 226, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 226, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_v_all_valuesaa = __pyx_t_6;__pyx_t_6.memview = NULL;__pyx_t_6.data = NULL;</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0227</span>:     cdef float32[:] deltaaa = numpy.empty(X.shape[1]*2 - 1, dtype = numpy.float32)</pre>
<pre class='cython code score-41 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 227, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 227, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 227, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 227, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_MultiplyObjC</span>(__pyx_t_2, __pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 227, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_3, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 227, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 227, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);__pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 227, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 227, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 227, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 227, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 227, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 227, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_v_deltaaa = __pyx_t_6;__pyx_t_6.memview = NULL;__pyx_t_6.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0228</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0229</span>:     cdef float32 [:] ALL_X_VIEW = ALL_X[:]</pre>
<pre class='cython code score-0 '>__PYX_INC_MEMVIEW(&amp;__pyx_v_ALL_X, 1);__pyx_v_ALL_X_VIEW = __pyx_v_ALL_X;</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0230</span>:     cdef float32 [:, :] XX = X[:]</pre>
<pre class='cython code score-8 '>__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_X, 0, 0, NULL, NULL, &amp;__pyx_slice_, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 230, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_float32(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 230, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_v_XX = __pyx_t_7;__pyx_t_7.memview = NULL;__pyx_t_7.data = NULL;__pyx_slice_ = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice_)) __PYX_ERR(0, 230, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice_);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice_);</pre><pre class="cython line score-0">&#xA0;<span class="">0231</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0232</span>:     sparse = False</pre>
<pre class='cython code score-0 '>__pyx_v_sparse = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0233</span>:     if weights is None:</pre>
<pre class='cython code score-0 '>__pyx_t_8 = (__pyx_v_weights == Py_None);if (__pyx_t_8) {}</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0234</span>:         weights = numpy.ones(X.shape[0], dtype=numpy.double)</pre>
<pre class='cython code score-35 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 234, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 234, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 234, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 234, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 234, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3);__pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 234, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 234, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 234, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 234, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 234, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_weights, __pyx_t_1);__pyx_t_1 = 0;</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0235</span>:     if random_state is None or isinstance(random_state, int):</pre>
<pre class='cython code score-5 '>__pyx_t_9 = (__pyx_v_random_state == Py_None);if (!__pyx_t_9) {} else {__pyx_t_8 = __pyx_t_9;goto __pyx_L5_bool_binop_done;}__pyx_t_9 = <span class='py_c_api'>PyInt_Check</span>(__pyx_v_random_state); __pyx_t_8 = __pyx_t_9;__pyx_L5_bool_binop_done:;if (__pyx_t_8) {}</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0236</span>:         random_state = numpy.random.RandomState(random_state)</pre>
<pre class='cython code score-23 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 236, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 236, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_RandomState);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 236, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_5)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_v_random_state};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 236, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_random_state, __pyx_t_1);__pyx_t_1 = 0;</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0237</span>:     if not isinstance(random_state, numpy.random.RandomState):</pre>
<pre class='cython code score-14 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 237, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 237, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_RandomState);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 237, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_8 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_random_state, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 237, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_9 = (!__pyx_t_8);if (unlikely(__pyx_t_9)) {}</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0238</span>:         raise ValueError("RandomState should either be a numpy.random.RandomState"</pre>
<pre class='cython code score-10 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 238, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>__PYX_ERR(0, 238, __pyx_L1_error)</span>__pyx_tuple__2 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_RandomState_should_either_be_a_n);<span class='error_goto'> if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 238, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__2);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__2);</pre><pre class="cython line score-0">&#xA0;<span class="">0239</span>:                          " instance, None or an integer to be used as seed.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">0240</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0241</span>: </pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0242</span>:     cntrs = numpy.zeros((k, X.shape[1]), dtype=numpy.float32)</pre>
<pre class='cython code score-42 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 242, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 242, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 242, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 242, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 242, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_k);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_5);__pyx_t_5 = 0;__pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 242, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);__pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 242, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 242, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 242, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 242, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_v_cntrs = __pyx_t_4;__pyx_t_4 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0243</span>: </pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0244</span>:     cntrs[0] = X[random_state.choice(X.shape[0], p=weights/weights.sum())]</pre>
<pre class='cython code score-51 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_random_state, __pyx_n_s_choice);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 244, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 244, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 244, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 244, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);__pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 244, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_weights, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 244, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_11 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_11)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_11, };__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_10, 0+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 244, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_weights, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 244, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_p, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 244, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 244, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_X, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 244, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_cntrs, 0, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 244, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0245</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0246</span>:     cdef float32[:,:] ctr = cntrs[:]</pre>
<pre class='cython code score-3 '>__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_cntrs, 0, 0, NULL, NULL, &amp;__pyx_slice_, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 246, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_float32(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 246, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_v_ctr = __pyx_t_7;__pyx_t_7.memview = NULL;__pyx_t_7.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0247</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0248</span>:     cdef float32[:] ct = cntrs[0]</pre>
<pre class='cython code score-3 '>__pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_cntrs, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 248, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 248, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_v_ct = __pyx_t_6;__pyx_t_6.memview = NULL;__pyx_t_6.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0249</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0250</span>:     if afkmc2:</pre>
<pre class='cython code score-2 '>__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_afkmc2); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 250, __pyx_L1_error)</span>if (__pyx_t_9) {goto __pyx_L8;}</pre><pre class="cython line score-0">&#xA0;<span class="">0251</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0252</span>:         # assumption free proposal distribution using EMD_C</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0253</span>:         for j in range(ALL_X_VIEW.shape[0]):</pre>
<pre class='cython code score-0 '>__pyx_t_12 = (__pyx_v_ALL_X_VIEW.shape[0]);__pyx_t_13 = __pyx_t_12;for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {__pyx_v_j = __pyx_t_14;</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0254</span>:             ALL_X_VIEW[j] = emd_c(1, XX[j], ct, all_values, all_valuesa, all_valuesaa, deltaaa)</pre>
<pre class='cython code score-7 '>__pyx_t_6.data = __pyx_v_XX.data;__pyx_t_6.memview = __pyx_v_XX.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_6, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_j;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_XX.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_XX.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 254, __pyx_L1_error)</span>
        }
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_XX.shape[1];
__pyx_t_6.strides[0] = __pyx_v_XX.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

__pyx_t_15 = __pyx_v_j;__pyx_t_10 = -1;if (__pyx_t_15 &lt; 0) {__pyx_t_15 += __pyx_v_ALL_X_VIEW.shape[0];if (unlikely(__pyx_t_15 &lt; 0)) __pyx_t_10 = 0;} else if (unlikely(__pyx_t_15 &gt;= __pyx_v_ALL_X_VIEW.shape[0])) __pyx_t_10 = 0;if (unlikely(__pyx_t_10 != -1)) {<span class='pyx_c_api'>__Pyx_RaiseBufferIndexError</span>(__pyx_t_10);<span class='error_goto'>__PYX_ERR(0, 254, __pyx_L1_error)</span>}*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_ALL_X_VIEW.data + __pyx_t_15 * __pyx_v_ALL_X_VIEW.strides[0]) )) = __pyx_f_8ccluster_emd_c(1, __pyx_t_6, __pyx_v_ct, __pyx_v_all_values, __pyx_v_all_valuesa, __pyx_v_all_valuesaa, __pyx_v_deltaaa, NULL);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;}</pre><pre class="cython line score-0">&#xA0;<span class="">0255</span>:         # following q value pulled from adriangoe afkmc2</pre>
<pre class="cython line score-0">&#xA0;<span class="">0256</span>: </pre>
<pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0257</span>:         q = numpy.fromiter(ALL_X_VIEW, numpy.double, count=X.shape[0])</pre>
<pre class='cython code score-35 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 257, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_fromiter);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 257, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_ALL_X_VIEW, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_8ccluster_float32, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_8ccluster_float32, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 257, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 257, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 257, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 257, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4);__pyx_t_5 = 0;__pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 257, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 257, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 257, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_count, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 257, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 257, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_v_q = __pyx_t_3;__pyx_t_3 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0258</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0259</span>:         print(q)</pre>
<pre class='cython code score-3 '>__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_v_q);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 259, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0260</span>:         q = q/(2*numpy.sum(q)) + 1/(2 * X.shape[0])</pre>
<pre class='cython code score-44 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {__pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);if (likely(__pyx_t_4)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_q};__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;}__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_MultiplyCObj</span>(__pyx_int_2, __pyx_t_3, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_q, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_MultiplyCObj</span>(__pyx_int_2, __pyx_t_4, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_int_1, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_q, __pyx_t_1);__pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0261</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0262</span>:         #di = numpy.min(numpy.fromiter(ALL_X_VIEW, numpy.double, count=X.shape[0]))</pre>
<pre class="cython line score-0">&#xA0;<span class="">0263</span>:         #print(di)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0264</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0265</span>:         #q = di/numpy.sum(di, dtype = numpy.double) + weights/numpy.sum(weights)  # Only the potentials</pre>
<pre class="cython line score-0">&#xA0;<span class="">0266</span>:         #print(q)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0267</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0268</span>:     else:</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0269</span>:         q = numpy.copy(weights)</pre>
<pre class='cython code score-19 '>/*else*/ {<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 269, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 269, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_4)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_weights};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 269, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}__pyx_v_q = __pyx_t_1;__pyx_t_1 = 0;}__pyx_L8:;</pre><pre class="cython line score-0">&#xA0;<span class="">0270</span>:     # Renormalize the proposal distribution</pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0271</span>:     q = q / numpy.sum(q)</pre>
<pre class='cython code score-23 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 271, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 271, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_q};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 271, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;}__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_q, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 271, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_q, __pyx_t_4);__pyx_t_4 = 0;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0272</span>:     print(q)</pre>
<pre class='cython code score-3 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_v_q);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 272, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0273</span>:     for i in range(k-1):</pre>
<pre class='cython code score-51 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_k, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 273, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 273, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {__pyx_t_4 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_12 = 0;__pyx_t_16 = NULL;} else {__pyx_t_12 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 273, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 273, __pyx_L1_error)</span>}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;for (;;) {if (likely(!__pyx_t_16)) {if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {if (__pyx_t_12 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_12++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 273, __pyx_L1_error)</span>#else__pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 273, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);#endif} else {if (__pyx_t_12 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_12++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 273, __pyx_L1_error)</span>#else__pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 273, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);#endif}} else {__pyx_t_1 = __pyx_t_16(__pyx_t_4);if (unlikely(!__pyx_t_1)) {PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();if (exc_type) {if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();else <span class='error_goto'>__PYX_ERR(0, 273, __pyx_L1_error)</span>}break;}<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);__pyx_t_1 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0274</span>:         t1 = time.time()</pre>
<pre class='cython code score-20 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 274, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 274, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_3, };__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_10, 0+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 274, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t1, __pyx_t_1);__pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0275</span>:         # Draw the candidate indices</pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0276</span>:         cand_ind = random_state.choice(X.shape[0], size=(chain_length), p=q).astype(dtype=numpy.intp)</pre>
<pre class='cython code score-51 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_random_state, __pyx_n_s_choice);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);__pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_size, __pyx_v_chain_length) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 276, __pyx_L1_error)</span>if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_p, __pyx_v_q) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 276, __pyx_L1_error)</span>__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_intp);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 276, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_empty_tuple, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cand_ind, __pyx_t_1);__pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0277</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0278</span>:         # Extract the proposal probabilities</pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0279</span>:         q_cand = q[cand_ind].astype(numpy.double)</pre>
<pre class='cython code score-28 '>__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_q, __pyx_v_cand_ind);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 279, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 279, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 279, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 279, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_5)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_2};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 279, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}__pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 279, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_q_cand, 1);__pyx_v_q_cand = __pyx_t_17;__pyx_t_17.memview = NULL;__pyx_t_17.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0280</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0281</span>:         # shortest distance from previous centers using EMD_C</pre>
<pre class="cython line score-60" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0282</span>:         dist = [[emd_c(1, xi, XX[cand_ind[yi]], all_values, all_valuesa, all_valuesaa, deltaaa) for yi in range(len(cand_ind))] for xi in ctr[0:(i+1)]]</pre>
<pre class='cython code score-60 '>{ /* enter inner scope */__pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 282, __pyx_L15_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 282, __pyx_L15_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_3); if (unlikely((__pyx_t_13 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L15_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_7.data = __pyx_v_ctr.data;__pyx_t_7.memview = __pyx_v_ctr.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_7, 1);__pyx_t_10 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_7,
    __pyx_v_ctr.shape[0], __pyx_v_ctr.strides[0], __pyx_v_ctr.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_10,
    0,
    __pyx_t_13,
    0,
    1,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L15_error)</span>
}

__pyx_t_7.shape[1] = __pyx_v_ctr.shape[1];
__pyx_t_7.strides[1] = __pyx_v_ctr.strides[1];
    __pyx_t_7.suboffsets[1] = -1;

if (unlikely(((PyObject *) __pyx_t_7.memview) == Py_None)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' is not iterable");<span class='error_goto'>__PYX_ERR(0, 282, __pyx_L15_error)</span>}__pyx_t_13 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_t_7); for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_13; __pyx_t_19++) {__pyx_t_18 = __pyx_t_19;__pyx_t_6.data = __pyx_t_7.data;__pyx_t_6.memview = __pyx_t_7.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_6, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_t_18;
    Py_ssize_t __pyx_tmp_stride = __pyx_t_7.strides[0];
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_t_7.shape[1];
__pyx_t_6.strides[0] = __pyx_t_7.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

__pyx_t_3 = __pyx_memoryview_fromslice(__pyx_t_6, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_8ccluster_float32, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_8ccluster_float32, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 282, __pyx_L15_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_7genexpr__pyx_v_xi, __pyx_t_3);__pyx_t_3 = 0;{ /* enter inner scope */__pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 282, __pyx_L15_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_20 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_cand_ind);<span class='error_goto'> if (unlikely(__pyx_t_20 == ((Py_ssize_t)-1))) __PYX_ERR(0, 282, __pyx_L15_error)</span>__pyx_t_21 = __pyx_t_20;for (__pyx_t_22 = 0; __pyx_t_22 &lt; __pyx_t_21; __pyx_t_22+=1) {__pyx_8genexpr1__pyx_v_yi = __pyx_t_22;__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_7genexpr__pyx_v_xi, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 282, __pyx_L15_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_cand_ind, __pyx_8genexpr1__pyx_v_yi, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 282, __pyx_L15_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_23 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_2); if (unlikely((__pyx_t_23 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L15_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_24.data = __pyx_v_XX.data;__pyx_t_24.memview = __pyx_v_XX.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_24, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_t_23;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_XX.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_XX.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L15_error)</span>
        }
        __pyx_t_24.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_24.shape[0] = __pyx_v_XX.shape[1];
__pyx_t_24.strides[0] = __pyx_v_XX.strides[1];
    __pyx_t_24.suboffsets[0] = -1;

__pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_f_8ccluster_emd_c(1, __pyx_t_6, __pyx_t_24, __pyx_v_all_values, __pyx_v_all_valuesa, __pyx_v_all_valuesaa, __pyx_v_deltaaa, NULL));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 282, __pyx_L15_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_24, 1);__pyx_t_24.memview = NULL; __pyx_t_24.data = NULL;<span class='error_goto'>if (unlikely(__Pyx_ListComp_Append(__pyx_t_3, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 282, __pyx_L15_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}} /* exit inner scope */if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_3))) <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L15_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);__pyx_t_7.memview = NULL; __pyx_t_7.data = NULL;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_7genexpr__pyx_v_xi); __pyx_7genexpr__pyx_v_xi = 0;goto __pyx_L20_exit_scope;__pyx_L15_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_7genexpr__pyx_v_xi); __pyx_7genexpr__pyx_v_xi = 0;goto __pyx_L1_error;__pyx_L20_exit_scope:;} /* exit inner scope */<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dist, ((PyObject*)__pyx_t_1));__pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0283</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0284</span>:         # Compute potentials</pre>
<pre class="cython line score-0">&#xA0;<span class="">0285</span>: </pre>
<pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0286</span>:         p_cand = numpy.min(dist).astype(numpy.double)*weights[cand_ind]</pre>
<pre class='cython code score-54 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 286, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {__pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);if (likely(__pyx_t_2)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_dist};__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 286, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;}__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 286, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 286, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_2};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;}__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_weights, __pyx_v_cand_ind);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 286, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 286, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_p_cand, 1);__pyx_v_p_cand = __pyx_t_17;__pyx_t_17.memview = NULL;__pyx_t_17.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0287</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0288</span>:         # Compute acceptance probabilities</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0289</span>:         rand_a = random_state.random_sample(size=(chain_length))</pre>
<pre class='cython code score-16 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_random_state, __pyx_n_s_random_sample);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 289, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 289, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_size, __pyx_v_chain_length) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 289, __pyx_L1_error)</span>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_empty_tuple, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_17.memview)) __PYX_ERR(0, 289, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_rand_a, 1);__pyx_v_rand_a = __pyx_t_17;__pyx_t_17.memview = NULL;__pyx_t_17.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0290</span>:         with cython.boundscheck(False), cython.wraparound(False), cython.cdivision(True):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0291</span>:             # Markov chain</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0292</span>:             for j in range(q_cand.shape[0]):</pre>
<pre class='cython code score-0 '>__pyx_t_13 = (__pyx_v_q_cand.shape[0]);__pyx_t_18 = __pyx_t_13;for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_18; __pyx_t_14+=1) {__pyx_v_j = __pyx_t_14;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0293</span>:                 cand_prob = (p_cand[j])/(q_cand[j])</pre>
<pre class='cython code score-0 '>__pyx_t_15 = __pyx_v_j;__pyx_t_25 = __pyx_v_j;__pyx_v_cand_prob = ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_p_cand.data) + __pyx_t_15)) ))) / (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_q_cand.data) + __pyx_t_25)) ))));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0294</span>:                 if j == 0 or curr_prob == 0.0 or cand_prob/curr_prob &gt; rand_a[j]:</pre>
<pre class='cython code score-0 '>__pyx_t_8 = (__pyx_v_j == 0);if (!__pyx_t_8) {} else {__pyx_t_9 = __pyx_t_8;goto __pyx_L24_bool_binop_done;}__pyx_t_8 = (__pyx_v_curr_prob == 0.0);if (!__pyx_t_8) {} else {__pyx_t_9 = __pyx_t_8;goto __pyx_L24_bool_binop_done;}__pyx_t_25 = __pyx_v_j;__pyx_t_8 = ((__pyx_v_cand_prob / __pyx_v_curr_prob) &gt; (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_rand_a.data) + __pyx_t_25)) ))));__pyx_t_9 = __pyx_t_8;__pyx_L24_bool_binop_done:;if (__pyx_t_9) {}}</pre><pre class="cython line score-0">&#xA0;<span class="">0295</span>:                     # Init new chain             Metropolis-Hastings step</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0296</span>:                     curr_ind = j</pre>
<pre class='cython code score-0 '>__pyx_v_curr_ind = __pyx_v_j;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0297</span>:                     curr_prob = cand_prob</pre>
<pre class='cython code score-0 '>__pyx_v_curr_prob = __pyx_v_cand_prob;</pre><pre class="cython line score-0">&#xA0;<span class="">0298</span>:         # centers[i+1, :] = rel_row.todense().flatten() if sparse else rel_row</pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0299</span>:         ctr[i+1] = XX[cand_ind[curr_ind]]</pre>
<pre class='cython code score-30 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_cand_ind, __pyx_v_curr_ind, __pyx_t_5numpy_intp_t, 1, PyInt_FromSsize_t, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 299, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_1); if (unlikely((__pyx_t_13 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_24.data = __pyx_v_XX.data;__pyx_t_24.memview = __pyx_v_XX.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_24, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_t_13;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_XX.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_XX.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
        }
        __pyx_t_24.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_24.shape[0] = __pyx_v_XX.shape[1];
__pyx_t_24.strides[0] = __pyx_v_XX.strides[1];
    __pyx_t_24.suboffsets[0] = -1;

__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 299, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_1); if (unlikely((__pyx_t_13 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_6.data = __pyx_v_ctr.data;__pyx_t_6.memview = __pyx_v_ctr.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_6, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_t_13;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_ctr.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_ctr.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
            <span class='py_c_api'>PyErr_SetString</span>(PyExc_IndexError,
                            "Index out of bounds (axis 0)");
            <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
        }
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_ctr.shape[1];
__pyx_t_6.strides[0] = __pyx_v_ctr.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

if (unlikely((__pyx_memoryview_copy_contents(__pyx_t_24, __pyx_t_6, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_24, 1);__pyx_t_24.memview = NULL; __pyx_t_24.data = NULL;</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0300</span>:         t2=time.time()</pre>
<pre class='cython code score-20 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 300, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 300, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = NULL;__pyx_t_10 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_5)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_10 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_5, };__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_10, 0+__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 300, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t2, __pyx_t_1);__pyx_t_1 = 0;</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0301</span>:         t = t2-t1</pre>
<pre class='cython code score-6 '>__pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_t2, __pyx_v_t1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 301, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_t, __pyx_t_1);__pyx_t_1 = 0;</pre><pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0302</span>:         print('~' + str(t*(k - 1 - i)//60) + ' minutes until finished. ' + str(100*(i/(k-1)))[:4] + '% done     ', end = '\r')</pre>
<pre class='cython code score-71 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_k, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 302, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 302, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_t, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 302, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_FloorDivideObjC</span>(__pyx_t_1, __pyx_int_60, 60, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 302, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 302, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_u__3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 302, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlace</span>(__pyx_t_2, __pyx_kp_u_minutes_until_finished);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 302, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_k, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 302, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_i, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 302, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_MultiplyCObj</span>(__pyx_int_100, __pyx_t_5, 0x64, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 302, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 302, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PySequence_GetSlice</span>(__pyx_t_5, 0, 4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 302, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlaceSafe</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 302, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlace</span>(__pyx_t_5, __pyx_kp_u_done);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 302, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 302, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);__pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 302, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_end, __pyx_kp_u__4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 302, __pyx_L1_error)</span>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_t_5, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 302, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0303</span>:     return cntrs</pre>
<pre class='cython code score-2 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cntrs);__pyx_r = __pyx_v_cntrs;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0304</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0305</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0306</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0307</span>: #################################################################################################</pre>
<pre class="cython line score-0">&#xA0;<span class="">0308</span>: # My code below.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0309</span>: #################################################################################################</pre>
<pre class="cython line score-0">&#xA0;<span class="">0310</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0311</span>: # Taken from stack overflow. Fast list combination generator for C(n, k)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0312</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0313</span>: </pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0314</span>: def nump2(n, k):</pre>
<pre class='cython code score-61 '>/* Python wrapper */static PyObject *__pyx_pw_8ccluster_3nump2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/static PyMethodDef __pyx_mdef_8ccluster_3nump2 = {"nump2", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8ccluster_3nump2, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};static PyObject *__pyx_pw_8ccluster_3nump2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {PyObject *__pyx_v_n = 0;PyObject *__pyx_v_k = 0;#if !CYTHON_METH_FASTCALLCYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);#endifCYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);PyObject *__pyx_r = 0;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("nump2 (wrapper)", 0);{#if CYTHON_USE_MODULE_STATEPyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n,&amp;__pyx_n_s_k,0};#elsestatic PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n,&amp;__pyx_n_s_k,0};#endifPyObject* values[2] = {0,0};if (__pyx_kwds) {Py_ssize_t kw_args;switch (__pyx_nargs) {case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);CYTHON_FALLTHROUGH;case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);CYTHON_FALLTHROUGH;case  0: break;default: goto __pyx_L5_argtuple_error;}kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);switch (__pyx_nargs) {case  0:if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>else goto __pyx_L5_argtuple_error;CYTHON_FALLTHROUGH;case  1:if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_k)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("nump2", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>}}if (unlikely(kw_args &gt; 0)) {const Py_ssize_t kwd_pos_args = __pyx_nargs;if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "nump2") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>}} else if (unlikely(__pyx_nargs != 2)) {goto __pyx_L5_argtuple_error;} else {values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);}__pyx_v_n = values[0];__pyx_v_k = values[1];}goto __pyx_L4_argument_unpacking_done;__pyx_L5_argtuple_error:;<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("nump2", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>__pyx_L3_error:;<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.nump2", __pyx_clineno, __pyx_lineno, __pyx_filename);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return NULL;__pyx_L4_argument_unpacking_done:;__pyx_r = __pyx_pf_8ccluster_2nump2(__pyx_self, __pyx_v_n, __pyx_v_k);int __pyx_lineno = 0;const char *__pyx_filename = NULL;int __pyx_clineno = 0;/* function exit code */<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}static PyObject *__pyx_pf_8ccluster_2nump2(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_n, PyObject *__pyx_v_k) {PyObject *__pyx_v_a = NULL;PyObject *__pyx_v_j = NULL;PyObject *__pyx_v_reps = NULL;PyObject *__pyx_v_ind = NULL;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("nump2", 0);/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.nump2", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = NULL;__pyx_L0:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_a);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_reps);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ind);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}__pyx_tuple__38 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_n, __pyx_n_s_k, __pyx_n_s_a, __pyx_n_s_j, __pyx_n_s_reps, __pyx_n_s_ind);<span class='error_goto'> if (unlikely(!__pyx_tuple__38)) __PYX_ERR(0, 314, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__38);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__38);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8ccluster_3nump2, 0, __pyx_n_s_nump2, NULL, __pyx_n_s_ccluster, __pyx_d, ((PyObject *)__pyx_codeobj__39));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 314, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_nump2, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_codeobj__39 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__38, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ccluster_pyx, __pyx_n_s_nump2, 314, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__39)) __PYX_ERR(0, 314, __pyx_L1_error)</span></pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0315</span>:     a = numpy.ones((k, n-k+1), dtype=numpy.int16)</pre>
<pre class='cython code score-45 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 315, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 315, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_n, __pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 315, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 315, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 315, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_k);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_3);__pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 315, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);__pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 315, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 315, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 315, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 315, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 315, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_v_a = __pyx_t_5;__pyx_t_5 = 0;</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0316</span>:     a[0] = numpy.arange(n-k+1)</pre>
<pre class='cython code score-31 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 316, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 316, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_n, __pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 316, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 316, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = NULL;__pyx_t_6 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_1)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_6 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_2};__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 316, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_a, 0, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 316, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;</pre><pre class="cython line score-58" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0317</span>:     for j in range(1, k):</pre>
<pre class='cython code score-58 '>__pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 317, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_int_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_k);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_range, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 317, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {__pyx_t_5 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_7 = 0;__pyx_t_8 = NULL;} else {__pyx_t_7 = -1; __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 317, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 317, __pyx_L1_error)</span>}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;for (;;) {if (likely(!__pyx_t_8)) {if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_5)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_5, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 317, __pyx_L1_error)</span>#else__pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 317, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);#endif} else {if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_5)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_5, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 317, __pyx_L1_error)</span>#else__pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_5, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 317, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);#endif}} else {__pyx_t_3 = __pyx_t_8(__pyx_t_5);if (unlikely(!__pyx_t_3)) {PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();if (exc_type) {if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();else <span class='error_goto'>__PYX_ERR(0, 317, __pyx_L1_error)</span>}break;}<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_j, __pyx_t_3);__pyx_t_3 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0318</span>:         reps = (n-k+j) - a[j-1]</pre>
<pre class='cython code score-24 '>__pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_n, __pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 318, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 318, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_j, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 318, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_a, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 318, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 318, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_reps, __pyx_t_3);__pyx_t_3 = 0;</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0319</span>:         a = numpy.repeat(a, reps, axis=1)</pre>
<pre class='cython code score-27 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 319, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_repeat);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 319, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 319, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_a);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_a);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_a);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_reps);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_reps);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_reps);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 319, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 319, __pyx_L1_error)</span>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 319, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_a, __pyx_t_4);__pyx_t_4 = 0;</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0320</span>:         ind = numpy.add.accumulate(reps)</pre>
<pre class='cython code score-23 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 320, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 320, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_accumulate);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 320, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = NULL;__pyx_t_6 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_6 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_reps};__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 320, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ind, __pyx_t_4);__pyx_t_4 = 0;</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0321</span>:         a[j, ind[:-1]] = 1-reps[1:]</pre>
<pre class='cython code score-32 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_reps, 1, 0, NULL, NULL, &amp;__pyx_slice__5, 1, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 321, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_t_4, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 321, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_slice__5 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_1, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__5)) __PYX_ERR(0, 321, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__5);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_ind, 0, -1L, NULL, NULL, &amp;__pyx_slice__6, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 321, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 321, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_j);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_j);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_j);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4);__pyx_t_4 = 0;if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_a, __pyx_t_3, __pyx_t_2) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 321, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_slice__6 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__6)) __PYX_ERR(0, 321, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__6);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__6);</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0322</span>:         a[j, 0] = j</pre>
<pre class='cython code score-15 '>__pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 322, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_j);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_j);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_j);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_0);if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_a, __pyx_t_2, __pyx_v_j) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 322, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0323</span>:         a[j] = numpy.add.accumulate(a[j])</pre>
<pre class='cython code score-31 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_add);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 323, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_accumulate);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_a, __pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 323, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_1 = NULL;__pyx_t_6 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_1)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_6 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_4};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 323, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_a, __pyx_v_j, __pyx_t_2) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0324</span>:     return a.T</pre>
<pre class='cython code score-3 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_a, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 324, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_r = __pyx_t_5;__pyx_t_5 = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0325</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0326</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0327</span>: # Taken from stack overflow. Fast list combination generator for C(n, k)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0328</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0329</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0330</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0331</span>: # See if a card appears twice in the hand/table combo. Can be faster.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0332</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0333</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0334</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0335</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0336</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0337</span>: cdef numpy.npy_bool contains_duplicates(int16[:] XX) nogil:</pre>
<pre class='cython code score-0 '>static npy_bool __pyx_f_8ccluster_contains_duplicates(__Pyx_memviewslice __pyx_v_XX) {unsigned int __pyx_v_count;unsigned int __pyx_v_length;unsigned int __pyx_v_countt;npy_bool __pyx_r;/* function exit code */__pyx_L0:;return __pyx_r;}</pre><pre class="cython line score-0">&#xA0;<span class="">0338</span>:     cdef unsigned int count</pre>
<pre class="cython line score-0">&#xA0;<span class="">0339</span>:     cdef unsigned int length</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0340</span>:     cdef unsigned int countt = 0</pre>
<pre class='cython code score-0 '>__pyx_v_countt = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0341</span>:     length = 7</pre>
<pre class='cython code score-0 '>__pyx_v_length = 7;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0342</span>:     for count in range(length):</pre>
<pre class='cython code score-0 '>__pyx_t_1 = __pyx_v_length;__pyx_t_2 = __pyx_t_1;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {__pyx_v_count = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0343</span>:         for countt in range(count+1, length):</pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_length;__pyx_t_5 = __pyx_t_4;for (__pyx_t_6 = (__pyx_v_count + 1); __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {__pyx_v_countt = __pyx_t_6;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0344</span>:             if(XX[count] == XX[countt]):</pre>
<pre class='cython code score-0 '>__pyx_t_7 = __pyx_v_count;__pyx_t_8 = __pyx_v_countt;__pyx_t_9 = ((*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_XX.data + __pyx_t_7 * __pyx_v_XX.strides[0]) ))) == (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_XX.data + __pyx_t_8 * __pyx_v_XX.strides[0]) ))));if (__pyx_t_9) {}}}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0345</span>:                 return True</pre>
<pre class='cython code score-0 '>__pyx_r = 1;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0346</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0347</span>:     return False</pre>
<pre class='cython code score-0 '>__pyx_r = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0348</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0349</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0350</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0351</span>: # See if a card appears twice in the hand/table combo. Can be faster.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0352</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0353</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0354</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0355</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0356</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0357</span>: cdef numpy.npy_bool contains_duplicates_turn(int16[:] XX) nogil:</pre>
<pre class='cython code score-0 '>static npy_bool __pyx_f_8ccluster_contains_duplicates_turn(__Pyx_memviewslice __pyx_v_XX) {unsigned int __pyx_v_count;unsigned int __pyx_v_length;unsigned int __pyx_v_countt;npy_bool __pyx_r;/* function exit code */__pyx_L0:;return __pyx_r;}</pre><pre class="cython line score-0">&#xA0;<span class="">0358</span>:     cdef unsigned int count</pre>
<pre class="cython line score-0">&#xA0;<span class="">0359</span>:     cdef unsigned int length</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0360</span>:     cdef unsigned int countt = 0</pre>
<pre class='cython code score-0 '>__pyx_v_countt = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0361</span>:     length = 6</pre>
<pre class='cython code score-0 '>__pyx_v_length = 6;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0362</span>:     for count in range(length):</pre>
<pre class='cython code score-0 '>__pyx_t_1 = __pyx_v_length;__pyx_t_2 = __pyx_t_1;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {__pyx_v_count = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0363</span>:         for countt in range(count+1, length):</pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_length;__pyx_t_5 = __pyx_t_4;for (__pyx_t_6 = (__pyx_v_count + 1); __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {__pyx_v_countt = __pyx_t_6;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0364</span>:             if(XX[count] == XX[countt]):</pre>
<pre class='cython code score-0 '>__pyx_t_7 = __pyx_v_count;__pyx_t_8 = __pyx_v_countt;__pyx_t_9 = ((*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_XX.data + __pyx_t_7 * __pyx_v_XX.strides[0]) ))) == (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_XX.data + __pyx_t_8 * __pyx_v_XX.strides[0]) ))));if (__pyx_t_9) {}}}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0365</span>:                 return True</pre>
<pre class='cython code score-0 '>__pyx_r = 1;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0366</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0367</span>:     return False</pre>
<pre class='cython code score-0 '>__pyx_r = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0368</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0369</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0370</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0371</span>: cdef numpy.npy_bool contains_duplicates_flop(int16[:] XX) nogil:</pre>
<pre class='cython code score-0 '>static npy_bool __pyx_f_8ccluster_contains_duplicates_flop(__Pyx_memviewslice __pyx_v_XX) {unsigned int __pyx_v_count;unsigned int __pyx_v_length;unsigned int __pyx_v_countt;npy_bool __pyx_r;/* function exit code */__pyx_L0:;return __pyx_r;}</pre><pre class="cython line score-0">&#xA0;<span class="">0372</span>:     cdef unsigned int count</pre>
<pre class="cython line score-0">&#xA0;<span class="">0373</span>:     cdef unsigned int length</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0374</span>:     cdef unsigned int countt = 0</pre>
<pre class='cython code score-0 '>__pyx_v_countt = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0375</span>:     length = 5</pre>
<pre class='cython code score-0 '>__pyx_v_length = 5;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0376</span>:     for count in range(length):</pre>
<pre class='cython code score-0 '>__pyx_t_1 = __pyx_v_length;__pyx_t_2 = __pyx_t_1;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {__pyx_v_count = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0377</span>:         for countt in range(count+1, length):</pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_length;__pyx_t_5 = __pyx_t_4;for (__pyx_t_6 = (__pyx_v_count + 1); __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {__pyx_v_countt = __pyx_t_6;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0378</span>:             if(XX[count] == XX[countt]):</pre>
<pre class='cython code score-0 '>__pyx_t_7 = __pyx_v_count;__pyx_t_8 = __pyx_v_countt;__pyx_t_9 = ((*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_XX.data + __pyx_t_7 * __pyx_v_XX.strides[0]) ))) == (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_XX.data + __pyx_t_8 * __pyx_v_XX.strides[0]) ))));if (__pyx_t_9) {}}}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0379</span>:                 return True</pre>
<pre class='cython code score-0 '>__pyx_r = 1;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0380</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0381</span>:     return False</pre>
<pre class='cython code score-0 '>__pyx_r = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0382</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0383</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0384</span>: # Check if the hand/board combo (XX) contains a given card (comp)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0385</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0386</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0387</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0388</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0389</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0390</span>: cdef numpy.npy_bool contains(int16[:] XX, int comp) nogil:</pre>
<pre class='cython code score-0 '>static npy_bool __pyx_f_8ccluster_contains(__Pyx_memviewslice __pyx_v_XX, int __pyx_v_comp) {unsigned int __pyx_v_count;unsigned int __pyx_v_length;npy_bool __pyx_r;/* function exit code */__pyx_L0:;return __pyx_r;}</pre><pre class="cython line score-0">&#xA0;<span class="">0391</span>:     cdef unsigned int count</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0392</span>:     cdef unsigned int length = 7</pre>
<pre class='cython code score-0 '>__pyx_v_length = 7;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0393</span>:     for count in range(length):</pre>
<pre class='cython code score-0 '>__pyx_t_1 = __pyx_v_length;__pyx_t_2 = __pyx_t_1;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {__pyx_v_count = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0394</span>:         if(XX[count] == comp):</pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_count;__pyx_t_5 = ((*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_XX.data + __pyx_t_4 * __pyx_v_XX.strides[0]) ))) == __pyx_v_comp);if (__pyx_t_5) {}}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0395</span>:             return True</pre>
<pre class='cython code score-0 '>__pyx_r = 1;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0396</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0397</span>:     return False</pre>
<pre class='cython code score-0 '>__pyx_r = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0398</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0399</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0400</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0401</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0402</span>: cdef numpy.npy_bool contains_flop(int16[:] XX, int comp) nogil:</pre>
<pre class='cython code score-0 '>static npy_bool __pyx_f_8ccluster_contains_flop(__Pyx_memviewslice __pyx_v_XX, int __pyx_v_comp) {unsigned int __pyx_v_count;unsigned int __pyx_v_length;npy_bool __pyx_r;/* function exit code */__pyx_L0:;return __pyx_r;}</pre><pre class="cython line score-0">&#xA0;<span class="">0403</span>:     cdef unsigned int count</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0404</span>:     cdef unsigned int length = 5</pre>
<pre class='cython code score-0 '>__pyx_v_length = 5;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0405</span>:     for count in range(length):</pre>
<pre class='cython code score-0 '>__pyx_t_1 = __pyx_v_length;__pyx_t_2 = __pyx_t_1;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {__pyx_v_count = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0406</span>:         if(XX[count] == comp):</pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_count;__pyx_t_5 = ((*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_XX.data + __pyx_t_4 * __pyx_v_XX.strides[0]) ))) == __pyx_v_comp);if (__pyx_t_5) {}}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0407</span>:             return True</pre>
<pre class='cython code score-0 '>__pyx_r = 1;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0408</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0409</span>:     return False</pre>
<pre class='cython code score-0 '>__pyx_r = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0410</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0411</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0412</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0413</span>: cdef numpy.npy_bool contains_turn(int16[:] XX, int comp) nogil:</pre>
<pre class='cython code score-0 '>static npy_bool __pyx_f_8ccluster_contains_turn(__Pyx_memviewslice __pyx_v_XX, int __pyx_v_comp) {unsigned int __pyx_v_count;unsigned int __pyx_v_length;npy_bool __pyx_r;/* function exit code */__pyx_L0:;return __pyx_r;}</pre><pre class="cython line score-0">&#xA0;<span class="">0414</span>:     cdef unsigned int count</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0415</span>:     cdef unsigned int length = 6</pre>
<pre class='cython code score-0 '>__pyx_v_length = 6;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0416</span>:     for count in range(length):</pre>
<pre class='cython code score-0 '>__pyx_t_1 = __pyx_v_length;__pyx_t_2 = __pyx_t_1;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {__pyx_v_count = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0417</span>:         if(XX[count] == comp):</pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_count;__pyx_t_5 = ((*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_XX.data + __pyx_t_4 * __pyx_v_XX.strides[0]) ))) == __pyx_v_comp);if (__pyx_t_5) {}}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0418</span>:             return True</pre>
<pre class='cython code score-0 '>__pyx_r = 1;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0419</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0420</span>:     return False</pre>
<pre class='cython code score-0 '>__pyx_r = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0421</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0422</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0423</span>: # Get the Expected Hand Strength for a given hand/board river combination.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0424</span>: # Returns a 'tally' array for the total number of ties, wins, and losses.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0425</span>: # This is an exact calculation so I leave the result as an integer ratio</pre>
<pre class="cython line score-0">&#xA0;<span class="">0426</span>: # in order to avoid precision loss later down the line.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0427</span>: #</pre>
<pre class="cython line score-0">&#xA0;<span class="">0428</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0429</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0430</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0431</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0432</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0433</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0434</span>: cdef void get_ehs_fast(int16[:] j, int16[:] twl_tiewinloss) nogil:</pre>
<pre class='cython code score-0 '>static void __pyx_f_8ccluster_get_ehs_fast(__Pyx_memviewslice __pyx_v_j, __Pyx_memviewslice __pyx_v_twl_tiewinloss) {int __pyx_v_T_CARDS;int __pyx_v_N_CARDS;__pyx_t_8ccluster_int16 __pyx_v_x[45];__pyx_t_8ccluster_int16 __pyx_v_i;__pyx_t_8ccluster_int16 __pyx_v_k;int __pyx_v_hero;int __pyx_v_v;int __pyx_v_c;unsigned PY_LONG_LONG __pyx_v_mask;unsigned int __pyx_v_seven;unsigned PY_LONG_LONG __pyx_v_one;/* function exit code */}</pre><pre class="cython line score-0">&#xA0;<span class="">0435</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0436</span>:     cdef int T_CARDS = 5</pre>
<pre class='cython code score-0 '>__pyx_v_T_CARDS = 5;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0437</span>:     cdef int N_CARDS = 24</pre>
<pre class='cython code score-0 '>__pyx_v_N_CARDS = 24;</pre><pre class="cython line score-0">&#xA0;<span class="">0438</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0439</span>:     cdef int16 x[45]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0440</span>:     cdef int16 i, k</pre>
<pre class="cython line score-0">&#xA0;<span class="">0441</span>:     cdef int hero, v, c</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0442</span>:     cdef unsigned long long mask = 0</pre>
<pre class='cython code score-0 '>__pyx_v_mask = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0443</span>:     cdef unsigned int seven = 7</pre>
<pre class='cython code score-0 '>__pyx_v_seven = 7;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0444</span>:     cdef unsigned long long one = 1</pre>
<pre class='cython code score-0 '>__pyx_v_one = 1;</pre><pre class="cython line score-0">&#xA0;<span class="">0445</span>:     cdef unsigned long long key</pre>
<pre class="cython line score-0">&#xA0;<span class="">0446</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0447</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0448</span>:     c = 0</pre>
<pre class='cython code score-0 '>__pyx_v_c = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0449</span>:     for i in range(N_CARDS):</pre>
<pre class='cython code score-0 '>__pyx_t_1 = __pyx_v_N_CARDS;__pyx_t_2 = __pyx_t_1;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {__pyx_v_i = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0450</span>:         if not contains(j, i):</pre>
<pre class='cython code score-0 '>__pyx_t_4 = (!(__pyx_f_8ccluster_contains(__pyx_v_j, __pyx_v_i) != 0));if (__pyx_t_4) {}}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0451</span>:             x[c] = i</pre>
<pre class='cython code score-0 '>(__pyx_v_x[__pyx_v_c]) = __pyx_v_i;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0452</span>:             c += 1</pre>
<pre class='cython code score-0 '>__pyx_v_c = (__pyx_v_c + 1);</pre><pre class="cython line score-0">&#xA0;<span class="">0453</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0454</span>:     mask |= one &lt;&lt; j[2]</pre>
<pre class='cython code score-0 '>__pyx_t_5 = 2;__pyx_v_mask = (__pyx_v_mask | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_j.data + __pyx_t_5 * __pyx_v_j.strides[0]) )))));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0455</span>:     mask |= one &lt;&lt; j[3]</pre>
<pre class='cython code score-0 '>__pyx_t_5 = 3;__pyx_v_mask = (__pyx_v_mask | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_j.data + __pyx_t_5 * __pyx_v_j.strides[0]) )))));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0456</span>:     mask |= one &lt;&lt; j[4]</pre>
<pre class='cython code score-0 '>__pyx_t_5 = 4;__pyx_v_mask = (__pyx_v_mask | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_j.data + __pyx_t_5 * __pyx_v_j.strides[0]) )))));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0457</span>:     mask |= one &lt;&lt; j[5]</pre>
<pre class='cython code score-0 '>__pyx_t_5 = 5;__pyx_v_mask = (__pyx_v_mask | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_j.data + __pyx_t_5 * __pyx_v_j.strides[0]) )))));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0458</span>:     mask |= one &lt;&lt; j[6]</pre>
<pre class='cython code score-0 '>__pyx_t_5 = 6;__pyx_v_mask = (__pyx_v_mask | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_j.data + __pyx_t_5 * __pyx_v_j.strides[0]) )))));</pre><pre class="cython line score-0">&#xA0;<span class="">0459</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0460</span>:     hero = cy_evaluate(one &lt;&lt; j[0] | one &lt;&lt; j[1] | mask, seven)</pre>
<pre class='cython code score-0 '>__pyx_t_5 = 0;__pyx_t_6 = 1;__pyx_v_hero = __pyx_f_8ccluster_cy_evaluate((((__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_j.data + __pyx_t_5 * __pyx_v_j.strides[0]) )))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_j.data + __pyx_t_6 * __pyx_v_j.strides[0]) ))))) | __pyx_v_mask), __pyx_v_seven);</pre><pre class="cython line score-0">&#xA0;<span class="">0461</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0462</span>:     for i in range(0, N_CARDS - T_CARDS - 3):</pre>
<pre class='cython code score-0 '>__pyx_t_7 = ((__pyx_v_N_CARDS - __pyx_v_T_CARDS) - 3);__pyx_t_8 = __pyx_t_7;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_8; __pyx_t_3+=1) {__pyx_v_i = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0463</span>:         for k in range(i+1, N_CARDS - T_CARDS - 2):</pre>
<pre class='cython code score-0 '>__pyx_t_9 = ((__pyx_v_N_CARDS - __pyx_v_T_CARDS) - 2);__pyx_t_10 = __pyx_t_9;for (__pyx_t_11 = (__pyx_v_i + 1); __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {__pyx_v_k = __pyx_t_11;</pre><pre class="cython line score-0">&#xA0;<span class="">0464</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0465</span>:             v = cy_evaluate(one &lt;&lt; x[i] | one &lt;&lt; x[k] | mask, seven)</pre>
<pre class='cython code score-0 '>__pyx_v_v = __pyx_f_8ccluster_cy_evaluate((((__pyx_v_one &lt;&lt; (__pyx_v_x[__pyx_v_i])) | (__pyx_v_one &lt;&lt; (__pyx_v_x[__pyx_v_k]))) | __pyx_v_mask), __pyx_v_seven);</pre><pre class="cython line score-0">&#xA0;<span class="">0466</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0467</span>:             if(hero &gt; v):</pre>
<pre class='cython code score-0 '>__pyx_t_4 = (__pyx_v_hero &gt; __pyx_v_v);if (__pyx_t_4) {goto __pyx_L10;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0468</span>:                 twl_tiewinloss[1] += 1</pre>
<pre class='cython code score-0 '>__pyx_t_6 = 1;*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_twl_tiewinloss.data + __pyx_t_6 * __pyx_v_twl_tiewinloss.strides[0]) )) += 1;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0469</span>:             elif(v &gt; hero):</pre>
<pre class='cython code score-0 '>__pyx_t_4 = (__pyx_v_v &gt; __pyx_v_hero);if (__pyx_t_4) {goto __pyx_L10;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0470</span>:                 twl_tiewinloss[2] += 1</pre>
<pre class='cython code score-0 '>__pyx_t_6 = 2;*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_twl_tiewinloss.data + __pyx_t_6 * __pyx_v_twl_tiewinloss.strides[0]) )) += 1;</pre><pre class="cython line score-0">&#xA0;<span class="">0471</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0472</span>:                 twl_tiewinloss[0] += 1</pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_t_6 = 0;*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_twl_tiewinloss.data + __pyx_t_6 * __pyx_v_twl_tiewinloss.strides[0]) )) += 1;}__pyx_L10:;}}</pre><pre class="cython line score-0">&#xA0;<span class="">0473</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0474</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0475</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0476</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0477</span>: @cython.initializedcheck(False)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0478</span>: cdef int n_less(int16[:] X, int16 n) nogil:</pre>
<pre class='cython code score-0 '>static int __pyx_f_8ccluster_n_less(__Pyx_memviewslice __pyx_v_X, __pyx_t_8ccluster_int16 __pyx_v_n) {int __pyx_v_i;int __pyx_v_j;int __pyx_v_length_X;int __pyx_r;/* function exit code */__pyx_L0:;return __pyx_r;}</pre><pre class="cython line score-0">&#xA0;<span class="">0479</span>:     cdef:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0480</span>:         int i, j</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0481</span>:         int length_X = X.shape[0]</pre>
<pre class='cython code score-0 '>__pyx_v_length_X = (__pyx_v_X.shape[0]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0482</span>:     i = 0</pre>
<pre class='cython code score-0 '>__pyx_v_i = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0483</span>:     for j in range(length_X):</pre>
<pre class='cython code score-0 '>__pyx_t_1 = __pyx_v_length_X;__pyx_t_2 = __pyx_t_1;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {__pyx_v_j = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0484</span>:         if (X[j] &lt; n):</pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_j;__pyx_t_5 = ((*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_X.data + __pyx_t_4 * __pyx_v_X.strides[0]) ))) &lt; __pyx_v_n);if (__pyx_t_5) {}}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0485</span>:             i+=1</pre>
<pre class='cython code score-0 '>__pyx_v_i = (__pyx_v_i + 1);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0486</span>:     return i</pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_v_i;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0487</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0488</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0489</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0490</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0491</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0492</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0493</span>: cdef float32 emd_c(int p, float32[:] u_values, float32[:] v_values, float32[:] all_values,float32[:] all_valuesa, float32[:] all_valuesaa, float32[:] deltas, u_weights=None, v_weights=None) nogil:</pre>
<pre class='cython code score-0 '>static __pyx_t_8ccluster_float32 __pyx_f_8ccluster_emd_c(CYTHON_UNUSED int __pyx_v_p, __Pyx_memviewslice __pyx_v_u_values, __Pyx_memviewslice __pyx_v_v_values, __Pyx_memviewslice __pyx_v_all_values, __Pyx_memviewslice __pyx_v_all_valuesa, __Pyx_memviewslice __pyx_v_all_valuesaa, __Pyx_memviewslice __pyx_v_deltas, struct __pyx_opt_args_8ccluster_emd_c *__pyx_optional_args) {int __pyx_v_i;int __pyx_v_all_len;__pyx_t_8ccluster_float32 __pyx_r;if (__pyx_optional_args) {}/* function exit code */__pyx_L0:;return __pyx_r;}struct __pyx_opt_args_8ccluster_emd_c {int __pyx_n;PyObject *u_weights;PyObject *v_weights;};</pre><pre class="cython line score-0">&#xA0;<span class="">0494</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0495</span>:     # the extra arrays after v_values are empty arrays to be filled by the funciton.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0496</span>:     # for best performance, it is up to you to define these empty arrays outside of heavy looping.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0497</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0498</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0499</span>:     insertion_sort_inplace_cython_float32(u_values)</pre>
<pre class='cython code score-0 '>__pyx_f_8ccluster_insertion_sort_inplace_cython_float32(__pyx_v_u_values);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0500</span>:     insertion_sort_inplace_cython_float32(v_values)</pre>
<pre class='cython code score-0 '>__pyx_f_8ccluster_insertion_sort_inplace_cython_float32(__pyx_v_v_values);</pre><pre class="cython line score-0">&#xA0;<span class="">0501</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0502</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0503</span>:     cdef int i</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0504</span>:     cdef int all_len = len(u_values) + len(v_values)</pre>
<pre class='cython code score-4 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_u_values); __pyx_t_2 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_v_values); __pyx_v_all_len = (__pyx_t_1 + __pyx_t_2);</pre><pre class="cython line score-0">&#xA0;<span class="">0505</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0506</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0507</span>:     for i in range(len(u_values)):</pre>
<pre class='cython code score-2 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_u_values); __pyx_t_1 = __pyx_t_2;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_1; __pyx_t_3+=1) {__pyx_v_i = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0508</span>:         all_values[i] = u_values[i]</pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_i;if (__pyx_t_4 &lt; 0) __pyx_t_4 += __pyx_v_u_values.shape[0];__pyx_t_5 = __pyx_v_i;if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_all_values.shape[0];*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_all_values.data + __pyx_t_5 * __pyx_v_all_values.strides[0]) )) = (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_u_values.data + __pyx_t_4 * __pyx_v_u_values.strides[0]) )));}</pre><pre class="cython line score-0">&#xA0;<span class="">0509</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0510</span>:     for i in range(len(u_values), all_len):</pre>
<pre class='cython code score-2 '>__pyx_t_3 = __pyx_v_all_len;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_u_values); __pyx_t_6 = __pyx_t_3;for (__pyx_t_7 = __pyx_t_2; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {__pyx_v_i = __pyx_t_7;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0511</span>:         all_values[i] = v_values[i-len(u_values)]</pre>
<pre class='cython code score-2 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_u_values); __pyx_t_4 = (__pyx_v_i - __pyx_t_1);if (__pyx_t_4 &lt; 0) __pyx_t_4 += __pyx_v_v_values.shape[0];__pyx_t_5 = __pyx_v_i;if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_all_values.shape[0];*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_all_values.data + __pyx_t_5 * __pyx_v_all_values.strides[0]) )) = (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_v_values.data + __pyx_t_4 * __pyx_v_v_values.strides[0]) )));}</pre><pre class="cython line score-0">&#xA0;<span class="">0512</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0513</span>:     insertion_sort_inplace_cython_float32(all_values)</pre>
<pre class='cython code score-0 '>__pyx_f_8ccluster_insertion_sort_inplace_cython_float32(__pyx_v_all_values);</pre><pre class="cython line score-0">&#xA0;<span class="">0514</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0515</span>:     for i in range(all_len-1):</pre>
<pre class='cython code score-0 '>__pyx_t_8 = (__pyx_v_all_len - 1);__pyx_t_9 = __pyx_t_8;for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_9; __pyx_t_3+=1) {__pyx_v_i = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0516</span>:         deltas[i] = all_values[i+1] - all_values[i]</pre>
<pre class='cython code score-0 '>__pyx_t_4 = (__pyx_v_i + 1);if (__pyx_t_4 &lt; 0) __pyx_t_4 += __pyx_v_all_values.shape[0];__pyx_t_5 = __pyx_v_i;if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_all_values.shape[0];__pyx_t_10 = __pyx_v_i;if (__pyx_t_10 &lt; 0) __pyx_t_10 += __pyx_v_deltas.shape[0];*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_deltas.data + __pyx_t_10 * __pyx_v_deltas.strides[0]) )) = ((*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_all_values.data + __pyx_t_4 * __pyx_v_all_values.strides[0]) ))) - (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_all_values.data + __pyx_t_5 * __pyx_v_all_values.strides[0]) ))));}</pre><pre class="cython line score-0">&#xA0;<span class="">0517</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0518</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0519</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0520</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0521</span>:     return all_ind(u_values, v_values, all_values, all_valuesa, all_valuesaa, deltas)</pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_f_8ccluster_all_ind(__pyx_v_u_values, __pyx_v_v_values, __pyx_v_all_values, __pyx_v_all_valuesa, __pyx_v_all_valuesaa, __pyx_v_deltas);goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0522</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0523</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0524</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-173" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0525</span>: cpdef float32 emd_cp(int p, float32[:] u_values, float32[:] v_values, float32[:] _all_values,float32[:] _all_valuesa, float32[:] _all_valuesaa, float32[:] _deltas, u_weights=None, v_weights=None):</pre>
<pre class='cython code score-173 '>static PyObject *__pyx_pw_8ccluster_5emd_cp(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/static __pyx_t_8ccluster_float32 __pyx_f_8ccluster_emd_cp(CYTHON_UNUSED int __pyx_v_p, __Pyx_memviewslice __pyx_v_u_values, __Pyx_memviewslice __pyx_v_v_values, __Pyx_memviewslice __pyx_v__all_values, __Pyx_memviewslice __pyx_v__all_valuesa, __Pyx_memviewslice __pyx_v__all_valuesaa, __Pyx_memviewslice __pyx_v__deltas, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_8ccluster_emd_cp *__pyx_optional_args) {__pyx_t_8ccluster_float32 __pyx_r;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("emd_cp", 0);if (__pyx_optional_args) {}/* function exit code */__pyx_L0:;<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}/* Python wrapper */static PyObject *__pyx_pw_8ccluster_5emd_cp(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8ccluster_4emd_cp, "\n    Compute, between two one-dimensional distributions :math:`u` and\n    :math:`v`, whose respective CDFs are :math:`U` and :math:`V`, the\n    statistical distance that is defined as:\n\n    .. math::\n\n        l_p(u, v) = \\left( \\int_{-\\infty}^{+\\infty} |U-V|^p \\right)^{1/p}\n\n    p is a positive parameter; p = 1 gives the Wasserstein distance, p = 2\n    gives the energy distance.\n\n    Parameters\n    ----------\n    u_values, v_values : array_like\n        Values observed in the (empirical) distribution.\n    u_weights, v_weights : array_like, optional\n        Weight for each value. If unspecified, each value is assigned the same\n        weight.\n        `u_weights` (resp. `v_weights`) must have the same length as\n        `u_values` (resp. `v_values`). If the weight sum differs from 1, it\n        must still be positive and finite so that the weights can be normalized\n        to sum to 1.\n\n    Returns\n    -------\n    distance : float\n        The computed distance between the distributions.\n\n    Notes\n    -----\n    The input distributions can be empirical, therefore coming from samples\n    whose values are effectively inputs of the function, or they can be seen as\n    generalized functions, in which case they are weighted sums of Dirac delta\n    functions located at the specified values.\n\n    References\n    ----------\n    .. [1] Bellemare, Danihelka, Dabney, Mohamed, Lakshminarayanan, Hoyer,\n           Munos \"The Cramer Distance as a Solution to Biased Wasserstein\n           Gradients\" (2017). :arXiv:`1705.10743`.\n\n    ");static PyMethodDef __pyx_mdef_8ccluster_5emd_cp = {"emd_cp", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8ccluster_5emd_cp, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8ccluster_4emd_cp};static PyObject *__pyx_pw_8ccluster_5emd_cp(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {int __pyx_v_p;__Pyx_memviewslice __pyx_v_u_values = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_v_values = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v__all_values = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v__all_valuesa = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v__all_valuesaa = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v__deltas = { 0, 0, { 0 }, { 0 }, { 0 } };PyObject *__pyx_v_u_weights = 0;PyObject *__pyx_v_v_weights = 0;#if !CYTHON_METH_FASTCALLCYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);#endifCYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);PyObject *__pyx_r = 0;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("emd_cp (wrapper)", 0);{#if CYTHON_USE_MODULE_STATEPyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_p,&amp;__pyx_n_s_u_values,&amp;__pyx_n_s_v_values,&amp;__pyx_n_s_all_values,&amp;__pyx_n_s_all_valuesa,&amp;__pyx_n_s_all_valuesaa,&amp;__pyx_n_s_deltas,&amp;__pyx_n_s_u_weights,&amp;__pyx_n_s_v_weights,0};#elsestatic PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_p,&amp;__pyx_n_s_u_values,&amp;__pyx_n_s_v_values,&amp;__pyx_n_s_all_values,&amp;__pyx_n_s_all_valuesa,&amp;__pyx_n_s_all_valuesaa,&amp;__pyx_n_s_deltas,&amp;__pyx_n_s_u_weights,&amp;__pyx_n_s_v_weights,0};#endifPyObject* values[9] = {0,0,0,0,0,0,0,0,0};values[7] = ((PyObject *)Py_None);values[8] = ((PyObject *)Py_None);if (__pyx_kwds) {Py_ssize_t kw_args;switch (__pyx_nargs) {case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);CYTHON_FALLTHROUGH;case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);CYTHON_FALLTHROUGH;case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);CYTHON_FALLTHROUGH;case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);CYTHON_FALLTHROUGH;case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);CYTHON_FALLTHROUGH;case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);CYTHON_FALLTHROUGH;case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);CYTHON_FALLTHROUGH;case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);CYTHON_FALLTHROUGH;case  0: break;default: goto __pyx_L5_argtuple_error;}kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);switch (__pyx_nargs) {case  0:if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_p)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L3_error)</span>else goto __pyx_L5_argtuple_error;CYTHON_FALLTHROUGH;case  1:if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_u_values)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emd_cp", 0, 7, 9, 1); <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  2:if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v_values)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emd_cp", 0, 7, 9, 2); <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  3:if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_all_values)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emd_cp", 0, 7, 9, 3); <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  4:if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_all_valuesa)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emd_cp", 0, 7, 9, 4); <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  5:if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_all_valuesaa)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emd_cp", 0, 7, 9, 5); <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  6:if (likely((values[6] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deltas)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emd_cp", 0, 7, 9, 6); <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  7:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_u_weights);if (value) { values[7] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  8:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v_weights);if (value) { values[8] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L3_error)</span>}}if (unlikely(kw_args &gt; 0)) {const Py_ssize_t kwd_pos_args = __pyx_nargs;if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "emd_cp") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L3_error)</span>}} else {switch (__pyx_nargs) {case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);CYTHON_FALLTHROUGH;case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);CYTHON_FALLTHROUGH;case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);break;default: goto __pyx_L5_argtuple_error;}}__pyx_v_p = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_p == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L3_error)</span>__pyx_v_u_values = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_u_values.memview)) __PYX_ERR(0, 525, __pyx_L3_error)</span>__pyx_v_v_values = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_v_values.memview)) __PYX_ERR(0, 525, __pyx_L3_error)</span>__pyx_v__all_values = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v__all_values.memview)) __PYX_ERR(0, 525, __pyx_L3_error)</span>__pyx_v__all_valuesa = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(values[4], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v__all_valuesa.memview)) __PYX_ERR(0, 525, __pyx_L3_error)</span>__pyx_v__all_valuesaa = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(values[5], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v__all_valuesaa.memview)) __PYX_ERR(0, 525, __pyx_L3_error)</span>__pyx_v__deltas = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(values[6], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v__deltas.memview)) __PYX_ERR(0, 525, __pyx_L3_error)</span>__pyx_v_u_weights = values[7];__pyx_v_v_weights = values[8];}goto __pyx_L4_argument_unpacking_done;__pyx_L5_argtuple_error:;<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emd_cp", 0, 7, 9, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L3_error)</span>__pyx_L3_error:;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_u_values, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_values, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v__all_values, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v__all_valuesa, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v__all_valuesaa, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v__deltas, 1);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.emd_cp", __pyx_clineno, __pyx_lineno, __pyx_filename);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return NULL;__pyx_L4_argument_unpacking_done:;__pyx_r = __pyx_pf_8ccluster_4emd_cp(__pyx_self, __pyx_v_p, __pyx_v_u_values, __pyx_v_v_values, __pyx_v__all_values, __pyx_v__all_valuesa, __pyx_v__all_valuesaa, __pyx_v__deltas, __pyx_v_u_weights, __pyx_v_v_weights);/* function exit code */__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_u_values, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_v_values, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v__all_values, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v__all_valuesa, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v__all_valuesaa, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v__deltas, 1);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}static PyObject *__pyx_pf_8ccluster_4emd_cp(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_p, __Pyx_memviewslice __pyx_v_u_values, __Pyx_memviewslice __pyx_v_v_values, __Pyx_memviewslice __pyx_v__all_values, __Pyx_memviewslice __pyx_v__all_valuesa, __Pyx_memviewslice __pyx_v__all_valuesaa, __Pyx_memviewslice __pyx_v__deltas, PyObject *__pyx_v_u_weights, PyObject *__pyx_v_v_weights) {PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("emd_cp", 0);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);if (unlikely(!__pyx_v_u_values.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("u_values"); <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L1_error)</span> }if (unlikely(!__pyx_v_v_values.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("v_values"); <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L1_error)</span> }if (unlikely(!__pyx_v__all_values.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("_all_values"); <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L1_error)</span> }if (unlikely(!__pyx_v__all_valuesa.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("_all_valuesa"); <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L1_error)</span> }if (unlikely(!__pyx_v__all_valuesaa.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("_all_valuesaa"); <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L1_error)</span> }if (unlikely(!__pyx_v__deltas.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("_deltas"); <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L1_error)</span> }__pyx_t_2.__pyx_n = 2;__pyx_t_2.u_weights = __pyx_v_u_weights;__pyx_t_2.v_weights = __pyx_v_v_weights;__pyx_t_1 = __pyx_f_8ccluster_emd_cp(__pyx_v_p, __pyx_v_u_values, __pyx_v_v_values, __pyx_v__all_values, __pyx_v__all_valuesa, __pyx_v__all_valuesaa, __pyx_v__deltas, 0, &amp;__pyx_t_2); __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 525, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_r = __pyx_t_3;__pyx_t_3 = 0;goto __pyx_L0;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.emd_cp", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = NULL;__pyx_L0:;<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}__pyx_tuple__40 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_p, __pyx_n_s_u_values, __pyx_n_s_v_values, __pyx_n_s_all_values, __pyx_n_s_all_valuesa, __pyx_n_s_all_valuesaa, __pyx_n_s_deltas, __pyx_n_s_u_weights, __pyx_n_s_v_weights);<span class='error_goto'> if (unlikely(!__pyx_tuple__40)) __PYX_ERR(0, 525, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__40);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__40);__pyx_codeobj__41 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(9, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__40, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ccluster_pyx, __pyx_n_s_emd_cp, 525, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__41)) __PYX_ERR(0, 525, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8ccluster_5emd_cp, 0, __pyx_n_s_emd_cp, NULL, __pyx_n_s_ccluster, __pyx_d, ((PyObject *)__pyx_codeobj__41));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 525, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__42);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_emd_cp, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_tuple__42 = <span class='py_c_api'>PyTuple_Pack</span>(2, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__42)) __PYX_ERR(0, 525, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__42);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__42);struct __pyx_opt_args_8ccluster_emd_cp {int __pyx_n;PyObject *u_weights;PyObject *v_weights;};</pre><pre class="cython line score-0">&#xA0;<span class="">0526</span>:     r"""</pre>
<pre class="cython line score-0">&#xA0;<span class="">0527</span>:     Compute, between two one-dimensional distributions :math:`u` and</pre>
<pre class="cython line score-0">&#xA0;<span class="">0528</span>:     :math:`v`, whose respective CDFs are :math:`U` and :math:`V`, the</pre>
<pre class="cython line score-0">&#xA0;<span class="">0529</span>:     statistical distance that is defined as:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0530</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0531</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">0532</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0533</span>:         l_p(u, v) = \left( \int_{-\infty}^{+\infty} |U-V|^p \right)^{1/p}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0534</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0535</span>:     p is a positive parameter; p = 1 gives the Wasserstein distance, p = 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">0536</span>:     gives the energy distance.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0537</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0538</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0539</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0540</span>:     u_values, v_values : array_like</pre>
<pre class="cython line score-0">&#xA0;<span class="">0541</span>:         Values observed in the (empirical) distribution.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0542</span>:     u_weights, v_weights : array_like, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0543</span>:         Weight for each value. If unspecified, each value is assigned the same</pre>
<pre class="cython line score-0">&#xA0;<span class="">0544</span>:         weight.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0545</span>:         `u_weights` (resp. `v_weights`) must have the same length as</pre>
<pre class="cython line score-0">&#xA0;<span class="">0546</span>:         `u_values` (resp. `v_values`). If the weight sum differs from 1, it</pre>
<pre class="cython line score-0">&#xA0;<span class="">0547</span>:         must still be positive and finite so that the weights can be normalized</pre>
<pre class="cython line score-0">&#xA0;<span class="">0548</span>:         to sum to 1.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0549</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0550</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0551</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0552</span>:     distance : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">0553</span>:         The computed distance between the distributions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0554</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0555</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">0556</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">0557</span>:     The input distributions can be empirical, therefore coming from samples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0558</span>:     whose values are effectively inputs of the function, or they can be seen as</pre>
<pre class="cython line score-0">&#xA0;<span class="">0559</span>:     generalized functions, in which case they are weighted sums of Dirac delta</pre>
<pre class="cython line score-0">&#xA0;<span class="">0560</span>:     functions located at the specified values.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0561</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0562</span>:     References</pre>
<pre class="cython line score-0">&#xA0;<span class="">0563</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0564</span>:     .. [1] Bellemare, Danihelka, Dabney, Mohamed, Lakshminarayanan, Hoyer,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0565</span>:            Munos "The Cramer Distance as a Solution to Biased Wasserstein</pre>
<pre class="cython line score-0">&#xA0;<span class="">0566</span>:            Gradients" (2017). :arXiv:`1705.10743`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0567</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0568</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0569</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0570</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0571</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0572</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0573</span>:     return emd_c(1, u_values, v_values, _all_values, _all_valuesa, _all_valuesaa, _deltas)</pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_f_8ccluster_emd_c(1, __pyx_v_u_values, __pyx_v_v_values, __pyx_v__all_values, __pyx_v__all_valuesa, __pyx_v__all_valuesaa, __pyx_v__deltas, NULL);goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0574</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0575</span>: </pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0576</span>: def _validate_distribution(values, weights):</pre>
<pre class='cython code score-61 '>/* Python wrapper */static PyObject *__pyx_pw_8ccluster_7_validate_distribution(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8ccluster_6_validate_distribution, "\n    Validate the values and weights from a distribution input of `cdf_distance`\n    and return them as ndarray objects.\n\n    Parameters\n    ----------\n    values : array_like\n        Values observed in the (empirical) distribution.\n    weights : array_like\n        Weight for each value.\n\n    Returns\n    -------\n    values : ndarray\n        Values as ndarray.\n    weights : ndarray\n        Weights as ndarray.\n\n    ");static PyMethodDef __pyx_mdef_8ccluster_7_validate_distribution = {"_validate_distribution", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8ccluster_7_validate_distribution, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8ccluster_6_validate_distribution};static PyObject *__pyx_pw_8ccluster_7_validate_distribution(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {PyObject *__pyx_v_values = 0;PyObject *__pyx_v_weights = 0;#if !CYTHON_METH_FASTCALLCYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);#endifCYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);PyObject *__pyx_r = 0;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("_validate_distribution (wrapper)", 0);{#if CYTHON_USE_MODULE_STATEPyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_values,&amp;__pyx_n_s_weights,0};#elsestatic PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_values,&amp;__pyx_n_s_weights,0};#endifPyObject* values[2] = {0,0};if (__pyx_kwds) {Py_ssize_t kw_args;switch (__pyx_nargs) {case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);CYTHON_FALLTHROUGH;case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);CYTHON_FALLTHROUGH;case  0: break;default: goto __pyx_L5_argtuple_error;}kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);switch (__pyx_nargs) {case  0:if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_values)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 576, __pyx_L3_error)</span>else goto __pyx_L5_argtuple_error;CYTHON_FALLTHROUGH;case  1:if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_weights)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 576, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_validate_distribution", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 576, __pyx_L3_error)</span>}}if (unlikely(kw_args &gt; 0)) {const Py_ssize_t kwd_pos_args = __pyx_nargs;if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_validate_distribution") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 576, __pyx_L3_error)</span>}} else if (unlikely(__pyx_nargs != 2)) {goto __pyx_L5_argtuple_error;} else {values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);}__pyx_v_values = values[0];__pyx_v_weights = values[1];}goto __pyx_L4_argument_unpacking_done;__pyx_L5_argtuple_error:;<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_validate_distribution", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 576, __pyx_L3_error)</span>__pyx_L3_error:;<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster._validate_distribution", __pyx_clineno, __pyx_lineno, __pyx_filename);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return NULL;__pyx_L4_argument_unpacking_done:;__pyx_r = __pyx_pf_8ccluster_6_validate_distribution(__pyx_self, __pyx_v_values, __pyx_v_weights);int __pyx_lineno = 0;const char *__pyx_filename = NULL;int __pyx_clineno = 0;/* function exit code */<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}static PyObject *__pyx_pf_8ccluster_6_validate_distribution(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_values, PyObject *__pyx_v_weights) {PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("_validate_distribution", 0);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_values);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_weights);/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster._validate_distribution", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = NULL;__pyx_L0:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_values);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_weights);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}__pyx_tuple__43 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_values, __pyx_n_s_weights);<span class='error_goto'> if (unlikely(!__pyx_tuple__43)) __PYX_ERR(0, 576, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__43);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__43);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8ccluster_7_validate_distribution, 0, __pyx_n_s_validate_distribution, NULL, __pyx_n_s_ccluster, __pyx_d, ((PyObject *)__pyx_codeobj__44));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 576, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_validate_distribution, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 576, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_codeobj__44 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__43, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ccluster_pyx, __pyx_n_s_validate_distribution, 576, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__44)) __PYX_ERR(0, 576, __pyx_L1_error)</span></pre><pre class="cython line score-0">&#xA0;<span class="">0577</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0578</span>:     Validate the values and weights from a distribution input of `cdf_distance`</pre>
<pre class="cython line score-0">&#xA0;<span class="">0579</span>:     and return them as ndarray objects.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0580</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0581</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0582</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0583</span>:     values : array_like</pre>
<pre class="cython line score-0">&#xA0;<span class="">0584</span>:         Values observed in the (empirical) distribution.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0585</span>:     weights : array_like</pre>
<pre class="cython line score-0">&#xA0;<span class="">0586</span>:         Weight for each value.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0587</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0588</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0589</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0590</span>:     values : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">0591</span>:         Values as ndarray.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0592</span>:     weights : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">0593</span>:         Weights as ndarray.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0594</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0595</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0596</span>:     # Validate the value array.</pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0597</span>:     values = numpy.asarray(values, dtype=float)</pre>
<pre class='cython code score-25 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 597, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 597, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 597, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_values);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_values);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_values);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 597, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 597, __pyx_L1_error)</span>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 597, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_values, __pyx_t_4);__pyx_t_4 = 0;</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0598</span>:     if len(values) == 0:</pre>
<pre class='cython code score-5 '>__pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_values);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 598, __pyx_L1_error)</span>__pyx_t_6 = (__pyx_t_5 == 0);if (unlikely(__pyx_t_6)) {}</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0599</span>:         raise ValueError("Distribution can't be empty.")</pre>
<pre class='cython code score-10 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 599, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='error_goto'>__PYX_ERR(0, 599, __pyx_L1_error)</span>__pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Distribution_can_t_be_empty);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 599, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);</pre><pre class="cython line score-0">&#xA0;<span class="">0600</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0601</span>:     # Validate the weight array, if specified.</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0602</span>:     if weights is not None:</pre>
<pre class='cython code score-0 '>__pyx_t_6 = (__pyx_v_weights != Py_None);if (__pyx_t_6) {}</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0603</span>:         weights = numpy.asarray(weights, dtype=float)</pre>
<pre class='cython code score-25 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 603, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 603, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 603, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_weights);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_weights);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_weights);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 603, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 603, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 603, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_weights, __pyx_t_2);__pyx_t_2 = 0;</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0604</span>:         if len(weights) != len(values):</pre>
<pre class='cython code score-10 '>__pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_weights);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 604, __pyx_L1_error)</span>__pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_values);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 604, __pyx_L1_error)</span>__pyx_t_6 = (__pyx_t_5 != __pyx_t_7);if (unlikely(__pyx_t_6)) {}</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0605</span>:             raise ValueError('Value and weight array-likes for the same '</pre>
<pre class='cython code score-10 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 605, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>__PYX_ERR(0, 605, __pyx_L1_error)</span>__pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Value_and_weight_array_likes_for);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 605, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);</pre><pre class="cython line score-0">&#xA0;<span class="">0606</span>:                              'empirical distribution must be of the same size.')</pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0607</span>:         if numpy.any(weights &lt; 0):</pre>
<pre class='cython code score-28 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 607, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_any);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 607, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_weights, __pyx_int_0, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 607, __pyx_L1_error)</span>__pyx_t_3 = NULL;__pyx_t_8 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);__pyx_t_8 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_1};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 607, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;}__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 607, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (unlikely(__pyx_t_6)) {}</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0608</span>:             raise ValueError('All weights must be non-negative.')</pre>
<pre class='cython code score-10 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 608, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>__PYX_ERR(0, 608, __pyx_L1_error)</span>__pyx_tuple__9 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_All_weights_must_be_non_negative);<span class='error_goto'> if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 608, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__9);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__9);</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0609</span>:         if not 0 &lt; numpy.sum(weights) &lt; numpy.inf:</pre>
<pre class='cython code score-42 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 609, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 609, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = NULL;__pyx_t_8 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {__pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);if (likely(__pyx_t_4)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);__pyx_t_8 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_weights};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 609, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;}__pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_int_0, __pyx_t_2, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 609, __pyx_L1_error)</span>if (<span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1)) {<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 609, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_inf);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 609, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 609, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 609, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_9 = (!__pyx_t_6);if (unlikely(__pyx_t_9)) {}</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0610</span>:             raise ValueError('Weight array-like sum must be positive and '</pre>
<pre class='cython code score-10 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 610, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>__PYX_ERR(0, 610, __pyx_L1_error)</span>__pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Weight_array_like_sum_must_be_po);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 610, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);</pre><pre class="cython line score-0">&#xA0;<span class="">0611</span>:                              'finite. Set as None for an equal distribution of '</pre>
<pre class="cython line score-0">&#xA0;<span class="">0612</span>:                              'weight.')</pre>
<pre class="cython line score-0">&#xA0;<span class="">0613</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0614</span>:         return values, weights</pre>
<pre class='cython code score-10 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 614, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_values);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_values);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_values);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_weights);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_weights);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_weights);__pyx_r = __pyx_t_1;__pyx_t_1 = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0615</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0616</span>:     return values, None</pre>
<pre class='cython code score-10 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 616, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_values);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_values);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_values);<span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);<span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, Py_None);__pyx_r = __pyx_t_1;__pyx_t_1 = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0617</span>: </pre>
<pre class="cython line score-127" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0618</span>: cpdef emd(int p, u_values, v_values, u_weights=None, v_weights=None):</pre>
<pre class='cython code score-127 '>static PyObject *__pyx_pw_8ccluster_9emd(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/static PyObject *__pyx_f_8ccluster_emd(CYTHON_UNUSED int __pyx_v_p, PyObject *__pyx_v_u_values, PyObject *__pyx_v_v_values, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_8ccluster_emd *__pyx_optional_args) {PyObject *__pyx_v_u_weights = ((PyObject *)Py_None);PyObject *__pyx_v_v_weights = ((PyObject *)Py_None);PyObject *__pyx_v_u_sorter = NULL;PyObject *__pyx_v_v_sorter = NULL;PyObject *__pyx_v_all_values = NULL;PyObject *__pyx_v_deltas = NULL;PyObject *__pyx_v_u_cdf_indices = NULL;PyObject *__pyx_v_v_cdf_indices = NULL;PyObject *__pyx_v_u_cdf = NULL;PyObject *__pyx_v_u_sorted_cumweights = NULL;PyObject *__pyx_v_v_cdf = NULL;PyObject *__pyx_v_v_sorted_cumweights = NULL;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("emd", 0);if (__pyx_optional_args) {if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {__pyx_v_u_weights = __pyx_optional_args-&gt;u_weights;if (__pyx_optional_args-&gt;__pyx_n &gt; 1) {__pyx_v_v_weights = __pyx_optional_args-&gt;v_weights;}}}<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_u_values);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_v_values);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_u_weights);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_v_weights);/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.emd", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = 0;__pyx_L0:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_u_sorter);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v_sorter);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_all_values);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_deltas);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_u_cdf_indices);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v_cdf_indices);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_u_cdf);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_u_sorted_cumweights);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v_cdf);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v_sorted_cumweights);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_u_values);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v_values);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_u_weights);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v_weights);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}/* Python wrapper */static PyObject *__pyx_pw_8ccluster_9emd(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_8ccluster_8emd, "\n    Compute, between two one-dimensional distributions :math:`u` and\n    :math:`v`, whose respective CDFs are :math:`U` and :math:`V`, the\n    statistical distance that is defined as:\n\n    .. math::\n\n        l_p(u, v) = \\left( \\int_{-\\infty}^{+\\infty} |U-V|^p \\right)^{1/p}\n\n    p is a positive parameter; p = 1 gives the Wasserstein distance, p = 2\n    gives the energy distance.\n\n    Parameters\n    ----------\n    u_values, v_values : array_like\n        Values observed in the (empirical) distribution.\n    u_weights, v_weights : array_like, optional\n        Weight for each value. If unspecified, each value is assigned the same\n        weight.\n        `u_weights` (resp. `v_weights`) must have the same length as\n        `u_values` (resp. `v_values`). If the weight sum differs from 1, it\n        must still be positive and finite so that the weights can be normalized\n        to sum to 1.\n\n    Returns\n    -------\n    distance : float\n        The computed distance between the distributions.\n\n    Notes\n    -----\n    The input distributions can be empirical, therefore coming from samples\n    whose values are effectively inputs of the function, or they can be seen as\n    generalized functions, in which case they are weighted sums of Dirac delta\n    functions located at the specified values.\n\n    References\n    ----------\n    .. [1] Bellemare, Danihelka, Dabney, Mohamed, Lakshminarayanan, Hoyer,\n           Munos \"The Cramer Distance as a Solution to Biased Wasserstein\n           Gradients\" (2017). :arXiv:`1705.10743`.\n\n    ");static PyMethodDef __pyx_mdef_8ccluster_9emd = {"emd", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8ccluster_9emd, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_8ccluster_8emd};static PyObject *__pyx_pw_8ccluster_9emd(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {int __pyx_v_p;PyObject *__pyx_v_u_values = 0;PyObject *__pyx_v_v_values = 0;PyObject *__pyx_v_u_weights = 0;PyObject *__pyx_v_v_weights = 0;#if !CYTHON_METH_FASTCALLCYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);#endifCYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);PyObject *__pyx_r = 0;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("emd (wrapper)", 0);{#if CYTHON_USE_MODULE_STATEPyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_p,&amp;__pyx_n_s_u_values,&amp;__pyx_n_s_v_values,&amp;__pyx_n_s_u_weights,&amp;__pyx_n_s_v_weights,0};#elsestatic PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_p,&amp;__pyx_n_s_u_values,&amp;__pyx_n_s_v_values,&amp;__pyx_n_s_u_weights,&amp;__pyx_n_s_v_weights,0};#endifPyObject* values[5] = {0,0,0,0,0};values[3] = ((PyObject *)Py_None);values[4] = ((PyObject *)Py_None);if (__pyx_kwds) {Py_ssize_t kw_args;switch (__pyx_nargs) {case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);CYTHON_FALLTHROUGH;case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);CYTHON_FALLTHROUGH;case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);CYTHON_FALLTHROUGH;case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);CYTHON_FALLTHROUGH;case  0: break;default: goto __pyx_L5_argtuple_error;}kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);switch (__pyx_nargs) {case  0:if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_p)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L3_error)</span>else goto __pyx_L5_argtuple_error;CYTHON_FALLTHROUGH;case  1:if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_u_values)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emd", 0, 3, 5, 1); <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  2:if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v_values)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emd", 0, 3, 5, 2); <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  3:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_u_weights);if (value) { values[3] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  4:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_v_weights);if (value) { values[4] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L3_error)</span>}}if (unlikely(kw_args &gt; 0)) {const Py_ssize_t kwd_pos_args = __pyx_nargs;if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "emd") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L3_error)</span>}} else {switch (__pyx_nargs) {case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);CYTHON_FALLTHROUGH;case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);break;default: goto __pyx_L5_argtuple_error;}}__pyx_v_p = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_p == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L3_error)</span>__pyx_v_u_values = values[1];__pyx_v_v_values = values[2];__pyx_v_u_weights = values[3];__pyx_v_v_weights = values[4];}goto __pyx_L4_argument_unpacking_done;__pyx_L5_argtuple_error:;<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("emd", 0, 3, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L3_error)</span>__pyx_L3_error:;<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.emd", __pyx_clineno, __pyx_lineno, __pyx_filename);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return NULL;__pyx_L4_argument_unpacking_done:;__pyx_r = __pyx_pf_8ccluster_8emd(__pyx_self, __pyx_v_p, __pyx_v_u_values, __pyx_v_v_values, __pyx_v_u_weights, __pyx_v_v_weights);/* function exit code */<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}static PyObject *__pyx_pf_8ccluster_8emd(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_p, PyObject *__pyx_v_u_values, PyObject *__pyx_v_v_values, PyObject *__pyx_v_u_weights, PyObject *__pyx_v_v_weights) {PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("emd", 0);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);__pyx_t_2.__pyx_n = 2;__pyx_t_2.u_weights = __pyx_v_u_weights;__pyx_t_2.v_weights = __pyx_v_v_weights;__pyx_t_1 = __pyx_f_8ccluster_emd(__pyx_v_p, __pyx_v_u_values, __pyx_v_v_values, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 618, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_r = __pyx_t_1;__pyx_t_1 = 0;goto __pyx_L0;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.emd", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = NULL;__pyx_L0:;<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}__pyx_tuple__45 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_p, __pyx_n_s_u_values, __pyx_n_s_v_values, __pyx_n_s_u_weights, __pyx_n_s_v_weights);<span class='error_goto'> if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 618, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__45);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__45);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8ccluster_9emd, 0, __pyx_n_s_emd, NULL, __pyx_n_s_ccluster, __pyx_d, ((PyObject *)__pyx_codeobj__46));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 618, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__42);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_emd, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_codeobj__46 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__45, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ccluster_pyx, __pyx_n_s_emd, 618, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__46)) __PYX_ERR(0, 618, __pyx_L1_error)</span>struct __pyx_opt_args_8ccluster_emd {int __pyx_n;PyObject *u_weights;PyObject *v_weights;};</pre><pre class="cython line score-0">&#xA0;<span class="">0619</span>:     r"""</pre>
<pre class="cython line score-0">&#xA0;<span class="">0620</span>:     Compute, between two one-dimensional distributions :math:`u` and</pre>
<pre class="cython line score-0">&#xA0;<span class="">0621</span>:     :math:`v`, whose respective CDFs are :math:`U` and :math:`V`, the</pre>
<pre class="cython line score-0">&#xA0;<span class="">0622</span>:     statistical distance that is defined as:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0623</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0624</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">0625</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0626</span>:         l_p(u, v) = \left( \int_{-\infty}^{+\infty} |U-V|^p \right)^{1/p}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0627</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0628</span>:     p is a positive parameter; p = 1 gives the Wasserstein distance, p = 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">0629</span>:     gives the energy distance.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0630</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0631</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0632</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0633</span>:     u_values, v_values : array_like</pre>
<pre class="cython line score-0">&#xA0;<span class="">0634</span>:         Values observed in the (empirical) distribution.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0635</span>:     u_weights, v_weights : array_like, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0636</span>:         Weight for each value. If unspecified, each value is assigned the same</pre>
<pre class="cython line score-0">&#xA0;<span class="">0637</span>:         weight.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0638</span>:         `u_weights` (resp. `v_weights`) must have the same length as</pre>
<pre class="cython line score-0">&#xA0;<span class="">0639</span>:         `u_values` (resp. `v_values`). If the weight sum differs from 1, it</pre>
<pre class="cython line score-0">&#xA0;<span class="">0640</span>:         must still be positive and finite so that the weights can be normalized</pre>
<pre class="cython line score-0">&#xA0;<span class="">0641</span>:         to sum to 1.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0642</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0643</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0644</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0645</span>:     distance : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">0646</span>:         The computed distance between the distributions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0647</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0648</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">0649</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">0650</span>:     The input distributions can be empirical, therefore coming from samples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0651</span>:     whose values are effectively inputs of the function, or they can be seen as</pre>
<pre class="cython line score-0">&#xA0;<span class="">0652</span>:     generalized functions, in which case they are weighted sums of Dirac delta</pre>
<pre class="cython line score-0">&#xA0;<span class="">0653</span>:     functions located at the specified values.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0654</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0655</span>:     References</pre>
<pre class="cython line score-0">&#xA0;<span class="">0656</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0657</span>:     .. [1] Bellemare, Danihelka, Dabney, Mohamed, Lakshminarayanan, Hoyer,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0658</span>:            Munos "The Cramer Distance as a Solution to Biased Wasserstein</pre>
<pre class="cython line score-0">&#xA0;<span class="">0659</span>:            Gradients" (2017). :arXiv:`1705.10743`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0660</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0661</span>:     """</pre>
<pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0662</span>:     u_values, u_weights = _validate_distribution(u_values, u_weights)</pre>
<pre class='cython code score-64 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_validate_distribution);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 662, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_u_values, __pyx_v_u_weights};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 662, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {PyObject* sequence = __pyx_t_1;Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);if (unlikely(size != 2)) {if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);<span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>}#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFSif (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {__pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); } else {__pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); }<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);#else__pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 662, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 662, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);#endif<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;} else {Py_ssize_t index = -1;__pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 662, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_5);index = 0; __pyx_t_2 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);index = 1; __pyx_t_3 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_6(__pyx_t_5), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>__pyx_t_6 = NULL;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;goto __pyx_L4_unpacking_done;__pyx_L3_unpacking_failed:;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_6 = NULL;if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);<span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>__pyx_L4_unpacking_done:;}<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_u_values, __pyx_t_2);__pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_u_weights, __pyx_t_3);__pyx_t_3 = 0;</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0663</span>:     v_values, v_weights = _validate_distribution(v_values, v_weights)</pre>
<pre class='cython code score-64 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_validate_distribution);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 663, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_2)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_v_v_values, __pyx_v_v_weights};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 663, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {PyObject* sequence = __pyx_t_1;Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);if (unlikely(size != 2)) {if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);<span class='error_goto'>__PYX_ERR(0, 663, __pyx_L1_error)</span>}#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFSif (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {__pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); } else {__pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); }<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);#else__pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 663, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 663, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);#endif<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;} else {Py_ssize_t index = -1;__pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 663, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_5);index = 0; __pyx_t_3 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_3)) goto __pyx_L5_unpacking_failed;<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);index = 1; __pyx_t_2 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_2)) goto __pyx_L5_unpacking_failed;<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_6(__pyx_t_5), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 663, __pyx_L1_error)</span>__pyx_t_6 = NULL;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;goto __pyx_L6_unpacking_done;__pyx_L5_unpacking_failed:;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_6 = NULL;if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);<span class='error_goto'>__PYX_ERR(0, 663, __pyx_L1_error)</span>__pyx_L6_unpacking_done:;}<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_v_values, __pyx_t_3);__pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_v_weights, __pyx_t_2);__pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0664</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0665</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0666</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0667</span>:     u_sorter = numpy.argsort(u_values)</pre>
<pre class='cython code score-19 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 667, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_argsort);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 667, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_2)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_u_values};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 667, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}__pyx_v_u_sorter = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0668</span>:     v_sorter = numpy.argsort(v_values)</pre>
<pre class='cython code score-19 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 668, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_argsort);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 668, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_v_values};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 668, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}__pyx_v_v_sorter = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0669</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0670</span>:     all_values = numpy.concatenate((u_values, v_values))</pre>
<pre class='cython code score-29 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 670, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_concatenate);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 670, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 670, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_u_values);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_u_values);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_u_values);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_v_values);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_v_values);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_v_values);__pyx_t_5 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_5)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_2};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 670, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}__pyx_v_all_values = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0671</span>:     all_values.sort(kind='mergesort')</pre>
<pre class='cython code score-14 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_all_values, __pyx_n_s_sort);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 671, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 671, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_kind, __pyx_n_u_mergesort) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 671, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 671, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0672</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0673</span>:     # Compute the differences between pairs of successive values of u and v.</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0674</span>:     deltas = numpy.diff(all_values)</pre>
<pre class='cython code score-19 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 674, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_diff);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 674, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_all_values};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 674, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;}__pyx_v_deltas = __pyx_t_2;__pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0675</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0676</span>:     # Get the respective positions of the values of u and v among the values of</pre>
<pre class="cython line score-0">&#xA0;<span class="">0677</span>:     # both distributions.</pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0678</span>:     u_cdf_indices = u_values[u_sorter].searchsorted(all_values[:-1], 'right')</pre>
<pre class='cython code score-22 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_u_values, __pyx_v_u_sorter);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 678, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_searchsorted);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 678, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_all_values, 0, -1L, NULL, NULL, &amp;__pyx_slice__6, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 678, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_5 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_5)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_t_1, __pyx_n_u_right};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 678, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}__pyx_v_u_cdf_indices = __pyx_t_2;__pyx_t_2 = 0;</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0679</span>:     v_cdf_indices = v_values[v_sorter].searchsorted(all_values[:-1], 'right')</pre>
<pre class='cython code score-22 '>__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_v_values, __pyx_v_v_sorter);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 679, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_searchsorted);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 679, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_all_values, 0, -1L, NULL, NULL, &amp;__pyx_slice__6, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 679, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_5 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {__pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);if (likely(__pyx_t_5)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_t_3, __pyx_n_u_right};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 679, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;}__pyx_v_v_cdf_indices = __pyx_t_2;__pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0680</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0681</span>:     # Calculate the CDFs of u and v using their weights, if specified.</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0682</span>:     if u_weights is None:</pre>
<pre class='cython code score-0 '>__pyx_t_7 = (__pyx_v_u_weights == Py_None);if (__pyx_t_7) {goto __pyx_L7;}</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0683</span>:         u_cdf = u_cdf_indices / u_values.size</pre>
<pre class='cython code score-5 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_u_values, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 683, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_u_cdf_indices, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 683, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_u_cdf = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0684</span>:     else:</pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0685</span>:         u_sorted_cumweights = numpy.concatenate(([0],</pre>
<pre class='cython code score-34 '>/*else*/ {<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 685, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_concatenate);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 685, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 685, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);<span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_int_0);__pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 685, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_2);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_5);__pyx_t_2 = 0;__pyx_t_5 = 0;__pyx_t_5 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_5)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_9};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 685, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}__pyx_v_u_sorted_cumweights = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0686</span>:                                               numpy.cumsum(u_weights[u_sorter])))</pre>
<pre class='cython code score-22 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 686, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 686, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_u_weights, __pyx_v_u_sorter);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 686, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_10 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {__pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);if (likely(__pyx_t_10)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_8};__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 686, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;}</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0687</span>:         u_cdf = u_sorted_cumweights[u_cdf_indices] / u_sorted_cumweights[-1]</pre>
<pre class='cython code score-8 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_u_sorted_cumweights, __pyx_v_u_cdf_indices);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 687, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_u_sorted_cumweights, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 687, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 687, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_v_u_cdf = __pyx_t_9;__pyx_t_9 = 0;}__pyx_L7:;</pre><pre class="cython line score-0">&#xA0;<span class="">0688</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0689</span>:     if v_weights is None:</pre>
<pre class='cython code score-0 '>__pyx_t_7 = (__pyx_v_v_weights == Py_None);if (__pyx_t_7) {goto __pyx_L8;}</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0690</span>:         v_cdf = v_cdf_indices / v_values.size</pre>
<pre class='cython code score-5 '>__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_v_values, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 690, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_v_cdf_indices, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 690, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_v_v_cdf = __pyx_t_3;__pyx_t_3 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0691</span>:     else:</pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0692</span>:         v_sorted_cumweights = numpy.concatenate(([0],</pre>
<pre class='cython code score-34 '>/*else*/ {<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 692, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_concatenate);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 692, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_9 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 692, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);<span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_int_0);__pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 692, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_9);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_5);__pyx_t_9 = 0;__pyx_t_5 = 0;__pyx_t_5 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {__pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);if (likely(__pyx_t_5)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_8};__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 692, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;}__pyx_v_v_sorted_cumweights = __pyx_t_3;__pyx_t_3 = 0;</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0693</span>:                                               numpy.cumsum(v_weights[v_sorter])))</pre>
<pre class='cython code score-22 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 693, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 693, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_v_weights, __pyx_v_v_sorter);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 693, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_10 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {__pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);if (likely(__pyx_t_10)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_2};__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 693, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;}</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0694</span>:         v_cdf = v_sorted_cumweights[v_cdf_indices] / v_sorted_cumweights[-1]</pre>
<pre class='cython code score-8 '>__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_v_sorted_cumweights, __pyx_v_v_cdf_indices);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 694, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_v_sorted_cumweights, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 694, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 694, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_v_v_cdf = __pyx_t_8;__pyx_t_8 = 0;}__pyx_L8:;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0695</span>:     print(u_cdf)</pre>
<pre class='cython code score-3 '>__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_v_u_cdf);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 695, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0696</span>:     print(v_cdf)</pre>
<pre class='cython code score-3 '>__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_v_v_cdf);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 696, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0697</span>:     # Compute the value of the integral based on the CDFs.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0698</span>:     # If p = 1 or p = 2, we avoid using numpy.power, which introduces an overhead</pre>
<pre class="cython line score-0">&#xA0;<span class="">0699</span>:     # of about 15%.</pre>
<pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0700</span>:     return numpy.sum(numpy.multiply(numpy.abs(u_cdf - v_cdf), deltas))</pre>
<pre class='cython code score-66 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 700, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 700, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 700, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_multiply);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 700, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 700, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_abs);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 700, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_u_cdf, __pyx_v_v_cdf);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 700, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_11 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {__pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);if (likely(__pyx_t_11)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_t_2};__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 700, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;}__pyx_t_10 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {__pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);if (likely(__pyx_t_10)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_10, __pyx_t_5, __pyx_v_deltas};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 700, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;}__pyx_t_9 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_9)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_t_1};__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 700, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}__pyx_r = __pyx_t_8;__pyx_t_8 = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0701</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0702</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0703</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0704</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0705</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0706</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0707</span>: </pre>
<pre class="cython line score-107" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0708</span>: @cython.boundscheck(False)</pre>
<pre class='cython code score-107 '>/* Python wrapper */static PyObject *__pyx_pw_8ccluster_11do_calc(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/static PyMethodDef __pyx_mdef_8ccluster_11do_calc = {"do_calc", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8ccluster_11do_calc, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};static PyObject *__pyx_pw_8ccluster_11do_calc(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {__pyx_t_5numpy_int64_t __pyx_v_os;__Pyx_memviewslice __pyx_v_x = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_y = { 0, 0, { 0 }, { 0 }, { 0 } };int __pyx_v_dupes;#if !CYTHON_METH_FASTCALLCYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);#endifCYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);PyObject *__pyx_r = 0;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("do_calc (wrapper)", 0);{#if CYTHON_USE_MODULE_STATEPyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_os,&amp;__pyx_n_s_x,&amp;__pyx_n_s_y,&amp;__pyx_n_s_dupes,0};#elsestatic PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_os,&amp;__pyx_n_s_x,&amp;__pyx_n_s_y,&amp;__pyx_n_s_dupes,0};#endifPyObject* values[4] = {0,0,0,0};if (__pyx_kwds) {Py_ssize_t kw_args;switch (__pyx_nargs) {case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);CYTHON_FALLTHROUGH;case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);CYTHON_FALLTHROUGH;case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);CYTHON_FALLTHROUGH;case  0: break;default: goto __pyx_L5_argtuple_error;}kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);switch (__pyx_nargs) {case  0:if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_os)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 708, __pyx_L3_error)</span>else goto __pyx_L5_argtuple_error;CYTHON_FALLTHROUGH;case  1:if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 708, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("do_calc", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 708, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  2:if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 708, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("do_calc", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 708, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  3:if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dupes)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 708, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("do_calc", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 708, __pyx_L3_error)</span>}}if (unlikely(kw_args &gt; 0)) {const Py_ssize_t kwd_pos_args = __pyx_nargs;if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "do_calc") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 708, __pyx_L3_error)</span>}} else if (unlikely(__pyx_nargs != 4)) {goto __pyx_L5_argtuple_error;} else {values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);}__pyx_v_os = __Pyx_PyInt_As_npy_int64(values[0]); if (unlikely((__pyx_v_os == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 710, __pyx_L3_error)</span>__pyx_v_x = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_x.memview)) __PYX_ERR(0, 710, __pyx_L3_error)</span>__pyx_v_y = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_y.memview)) __PYX_ERR(0, 710, __pyx_L3_error)</span>__pyx_v_dupes = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]); if (unlikely((__pyx_v_dupes == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 710, __pyx_L3_error)</span>}goto __pyx_L4_argument_unpacking_done;__pyx_L5_argtuple_error:;<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("do_calc", 1, 4, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 708, __pyx_L3_error)</span>__pyx_L3_error:;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_x, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_y, 1);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.do_calc", __pyx_clineno, __pyx_lineno, __pyx_filename);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return NULL;__pyx_L4_argument_unpacking_done:;__pyx_r = __pyx_pf_8ccluster_10do_calc(__pyx_self, __pyx_v_os, __pyx_v_x, __pyx_v_y, __pyx_v_dupes);int __pyx_lineno = 0;const char *__pyx_filename = NULL;int __pyx_clineno = 0;/* function exit code */__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_x, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_y, 1);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}static PyObject *__pyx_pf_8ccluster_10do_calc(CYTHON_UNUSED PyObject *__pyx_self, __pyx_t_5numpy_int64_t __pyx_v_os, __Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y, int __pyx_v_dupes) {CYTHON_UNUSED unsigned PY_LONG_LONG __pyx_v_total;__pyx_t_5numpy_int64_t __pyx_v_i;__pyx_t_5numpy_int64_t __pyx_v_j;double __pyx_v_t1;double __pyx_v_t2;double __pyx_v_t;__pyx_t_5numpy_int64_t __pyx_v_x_shape;__pyx_t_5numpy_int64_t __pyx_v_y_shape;PyObject *__pyx_v_cd = NULL;PyObject *__pyx_v_z_memmap = NULL;PyObject *__pyx_v_z_f_memmap = NULL;__Pyx_memviewslice __pyx_v_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_z_f_view = { 0, 0, { 0 }, { 0 }, { 0 } };PyArrayObject *__pyx_v_oh = 0;__Pyx_memviewslice __pyx_v_oh_view = { 0, 0, { 0 }, { 0 }, { 0 } };unsigned PY_LONG_LONG __pyx_v_one;CYTHON_UNUSED unsigned PY_LONG_LONG __pyx_v_key;__Pyx_LocalBuf_ND __pyx_pybuffernd_oh;__Pyx_Buffer __pyx_pybuffer_oh;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("do_calc", 0);__pyx_pybuffer_oh.pybuffer.buf = NULL;__pyx_pybuffer_oh.refcount = 0;__pyx_pybuffernd_oh.data = NULL;__pyx_pybuffernd_oh.rcbuffer = &amp;__pyx_pybuffer_oh;/* function exit code */__pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);goto __pyx_L0;__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_5, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_17, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_29, 1);{ PyObject *__pyx_type, *__pyx_value, *__pyx_tb;<span class='pyx_c_api'>__Pyx_PyThreadState_declare__Pyx_PyThreadState_assign__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.do_calc", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = NULL;goto __pyx_L2;__pyx_L0:;<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);__pyx_L2:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cd);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_z_memmap);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_z_f_memmap);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_view, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_z_f_view, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_oh);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_oh_view, 1);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}__pyx_tuple__47 = <span class='py_c_api'>PyTuple_Pack</span>(22, __pyx_n_s_os, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_dupes, __pyx_n_s_total, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_c, __pyx_n_s_t1, __pyx_n_s_t2, __pyx_n_s_t, __pyx_n_s_x_shape, __pyx_n_s_y_shape, __pyx_n_s_cd, __pyx_n_s_z_memmap, __pyx_n_s_z_f_memmap, __pyx_n_s_z_view, __pyx_n_s_z_f_view, __pyx_n_s_oh, __pyx_n_s_oh_view, __pyx_n_s_one, __pyx_n_s_key);<span class='error_goto'> if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 708, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__47);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__47);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8ccluster_11do_calc, 0, __pyx_n_s_do_calc, NULL, __pyx_n_s_ccluster, __pyx_d, ((PyObject *)__pyx_codeobj__48));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 708, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_do_calc, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 708, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_codeobj__48 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 22, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__47, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ccluster_pyx, __pyx_n_s_do_calc, 708, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__48)) __PYX_ERR(0, 708, __pyx_L1_error)</span></pre><pre class="cython line score-0">&#xA0;<span class="">0709</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0710</span>: def do_calc(numpy.int64_t os, int16[:, :] x, int16[:, :] y, int dupes):</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0711</span>:     cdef unsigned long long int total = 0</pre>
<pre class='cython code score-0 '>__pyx_v_total = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0712</span>:     cdef numpy.int64_t i, j, c</pre>
<pre class="cython line score-0">&#xA0;<span class="">0713</span>:     cdef double t1, t2, t</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0714</span>:     cdef numpy.int64_t x_shape = x.shape[0]</pre>
<pre class='cython code score-0 '>__pyx_v_x_shape = (__pyx_v_x.shape[0]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0715</span>:     cdef numpy.int64_t y_shape = y.shape[0]</pre>
<pre class='cython code score-0 '>__pyx_v_y_shape = (__pyx_v_y.shape[0]);</pre><pre class="cython line score-0">&#xA0;<span class="">0716</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0717</span>:     cd = 0</pre>
<pre class='cython code score-1 '><span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);__pyx_v_cd = __pyx_int_0;</pre><pre class="cython line score-0">&#xA0;<span class="">0718</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0719</span>:     # cdef numpy.ndarray[int16, ndim=2] z = numpy.empty((x_shape * y_shape, x.shape[1] + y.shape[1] + 3), dtype=numpy.int16)</pre>
<pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0720</span>:     z_memmap = numpy.memmap('results/river.npy', mode = 'r+', dtype = numpy.int16, shape = (x_shape * (y_shape - dupes), 3), offset = os )</pre>
<pre class='cython code score-52 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 720, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 720, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 720, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_mode, __pyx_kp_u_r) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 720, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 720, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 720, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 720, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = __Pyx_PyInt_From_npy_int64((__pyx_v_x_shape * (__pyx_v_y_shape - __pyx_v_dupes)));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 720, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 720, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_3);__pyx_t_4 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_shape, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 720, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = __Pyx_PyInt_From_npy_int64(__pyx_v_os);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 720, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_offset, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 720, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__11, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 720, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_v_z_memmap = __pyx_t_3;__pyx_t_3 = 0;__pyx_tuple__11 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_results_river_npy);<span class='error_goto'> if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 720, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__11);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__11);</pre><pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0721</span>:     z_f_memmap = numpy.memmap('results/river_f.npy', mode = 'r+', dtype = numpy.float32, shape = (x_shape * (y_shape - dupes), 1), offset = os//3 * 2)</pre>
<pre class='cython code score-52 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 721, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 721, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 721, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_mode, __pyx_kp_u_r) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 721, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 721, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 721, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 721, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = __Pyx_PyInt_From_npy_int64((__pyx_v_x_shape * (__pyx_v_y_shape - __pyx_v_dupes)));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 721, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 721, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_int_1);__pyx_t_4 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_shape, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 721, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = __Pyx_PyInt_From_npy_int64((__Pyx_div___pyx_t_5numpy_int64_t(__pyx_v_os, 3) * 2));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 721, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_offset, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 721, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__12, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 721, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_v_z_f_memmap = __pyx_t_2;__pyx_t_2 = 0;__pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_results_river_f_npy);<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 721, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);</pre><pre class="cython line score-0">&#xA0;<span class="">0722</span>:     #mp_memmap = numpy.memmap('results/map.npy', mode = 'r+', dtype = numpy.ulonglong, shape = (x_shape * (y_shape - dupes), 1), offset = os//3 * 2)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0723</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0724</span>:     cdef int16 [:, :] z_view = z_memmap</pre>
<pre class='cython code score-0 '>__pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_v_z_memmap, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 724, __pyx_L1_error)</span>__pyx_v_z_view = __pyx_t_5;__pyx_t_5.memview = NULL;__pyx_t_5.data = NULL;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0725</span>:     cdef numpy.float32_t [:, :] z_f_view = z_f_memmap</pre>
<pre class='cython code score-0 '>__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_5numpy_float32_t(__pyx_v_z_f_memmap, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 725, __pyx_L1_error)</span>__pyx_v_z_f_view = __pyx_t_6;__pyx_t_6.memview = NULL;__pyx_t_6.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0726</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0727</span>:     #cdef unsigned long long [:, :] mp_view = mp_memmap</pre>
<pre class="cython line score-0">&#xA0;<span class="">0728</span>: </pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0729</span>:     cdef numpy.ndarray[int16, ndim=1] oh = numpy.empty(7, dtype=numpy.int16)</pre>
<pre class='cython code score-30 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 729, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 729, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 729, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 729, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 729, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 729, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__13, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 729, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 729, __pyx_L1_error)</span>__pyx_t_7 = ((PyArrayObject *)__pyx_t_4);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_int16, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_v_oh = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 729, __pyx_L1_error)</span>} else {__pyx_pybuffernd_oh.diminfo[0].strides = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_oh.diminfo[0].shape = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.shape[0];}}__pyx_t_7 = 0;__pyx_v_oh = ((PyArrayObject *)__pyx_t_4);__pyx_t_4 = 0;__pyx_tuple__13 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_7);<span class='error_goto'> if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 729, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__13);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__13);</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0730</span>:     cdef int16[:] oh_view = oh[:]</pre>
<pre class='cython code score-3 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_oh), __pyx_slice_);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 730, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 730, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_v_oh_view = __pyx_t_8;__pyx_t_8.memview = NULL;__pyx_t_8.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0731</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0732</span>:     cdef unsigned long long one = 1</pre>
<pre class='cython code score-0 '>__pyx_v_one = 1;</pre><pre class="cython line score-0">&#xA0;<span class="">0733</span>:     cdef unsigned long long key</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0734</span>:     for i in range(x_shape):</pre>
<pre class='cython code score-0 '>__pyx_t_9 = __pyx_v_x_shape;__pyx_t_10 = __pyx_t_9;for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {__pyx_v_i = __pyx_t_11;</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0735</span>:         t1=time.time()</pre>
<pre class='cython code score-30 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 735, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 735, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = NULL;__pyx_t_12 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_2)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_12 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_2, };__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_12, 0+__pyx_t_12);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 735, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}__pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_13 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 735, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_v_t1 = __pyx_t_13;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0736</span>:         for j in range(y.shape[0]):</pre>
<pre class='cython code score-0 '>__pyx_t_14 = (__pyx_v_y.shape[0]);__pyx_t_15 = __pyx_t_14;for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {__pyx_v_j = __pyx_t_16;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0737</span>:             oh_view[:2] = x[i]</pre>
<pre class='cython code score-0 '>__pyx_t_8.data = __pyx_v_x.data;__pyx_t_8.memview = __pyx_v_x.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_8, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_x.strides[0];
        __pyx_t_8.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_8.shape[0] = __pyx_v_x.shape[1];
__pyx_t_8.strides[0] = __pyx_v_x.strides[1];
    __pyx_t_8.suboffsets[0] = -1;

__pyx_t_17.data = __pyx_v_oh_view.data;__pyx_t_17.memview = __pyx_v_oh_view.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_17, 1);__pyx_t_12 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_17,
    __pyx_v_oh_view.shape[0], __pyx_v_oh_view.strides[0], __pyx_v_oh_view.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_12,
    0,
    2,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 737, __pyx_L1_error)</span>
}

if (unlikely((__pyx_memoryview_copy_contents(__pyx_t_8, __pyx_t_17, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 737, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_17, 1);__pyx_t_17.memview = NULL; __pyx_t_17.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);__pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0738</span>:             oh_view[2:] = y[j]</pre>
<pre class='cython code score-0 '>__pyx_t_8.data = __pyx_v_y.data;__pyx_t_8.memview = __pyx_v_y.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_8, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_j;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_y.strides[0];
        __pyx_t_8.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_8.shape[0] = __pyx_v_y.shape[1];
__pyx_t_8.strides[0] = __pyx_v_y.strides[1];
    __pyx_t_8.suboffsets[0] = -1;

__pyx_t_17.data = __pyx_v_oh_view.data;__pyx_t_17.memview = __pyx_v_oh_view.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_17, 1);__pyx_t_12 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_17,
    __pyx_v_oh_view.shape[0], __pyx_v_oh_view.strides[0], __pyx_v_oh_view.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_12,
    2,
    0,
    0,
    1,
    0,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 738, __pyx_L1_error)</span>
}

if (unlikely((__pyx_memoryview_copy_contents(__pyx_t_8, __pyx_t_17, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 738, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_17, 1);__pyx_t_17.memview = NULL; __pyx_t_17.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);__pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0739</span>:             if(not contains_duplicates(oh_view)):</pre>
<pre class='cython code score-0 '>__pyx_t_18 = (!(__pyx_f_8ccluster_contains_duplicates(__pyx_v_oh_view) != 0));if (__pyx_t_18) {}}</pre><pre class="cython line score-0">&#xA0;<span class="">0740</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0741</span>:                 get_ehs_fast(oh_view, z_view[cd])</pre>
<pre class='cython code score-7 '>__pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_cd); if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 741, __pyx_L1_error)</span>__pyx_t_8.data = __pyx_v_z_view.data;__pyx_t_8.memview = __pyx_v_z_view.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_8, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_t_19;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_z_view.strides[0];
        __pyx_t_8.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_8.shape[0] = __pyx_v_z_view.shape[1];
__pyx_t_8.strides[0] = __pyx_v_z_view.strides[1];
    __pyx_t_8.suboffsets[0] = -1;

__pyx_f_8ccluster_get_ehs_fast(__pyx_v_oh_view, __pyx_t_8);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);__pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0742</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0743</span>:                 key = (one &lt;&lt; oh_view[0]) | (one &lt;&lt; oh_view[1]) | (one &lt;&lt; oh_view[2]) | (one &lt;&lt; oh_view[3]) | (one &lt;&lt; oh_view[4]) | (one &lt;&lt; oh_view[5]) | (one &lt;&lt; oh_view[6])</pre>
<pre class='cython code score-0 '>__pyx_t_20 = 0;__pyx_t_21 = 1;__pyx_t_22 = 2;__pyx_t_23 = 3;__pyx_t_24 = 4;__pyx_t_25 = 5;__pyx_t_26 = 6;__pyx_v_key = (((((((__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_20 * __pyx_v_oh_view.strides[0]) )))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_21 * __pyx_v_oh_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_22 * __pyx_v_oh_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_23 * __pyx_v_oh_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_24 * __pyx_v_oh_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_25 * __pyx_v_oh_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_view.data + __pyx_t_26 * __pyx_v_oh_view.strides[0]) )))));</pre><pre class="cython line score-0">&#xA0;<span class="">0744</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0745</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0746</span>:                 z_f_view[cd] = (z_view[cd][1]+.5*z_view[cd][0]) / (z_view[cd][1]+z_view[cd][0]+z_view[cd][2])</pre>
<pre class='cython code score-47 '>__pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_cd); if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 746, __pyx_L1_error)</span>__pyx_t_26 = __pyx_t_19;__pyx_t_25 = 1;__pyx_t_27 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_cd); if (unlikely((__pyx_t_27 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 746, __pyx_L1_error)</span>__pyx_t_24 = __pyx_t_27;__pyx_t_23 = 0;__pyx_t_13 = ((*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_26 * __pyx_v_z_view.strides[0]) ) + __pyx_t_25 * __pyx_v_z_view.strides[1]) ))) + (.5 * (*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_24 * __pyx_v_z_view.strides[0]) ) + __pyx_t_23 * __pyx_v_z_view.strides[1]) )))));__pyx_t_27 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_cd); if (unlikely((__pyx_t_27 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 746, __pyx_L1_error)</span>__pyx_t_23 = __pyx_t_27;__pyx_t_24 = 1;__pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_cd); if (unlikely((__pyx_t_19 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 746, __pyx_L1_error)</span>__pyx_t_25 = __pyx_t_19;__pyx_t_26 = 0;__pyx_t_28 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_cd); if (unlikely((__pyx_t_28 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 746, __pyx_L1_error)</span>__pyx_t_22 = __pyx_t_28;__pyx_t_21 = 2;__pyx_t_12 = (((*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_23 * __pyx_v_z_view.strides[0]) ) + __pyx_t_24 * __pyx_v_z_view.strides[1]) ))) + (*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_25 * __pyx_v_z_view.strides[0]) ) + __pyx_t_26 * __pyx_v_z_view.strides[1]) )))) + (*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_z_view.data + __pyx_t_22 * __pyx_v_z_view.strides[0]) ) + __pyx_t_21 * __pyx_v_z_view.strides[1]) ))));if (unlikely(__pyx_t_12 == 0)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");<span class='error_goto'>__PYX_ERR(0, 746, __pyx_L1_error)</span>}__pyx_t_28 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_cd); if (unlikely((__pyx_t_28 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 746, __pyx_L1_error)</span>__pyx_t_29.data = __pyx_v_z_f_view.data;__pyx_t_29.memview = __pyx_v_z_f_view.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_29, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_t_28;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_z_f_view.strides[0];
        __pyx_t_29.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_29.shape[0] = __pyx_v_z_f_view.shape[1];
__pyx_t_29.strides[0] = __pyx_v_z_f_view.strides[1];
    __pyx_t_29.suboffsets[0] = -1;

{__pyx_t_5numpy_float32_t __pyx_temp_scalar = (__pyx_t_13 / ((double)__pyx_t_12));{Py_ssize_t __pyx_temp_extent_0 = __pyx_t_29.shape[0];Py_ssize_t __pyx_temp_stride_0 = __pyx_t_29.strides[0];char *__pyx_temp_pointer_0;Py_ssize_t __pyx_temp_idx_0;__pyx_temp_pointer_0 = __pyx_t_29.data;for (__pyx_temp_idx_0 = 0; __pyx_temp_idx_0 &lt; __pyx_temp_extent_0; __pyx_temp_idx_0++) {*((__pyx_t_5numpy_float32_t *) __pyx_temp_pointer_0) = __pyx_temp_scalar;__pyx_temp_pointer_0 += __pyx_temp_stride_0;}}}__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_29, 1);__pyx_t_29.memview = NULL; __pyx_t_29.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0747</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0748</span>:                 #mp_view[cd] = key</pre>
<pre class="cython line score-0">&#xA0;<span class="">0749</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0750</span>:                 cd += 1</pre>
<pre class='cython code score-3 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_cd, __pyx_int_1, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 750, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_cd, __pyx_t_4);__pyx_t_4 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0751</span>: </pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0752</span>:         t2=time.time()</pre>
<pre class='cython code score-30 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 752, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 752, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = NULL;__pyx_t_12 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_12 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_3, };__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_12, 0+__pyx_t_12);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 752, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}__pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_13 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 752, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_v_t2 = __pyx_t_13;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0753</span>:         t = t2-t1</pre>
<pre class='cython code score-0 '>__pyx_v_t = (__pyx_v_t2 - __pyx_v_t1);</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0754</span>:         print('~' + str(t*(x_shape - i)//60) + ' minutes until finished. ' + str(100*(i/x_shape))[:4] + '% done     ', end = '\r')</pre>
<pre class='cython code score-61 '>__pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(floor((__pyx_v_t * (__pyx_v_x_shape - __pyx_v_i)) / 60.0));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 754, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 754, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_u__3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 754, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlace</span>(__pyx_t_4, __pyx_kp_u_minutes_until_finished);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 754, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;if (unlikely(__pyx_v_x_shape == 0)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");<span class='error_goto'>__PYX_ERR(0, 754, __pyx_L1_error)</span>}__pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((100.0 * (((double)__pyx_v_i) / ((double)__pyx_v_x_shape))));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 754, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 754, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='py_c_api'>PySequence_GetSlice</span>(__pyx_t_3, 0, 4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 754, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlaceSafe</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 754, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlace</span>(__pyx_t_3, __pyx_kp_u_done);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 754, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 754, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);__pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 754, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_end, __pyx_kp_u__4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 754, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 754, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}</pre><pre class="cython line score-0">&#xA0;<span class="">0755</span>:     # mp_memmap.flush()</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0756</span>:     z_f_memmap.flush()</pre>
<pre class='cython code score-17 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z_f_memmap, __pyx_n_s_flush);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 756, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = NULL;__pyx_t_12 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);__pyx_t_12 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_3, };__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_12, 0+__pyx_t_12);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 756, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0757</span>:     z_memmap.flush()</pre>
<pre class='cython code score-17 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z_memmap, __pyx_n_s_flush);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 757, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = NULL;__pyx_t_12 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);__pyx_t_12 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_3, };__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_12, 0+__pyx_t_12);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 757, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0758</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0759</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0760</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0761</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0762</span>: @cython.initializedcheck(False)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0763</span>: cdef void insertion_sort_inplace_cython_float32(float32[:] A) nogil:</pre>
<pre class='cython code score-0 '>static void __pyx_f_8ccluster_insertion_sort_inplace_cython_float32(__Pyx_memviewslice __pyx_v_A) {int __pyx_v_i;int __pyx_v_j;__pyx_t_5numpy_float32_t __pyx_v_key;int __pyx_v_length_A;/* function exit code */}</pre><pre class="cython line score-0">&#xA0;<span class="">0764</span>:     cdef:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0765</span>:         int i, j</pre>
<pre class="cython line score-0">&#xA0;<span class="">0766</span>:         numpy.float32_t key</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0767</span>:         int length_A = A.shape[0]</pre>
<pre class='cython code score-0 '>__pyx_v_length_A = (__pyx_v_A.shape[0]);</pre><pre class="cython line score-0">&#xA0;<span class="">0768</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0769</span>:     for j in range(1, length_A):</pre>
<pre class='cython code score-0 '>__pyx_t_1 = __pyx_v_length_A;__pyx_t_2 = __pyx_t_1;for (__pyx_t_3 = 1; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {__pyx_v_j = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0770</span>:         key = A[j]</pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_j;__pyx_v_key = (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_4 * __pyx_v_A.strides[0]) )));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0771</span>:         i = j - 1</pre>
<pre class='cython code score-0 '>__pyx_v_i = (__pyx_v_j - 1);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0772</span>:         while (i &gt;= 0) &amp; (A[i] &gt; key):</pre>
<pre class='cython code score-0 '>while (1) {__pyx_t_4 = __pyx_v_i;__pyx_t_5 = ((__pyx_v_i &gt;= 0) &amp; ((*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_4 * __pyx_v_A.strides[0]) ))) &gt; __pyx_v_key));if (!__pyx_t_5) break;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0773</span>:             A[i + 1] = A[i]</pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_i;__pyx_t_6 = (__pyx_v_i + 1);*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_6 * __pyx_v_A.strides[0]) )) = (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_4 * __pyx_v_A.strides[0]) )));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0774</span>:             i = i - 1</pre>
<pre class='cython code score-0 '>__pyx_v_i = (__pyx_v_i - 1);}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0775</span>:         A[i + 1] = key</pre>
<pre class='cython code score-0 '>__pyx_t_4 = (__pyx_v_i + 1);*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_4 * __pyx_v_A.strides[0]) )) = __pyx_v_key;}</pre><pre class="cython line score-0">&#xA0;<span class="">0776</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0777</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0778</span>: #set elents in A to the index they appear in B</pre>
<pre class="cython line score-0">&#xA0;<span class="">0779</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0780</span>: @cython.initializedcheck(False)</pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0781</span>: cdef float32 all_ind(float32[:] A, float32[:] AA, float32[:] B, float32[:] BB, float32[:] BBB, float32[:] deltas) nogil:</pre>
<pre class='cython code score-6 '>static __pyx_t_8ccluster_float32 __pyx_f_8ccluster_all_ind(__Pyx_memviewslice __pyx_v_A, __Pyx_memviewslice __pyx_v_AA, __Pyx_memviewslice __pyx_v_B, __Pyx_memviewslice __pyx_v_BB, __Pyx_memviewslice __pyx_v_BBB, __Pyx_memviewslice __pyx_v_deltas) {__pyx_t_8ccluster_int32 __pyx_v_i;__pyx_t_8ccluster_int32 __pyx_v_j;__pyx_t_5numpy_float32_t __pyx_v_key;__pyx_t_5numpy_float32_t __pyx_v_pd;__pyx_t_8ccluster_int32 __pyx_v_length_A;__pyx_t_8ccluster_int32 __pyx_v_length_AA;__pyx_t_8ccluster_int32 __pyx_v_length_B;__pyx_t_8ccluster_float32 __pyx_r;/* function exit code */__pyx_L1_error:;#ifdef WITH_THREAD__pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();#endif<span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("ccluster.all_ind", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);__pyx_r = 0;#ifdef WITH_THREAD<span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);#endif__pyx_L0:;return __pyx_r;}</pre><pre class="cython line score-0">&#xA0;<span class="">0782</span>:     cdef:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0783</span>:         int32 i, j</pre>
<pre class="cython line score-0">&#xA0;<span class="">0784</span>:         numpy.float32_t key, keyy, pd</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0785</span>:         int32 length_A = len(A)</pre>
<pre class='cython code score-2 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_A); __pyx_v_length_A = __pyx_t_1;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0786</span>:         int32 length_AA = len(AA)</pre>
<pre class='cython code score-2 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_AA); __pyx_v_length_AA = __pyx_t_1;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0787</span>:         int32 length_B = len(B)</pre>
<pre class='cython code score-2 '>__pyx_t_1 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_v_B); __pyx_v_length_B = __pyx_t_1;</pre><pre class="cython line score-0">&#xA0;<span class="">0788</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0789</span>:     pd = 0</pre>
<pre class='cython code score-0 '>__pyx_v_pd = 0.0;</pre><pre class="cython line score-0">&#xA0;<span class="">0790</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0791</span>:     for j in range(length_B - 1):</pre>
<pre class='cython code score-0 '>__pyx_t_2 = (__pyx_v_length_B - 1);__pyx_t_3 = __pyx_t_2;for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {__pyx_v_j = __pyx_t_4;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0792</span>:         key = B[j]</pre>
<pre class='cython code score-0 '>__pyx_t_5 = __pyx_v_j;if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_B.shape[0];__pyx_v_key = (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_B.data + __pyx_t_5 * __pyx_v_B.strides[0]) )));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0793</span>:         i = 0</pre>
<pre class='cython code score-0 '>__pyx_v_i = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0794</span>:         while (i &lt; length_A) &amp; (A[i] &lt;= key):</pre>
<pre class='cython code score-0 '>while (1) {__pyx_t_5 = __pyx_v_i;if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_A.shape[0];__pyx_t_6 = ((__pyx_v_i &lt; __pyx_v_length_A) &amp; ((*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_5 * __pyx_v_A.strides[0]) ))) &lt;= __pyx_v_key));if (!__pyx_t_6) break;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0795</span>:             i = i + 1</pre>
<pre class='cython code score-0 '>__pyx_v_i = (__pyx_v_i + 1);}</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0796</span>:         BB[j] = i/(length_A)</pre>
<pre class='cython code score-9 '>if (unlikely(__pyx_v_length_A == 0)) {#ifdef WITH_THREADPyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();#endif<span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");#ifdef WITH_THREAD<span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);#endif<span class='error_goto'>__PYX_ERR(0, 796, __pyx_L1_error)</span>}__pyx_t_5 = __pyx_v_j;if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_BB.shape[0];*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_BB.data + __pyx_t_5 * __pyx_v_BB.strides[0]) )) = (((double)__pyx_v_i) / ((double)__pyx_v_length_A));</pre><pre class="cython line score-0">&#xA0;<span class="">0797</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0798</span>:         i = 0</pre>
<pre class='cython code score-0 '>__pyx_v_i = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0799</span>:         while (i &lt; length_AA) &amp; (AA[i] &lt;= key):</pre>
<pre class='cython code score-0 '>while (1) {__pyx_t_5 = __pyx_v_i;if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_AA.shape[0];__pyx_t_6 = ((__pyx_v_i &lt; __pyx_v_length_AA) &amp; ((*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_AA.data + __pyx_t_5 * __pyx_v_AA.strides[0]) ))) &lt;= __pyx_v_key));if (!__pyx_t_6) break;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0800</span>:             i = i + 1</pre>
<pre class='cython code score-0 '>__pyx_v_i = (__pyx_v_i + 1);}</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0801</span>:         BBB[j] = (i)/(length_AA)</pre>
<pre class='cython code score-9 '>if (unlikely(__pyx_v_length_AA == 0)) {#ifdef WITH_THREADPyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();#endif<span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");#ifdef WITH_THREAD<span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);#endif<span class='error_goto'>__PYX_ERR(0, 801, __pyx_L1_error)</span>}__pyx_t_5 = __pyx_v_j;if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_BBB.shape[0];*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_BBB.data + __pyx_t_5 * __pyx_v_BBB.strides[0]) )) = (((double)__pyx_v_i) / ((double)__pyx_v_length_AA));</pre><pre class="cython line score-0">&#xA0;<span class="">0802</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0803</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0804</span>:         if(BB[j]&gt;BBB[j]):</pre>
<pre class='cython code score-0 '>__pyx_t_5 = __pyx_v_j;if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_BB.shape[0];__pyx_t_7 = __pyx_v_j;if (__pyx_t_7 &lt; 0) __pyx_t_7 += __pyx_v_BBB.shape[0];__pyx_t_6 = ((*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_BB.data + __pyx_t_5 * __pyx_v_BB.strides[0]) ))) &gt; (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_BBB.data + __pyx_t_7 * __pyx_v_BBB.strides[0]) ))));if (__pyx_t_6) {goto __pyx_L9;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0805</span>:             pd += (BB[j] - BBB[j]) * deltas[j]</pre>
<pre class='cython code score-0 '>__pyx_t_7 = __pyx_v_j;if (__pyx_t_7 &lt; 0) __pyx_t_7 += __pyx_v_BB.shape[0];__pyx_t_5 = __pyx_v_j;if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_BBB.shape[0];__pyx_t_8 = __pyx_v_j;if (__pyx_t_8 &lt; 0) __pyx_t_8 += __pyx_v_deltas.shape[0];__pyx_v_pd = (__pyx_v_pd + (((*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_BB.data + __pyx_t_7 * __pyx_v_BB.strides[0]) ))) - (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_BBB.data + __pyx_t_5 * __pyx_v_BBB.strides[0]) )))) * (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_deltas.data + __pyx_t_8 * __pyx_v_deltas.strides[0]) )))));</pre><pre class="cython line score-0">&#xA0;<span class="">0806</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0807</span>:             pd += (BBB[j] - BB[j]) * deltas[j]</pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_t_8 = __pyx_v_j;if (__pyx_t_8 &lt; 0) __pyx_t_8 += __pyx_v_BBB.shape[0];__pyx_t_5 = __pyx_v_j;if (__pyx_t_5 &lt; 0) __pyx_t_5 += __pyx_v_BB.shape[0];__pyx_t_7 = __pyx_v_j;if (__pyx_t_7 &lt; 0) __pyx_t_7 += __pyx_v_deltas.shape[0];__pyx_v_pd = (__pyx_v_pd + (((*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_BBB.data + __pyx_t_8 * __pyx_v_BBB.strides[0]) ))) - (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_BB.data + __pyx_t_5 * __pyx_v_BB.strides[0]) )))) * (*((__pyx_t_8ccluster_float32 *) ( /* dim=0 */ (__pyx_v_deltas.data + __pyx_t_7 * __pyx_v_deltas.strides[0]) )))));}__pyx_L9:;}</pre><pre class="cython line score-0">&#xA0;<span class="">0808</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0809</span>:     return pd</pre>
<pre class='cython code score-0 '>__pyx_r = __pyx_v_pd;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">0810</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0811</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0812</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0813</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0814</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0815</span>: @cython.initializedcheck(False)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0816</span>: cdef void insertion_sort_inplace_cython_int16(int16[:] A):</pre>
<pre class='cython code score-0 '>static void __pyx_f_8ccluster_insertion_sort_inplace_cython_int16(__Pyx_memviewslice __pyx_v_A) {int __pyx_v_i;int __pyx_v_j;__pyx_t_8ccluster_int16 __pyx_v_key;int __pyx_v_length_A;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("insertion_sort_inplace_cython_int16", 0);/* function exit code */<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();}</pre><pre class="cython line score-0">&#xA0;<span class="">0817</span>:     cdef:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0818</span>:         int i, j</pre>
<pre class="cython line score-0">&#xA0;<span class="">0819</span>:         int16 key</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0820</span>:         int length_A = A.shape[0]</pre>
<pre class='cython code score-0 '>__pyx_v_length_A = (__pyx_v_A.shape[0]);</pre><pre class="cython line score-0">&#xA0;<span class="">0821</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0822</span>:     for j in range(1, length_A):</pre>
<pre class='cython code score-0 '>__pyx_t_1 = __pyx_v_length_A;__pyx_t_2 = __pyx_t_1;for (__pyx_t_3 = 1; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {__pyx_v_j = __pyx_t_3;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0823</span>:         key = A[j]</pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_j;__pyx_v_key = (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_4 * __pyx_v_A.strides[0]) )));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0824</span>:         i = j - 1</pre>
<pre class='cython code score-0 '>__pyx_v_i = (__pyx_v_j - 1);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0825</span>:         while (i &gt;= 0) &amp; (A[i] &gt; key):</pre>
<pre class='cython code score-0 '>while (1) {__pyx_t_4 = __pyx_v_i;__pyx_t_5 = ((__pyx_v_i &gt;= 0) &amp; ((*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_4 * __pyx_v_A.strides[0]) ))) &gt; __pyx_v_key));if (!__pyx_t_5) break;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0826</span>:             A[i + 1] = A[i]</pre>
<pre class='cython code score-0 '>__pyx_t_4 = __pyx_v_i;__pyx_t_6 = (__pyx_v_i + 1);*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_6 * __pyx_v_A.strides[0]) )) = (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_4 * __pyx_v_A.strides[0]) )));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0827</span>:             i = i - 1</pre>
<pre class='cython code score-0 '>__pyx_v_i = (__pyx_v_i - 1);}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0828</span>:         A[i + 1] = key</pre>
<pre class='cython code score-0 '>__pyx_t_4 = (__pyx_v_i + 1);*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_A.data + __pyx_t_4 * __pyx_v_A.strides[0]) )) = __pyx_v_key;}</pre><pre class="cython line score-0">&#xA0;<span class="">0829</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0830</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0831</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0832</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0833</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0834</span>: @cython.initializedcheck(False)</pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0835</span>: cdef prob_dist_fun(int16[:, :] x, int16[:, :] y, float32[:, :] dist, float32[:, :] cntrs, int[:] lbs, int64 dupes, boolean turn, int64 os): #single byte offset. multiply by #cols and #bytes in data type</pre>
<pre class='cython code score-42 '>static PyObject *__pyx_f_8ccluster_prob_dist_fun(__Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y, __Pyx_memviewslice __pyx_v_dist, __Pyx_memviewslice __pyx_v_cntrs, __Pyx_memviewslice __pyx_v_lbs, __pyx_t_8ccluster_int64 __pyx_v_dupes, __pyx_t_8ccluster_boolean __pyx_v_turn, CYTHON_UNUSED __pyx_t_8ccluster_int64 __pyx_v_os) {int __pyx_v_T_CARDS;int __pyx_v_N_CARDS;PyArrayObject *__pyx_v_oh = 0;PyArrayObject *__pyx_v_oh_2d = 0;PyArrayObject *__pyx_v_oh_z = 0;PyArrayObject *__pyx_v_oh_z_tmp = 0;std::map&lt;unsigned PY_LONG_LONG,int&gt;  __pyx_v_mp;PyArrayObject *__pyx_v_prob_dist = 0;__Pyx_memviewslice __pyx_v_oh_view = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_oh_view_2d = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_oh_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };CYTHON_UNUSED __Pyx_memviewslice __pyx_v_oh_z_view_tmp = { 0, 0, { 0 }, { 0 }, { 0 } };int __pyx_v_c;int __pyx_v_i;int __pyx_v_j;int __pyx_v_k;int __pyx_v_cd;unsigned PY_LONG_LONG __pyx_v_one;unsigned PY_LONG_LONG __pyx_v_key;PyArrayObject *__pyx_v_mp_z = 0;__Pyx_memviewslice __pyx_v_yy = { 0, 0, { 0 }, { 0 }, { 0 } };CYTHON_UNUSED PyObject *__pyx_v_ndupes = NULL;__Pyx_memviewslice __pyx_v_mp_z_view = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_prob_dist_memview = { 0, 0, { 0 }, { 0 }, { 0 } };CYTHON_UNUSED __Pyx_memviewslice __pyx_v_prob_dist_sing_memview = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_all_values = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_all_valuesa = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_all_valuesaa = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_deltaaa = { 0, 0, { 0 }, { 0 }, { 0 } };int __pyx_v_ii;CYTHON_UNUSED int __pyx_v_nn;CYTHON_UNUSED int __pyx_v_ss;__Pyx_LocalBuf_ND __pyx_pybuffernd_mp_z;__Pyx_Buffer __pyx_pybuffer_mp_z;__Pyx_LocalBuf_ND __pyx_pybuffernd_oh;__Pyx_Buffer __pyx_pybuffer_oh;__Pyx_LocalBuf_ND __pyx_pybuffernd_oh_2d;__Pyx_Buffer __pyx_pybuffer_oh_2d;__Pyx_LocalBuf_ND __pyx_pybuffernd_oh_z;__Pyx_Buffer __pyx_pybuffer_oh_z;__Pyx_LocalBuf_ND __pyx_pybuffernd_oh_z_tmp;__Pyx_Buffer __pyx_pybuffer_oh_z_tmp;__Pyx_LocalBuf_ND __pyx_pybuffernd_prob_dist;__Pyx_Buffer __pyx_pybuffer_prob_dist;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("prob_dist_fun", 0);__pyx_pybuffer_oh.pybuffer.buf = NULL;__pyx_pybuffer_oh.refcount = 0;__pyx_pybuffernd_oh.data = NULL;__pyx_pybuffernd_oh.rcbuffer = &amp;__pyx_pybuffer_oh;__pyx_pybuffer_oh_2d.pybuffer.buf = NULL;__pyx_pybuffer_oh_2d.refcount = 0;__pyx_pybuffernd_oh_2d.data = NULL;__pyx_pybuffernd_oh_2d.rcbuffer = &amp;__pyx_pybuffer_oh_2d;__pyx_pybuffer_oh_z.pybuffer.buf = NULL;__pyx_pybuffer_oh_z.refcount = 0;__pyx_pybuffernd_oh_z.data = NULL;__pyx_pybuffernd_oh_z.rcbuffer = &amp;__pyx_pybuffer_oh_z;__pyx_pybuffer_oh_z_tmp.pybuffer.buf = NULL;__pyx_pybuffer_oh_z_tmp.refcount = 0;__pyx_pybuffernd_oh_z_tmp.data = NULL;__pyx_pybuffernd_oh_z_tmp.rcbuffer = &amp;__pyx_pybuffer_oh_z_tmp;__pyx_pybuffer_prob_dist.pybuffer.buf = NULL;__pyx_pybuffer_prob_dist.refcount = 0;__pyx_pybuffernd_prob_dist.data = NULL;__pyx_pybuffernd_prob_dist.rcbuffer = &amp;__pyx_pybuffer_prob_dist;__pyx_pybuffer_mp_z.pybuffer.buf = NULL;__pyx_pybuffer_mp_z.refcount = 0;__pyx_pybuffernd_mp_z.data = NULL;__pyx_pybuffernd_mp_z.rcbuffer = &amp;__pyx_pybuffer_mp_z;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_11, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_12, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_19, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_29, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_35, 1);{ PyObject *__pyx_type, *__pyx_value, *__pyx_tb;<span class='pyx_c_api'>__Pyx_PyThreadState_declare__Pyx_PyThreadState_assign__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_mp_z.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh_2d.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh_z.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh_z_tmp.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.prob_dist_fun", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = 0;goto __pyx_L2;__pyx_L0:;<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_mp_z.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh_2d.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh_z.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh_z_tmp.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer);__pyx_L2:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_oh);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_oh_2d);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_oh_z);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_oh_z_tmp);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_prob_dist);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_oh_view, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_oh_view_2d, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_oh_z_view, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_oh_z_view_tmp, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_mp_z);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_yy, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ndupes);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_mp_z_view, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_prob_dist_memview, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_prob_dist_sing_memview, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_all_values, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_all_valuesa, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_all_valuesaa, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_deltaaa, 1);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}</pre><pre class="cython line score-0">&#xA0;<span class="">0836</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0837</span>:     cdef int T_CARDS</pre>
<pre class="cython line score-0">&#xA0;<span class="">0838</span>:     cdef int N_CARDS</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0839</span>:     if turn:</pre>
<pre class='cython code score-0 '>__pyx_t_1 = (__pyx_v_turn != 0);if (__pyx_t_1) {goto __pyx_L3;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0840</span>:         T_CARDS = 5</pre>
<pre class='cython code score-0 '>__pyx_v_T_CARDS = 5;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0841</span>:         N_CARDS = 24</pre>
<pre class='cython code score-0 '>__pyx_v_N_CARDS = 24;</pre><pre class="cython line score-0">&#xA0;<span class="">0842</span>:     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0843</span>:         T_CARDS = 4</pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_v_T_CARDS = 4;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0844</span>:         N_CARDS = 24</pre>
<pre class='cython code score-0 '>__pyx_v_N_CARDS = 24;}__pyx_L3:;</pre><pre class="cython line score-0">&#xA0;<span class="">0845</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0846</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0847</span>: </pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0848</span>:     cdef numpy.ndarray[int16, ndim=1] oh = numpy.empty(T_CARDS+1, dtype=numpy.int16)</pre>
<pre class='cython code score-34 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 848, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 848, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_T_CARDS + 1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 848, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 848, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);__pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 848, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 848, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 848, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 848, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 848, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 848, __pyx_L1_error)</span>__pyx_t_7 = ((PyArrayObject *)__pyx_t_6);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_int16, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_v_oh = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 848, __pyx_L1_error)</span>} else {__pyx_pybuffernd_oh.diminfo[0].strides = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_oh.diminfo[0].shape = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.shape[0];}}__pyx_t_7 = 0;__pyx_v_oh = ((PyArrayObject *)__pyx_t_6);__pyx_t_6 = 0;</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0849</span>:     cdef numpy.ndarray[int16, ndim=2] oh_2d = numpy.empty((x.shape[0] * (y.shape[0] - dupes), T_CARDS+1 + 1), dtype=numpy.int16)</pre>
<pre class='cython code score-41 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 849, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 849, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = __Pyx_PyInt_From_npy_int64(((__pyx_v_x.shape[0]) * ((__pyx_v_y.shape[0]) - __pyx_v_dupes)));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 849, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(((__pyx_v_T_CARDS + 1) + 1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 849, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 849, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_6);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4);__pyx_t_6 = 0;__pyx_t_4 = 0;__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 849, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);__pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 849, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 849, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 849, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 849, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 849, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 849, __pyx_L1_error)</span>__pyx_t_8 = ((PyArrayObject *)__pyx_t_5);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_oh_2d.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_8, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_int16, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {__pyx_v_oh_2d = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_oh_2d.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 849, __pyx_L1_error)</span>} else {__pyx_pybuffernd_oh_2d.diminfo[0].strides = __pyx_pybuffernd_oh_2d.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_oh_2d.diminfo[0].shape = __pyx_pybuffernd_oh_2d.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_oh_2d.diminfo[1].strides = __pyx_pybuffernd_oh_2d.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_oh_2d.diminfo[1].shape = __pyx_pybuffernd_oh_2d.rcbuffer-&gt;pybuffer.shape[1];}}__pyx_t_8 = 0;__pyx_v_oh_2d = ((PyArrayObject *)__pyx_t_5);__pyx_t_5 = 0;</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0850</span>:     cdef numpy.ndarray[int16, ndim=1] oh_z = numpy.empty(T_CARDS+2, dtype=numpy.int16)</pre>
<pre class='cython code score-34 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 850, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 850, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_T_CARDS + 2));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 850, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 850, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);__pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 850, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 850, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 850, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 850, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 850, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 850, __pyx_L1_error)</span>__pyx_t_9 = ((PyArrayObject *)__pyx_t_6);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_oh_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_9, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_int16, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_v_oh_z = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_oh_z.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 850, __pyx_L1_error)</span>} else {__pyx_pybuffernd_oh_z.diminfo[0].strides = __pyx_pybuffernd_oh_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_oh_z.diminfo[0].shape = __pyx_pybuffernd_oh_z.rcbuffer-&gt;pybuffer.shape[0];}}__pyx_t_9 = 0;__pyx_v_oh_z = ((PyArrayObject *)__pyx_t_6);__pyx_t_6 = 0;</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0851</span>:     cdef numpy.ndarray[int16, ndim=1] oh_z_tmp = numpy.empty(T_CARDS + 2, dtype=numpy.int16)</pre>
<pre class='cython code score-34 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 851, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_T_CARDS + 2));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 851, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6);__pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 851, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 851, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 851, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 851, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 851, __pyx_L1_error)</span>__pyx_t_10 = ((PyArrayObject *)__pyx_t_2);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_oh_z_tmp.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_10, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_int16, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_v_oh_z_tmp = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_oh_z_tmp.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 851, __pyx_L1_error)</span>} else {__pyx_pybuffernd_oh_z_tmp.diminfo[0].strides = __pyx_pybuffernd_oh_z_tmp.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_oh_z_tmp.diminfo[0].shape = __pyx_pybuffernd_oh_z_tmp.rcbuffer-&gt;pybuffer.shape[0];}}__pyx_t_10 = 0;__pyx_v_oh_z_tmp = ((PyArrayObject *)__pyx_t_2);__pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0852</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0853</span>:     cdef mapp[unsigned long long, int] mp</pre>
<pre class="cython line score-0">&#xA0;<span class="">0854</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0855</span>:     cdef numpy.ndarray[float32, ndim=2] prob_dist</pre>
<pre class="cython line score-0">&#xA0;<span class="">0856</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0857</span>:     cdef int16[:] oh_view = oh[:]</pre>
<pre class='cython code score-3 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_oh), __pyx_slice_);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 857, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 857, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_oh_view = __pyx_t_11;__pyx_t_11.memview = NULL;__pyx_t_11.data = NULL;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0858</span>:     cdef int16[:, :] oh_view_2d = oh_2d[:]</pre>
<pre class='cython code score-3 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_oh_2d), __pyx_slice_);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 858, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 858, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_oh_view_2d = __pyx_t_12;__pyx_t_12.memview = NULL;__pyx_t_12.data = NULL;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0859</span>:     cdef int16[:] oh_z_view = oh_z[:]</pre>
<pre class='cython code score-3 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_oh_z), __pyx_slice_);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 859, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 859, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_oh_z_view = __pyx_t_11;__pyx_t_11.memview = NULL;__pyx_t_11.data = NULL;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0860</span>:     cdef int16[:] oh_z_view_tmp = oh_z_tmp[:]</pre>
<pre class='cython code score-3 '>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_oh_z_tmp), __pyx_slice_);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 860, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 860, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_oh_z_view_tmp = __pyx_t_11;__pyx_t_11.memview = NULL;__pyx_t_11.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0861</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0862</span>:     cdef int cc, c, i, j, tt, k, cd</pre>
<pre class="cython line score-0">&#xA0;<span class="">0863</span>:     cdef long t</pre>
<pre class="cython line score-0">&#xA0;<span class="">0864</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0865</span>:     cdef unsigned long long one = 1</pre>
<pre class='cython code score-0 '>__pyx_v_one = 1;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0866</span>:     cdef unsigned long long key = -1</pre>
<pre class='cython code score-0 '>__pyx_v_key = -1LL;</pre><pre class="cython line score-0">&#xA0;<span class="">0867</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0868</span>:     cdef unsigned long long [:, :] mp_turn_view</pre>
<pre class="cython line score-0">&#xA0;<span class="">0869</span>:     cdef numpy.ndarray[float32, ndim=1] mp_z</pre>
<pre class="cython line score-0">&#xA0;<span class="">0870</span>: </pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0871</span>:     cdef int16[:, :] yy = nump2(N_CARDS, T_CARDS)</pre>
<pre class='cython code score-23 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_nump2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 871, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N_CARDS);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 871, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_T_CARDS);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 871, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_3 = NULL;__pyx_t_13 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);__pyx_t_13 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_t_4, __pyx_t_5};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_13, 2+__pyx_t_13);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 871, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;}__pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 871, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_yy = __pyx_t_12;__pyx_t_12.memview = NULL;__pyx_t_12.data = NULL;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0872</span>:     if(turn):</pre>
<pre class='cython code score-0 '>__pyx_t_1 = (__pyx_v_turn != 0);if (__pyx_t_1) {goto __pyx_L4;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0873</span>:         ndupes = num_dupes(x, yy)</pre>
<pre class='cython code score-0 '>__pyx_t_2 = __pyx_f_8ccluster_num_dupes(__pyx_v_x, __pyx_v_yy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 873, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_v_ndupes = __pyx_t_2;__pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0874</span>:     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0875</span>:         ndupes = num_dupes_turn(x, yy)</pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_t_2 = __pyx_f_8ccluster_num_dupes_turn(__pyx_v_x, __pyx_v_yy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_v_ndupes = __pyx_t_2;__pyx_t_2 = 0;}__pyx_L4:;</pre><pre class="cython line score-0">&#xA0;<span class="">0876</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0877</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0878</span>:     # SET UP MAPPING TO R + 1 DISTRIBUTIONS</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0879</span>:     cd, c=0, 0</pre>
<pre class='cython code score-0 '>__pyx_t_13 = 0;__pyx_t_14 = 0;__pyx_v_cd = __pyx_t_13;__pyx_v_c = __pyx_t_14;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0880</span>:     for i in range(x.shape[0]):</pre>
<pre class='cython code score-0 '>__pyx_t_15 = (__pyx_v_x.shape[0]);__pyx_t_16 = __pyx_t_15;for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_16; __pyx_t_14+=1) {__pyx_v_i = __pyx_t_14;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0881</span>:         for j in range(yy.shape[0]):</pre>
<pre class='cython code score-0 '>__pyx_t_17 = (__pyx_v_yy.shape[0]);__pyx_t_18 = __pyx_t_17;for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_18; __pyx_t_13+=1) {__pyx_v_j = __pyx_t_13;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0882</span>:             oh_z_view[:2] = x[i][:]</pre>
<pre class='cython code score-0 '>__pyx_t_11.data = __pyx_v_x.data;__pyx_t_11.memview = __pyx_v_x.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_11, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_x.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_x.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        __pyx_t_11.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_11.shape[0] = __pyx_v_x.shape[1];
__pyx_t_11.strides[0] = __pyx_v_x.strides[1];
    __pyx_t_11.suboffsets[0] = -1;

__pyx_t_19.data = __pyx_v_oh_z_view.data;__pyx_t_19.memview = __pyx_v_oh_z_view.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_19, 1);__pyx_t_20 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_19,
    __pyx_v_oh_z_view.shape[0], __pyx_v_oh_z_view.strides[0], __pyx_v_oh_z_view.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_20,
    0,
    2,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 882, __pyx_L1_error)</span>
}

if (unlikely((__pyx_memoryview_copy_contents(__pyx_t_11, __pyx_t_19, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 882, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_19, 1);__pyx_t_19.memview = NULL; __pyx_t_19.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_11, 1);__pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0883</span>:             oh_z_view[2:] = yy[j][:]</pre>
<pre class='cython code score-0 '>__pyx_t_11.data = __pyx_v_yy.data;__pyx_t_11.memview = __pyx_v_yy.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_11, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_j;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_yy.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_yy.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        __pyx_t_11.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_11.shape[0] = __pyx_v_yy.shape[1];
__pyx_t_11.strides[0] = __pyx_v_yy.strides[1];
    __pyx_t_11.suboffsets[0] = -1;

__pyx_t_19.data = __pyx_v_oh_z_view.data;__pyx_t_19.memview = __pyx_v_oh_z_view.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_19, 1);__pyx_t_20 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_19,
    __pyx_v_oh_z_view.shape[0], __pyx_v_oh_z_view.strides[0], __pyx_v_oh_z_view.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_20,
    2,
    0,
    0,
    1,
    0,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 883, __pyx_L1_error)</span>
}

if (unlikely((__pyx_memoryview_copy_contents(__pyx_t_11, __pyx_t_19, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 883, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_19, 1);__pyx_t_19.memview = NULL; __pyx_t_19.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_11, 1);__pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0884</span>:             if(not ((turn and contains_duplicates(oh_z_view)) or (not turn and contains_duplicates_turn(oh_z_view)))):</pre>
<pre class='cython code score-0 '>__pyx_t_21 = (__pyx_v_turn != 0);if (!__pyx_t_21) {goto __pyx_L11_next_or;} else {}__pyx_t_21 = (__pyx_f_8ccluster_contains_duplicates(__pyx_v_oh_z_view) != 0);if (!__pyx_t_21) {} else {__pyx_t_1 = __pyx_t_21;goto __pyx_L10_bool_binop_done;}__pyx_L11_next_or:;__pyx_t_21 = (!(__pyx_v_turn != 0));if (__pyx_t_21) {} else {__pyx_t_1 = __pyx_t_21;goto __pyx_L10_bool_binop_done;}__pyx_t_21 = (__pyx_f_8ccluster_contains_duplicates_turn(__pyx_v_oh_z_view) != 0);__pyx_t_1 = __pyx_t_21;__pyx_L10_bool_binop_done:;__pyx_t_21 = (!__pyx_t_1);if (__pyx_t_21) {}}}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0885</span>:                 if(turn):</pre>
<pre class='cython code score-0 '>__pyx_t_21 = (__pyx_v_turn != 0);if (__pyx_t_21) {goto __pyx_L14;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0886</span>:                     key = (one &lt;&lt; oh_z_view[0]) | (one &lt;&lt; oh_z_view[1]) | (one &lt;&lt;oh_z_view[2]) | (one &lt;&lt;oh_z_view[3]) | (one &lt;&lt;oh_z_view[4]) | (one &lt;&lt;oh_z_view[5]) | (one &lt;&lt; oh_z_view[6])</pre>
<pre class='cython code score-0 '>__pyx_t_22 = 0;if (__pyx_t_22 &lt; 0) __pyx_t_22 += __pyx_v_oh_z_view.shape[0];__pyx_t_23 = 1;if (__pyx_t_23 &lt; 0) __pyx_t_23 += __pyx_v_oh_z_view.shape[0];__pyx_t_24 = 2;if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_v_oh_z_view.shape[0];__pyx_t_25 = 3;if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_v_oh_z_view.shape[0];__pyx_t_26 = 4;if (__pyx_t_26 &lt; 0) __pyx_t_26 += __pyx_v_oh_z_view.shape[0];__pyx_t_27 = 5;if (__pyx_t_27 &lt; 0) __pyx_t_27 += __pyx_v_oh_z_view.shape[0];__pyx_t_28 = 6;if (__pyx_t_28 &lt; 0) __pyx_t_28 += __pyx_v_oh_z_view.shape[0];__pyx_v_key = (((((((__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_22 * __pyx_v_oh_z_view.strides[0]) )))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_23 * __pyx_v_oh_z_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_24 * __pyx_v_oh_z_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_25 * __pyx_v_oh_z_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_26 * __pyx_v_oh_z_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_27 * __pyx_v_oh_z_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_28 * __pyx_v_oh_z_view.strides[0]) )))));</pre><pre class="cython line score-0">&#xA0;<span class="">0887</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0888</span>:                     key = (one &lt;&lt; oh_z_view[0]) | (one &lt;&lt; oh_z_view[1]) | (one &lt;&lt;oh_z_view[2]) | (one &lt;&lt;oh_z_view[3]) | (one &lt;&lt;oh_z_view[4]) | (one &lt;&lt;oh_z_view[5])</pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_t_28 = 0;if (__pyx_t_28 &lt; 0) __pyx_t_28 += __pyx_v_oh_z_view.shape[0];__pyx_t_27 = 1;if (__pyx_t_27 &lt; 0) __pyx_t_27 += __pyx_v_oh_z_view.shape[0];__pyx_t_26 = 2;if (__pyx_t_26 &lt; 0) __pyx_t_26 += __pyx_v_oh_z_view.shape[0];__pyx_t_25 = 3;if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_v_oh_z_view.shape[0];__pyx_t_24 = 4;if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_v_oh_z_view.shape[0];__pyx_t_23 = 5;if (__pyx_t_23 &lt; 0) __pyx_t_23 += __pyx_v_oh_z_view.shape[0];__pyx_v_key = ((((((__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_28 * __pyx_v_oh_z_view.strides[0]) )))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_27 * __pyx_v_oh_z_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_26 * __pyx_v_oh_z_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_25 * __pyx_v_oh_z_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_24 * __pyx_v_oh_z_view.strides[0]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=0 */ (__pyx_v_oh_z_view.data + __pyx_t_23 * __pyx_v_oh_z_view.strides[0]) )))));}__pyx_L14:;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0889</span>:                 mp[key] = cd</pre>
<pre class='cython code score-0 '>(__pyx_v_mp[__pyx_v_key]) = __pyx_v_cd;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0890</span>:                 cd+=1</pre>
<pre class='cython code score-0 '>__pyx_v_cd = (__pyx_v_cd + 1);</pre><pre class="cython line score-0">&#xA0;<span class="">0891</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0892</span>:     # SET 2D MAT FOR NOGIL PARALLELISM - NOT WORKING FOR REASON UNKONWN ATM (PARALLELISM)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0893</span>:     for i in range(x.shape[0]):</pre>
<pre class='cython code score-0 '>__pyx_t_15 = (__pyx_v_x.shape[0]);__pyx_t_16 = __pyx_t_15;for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_16; __pyx_t_14+=1) {__pyx_v_i = __pyx_t_14;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0894</span>:         for j in range(y.shape[0]):</pre>
<pre class='cython code score-0 '>__pyx_t_17 = (__pyx_v_y.shape[0]);__pyx_t_18 = __pyx_t_17;for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_18; __pyx_t_13+=1) {__pyx_v_j = __pyx_t_13;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0895</span>:             oh_view[:2] = x[i][:]</pre>
<pre class='cython code score-0 '>__pyx_t_11.data = __pyx_v_x.data;__pyx_t_11.memview = __pyx_v_x.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_11, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_i;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_x.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_x.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        __pyx_t_11.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_11.shape[0] = __pyx_v_x.shape[1];
__pyx_t_11.strides[0] = __pyx_v_x.strides[1];
    __pyx_t_11.suboffsets[0] = -1;

__pyx_t_19.data = __pyx_v_oh_view.data;__pyx_t_19.memview = __pyx_v_oh_view.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_19, 1);__pyx_t_20 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_19,
    __pyx_v_oh_view.shape[0], __pyx_v_oh_view.strides[0], __pyx_v_oh_view.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_20,
    0,
    2,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 895, __pyx_L1_error)</span>
}

if (unlikely((__pyx_memoryview_copy_contents(__pyx_t_11, __pyx_t_19, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 895, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_19, 1);__pyx_t_19.memview = NULL; __pyx_t_19.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_11, 1);__pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0896</span>:             oh_view[2:] = y[j][:]</pre>
<pre class='cython code score-0 '>__pyx_t_11.data = __pyx_v_y.data;__pyx_t_11.memview = __pyx_v_y.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_11, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_j;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_y.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_y.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        __pyx_t_11.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_11.shape[0] = __pyx_v_y.shape[1];
__pyx_t_11.strides[0] = __pyx_v_y.strides[1];
    __pyx_t_11.suboffsets[0] = -1;

__pyx_t_19.data = __pyx_v_oh_view.data;__pyx_t_19.memview = __pyx_v_oh_view.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_19, 1);__pyx_t_20 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_19,
    __pyx_v_oh_view.shape[0], __pyx_v_oh_view.strides[0], __pyx_v_oh_view.suboffsets[0],
    0,
    0,
    &amp;__pyx_t_20,
    2,
    0,
    0,
    1,
    0,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 896, __pyx_L1_error)</span>
}

if (unlikely((__pyx_memoryview_copy_contents(__pyx_t_11, __pyx_t_19, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 896, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_19, 1);__pyx_t_19.memview = NULL; __pyx_t_19.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_11, 1);__pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0897</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0898</span>:             if(not ((turn and contains_duplicates_turn(oh_view)) or (not turn and contains_duplicates_flop(oh_view)))):</pre>
<pre class='cython code score-0 '>__pyx_t_1 = (__pyx_v_turn != 0);if (!__pyx_t_1) {goto __pyx_L21_next_or;} else {}__pyx_t_1 = (__pyx_f_8ccluster_contains_duplicates_turn(__pyx_v_oh_view) != 0);if (!__pyx_t_1) {} else {__pyx_t_21 = __pyx_t_1;goto __pyx_L20_bool_binop_done;}__pyx_L21_next_or:;__pyx_t_1 = (!(__pyx_v_turn != 0));if (__pyx_t_1) {} else {__pyx_t_21 = __pyx_t_1;goto __pyx_L20_bool_binop_done;}__pyx_t_1 = (__pyx_f_8ccluster_contains_duplicates_flop(__pyx_v_oh_view) != 0);__pyx_t_21 = __pyx_t_1;__pyx_L20_bool_binop_done:;__pyx_t_1 = (!__pyx_t_21);if (__pyx_t_1) {}}}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0899</span>:                 oh_view_2d[c][:-1] = oh_view[:]</pre>
<pre class='cython code score-0 '>__pyx_t_11.data = __pyx_v_oh_view_2d.data;__pyx_t_11.memview = __pyx_v_oh_view_2d.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_11, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_c;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_oh_view_2d.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_oh_view_2d.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        __pyx_t_11.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_20 = -1;if (unlikely(__pyx_memoryview_slice_memviewslice(
    &amp;__pyx_t_11,
    __pyx_v_oh_view_2d.shape[1], __pyx_v_oh_view_2d.strides[1], __pyx_v_oh_view_2d.suboffsets[1],
    1,
    0,
    &amp;__pyx_t_20,
    0,
    -1L,
    0,
    0,
    1,
    0,
    1) &lt; 0))
{
    <span class='error_goto'>__PYX_ERR(0, 899, __pyx_L1_error)</span>
}

if (unlikely((__pyx_memoryview_copy_contents(__pyx_v_oh_view, __pyx_t_11, 1, 1, 0) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 899, __pyx_L1_error)</span>__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_11, 1);__pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0900</span>:                 c += 1</pre>
<pre class='cython code score-0 '>__pyx_v_c = (__pyx_v_c + 1);</pre><pre class="cython line score-0">&#xA0;<span class="">0901</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0902</span>: </pre>
<pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0903</span>:     mp_z = numpy.zeros(len(dist[0]), dtype = numpy.float32)</pre>
<pre class='cython code score-54 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 903, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 903, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_29.data = __pyx_v_dist.data;__pyx_t_29.memview = __pyx_v_dist.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_29, 1);{
    Py_ssize_t __pyx_tmp_idx = 0;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_dist.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_dist.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        __pyx_t_29.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_29.shape[0] = __pyx_v_dist.shape[1];
__pyx_t_29.strides[0] = __pyx_v_dist.strides[1];
    __pyx_t_29.suboffsets[0] = -1;

__pyx_t_15 = <span class='pyx_c_api'>__Pyx_MemoryView_Len</span>(__pyx_t_29); __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_29, 1);__pyx_t_29.memview = NULL; __pyx_t_29.data = NULL;__pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 903, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 903, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2);__pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 903, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 903, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 903, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 903, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_5, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 903, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 903, __pyx_L1_error)</span>__pyx_t_30 = ((PyArrayObject *)__pyx_t_3);{__Pyx_BufFmt_StackElem __pyx_stack[1];<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_mp_z.rcbuffer-&gt;pybuffer);__pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_mp_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_30, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_float32, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);if (unlikely(__pyx_t_14 &lt; 0)) {<span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_31, &amp;__pyx_t_32, &amp;__pyx_t_33);if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_mp_z.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_mp_z, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_float32, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {Py_XDECREF(__pyx_t_31); Py_XDECREF(__pyx_t_32); Py_XDECREF(__pyx_t_33);<span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();} else {<span class='py_c_api'>PyErr_Restore</span>(__pyx_t_31, __pyx_t_32, __pyx_t_33);}__pyx_t_31 = __pyx_t_32 = __pyx_t_33 = 0;}__pyx_pybuffernd_mp_z.diminfo[0].strides = __pyx_pybuffernd_mp_z.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_mp_z.diminfo[0].shape = __pyx_pybuffernd_mp_z.rcbuffer-&gt;pybuffer.shape[0];if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 903, __pyx_L1_error)</span>}__pyx_t_30 = 0;__pyx_v_mp_z = ((PyArrayObject *)__pyx_t_3);__pyx_t_3 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0904</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0905</span>:     cdef float32[:] mp_z_view = mp_z[:]</pre>
<pre class='cython code score-3 '>__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_mp_z), __pyx_slice_);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 905, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_29 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_29.memview)) __PYX_ERR(0, 905, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_v_mp_z_view = __pyx_t_29;__pyx_t_29.memview = NULL;__pyx_t_29.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0906</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0907</span>:     # for each possible remaining card, we will store the subsequent index of the river cluster to which it responds.</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0908</span>:     if turn:</pre>
<pre class='cython code score-0 '>__pyx_t_1 = (__pyx_v_turn != 0);if (__pyx_t_1) {goto __pyx_L24;}</pre><pre class="cython line score-68" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0909</span>:         prob_dist = numpy.memmap('results/prob_dist_TURN.npy', mode = 'r+', dtype = numpy.float32, shape = (x.shape[0] * (y.shape[0] - dupes), N_CARDS - T_CARDS - 2))[:] # 9 col</pre>
<pre class='cython code score-68 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 909, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 909, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 909, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_mode, __pyx_kp_u_r) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 909, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 909, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = __Pyx_PyInt_From_npy_int64(((__pyx_v_x.shape[0]) * ((__pyx_v_y.shape[0]) - __pyx_v_dupes)));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 909, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(((__pyx_v_N_CARDS - __pyx_v_T_CARDS) - 2));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 909, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 909, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_5);__pyx_t_6 = 0;__pyx_t_5 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_shape, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__14, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 909, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_4, 0, 0, NULL, NULL, &amp;__pyx_slice_, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 909, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 909, __pyx_L1_error)</span>__pyx_t_34 = ((PyArrayObject *)__pyx_t_3);{__Pyx_BufFmt_StackElem __pyx_stack[1];<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer);__pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_34, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_float32, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);if (unlikely(__pyx_t_14 &lt; 0)) {<span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_33, &amp;__pyx_t_32, &amp;__pyx_t_31);if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_prob_dist, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_float32, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {Py_XDECREF(__pyx_t_33); Py_XDECREF(__pyx_t_32); Py_XDECREF(__pyx_t_31);<span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();} else {<span class='py_c_api'>PyErr_Restore</span>(__pyx_t_33, __pyx_t_32, __pyx_t_31);}__pyx_t_33 = __pyx_t_32 = __pyx_t_31 = 0;}__pyx_pybuffernd_prob_dist.diminfo[0].strides = __pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_prob_dist.diminfo[0].shape = __pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_prob_dist.diminfo[1].strides = __pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_prob_dist.diminfo[1].shape = __pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer.shape[1];if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span>}__pyx_t_34 = 0;__pyx_v_prob_dist = ((PyArrayObject *)__pyx_t_3);__pyx_t_3 = 0;__pyx_tuple__14 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_results_prob_dist_TURN_npy);<span class='error_goto'> if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 909, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__14);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__14);</pre><pre class="cython line score-0">&#xA0;<span class="">0910</span>:     else:</pre>
<pre class="cython line score-68" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0911</span>:         prob_dist = numpy.memmap('results/prob_dist_FLOP.npy', mode = 'r+', dtype = numpy.float32, shape = (x.shape[0] * (y.shape[0] - dupes), N_CARDS - T_CARDS - 2))[:] # 10 col -- both will need to change according to proper histogram schematics..</pre>
<pre class='cython code score-68 '>/*else*/ {<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 911, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 911, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 911, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_mode, __pyx_kp_u_r) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 911, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 911, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 911, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 911, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = __Pyx_PyInt_From_npy_int64(((__pyx_v_x.shape[0]) * ((__pyx_v_y.shape[0]) - __pyx_v_dupes)));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 911, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(((__pyx_v_N_CARDS - __pyx_v_T_CARDS) - 2));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 911, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 911, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_2);__pyx_t_5 = 0;__pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_shape, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 911, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__15, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 911, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_6, 0, 0, NULL, NULL, &amp;__pyx_slice_, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 911, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 911, __pyx_L1_error)</span>__pyx_t_34 = ((PyArrayObject *)__pyx_t_3);{__Pyx_BufFmt_StackElem __pyx_stack[1];<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer);__pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_34, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_float32, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);if (unlikely(__pyx_t_14 &lt; 0)) {<span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_31, &amp;__pyx_t_32, &amp;__pyx_t_33);if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_prob_dist, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_float32, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {Py_XDECREF(__pyx_t_31); Py_XDECREF(__pyx_t_32); Py_XDECREF(__pyx_t_33);<span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();} else {<span class='py_c_api'>PyErr_Restore</span>(__pyx_t_31, __pyx_t_32, __pyx_t_33);}__pyx_t_31 = __pyx_t_32 = __pyx_t_33 = 0;}__pyx_pybuffernd_prob_dist.diminfo[0].strides = __pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_prob_dist.diminfo[0].shape = __pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_prob_dist.diminfo[1].strides = __pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_prob_dist.diminfo[1].shape = __pyx_pybuffernd_prob_dist.rcbuffer-&gt;pybuffer.shape[1];if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 911, __pyx_L1_error)</span>}__pyx_t_34 = 0;__pyx_v_prob_dist = ((PyArrayObject *)__pyx_t_3);__pyx_t_3 = 0;}__pyx_L24:;__pyx_tuple__15 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_results_prob_dist_FLOP_npy);<span class='error_goto'> if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 911, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__15);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__15);</pre><pre class="cython line score-0">&#xA0;<span class="">0912</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0913</span>:     cdef float32[:, :] prob_dist_memview = prob_dist[:]</pre>
<pre class='cython code score-3 '>__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_prob_dist), __pyx_slice_);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 913, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_35 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_float32(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_35.memview)) __PYX_ERR(0, 913, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_v_prob_dist_memview = __pyx_t_35;__pyx_t_35.memview = NULL;__pyx_t_35.data = NULL;</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0914</span>:     cdef float32[:] prob_dist_sing_memview = numpy.empty(N_CARDS-T_CARDS-1, dtype = numpy.float32)[:]</pre>
<pre class='cython code score-35 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 914, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 914, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(((__pyx_v_N_CARDS - __pyx_v_T_CARDS) - 1));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 914, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 914, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);__pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 914, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 914, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 914, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 914, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 914, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_5, 0, 0, NULL, NULL, &amp;__pyx_slice_, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 914, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_29 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_29.memview)) __PYX_ERR(0, 914, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_v_prob_dist_sing_memview = __pyx_t_29;__pyx_t_29.memview = NULL;__pyx_t_29.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0915</span>: </pre>
<pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0916</span>:     cdef float32[:] all_values = numpy.empty(cntrs.shape[1] + dist.shape[1], dtype = numpy.float32)</pre>
<pre class='cython code score-35 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 916, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 916, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(((__pyx_v_cntrs.shape[1]) + (__pyx_v_dist.shape[1])));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 916, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 916, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);__pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 916, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 916, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 916, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 916, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 916, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_29 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_29.memview)) __PYX_ERR(0, 916, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_all_values = __pyx_t_29;__pyx_t_29.memview = NULL;__pyx_t_29.data = NULL;</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0917</span>:     cdef float32[:] all_valuesa = numpy.empty(cntrs.shape[1] - 1 + dist.shape[1], dtype = numpy.float32)</pre>
<pre class='cython code score-35 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 917, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 917, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>((((__pyx_v_cntrs.shape[1]) - 1) + (__pyx_v_dist.shape[1])));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 917, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 917, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);__pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 917, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 917, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 917, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 917, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 917, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_29 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_29.memview)) __PYX_ERR(0, 917, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_v_all_valuesa = __pyx_t_29;__pyx_t_29.memview = NULL;__pyx_t_29.data = NULL;</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0918</span>:     cdef float32[:] all_valuesaa = numpy.empty(cntrs.shape[1] - 1 + dist.shape[1], dtype = numpy.float32)</pre>
<pre class='cython code score-35 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 918, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 918, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='py_c_api'>PyInt_FromSsize_t</span>((((__pyx_v_cntrs.shape[1]) - 1) + (__pyx_v_dist.shape[1])));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 918, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 918, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_6);__pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 918, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 918, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 918, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 918, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 918, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_29 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_29.memview)) __PYX_ERR(0, 918, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_v_all_valuesaa = __pyx_t_29;__pyx_t_29.memview = NULL;__pyx_t_29.data = NULL;</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0919</span>:     cdef float32[:] deltaaa = numpy.empty(cntrs.shape[1] - 1 + dist.shape[1], dtype = numpy.float32)</pre>
<pre class='cython code score-35 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 919, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>((((__pyx_v_cntrs.shape[1]) - 1) + (__pyx_v_dist.shape[1])));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 919, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);__pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 919, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 919, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 919, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 919, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_29 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_float32(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_29.memview)) __PYX_ERR(0, 919, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_v_deltaaa = __pyx_t_29;__pyx_t_29.memview = NULL;__pyx_t_29.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0920</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0921</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0922</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0923</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0924</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0925</span>:     ii = cython.declare(cython.int)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0926</span>:     nn = cython.declare(cython.int, (x.shape[0] * (y.shape[0] - dupes)))</pre>
<pre class='cython code score-0 '>__pyx_v_nn = ((__pyx_v_x.shape[0]) * ((__pyx_v_y.shape[0]) - __pyx_v_dupes));</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0927</span>:     ss = cython.declare(cython.int, 0)</pre>
<pre class='cython code score-0 '>__pyx_v_ss = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">0928</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0929</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0930</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0931</span>:     for ii in prange(nn, nogil=True, num_threads=16):</pre>
<pre class='cython code score-4 '>{#ifdef WITH_THREADPyThreadState *_save;_save = NULL;Py_UNBLOCK_THREADS<span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();#endif/*try:*/ {__pyx_t_14 = __pyx_v_nn;{#if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))    #undef likely    #undef unlikely    #define likely(x)   (x)    #define unlikely(x) (x)#endif__pyx_t_20 = (__pyx_t_14 - 0 + 1 - 1/abs(1)) / 1;if (__pyx_t_20 &gt; 0){#ifdef _OPENMP#pragma omp parallel#endif /* _OPENMP */{#ifdef _OPENMP#pragma omp for firstprivate(__pyx_v_ii) lastprivate(__pyx_v_ii) lastprivate(__pyx_v_k) lastprivate(__pyx_v_key) num_threads(16)#endif /* _OPENMP */for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_20; __pyx_t_13++){{__pyx_v_ii = (int)(0 + 1 * __pyx_t_13);/* Initialize private variables to invalid values */__pyx_v_k = ((int)0xbad0bad0);__pyx_v_key = ((unsigned PY_LONG_LONG)0xbad0bad0);/*finally:*/ {/*normal exit:*/{#ifdef WITH_THREAD<span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();Py_BLOCK_THREADS#endifgoto __pyx_L27;}__pyx_L27:;}}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0932</span>:         for k in range(N_CARDS):</pre>
<pre class='cython code score-0 '>__pyx_t_36 = __pyx_v_N_CARDS;__pyx_t_37 = __pyx_t_36;for (__pyx_t_38 = 0; __pyx_t_38 &lt; __pyx_t_37; __pyx_t_38+=1) {__pyx_v_k = __pyx_t_38;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0933</span>:             if(not ((turn and contains_turn(oh_view_2d[ii], k)) or (not turn and contains_flop(oh_view_2d[ii], k)))):</pre>
<pre class='cython code score-0 '>__pyx_t_21 = (__pyx_v_turn != 0);if (!__pyx_t_21) {goto __pyx_L36_next_or;} else {}__pyx_t_11.data = __pyx_v_oh_view_2d.data;__pyx_t_11.memview = __pyx_v_oh_view_2d.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_11, 0);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ii;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_oh_view_2d.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_oh_view_2d.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        __pyx_t_11.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_11.shape[0] = __pyx_v_oh_view_2d.shape[1];
__pyx_t_11.strides[0] = __pyx_v_oh_view_2d.strides[1];
    __pyx_t_11.suboffsets[0] = -1;

__pyx_t_21 = (__pyx_f_8ccluster_contains_turn(__pyx_t_11, __pyx_v_k) != 0);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_11, 0);__pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;if (!__pyx_t_21) {} else {__pyx_t_1 = __pyx_t_21;goto __pyx_L35_bool_binop_done;}__pyx_L36_next_or:;__pyx_t_21 = (!(__pyx_v_turn != 0));if (__pyx_t_21) {} else {__pyx_t_1 = __pyx_t_21;goto __pyx_L35_bool_binop_done;}__pyx_t_11.data = __pyx_v_oh_view_2d.data;__pyx_t_11.memview = __pyx_v_oh_view_2d.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_11, 0);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ii;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_oh_view_2d.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_oh_view_2d.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        __pyx_t_11.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_11.shape[0] = __pyx_v_oh_view_2d.shape[1];
__pyx_t_11.strides[0] = __pyx_v_oh_view_2d.strides[1];
    __pyx_t_11.suboffsets[0] = -1;

__pyx_t_21 = (__pyx_f_8ccluster_contains_flop(__pyx_t_11, __pyx_v_k) != 0);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_11, 0);__pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;__pyx_t_1 = __pyx_t_21;__pyx_L35_bool_binop_done:;__pyx_t_21 = (!__pyx_t_1);if (__pyx_t_21) {}}}}}}}#if ((defined(__APPLE__) || defined(__OSX__)) &amp;&amp; (defined(__GNUC__) &amp;&amp; (__GNUC__ &gt; 2 || (__GNUC__ == 2 &amp;&amp; (__GNUC_MINOR__ &gt; 95)))))    #undef likely    #undef unlikely    #define likely(x)   __builtin_expect(!!(x), 1)    #define unlikely(x) __builtin_expect(!!(x), 0)#endif}</pre><pre class="cython line score-0">&#xA0;<span class="">0934</span>:                 ## for each datapoint (float value for winning), find the best center given</pre>
<pre class="cython line score-0">&#xA0;<span class="">0935</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0936</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0937</span>:                 oh_view_2d[ii][T_CARDS + 1] = k</pre>
<pre class='cython code score-0 '>__pyx_t_23 = __pyx_v_ii;__pyx_t_24 = (__pyx_v_T_CARDS + 1);if (__pyx_t_23 &lt; 0) __pyx_t_23 += __pyx_v_oh_view_2d.shape[0];if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_v_oh_view_2d.shape[1];*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_oh_view_2d.data + __pyx_t_23 * __pyx_v_oh_view_2d.strides[0]) ) + __pyx_t_24 * __pyx_v_oh_view_2d.strides[1]) )) = __pyx_v_k;</pre><pre class="cython line score-0">&#xA0;<span class="">0938</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0939</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0940</span>:                 if(turn):</pre>
<pre class='cython code score-0 '>__pyx_t_21 = (__pyx_v_turn != 0);if (__pyx_t_21) {goto __pyx_L39;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0941</span>:                     key = (one &lt;&lt; oh_view_2d[ii][0])  | (one &lt;&lt; oh_view_2d[ii][1]) | (one &lt;&lt; oh_view_2d[ii][2])  | (one &lt;&lt; oh_view_2d[ii][3])  | (one &lt;&lt; oh_view_2d[ii][4])  | (one &lt;&lt; oh_view_2d[ii][5])  | (one &lt;&lt; oh_view_2d[ii][6])</pre>
<pre class='cython code score-0 '>__pyx_t_24 = __pyx_v_ii;__pyx_t_23 = 0;if (__pyx_t_24 &lt; 0) __pyx_t_24 += __pyx_v_oh_view_2d.shape[0];if (__pyx_t_23 &lt; 0) __pyx_t_23 += __pyx_v_oh_view_2d.shape[1];__pyx_t_25 = __pyx_v_ii;__pyx_t_26 = 1;if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_v_oh_view_2d.shape[0];if (__pyx_t_26 &lt; 0) __pyx_t_26 += __pyx_v_oh_view_2d.shape[1];__pyx_t_27 = __pyx_v_ii;__pyx_t_28 = 2;if (__pyx_t_27 &lt; 0) __pyx_t_27 += __pyx_v_oh_view_2d.shape[0];if (__pyx_t_28 &lt; 0) __pyx_t_28 += __pyx_v_oh_view_2d.shape[1];__pyx_t_22 = __pyx_v_ii;__pyx_t_39 = 3;if (__pyx_t_22 &lt; 0) __pyx_t_22 += __pyx_v_oh_view_2d.shape[0];if (__pyx_t_39 &lt; 0) __pyx_t_39 += __pyx_v_oh_view_2d.shape[1];__pyx_t_40 = __pyx_v_ii;__pyx_t_41 = 4;if (__pyx_t_40 &lt; 0) __pyx_t_40 += __pyx_v_oh_view_2d.shape[0];if (__pyx_t_41 &lt; 0) __pyx_t_41 += __pyx_v_oh_view_2d.shape[1];__pyx_t_42 = __pyx_v_ii;__pyx_t_43 = 5;if (__pyx_t_42 &lt; 0) __pyx_t_42 += __pyx_v_oh_view_2d.shape[0];if (__pyx_t_43 &lt; 0) __pyx_t_43 += __pyx_v_oh_view_2d.shape[1];__pyx_t_44 = __pyx_v_ii;__pyx_t_45 = 6;if (__pyx_t_44 &lt; 0) __pyx_t_44 += __pyx_v_oh_view_2d.shape[0];if (__pyx_t_45 &lt; 0) __pyx_t_45 += __pyx_v_oh_view_2d.shape[1];__pyx_v_key = (((((((__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_oh_view_2d.data + __pyx_t_24 * __pyx_v_oh_view_2d.strides[0]) ) + __pyx_t_23 * __pyx_v_oh_view_2d.strides[1]) )))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_oh_view_2d.data + __pyx_t_25 * __pyx_v_oh_view_2d.strides[0]) ) + __pyx_t_26 * __pyx_v_oh_view_2d.strides[1]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_oh_view_2d.data + __pyx_t_27 * __pyx_v_oh_view_2d.strides[0]) ) + __pyx_t_28 * __pyx_v_oh_view_2d.strides[1]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_oh_view_2d.data + __pyx_t_22 * __pyx_v_oh_view_2d.strides[0]) ) + __pyx_t_39 * __pyx_v_oh_view_2d.strides[1]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_oh_view_2d.data + __pyx_t_40 * __pyx_v_oh_view_2d.strides[0]) ) + __pyx_t_41 * __pyx_v_oh_view_2d.strides[1]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_oh_view_2d.data + __pyx_t_42 * __pyx_v_oh_view_2d.strides[0]) ) + __pyx_t_43 * __pyx_v_oh_view_2d.strides[1]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_oh_view_2d.data + __pyx_t_44 * __pyx_v_oh_view_2d.strides[0]) ) + __pyx_t_45 * __pyx_v_oh_view_2d.strides[1]) )))));</pre><pre class="cython line score-0">&#xA0;<span class="">0942</span>:                 else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0943</span>:                     key = (one &lt;&lt; oh_view_2d[ii][0])  | (one &lt;&lt; oh_view_2d[ii][1]) | (one &lt;&lt; oh_view_2d[ii][2])  | (one &lt;&lt; oh_view_2d[ii][3])  | (one &lt;&lt; oh_view_2d[ii][4]) | (one &lt;&lt; oh_view_2d[ii][5])</pre>
<pre class='cython code score-0 '>/*else*/ {__pyx_t_45 = __pyx_v_ii;__pyx_t_44 = 0;if (__pyx_t_45 &lt; 0) __pyx_t_45 += __pyx_v_oh_view_2d.shape[0];if (__pyx_t_44 &lt; 0) __pyx_t_44 += __pyx_v_oh_view_2d.shape[1];__pyx_t_43 = __pyx_v_ii;__pyx_t_42 = 1;if (__pyx_t_43 &lt; 0) __pyx_t_43 += __pyx_v_oh_view_2d.shape[0];if (__pyx_t_42 &lt; 0) __pyx_t_42 += __pyx_v_oh_view_2d.shape[1];__pyx_t_41 = __pyx_v_ii;__pyx_t_40 = 2;if (__pyx_t_41 &lt; 0) __pyx_t_41 += __pyx_v_oh_view_2d.shape[0];if (__pyx_t_40 &lt; 0) __pyx_t_40 += __pyx_v_oh_view_2d.shape[1];__pyx_t_39 = __pyx_v_ii;__pyx_t_22 = 3;if (__pyx_t_39 &lt; 0) __pyx_t_39 += __pyx_v_oh_view_2d.shape[0];if (__pyx_t_22 &lt; 0) __pyx_t_22 += __pyx_v_oh_view_2d.shape[1];__pyx_t_28 = __pyx_v_ii;__pyx_t_27 = 4;if (__pyx_t_28 &lt; 0) __pyx_t_28 += __pyx_v_oh_view_2d.shape[0];if (__pyx_t_27 &lt; 0) __pyx_t_27 += __pyx_v_oh_view_2d.shape[1];__pyx_t_26 = __pyx_v_ii;__pyx_t_25 = 5;if (__pyx_t_26 &lt; 0) __pyx_t_26 += __pyx_v_oh_view_2d.shape[0];if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_v_oh_view_2d.shape[1];__pyx_v_key = ((((((__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_oh_view_2d.data + __pyx_t_45 * __pyx_v_oh_view_2d.strides[0]) ) + __pyx_t_44 * __pyx_v_oh_view_2d.strides[1]) )))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_oh_view_2d.data + __pyx_t_43 * __pyx_v_oh_view_2d.strides[0]) ) + __pyx_t_42 * __pyx_v_oh_view_2d.strides[1]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_oh_view_2d.data + __pyx_t_41 * __pyx_v_oh_view_2d.strides[0]) ) + __pyx_t_40 * __pyx_v_oh_view_2d.strides[1]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_oh_view_2d.data + __pyx_t_39 * __pyx_v_oh_view_2d.strides[0]) ) + __pyx_t_22 * __pyx_v_oh_view_2d.strides[1]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_oh_view_2d.data + __pyx_t_28 * __pyx_v_oh_view_2d.strides[0]) ) + __pyx_t_27 * __pyx_v_oh_view_2d.strides[1]) ))))) | (__pyx_v_one &lt;&lt; (*((__pyx_t_8ccluster_int16 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_oh_view_2d.data + __pyx_t_26 * __pyx_v_oh_view_2d.strides[0]) ) + __pyx_t_25 * __pyx_v_oh_view_2d.strides[1]) )))));}__pyx_L39:;</pre><pre class="cython line score-0">&#xA0;<span class="">0944</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0945</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0946</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0947</span>:                 #reward distance from losing.. temp logic until i understand paper</pre>
<pre class="cython line score-0">&#xA0;<span class="">0948</span>:                 #prob_dist_memview[ii][k] = emd_c(1, mp_z_view, cntrs[lbs[mp[key]]], all_values, all_valuesa, all_valuesaa, deltaaa)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0949</span>:                 #with gil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0950</span>:                 #    print(k - n_less(oh_view_2d[ii], k))</pre>
<pre class="cython line score-0">&#xA0;<span class="">0951</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0952</span>:                 prob_dist_memview[ii][k - n_less(oh_view_2d[ii], k)] = emd_c(1, mp_z_view, cntrs[lbs[mp[key]]], all_values, all_valuesa, all_valuesaa, deltaaa)</pre>
<pre class='cython code score-0 '>__pyx_t_25 = (__pyx_v_mp[__pyx_v_key]);if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_v_lbs.shape[0];__pyx_t_29.data = __pyx_v_cntrs.data;__pyx_t_29.memview = __pyx_v_cntrs.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_29, 0);{
    Py_ssize_t __pyx_tmp_idx = (*((int *) ( /* dim=0 */ (__pyx_v_lbs.data + __pyx_t_25 * __pyx_v_lbs.strides[0]) )));
        Py_ssize_t __pyx_tmp_shape = __pyx_v_cntrs.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_cntrs.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        __pyx_t_29.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_29.shape[0] = __pyx_v_cntrs.shape[1];
__pyx_t_29.strides[0] = __pyx_v_cntrs.strides[1];
    __pyx_t_29.suboffsets[0] = -1;

__pyx_t_11.data = __pyx_v_oh_view_2d.data;__pyx_t_11.memview = __pyx_v_oh_view_2d.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_11, 0);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_ii;
        Py_ssize_t __pyx_tmp_shape = __pyx_v_oh_view_2d.shape[0];
    Py_ssize_t __pyx_tmp_stride = __pyx_v_oh_view_2d.strides[0];
        if (__pyx_tmp_idx &lt; 0)
            __pyx_tmp_idx += __pyx_tmp_shape;
        __pyx_t_11.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_11.shape[0] = __pyx_v_oh_view_2d.shape[1];
__pyx_t_11.strides[0] = __pyx_v_oh_view_2d.strides[1];
    __pyx_t_11.suboffsets[0] = -1;

__pyx_t_25 = __pyx_v_ii;__pyx_t_26 = (__pyx_v_k - __pyx_f_8ccluster_n_less(__pyx_t_11, __pyx_v_k));if (__pyx_t_25 &lt; 0) __pyx_t_25 += __pyx_v_prob_dist_memview.shape[0];if (__pyx_t_26 &lt; 0) __pyx_t_26 += __pyx_v_prob_dist_memview.shape[1];*((__pyx_t_8ccluster_float32 *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_prob_dist_memview.data + __pyx_t_25 * __pyx_v_prob_dist_memview.strides[0]) ) + __pyx_t_26 * __pyx_v_prob_dist_memview.strides[1]) )) = __pyx_f_8ccluster_emd_c(1, __pyx_v_mp_z_view, __pyx_t_29, __pyx_v_all_values, __pyx_v_all_valuesa, __pyx_v_all_valuesaa, __pyx_v_deltaaa, NULL);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_11, 0);__pyx_t_11.memview = NULL; __pyx_t_11.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_29, 0);__pyx_t_29.memview = NULL; __pyx_t_29.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">0953</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0954</span>:     ## will delete soon. NOGIL PARALLELISM ABOVE :)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0955</span>:     '''</pre>
<pre class="cython line score-0">&#xA0;<span class="">0956</span>:     for i in range(x.shape[0]):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0957</span>:         # load current portion of dataset to memory using the offset.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0958</span>:         # fluff_view[:, :] = numpy.memmap('results/fluffy.npy', mode = 'c', dtype = numpy.float32, shape = (y_shape_river[0], 1), offset = i * y_shape_river[0] * 8)[:]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0959</span>:         t1=time.time()</pre>
<pre class="cython line score-0">&#xA0;<span class="">0960</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0961</span>:         for j in range(y.shape[0]):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0962</span>:             oh_view[:2] = x[i][:]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0963</span>:             oh_view[2:] = y[j][:]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0964</span>:             if(not ((turn and contains_duplicates_turn(oh_view)) or (not turn and contains_duplicates_flop(oh_view)))):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0965</span>:                 oh_z_view[:T_CARDS+1] = oh_view</pre>
<pre class="cython line score-0">&#xA0;<span class="">0966</span>:                 oh_z_view_tmp[:] = oh_z_view</pre>
<pre class="cython line score-0">&#xA0;<span class="">0967</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0968</span>:                 prob_dist_sing_memview[:] = prob_dist_memview[cd][:]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0969</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0970</span>:                 c = 0</pre>
<pre class="cython line score-0">&#xA0;<span class="">0971</span>:                 # print(cd)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0972</span>:                 for k in range(N_CARDS):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0973</span>:                     if(not ((turn and contains_turn(oh_view, k)) or (not turn and contains_flop(oh_view, k)))):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0974</span>:                         ## for each datapoint (float value for winning), find the best center given</pre>
<pre class="cython line score-0">&#xA0;<span class="">0975</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0976</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0977</span>:                         oh_z_view[T_CARDS + 1] = k</pre>
<pre class="cython line score-0">&#xA0;<span class="">0978</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0979</span>:                         # print()</pre>
<pre class="cython line score-0">&#xA0;<span class="">0980</span>:                         # print()</pre>
<pre class="cython line score-0">&#xA0;<span class="">0981</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0982</span>:                         # must sort table cards before using the mapping..</pre>
<pre class="cython line score-0">&#xA0;<span class="">0983</span>:                         #insertion_sort_inplace_cython_int16(oh_z_view[2:])</pre>
<pre class="cython line score-0">&#xA0;<span class="">0984</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0985</span>:                         # print([oh_z_view[xxx] for xxx in range(T_CARDS+2)])</pre>
<pre class="cython line score-0">&#xA0;<span class="">0986</span>:                         # print([oh_z_view_tmp[xxx] for xxx in range(T_CARDS+2)])</pre>
<pre class="cython line score-0">&#xA0;<span class="">0987</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0988</span>:                         if(turn):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0989</span>:                             key = (one &lt;&lt; oh_z_view[0])  | (one &lt;&lt; oh_z_view[1]) | (one &lt;&lt; oh_z_view[2])  | (one &lt;&lt; oh_z_view[3])  | (one &lt;&lt; oh_z_view[4])  | (one &lt;&lt; oh_z_view[5])  | (one &lt;&lt; oh_z_view[6])</pre>
<pre class="cython line score-0">&#xA0;<span class="">0990</span>:                         else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0991</span>:                             key = (one &lt;&lt; oh_z_view[0])  | (one &lt;&lt; oh_z_view[1]) | (one &lt;&lt; oh_z_view[2])  | (one &lt;&lt; oh_z_view[3])  | (one &lt;&lt; oh_z_view[4]) | (one &lt;&lt; oh_z_view[5])</pre>
<pre class="cython line score-0">&#xA0;<span class="">0992</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0993</span>:                         # offset key returned by os.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0994</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0995</span>:                         # prob_dist_memview[cd][c] = emd_c(1, dist[mp[key]], cntrs[lbs[mp[key]]])</pre>
<pre class="cython line score-0">&#xA0;<span class="">0996</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0997</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0998</span>:                         #reward distance from losing.. temp logic until i understand paper</pre>
<pre class="cython line score-0">&#xA0;<span class="">0999</span>:                         prob_dist_sing_memview[c] = emd_c(1, mp_z_view, cntrs[lbs[mp[key]]], all_values, all_valuesa, all_valuesaa, deltaaa)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1000</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1001</span>:                         #print([dist[mp[key]][jjj] for jjj in range(len(dist[mp[key]]))])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1002</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1003</span>:                         #print([cntrs[lbs[mp[key]]][jjj] for jjj in range(len(cntrs[lbs[mp[key]]]))])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1004</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1005</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1006</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1007</span>:                         #oh_z_view[:] = oh_z_view_tmp</pre>
<pre class="cython line score-0">&#xA0;<span class="">1008</span>:                         c += 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">1009</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1010</span>:                 insertion_sort_inplace_cython_float32(prob_dist_sing_memview)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1011</span>:                 prob_dist_memview[cd] = prob_dist_sing_memview[:]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1012</span>:                 #print([prob_dist_memview[cd][jjj] for jjj in range(len(prob_dist_memview[cd]))])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1013</span>:                 cd += 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">1014</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1015</span>:         t2=time.time()</pre>
<pre class="cython line score-0">&#xA0;<span class="">1016</span>:         t = t2-t1</pre>
<pre class="cython line score-0">&#xA0;<span class="">1017</span>:         print('~' + str(t*(x.shape[0] - i)//60) + ' minutes until finished. ' + str(100*(i/x.shape[0]))[:4] + '% done     ', end = '\r')</pre>
<pre class="cython line score-0">&#xA0;<span class="">1018</span>:     '''</pre>
<pre class="cython line score-0">&#xA0;<span class="">1019</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1020</span>:     return dupes</pre>
<pre class='cython code score-1 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);__pyx_t_3 = __Pyx_PyInt_From_npy_int64(__pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1020, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_r = __pyx_t_3;__pyx_t_3 = 0;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">1021</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1022</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1023</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1024</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-115" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1025</span>: cpdef flop_ehs(n, k, threads, new_file=False):</pre>
<pre class='cython code score-115 '>static PyObject *__pyx_pw_8ccluster_13flop_ehs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/static PyObject *__pyx_f_8ccluster_flop_ehs(PyObject *__pyx_v_n, PyObject *__pyx_v_k, CYTHON_UNUSED PyObject *__pyx_v_threads, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_8ccluster_flop_ehs *__pyx_optional_args) {PyObject *__pyx_v_new_file = ((PyObject *)Py_False);PyObject *__pyx_v_adjcntrs = NULL;PyObject *__pyx_v_lbls = NULL;PyArrayObject *__pyx_v_cntrs = 0;__Pyx_memviewslice __pyx_v_lbs = { 0, 0, { 0 }, { 0 }, { 0 } };PyArrayObject *__pyx_v_oh = 0;CYTHON_UNUSED __Pyx_memviewslice __pyx_v_oh_view = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_x = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_y = { 0, 0, { 0 }, { 0 }, { 0 } };PyObject *__pyx_v_dupes = NULL;PyArrayObject *__pyx_v_dist = 0;__Pyx_memviewslice __pyx_v_dist_view = { 0, 0, { 0 }, { 0 }, { 0 } };PyObject *__pyx_v_flop_dist = NULL;__Pyx_LocalBuf_ND __pyx_pybuffernd_cntrs;__Pyx_Buffer __pyx_pybuffer_cntrs;__Pyx_LocalBuf_ND __pyx_pybuffernd_dist;__Pyx_Buffer __pyx_pybuffer_dist;__Pyx_LocalBuf_ND __pyx_pybuffernd_oh;__Pyx_Buffer __pyx_pybuffer_oh;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("flop_ehs", 0);if (__pyx_optional_args) {if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {__pyx_v_new_file = __pyx_optional_args-&gt;new_file;}}__pyx_pybuffer_cntrs.pybuffer.buf = NULL;__pyx_pybuffer_cntrs.refcount = 0;__pyx_pybuffernd_cntrs.data = NULL;__pyx_pybuffernd_cntrs.rcbuffer = &amp;__pyx_pybuffer_cntrs;__pyx_pybuffer_oh.pybuffer.buf = NULL;__pyx_pybuffer_oh.refcount = 0;__pyx_pybuffernd_oh.data = NULL;__pyx_pybuffernd_oh.rcbuffer = &amp;__pyx_pybuffer_oh;__pyx_pybuffer_dist.pybuffer.buf = NULL;__pyx_pybuffer_dist.refcount = 0;__pyx_pybuffernd_dist.data = NULL;__pyx_pybuffernd_dist.rcbuffer = &amp;__pyx_pybuffer_dist;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_4, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_10, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_12, 1);{ PyObject *__pyx_type, *__pyx_value, *__pyx_tb;<span class='pyx_c_api'>__Pyx_PyThreadState_declare__Pyx_PyThreadState_assign__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_cntrs.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.flop_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = 0;goto __pyx_L2;__pyx_L0:;<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_cntrs.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);__pyx_L2:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_adjcntrs);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lbls);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_cntrs);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_lbs, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_oh);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_oh_view, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_x, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_y, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dupes);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_dist);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_dist_view, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_flop_dist);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}/* Python wrapper */static PyObject *__pyx_pw_8ccluster_13flop_ehs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/static PyMethodDef __pyx_mdef_8ccluster_13flop_ehs = {"flop_ehs", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8ccluster_13flop_ehs, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};static PyObject *__pyx_pw_8ccluster_13flop_ehs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {PyObject *__pyx_v_n = 0;PyObject *__pyx_v_k = 0;PyObject *__pyx_v_threads = 0;PyObject *__pyx_v_new_file = 0;#if !CYTHON_METH_FASTCALLCYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);#endifCYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);PyObject *__pyx_r = 0;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("flop_ehs (wrapper)", 0);{#if CYTHON_USE_MODULE_STATEPyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n,&amp;__pyx_n_s_k,&amp;__pyx_n_s_threads,&amp;__pyx_n_s_new_file,0};#elsestatic PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n,&amp;__pyx_n_s_k,&amp;__pyx_n_s_threads,&amp;__pyx_n_s_new_file,0};#endifPyObject* values[4] = {0,0,0,0};values[3] = ((PyObject *)Py_False);if (__pyx_kwds) {Py_ssize_t kw_args;switch (__pyx_nargs) {case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);CYTHON_FALLTHROUGH;case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);CYTHON_FALLTHROUGH;case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);CYTHON_FALLTHROUGH;case  0: break;default: goto __pyx_L5_argtuple_error;}kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);switch (__pyx_nargs) {case  0:if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1025, __pyx_L3_error)</span>else goto __pyx_L5_argtuple_error;CYTHON_FALLTHROUGH;case  1:if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_k)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1025, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flop_ehs", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 1025, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  2:if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_threads)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1025, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flop_ehs", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 1025, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  3:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_new_file);if (value) { values[3] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1025, __pyx_L3_error)</span>}}if (unlikely(kw_args &gt; 0)) {const Py_ssize_t kwd_pos_args = __pyx_nargs;if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "flop_ehs") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1025, __pyx_L3_error)</span>}} else {switch (__pyx_nargs) {case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);break;default: goto __pyx_L5_argtuple_error;}}__pyx_v_n = values[0];__pyx_v_k = values[1];__pyx_v_threads = values[2];__pyx_v_new_file = values[3];}goto __pyx_L4_argument_unpacking_done;__pyx_L5_argtuple_error:;<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flop_ehs", 0, 3, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1025, __pyx_L3_error)</span>__pyx_L3_error:;<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.flop_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return NULL;__pyx_L4_argument_unpacking_done:;__pyx_r = __pyx_pf_8ccluster_12flop_ehs(__pyx_self, __pyx_v_n, __pyx_v_k, __pyx_v_threads, __pyx_v_new_file);/* function exit code */<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}static PyObject *__pyx_pf_8ccluster_12flop_ehs(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_n, PyObject *__pyx_v_k, PyObject *__pyx_v_threads, PyObject *__pyx_v_new_file) {PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("flop_ehs", 0);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);__pyx_t_2.__pyx_n = 1;__pyx_t_2.new_file = __pyx_v_new_file;__pyx_t_1 = __pyx_f_8ccluster_flop_ehs(__pyx_v_n, __pyx_v_k, __pyx_v_threads, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1025, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_r = __pyx_t_1;__pyx_t_1 = 0;goto __pyx_L0;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.flop_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = NULL;__pyx_L0:;<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}__pyx_tuple__49 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_n, __pyx_n_s_k, __pyx_n_s_threads, __pyx_n_s_new_file);<span class='error_goto'> if (unlikely(!__pyx_tuple__49)) __PYX_ERR(0, 1025, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__49);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__49);__pyx_codeobj__50 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__49, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ccluster_pyx, __pyx_n_s_flop_ehs, 1025, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__50)) __PYX_ERR(0, 1025, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8ccluster_13flop_ehs, 0, __pyx_n_s_flop_ehs, NULL, __pyx_n_s_ccluster, __pyx_d, ((PyObject *)__pyx_codeobj__50));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1025, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__51);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_flop_ehs, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1025, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_tuple__51 = <span class='py_c_api'>PyTuple_Pack</span>(1, Py_False);<span class='error_goto'> if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 1025, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__51);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__51);struct __pyx_opt_args_8ccluster_flop_ehs {int __pyx_n;PyObject *new_file;};</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1026</span>:     adjcntrs = numpy.load('results/adjcntrs_TURN.npy', mmap_mode = 'c')</pre>
<pre class='cython code score-21 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1026, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_load);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1026, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1026, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_mmap_mode, __pyx_n_u_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1026, __pyx_L1_error)</span>__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__16, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1026, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_v_adjcntrs = __pyx_t_3;__pyx_t_3 = 0;__pyx_tuple__16 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_results_adjcntrs_TURN_npy);<span class='error_goto'> if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 1026, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__16);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__16);</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1027</span>:     lbls = numpy.load('results/lbls_TURN.npy', mmap_mode = 'c')</pre>
<pre class='cython code score-21 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1027, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_load);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1027, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1027, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_mmap_mode, __pyx_n_u_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1027, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__17, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1027, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_v_lbls = __pyx_t_2;__pyx_t_2 = 0;__pyx_tuple__17 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_results_lbls_TURN_npy);<span class='error_goto'> if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 1027, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__17);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__17);</pre><pre class="cython line score-0">&#xA0;<span class="">1028</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1029</span>:     cdef numpy.ndarray[float32, ndim = 2] cntrs = adjcntrs</pre>
<pre class='cython code score-6 '>if (!(likely(((__pyx_v_adjcntrs) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_adjcntrs, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1029, __pyx_L1_error)</span>__pyx_t_2 = __pyx_v_adjcntrs;<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_cntrs.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_2), &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_float32, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {__pyx_v_cntrs = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_cntrs.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 1029, __pyx_L1_error)</span>} else {__pyx_pybuffernd_cntrs.diminfo[0].strides = __pyx_pybuffernd_cntrs.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_cntrs.diminfo[0].shape = __pyx_pybuffernd_cntrs.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_cntrs.diminfo[1].strides = __pyx_pybuffernd_cntrs.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_cntrs.diminfo[1].shape = __pyx_pybuffernd_cntrs.rcbuffer-&gt;pybuffer.shape[1];}}__pyx_v_cntrs = ((PyArrayObject *)__pyx_t_2);__pyx_t_2 = 0;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1030</span>:     cdef int[:] lbs = lbls</pre>
<pre class='cython code score-2 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_v_lbls, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 1030, __pyx_L1_error)</span>__pyx_v_lbs = __pyx_t_4;__pyx_t_4.memview = NULL;__pyx_t_4.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1031</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1032</span>:     cdef mapp[unsigned long long, int] mp</pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1033</span>:     cdef numpy.ndarray[int16, ndim=1] oh = numpy.empty(k+1, dtype=numpy.int16)</pre>
<pre class='cython code score-34 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1033, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1033, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_k, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1033, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1033, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);__pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1033, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1033, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1033, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1033, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1033, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1033, __pyx_L1_error)</span>__pyx_t_7 = ((PyArrayObject *)__pyx_t_6);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_int16, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_v_oh = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 1033, __pyx_L1_error)</span>} else {__pyx_pybuffernd_oh.diminfo[0].strides = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_oh.diminfo[0].shape = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.shape[0];}}__pyx_t_7 = 0;__pyx_v_oh = ((PyArrayObject *)__pyx_t_6);__pyx_t_6 = 0;</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1034</span>:     cdef int16[:] oh_view = oh[:]</pre>
<pre class='cython code score-3 '>__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_oh), __pyx_slice_);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1034, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1034, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_v_oh_view = __pyx_t_8;__pyx_t_8.memview = NULL;__pyx_t_8.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1035</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1036</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1037</span>:     cdef int16[:, :] x = nump2(n, 2)</pre>
<pre class='cython code score-17 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_nump2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1037, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_1 = NULL;__pyx_t_9 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_1)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_9 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_v_n, __pyx_int_2};__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_9, 2+__pyx_t_9);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1037, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}__pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1037, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_v_x = __pyx_t_10;__pyx_t_10.memview = NULL;__pyx_t_10.data = NULL;</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1038</span>:     cdef int16[:, :] y = nump2(n, k-1)</pre>
<pre class='cython code score-20 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_nump2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1038, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_k, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1038, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = NULL;__pyx_t_9 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_9 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_n, __pyx_t_1};__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_9, 2+__pyx_t_9);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1038, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}__pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1038, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_v_y = __pyx_t_10;__pyx_t_10.memview = NULL;__pyx_t_10.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1039</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1040</span>:     dupes = num_dupes_turn(x, y)</pre>
<pre class='cython code score-0 '>__pyx_t_6 = __pyx_f_8ccluster_num_dupes_turn(__pyx_v_x, __pyx_v_y);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1040, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_v_dupes = __pyx_t_6;__pyx_t_6 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1041</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1042</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1043</span>: </pre>
<pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1044</span>:     cdef numpy.ndarray[float32, ndim=2] dist = numpy.memmap('results/prob_dist_TURN.npy', mode = 'c', dtype = numpy.float32, shape = (x.shape[0] * (y.shape[0] - dupes), n - k - 2))</pre>
<pre class='cython code score-74 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1044, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1044, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1044, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_mode, __pyx_n_u_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1044, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1044, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1044, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1044, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_x.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1044, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_y.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1044, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1044, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1044, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_n, __pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1044, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_5, __pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1044, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1044, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_3);__pyx_t_1 = 0;__pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_shape, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1044, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__14, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1044, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1044, __pyx_L1_error)</span>__pyx_t_11 = ((PyArrayObject *)__pyx_t_5);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_11, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_float32, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {__pyx_v_dist = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 1044, __pyx_L1_error)</span>} else {__pyx_pybuffernd_dist.diminfo[0].strides = __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_dist.diminfo[0].shape = __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_dist.diminfo[1].strides = __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_dist.diminfo[1].shape = __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.shape[1];}}__pyx_t_11 = 0;__pyx_v_dist = ((PyArrayObject *)__pyx_t_5);__pyx_t_5 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1045</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1046</span>:     cdef float32[:, :] dist_view = dist[:]</pre>
<pre class='cython code score-3 '>__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_dist), __pyx_slice_);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1046, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_float32(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 1046, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_v_dist_view = __pyx_t_12;__pyx_t_12.memview = NULL;__pyx_t_12.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1047</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1048</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1049</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1050</span>:     y = nump2(n, k-2)</pre>
<pre class='cython code score-20 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_nump2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1050, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_k, __pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1050, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = NULL;__pyx_t_9 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);__pyx_t_9 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_n, __pyx_t_2};__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_9, 2+__pyx_t_9);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1050, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;}__pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 1050, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_y, 1);__pyx_v_y = __pyx_t_10;__pyx_t_10.memview = NULL;__pyx_t_10.data = NULL;</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1051</span>:     dupes = num_dupes_flop(x, y)</pre>
<pre class='cython code score-1 '>__pyx_t_5 = __pyx_f_8ccluster_num_dupes_flop(__pyx_v_x, __pyx_v_y);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1051, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_dupes, __pyx_t_5);__pyx_t_5 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1052</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1053</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1054</span>:     if(new_file):</pre>
<pre class='cython code score-2 '>__pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_new_file); if (unlikely((__pyx_t_13 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1054, __pyx_L1_error)</span>if (__pyx_t_13) {}</pre><pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1055</span>:         flop_dist = numpy.memmap('results/prob_dist_FLOP.npy', mode = 'w+', dtype = numpy.float32, shape = (x.shape[0] * (y.shape[0] - dupes), n - k - 1))</pre>
<pre class='cython code score-71 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1055, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1055, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1055, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_mode, __pyx_kp_u_w) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1055, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1055, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1055, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1055, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_x.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1055, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_y.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1055, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_2, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1055, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1055, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_n, __pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1055, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1055, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1055, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_3);__pyx_t_2 = 0;__pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_shape, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1055, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_tuple__15, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1055, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_v_flop_dist = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1056</span>:         flop_dist.flush()</pre>
<pre class='cython code score-17 '>__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_flop_dist, __pyx_n_s_flush);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1056, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);__pyx_t_6 = NULL;__pyx_t_9 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {__pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);if (likely(__pyx_t_6)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);__pyx_t_9 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_6, };__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_9, 0+__pyx_t_9);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1056, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1057</span>: </pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1058</span>:     prob_dist_fun(x, y, dist_view, cntrs, lbs, dupes,  False, 0 * (y.shape[0]-dupes))</pre>
<pre class='cython code score-26 '>__pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_float32(((PyObject *)__pyx_v_cntrs), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 1058, __pyx_L1_error)</span>__pyx_t_14 = __Pyx_PyInt_As_npy_int64(__pyx_v_dupes); if (unlikely((__pyx_t_14 == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1058, __pyx_L1_error)</span>__pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_y.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1058, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1058, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_MultiplyCObj</span>(__pyx_int_0, __pyx_t_5, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1058, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;__pyx_t_15 = __Pyx_PyInt_As_npy_int64(__pyx_t_1); if (unlikely((__pyx_t_15 == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1058, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = __pyx_f_8ccluster_prob_dist_fun(__pyx_v_x, __pyx_v_y, __pyx_v_dist_view, __pyx_t_12, __pyx_v_lbs, __pyx_t_14, 0, __pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1058, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_12, 1);__pyx_t_12.memview = NULL; __pyx_t_12.data = NULL;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1059</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1060</span>:     return dupes</pre>
<pre class='cython code score-2 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dupes);__pyx_r = __pyx_v_dupes;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">1061</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1062</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1063</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-100" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1064</span>: cpdef turn_ehs(n, k, threads, new_file=False):</pre>
<pre class='cython code score-100 '>static PyObject *__pyx_pw_8ccluster_15turn_ehs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/static PyObject *__pyx_f_8ccluster_turn_ehs(PyObject *__pyx_v_n, PyObject *__pyx_v_k, CYTHON_UNUSED PyObject *__pyx_v_threads, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_8ccluster_turn_ehs *__pyx_optional_args) {PyObject *__pyx_v_new_file = ((PyObject *)Py_False);PyObject *__pyx_v_adjcntrs = NULL;PyObject *__pyx_v_lbls = NULL;__Pyx_memviewslice __pyx_v_cntrs = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_lbs = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_x = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_memviewslice __pyx_v_y = { 0, 0, { 0 }, { 0 }, { 0 } };PyObject *__pyx_v_dupes = NULL;CYTHON_UNUSED unsigned PY_LONG_LONG __pyx_v_one;PyArrayObject *__pyx_v_dist = 0;__Pyx_memviewslice __pyx_v_dist_view = { 0, 0, { 0 }, { 0 }, { 0 } };PyObject *__pyx_v_prob_dist = NULL;__Pyx_LocalBuf_ND __pyx_pybuffernd_dist;__Pyx_Buffer __pyx_pybuffer_dist;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("turn_ehs", 0);if (__pyx_optional_args) {if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {__pyx_v_new_file = __pyx_optional_args-&gt;new_file;}}__pyx_pybuffer_dist.pybuffer.buf = NULL;__pyx_pybuffer_dist.refcount = 0;__pyx_pybuffernd_dist.data = NULL;__pyx_pybuffernd_dist.rcbuffer = &amp;__pyx_pybuffer_dist;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_4, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_5, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);{ PyObject *__pyx_type, *__pyx_value, *__pyx_tb;<span class='pyx_c_api'>__Pyx_PyThreadState_declare__Pyx_PyThreadState_assign__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.turn_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = 0;goto __pyx_L2;__pyx_L0:;<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer);__pyx_L2:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_adjcntrs);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lbls);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_cntrs, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_lbs, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_x, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_y, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dupes);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_dist);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_dist_view, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_prob_dist);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}/* Python wrapper */static PyObject *__pyx_pw_8ccluster_15turn_ehs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/static PyMethodDef __pyx_mdef_8ccluster_15turn_ehs = {"turn_ehs", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8ccluster_15turn_ehs, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};static PyObject *__pyx_pw_8ccluster_15turn_ehs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {PyObject *__pyx_v_n = 0;PyObject *__pyx_v_k = 0;PyObject *__pyx_v_threads = 0;PyObject *__pyx_v_new_file = 0;#if !CYTHON_METH_FASTCALLCYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);#endifCYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);PyObject *__pyx_r = 0;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("turn_ehs (wrapper)", 0);{#if CYTHON_USE_MODULE_STATEPyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n,&amp;__pyx_n_s_k,&amp;__pyx_n_s_threads,&amp;__pyx_n_s_new_file,0};#elsestatic PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n,&amp;__pyx_n_s_k,&amp;__pyx_n_s_threads,&amp;__pyx_n_s_new_file,0};#endifPyObject* values[4] = {0,0,0,0};values[3] = ((PyObject *)Py_False);if (__pyx_kwds) {Py_ssize_t kw_args;switch (__pyx_nargs) {case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);CYTHON_FALLTHROUGH;case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);CYTHON_FALLTHROUGH;case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);CYTHON_FALLTHROUGH;case  0: break;default: goto __pyx_L5_argtuple_error;}kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);switch (__pyx_nargs) {case  0:if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1064, __pyx_L3_error)</span>else goto __pyx_L5_argtuple_error;CYTHON_FALLTHROUGH;case  1:if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_k)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1064, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("turn_ehs", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 1064, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  2:if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_threads)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1064, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("turn_ehs", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 1064, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  3:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_new_file);if (value) { values[3] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1064, __pyx_L3_error)</span>}}if (unlikely(kw_args &gt; 0)) {const Py_ssize_t kwd_pos_args = __pyx_nargs;if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "turn_ehs") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1064, __pyx_L3_error)</span>}} else {switch (__pyx_nargs) {case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);break;default: goto __pyx_L5_argtuple_error;}}__pyx_v_n = values[0];__pyx_v_k = values[1];__pyx_v_threads = values[2];__pyx_v_new_file = values[3];}goto __pyx_L4_argument_unpacking_done;__pyx_L5_argtuple_error:;<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("turn_ehs", 0, 3, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1064, __pyx_L3_error)</span>__pyx_L3_error:;<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.turn_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return NULL;__pyx_L4_argument_unpacking_done:;__pyx_r = __pyx_pf_8ccluster_14turn_ehs(__pyx_self, __pyx_v_n, __pyx_v_k, __pyx_v_threads, __pyx_v_new_file);/* function exit code */<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}static PyObject *__pyx_pf_8ccluster_14turn_ehs(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_n, PyObject *__pyx_v_k, PyObject *__pyx_v_threads, PyObject *__pyx_v_new_file) {PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("turn_ehs", 0);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);__pyx_t_2.__pyx_n = 1;__pyx_t_2.new_file = __pyx_v_new_file;__pyx_t_1 = __pyx_f_8ccluster_turn_ehs(__pyx_v_n, __pyx_v_k, __pyx_v_threads, 0, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1064, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_r = __pyx_t_1;__pyx_t_1 = 0;goto __pyx_L0;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.turn_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = NULL;__pyx_L0:;<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}__pyx_codeobj__52 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__49, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ccluster_pyx, __pyx_n_s_turn_ehs, 1064, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__52)) __PYX_ERR(0, 1064, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8ccluster_15turn_ehs, 0, __pyx_n_s_turn_ehs, NULL, __pyx_n_s_ccluster, __pyx_d, ((PyObject *)__pyx_codeobj__52));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1064, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__53);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_turn_ehs, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1064, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_tuple__53 = <span class='py_c_api'>PyTuple_Pack</span>(1, Py_False);<span class='error_goto'> if (unlikely(!__pyx_tuple__53)) __PYX_ERR(0, 1064, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__53);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__53);struct __pyx_opt_args_8ccluster_turn_ehs {int __pyx_n;PyObject *new_file;};</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1065</span>:     adjcntrs = numpy.load('results/adjcntrs.npy', mmap_mode = 'c')</pre>
<pre class='cython code score-21 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1065, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_load);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1065, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1065, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_mmap_mode, __pyx_n_u_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1065, __pyx_L1_error)</span>__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__18, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1065, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_v_adjcntrs = __pyx_t_3;__pyx_t_3 = 0;__pyx_tuple__18 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_results_adjcntrs_npy);<span class='error_goto'> if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 1065, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__18);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__18);</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1066</span>:     lbls = numpy.load('results/lbls.npy', mmap_mode = 'c')</pre>
<pre class='cython code score-21 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1066, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_load);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1066, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1066, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_mmap_mode, __pyx_n_u_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1066, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__19, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1066, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_v_lbls = __pyx_t_2;__pyx_t_2 = 0;__pyx_tuple__19 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_results_lbls_npy);<span class='error_goto'> if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 1066, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__19);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__19);</pre><pre class="cython line score-0">&#xA0;<span class="">1067</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1068</span>:     cdef float32[:, :] cntrs = adjcntrs</pre>
<pre class='cython code score-0 '>__pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_float32(__pyx_v_adjcntrs, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 1068, __pyx_L1_error)</span>__pyx_v_cntrs = __pyx_t_4;__pyx_t_4.memview = NULL;__pyx_t_4.data = NULL;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1069</span>:     cdef int[:] lbs = lbls</pre>
<pre class='cython code score-2 '>__pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_int</span>(__pyx_v_lbls, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1069, __pyx_L1_error)</span>__pyx_v_lbs = __pyx_t_5;__pyx_t_5.memview = NULL;__pyx_t_5.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1070</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1071</span>:     cdef int16[:, :] x = nump2(n, 2)</pre>
<pre class='cython code score-17 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_nump2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1071, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = NULL;__pyx_t_6 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_1)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_6 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_v_n, __pyx_int_2};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1071, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}__pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1071, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_x = __pyx_t_7;__pyx_t_7.memview = NULL;__pyx_t_7.data = NULL;</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1072</span>:     cdef int16[:, :] y = nump2(n, k)</pre>
<pre class='cython code score-17 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_nump2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1072, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = NULL;__pyx_t_6 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_1)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_6 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_v_n, __pyx_v_k};__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1072, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}__pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1072, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_v_y = __pyx_t_7;__pyx_t_7.memview = NULL;__pyx_t_7.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1073</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1074</span>:     dupes = num_dupes(x, y)</pre>
<pre class='cython code score-0 '>__pyx_t_2 = __pyx_f_8ccluster_num_dupes(__pyx_v_x, __pyx_v_y);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1074, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_v_dupes = __pyx_t_2;__pyx_t_2 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1075</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1076</span>:     cdef unsigned long long one = 1</pre>
<pre class='cython code score-0 '>__pyx_v_one = 1;</pre><pre class="cython line score-0">&#xA0;<span class="">1077</span>:     cdef unsigned long long keyy</pre>
<pre class="cython line score-0">&#xA0;<span class="">1078</span>: </pre>
<pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1079</span>:     cdef numpy.ndarray[float32, ndim=2] dist = numpy.memmap('results/river_f.npy', mode = 'c', dtype = numpy.float32, shape = (x.shape[0] * (y.shape[0] - dupes), 1))</pre>
<pre class='cython code score-67 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1079, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1079, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1079, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_mode, __pyx_n_u_c) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1079, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1079, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1079, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1079, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_x.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1079, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_y.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1079, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1079, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_8, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1079, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1079, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_int_1);__pyx_t_1 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_shape, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1079, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__12, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1079, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_9) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_9, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1079, __pyx_L1_error)</span>__pyx_t_10 = ((PyArrayObject *)__pyx_t_9);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_10, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_float32, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {__pyx_v_dist = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 1079, __pyx_L1_error)</span>} else {__pyx_pybuffernd_dist.diminfo[0].strides = __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_dist.diminfo[0].shape = __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_dist.diminfo[1].strides = __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_dist.diminfo[1].shape = __pyx_pybuffernd_dist.rcbuffer-&gt;pybuffer.shape[1];}}__pyx_t_10 = 0;__pyx_v_dist = ((PyArrayObject *)__pyx_t_9);__pyx_t_9 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1080</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1081</span>:     cdef float32[:, :] dist_view = dist[:]</pre>
<pre class='cython code score-3 '>__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_dist), __pyx_slice_);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1081, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_float32(__pyx_t_9, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 1081, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_v_dist_view = __pyx_t_4;__pyx_t_4.memview = NULL;__pyx_t_4.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1082</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1083</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1084</span>:     y = nump2(n, k-1)</pre>
<pre class='cython code score-20 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_nump2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1084, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_k, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1084, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = NULL;__pyx_t_6 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_1)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_6 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_v_n, __pyx_t_3};__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1084, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}__pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_t_9, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1084, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_y, 1);__pyx_v_y = __pyx_t_7;__pyx_t_7.memview = NULL;__pyx_t_7.data = NULL;</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1085</span>:     dupes = num_dupes_turn(x, y)</pre>
<pre class='cython code score-1 '>__pyx_t_9 = __pyx_f_8ccluster_num_dupes_turn(__pyx_v_x, __pyx_v_y);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1085, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_dupes, __pyx_t_9);__pyx_t_9 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1086</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1087</span>:     if(new_file):</pre>
<pre class='cython code score-2 '>__pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_new_file); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1087, __pyx_L1_error)</span>if (__pyx_t_11) {}</pre><pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1088</span>:         prob_dist = numpy.memmap('results/prob_dist_TURN.npy', mode = 'w+', dtype = numpy.float32, shape = (x.shape[0] * (y.shape[0] - dupes), n - k - 2))</pre>
<pre class='cython code score-71 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1088, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1088, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1088, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_mode, __pyx_kp_u_w) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1088, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1088, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1088, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1088, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_x.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1088, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_y.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1088, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_8 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1088, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1088, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_n, __pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1088, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_8, __pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1088, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1088, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_3);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_1);__pyx_t_3 = 0;__pyx_t_1 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_shape, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1088, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__14, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1088, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_v_prob_dist = __pyx_t_8;__pyx_t_8 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1089</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1090</span>:         prob_dist.flush()</pre>
<pre class='cython code score-17 '>__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_prob_dist, __pyx_n_s_flush);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1090, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_2 = NULL;__pyx_t_6 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {__pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);if (likely(__pyx_t_2)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);__pyx_t_6 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_2, };__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1090, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1091</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1092</span>: </pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1093</span>:     prob_dist_fun(x, y, dist_view, cntrs, lbs, dupes, True, 0 * (y.shape[0]-dupes))</pre>
<pre class='cython code score-26 '>__pyx_t_12 = __Pyx_PyInt_As_npy_int64(__pyx_v_dupes); if (unlikely((__pyx_t_12 == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1093, __pyx_L1_error)</span>__pyx_t_8 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_y.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1093, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_9 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_8, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1093, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_MultiplyCObj</span>(__pyx_int_0, __pyx_t_9, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1093, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_13 = __Pyx_PyInt_As_npy_int64(__pyx_t_8); if (unlikely((__pyx_t_13 == ((npy_int64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1093, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = __pyx_f_8ccluster_prob_dist_fun(__pyx_v_x, __pyx_v_y, __pyx_v_dist_view, __pyx_v_cntrs, __pyx_v_lbs, __pyx_t_12, 1, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1093, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1094</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1095</span>:     return dupes</pre>
<pre class='cython code score-2 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dupes);__pyx_r = __pyx_v_dupes;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">1096</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1097</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1098</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1099</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1100</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1101</span>: cdef num_dupes_flop(int16[:, :] x, int16[:, :] y):</pre>
<pre class='cython code score-16 '>static PyObject *__pyx_f_8ccluster_num_dupes_flop(__Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y) {CYTHON_UNUSED unsigned PY_LONG_LONG __pyx_v_total;__pyx_t_5numpy_int64_t __pyx_v_j;CYTHON_UNUSED __pyx_t_5numpy_int64_t __pyx_v_x_shape;__pyx_t_5numpy_int64_t __pyx_v_y_shape;PyObject *__pyx_v_cd = NULL;PyArrayObject *__pyx_v_oh = 0;CYTHON_UNUSED __Pyx_memviewslice __pyx_v_oh_view = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_LocalBuf_ND __pyx_pybuffernd_oh;__Pyx_Buffer __pyx_pybuffer_oh;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("num_dupes_flop", 0);__pyx_pybuffer_oh.pybuffer.buf = NULL;__pyx_pybuffer_oh.refcount = 0;__pyx_pybuffernd_oh.data = NULL;__pyx_pybuffernd_oh.rcbuffer = &amp;__pyx_pybuffer_oh;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);{ PyObject *__pyx_type, *__pyx_value, *__pyx_tb;<span class='pyx_c_api'>__Pyx_PyThreadState_declare__Pyx_PyThreadState_assign__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.num_dupes_flop", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = 0;goto __pyx_L2;__pyx_L0:;<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);__pyx_L2:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cd);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_oh);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_oh_view, 1);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1102</span>:     cdef unsigned long long int total = 0</pre>
<pre class='cython code score-0 '>__pyx_v_total = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1103</span>:     cdef numpy.int64_t i, j, c</pre>
<pre class="cython line score-0">&#xA0;<span class="">1104</span>:     cdef double t1, t2, t</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1105</span>:     cdef numpy.int64_t x_shape = x.shape[0]</pre>
<pre class='cython code score-0 '>__pyx_v_x_shape = (__pyx_v_x.shape[0]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1106</span>:     cdef numpy.int64_t y_shape = y.shape[0]</pre>
<pre class='cython code score-0 '>__pyx_v_y_shape = (__pyx_v_y.shape[0]);</pre><pre class="cython line score-0">&#xA0;<span class="">1107</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1108</span>:     cdef mapp[unsigned long long, int] mp</pre>
<pre class="cython line score-0">&#xA0;<span class="">1109</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1110</span>:     cd = 0</pre>
<pre class='cython code score-1 '><span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);__pyx_v_cd = __pyx_int_0;</pre><pre class="cython line score-0">&#xA0;<span class="">1111</span>: </pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1112</span>:     cdef numpy.ndarray[int16, ndim=1] oh = numpy.empty(5, dtype=numpy.int16)</pre>
<pre class='cython code score-30 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1112, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1112, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1112, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1112, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1112, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1112, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__20, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1112, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1112, __pyx_L1_error)</span>__pyx_t_5 = ((PyArrayObject *)__pyx_t_4);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_5, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_int16, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_v_oh = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 1112, __pyx_L1_error)</span>} else {__pyx_pybuffernd_oh.diminfo[0].strides = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_oh.diminfo[0].shape = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.shape[0];}}__pyx_t_5 = 0;__pyx_v_oh = ((PyArrayObject *)__pyx_t_4);__pyx_t_4 = 0;__pyx_tuple__20 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_5);<span class='error_goto'> if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 1112, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__20);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__20);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1113</span>:     cdef int16 [:] oh_view = oh</pre>
<pre class='cython code score-0 '>__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(((PyObject *)__pyx_v_oh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1113, __pyx_L1_error)</span>__pyx_v_oh_view = __pyx_t_6;__pyx_t_6.memview = NULL;__pyx_t_6.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1114</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1115</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1116</span>:     for j in range(y_shape):</pre>
<pre class='cython code score-0 '>__pyx_t_7 = __pyx_v_y_shape;__pyx_t_8 = __pyx_t_7;for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {__pyx_v_j = __pyx_t_9;</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1117</span>:         oh[:2] = x[0][:]</pre>
<pre class='cython code score-11 '>__pyx_t_6.data = __pyx_v_x.data;__pyx_t_6.memview = __pyx_v_x.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_6, 1);{
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_x.strides[0];
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_x.shape[1];
__pyx_t_6.strides[0] = __pyx_v_x.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_6, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_8ccluster_int16, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_8ccluster_int16, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1117, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_oh), __pyx_slice__21, __pyx_t_4) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1117, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_slice__21 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_2, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__21)) __PYX_ERR(0, 1117, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__21);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__21);</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1118</span>:         oh[2:] = y[j][:]</pre>
<pre class='cython code score-11 '>__pyx_t_6.data = __pyx_v_y.data;__pyx_t_6.memview = __pyx_v_y.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_6, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_j;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_y.strides[0];
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_y.shape[1];
__pyx_t_6.strides[0] = __pyx_v_y.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_6, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_8ccluster_int16, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_8ccluster_int16, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1118, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_oh), __pyx_slice__22, __pyx_t_4) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1118, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_slice__22 = <span class='py_c_api'>PySlice_New</span>(__pyx_int_2, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__22)) __PYX_ERR(0, 1118, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__22);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__22);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1119</span>:         if(contains_duplicates_flop(oh)):</pre>
<pre class='cython code score-0 '>__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(((PyObject *)__pyx_v_oh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1119, __pyx_L1_error)</span>__pyx_t_10 = (__pyx_f_8ccluster_contains_duplicates_flop(__pyx_t_6) != 0);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;if (__pyx_t_10) {}}</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1120</span>:             cd += 1</pre>
<pre class='cython code score-3 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_cd, __pyx_int_1, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1120, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_cd, __pyx_t_4);__pyx_t_4 = 0;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1121</span>:     return cd</pre>
<pre class='cython code score-2 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cd);__pyx_r = __pyx_v_cd;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">1122</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1123</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1124</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1125</span>: cdef num_dupes_turn(int16[:, :] x, int16[:, :] y):</pre>
<pre class='cython code score-16 '>static PyObject *__pyx_f_8ccluster_num_dupes_turn(__Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y) {CYTHON_UNUSED unsigned PY_LONG_LONG __pyx_v_total;__pyx_t_5numpy_int64_t __pyx_v_j;CYTHON_UNUSED __pyx_t_5numpy_int64_t __pyx_v_x_shape;__pyx_t_5numpy_int64_t __pyx_v_y_shape;PyObject *__pyx_v_cd = NULL;PyArrayObject *__pyx_v_oh = 0;CYTHON_UNUSED __Pyx_memviewslice __pyx_v_oh_view = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_LocalBuf_ND __pyx_pybuffernd_oh;__Pyx_Buffer __pyx_pybuffer_oh;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("num_dupes_turn", 0);__pyx_pybuffer_oh.pybuffer.buf = NULL;__pyx_pybuffer_oh.refcount = 0;__pyx_pybuffernd_oh.data = NULL;__pyx_pybuffernd_oh.rcbuffer = &amp;__pyx_pybuffer_oh;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);{ PyObject *__pyx_type, *__pyx_value, *__pyx_tb;<span class='pyx_c_api'>__Pyx_PyThreadState_declare__Pyx_PyThreadState_assign__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.num_dupes_turn", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = 0;goto __pyx_L2;__pyx_L0:;<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);__pyx_L2:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cd);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_oh);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_oh_view, 1);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1126</span>:     cdef unsigned long long int total = 0</pre>
<pre class='cython code score-0 '>__pyx_v_total = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1127</span>:     cdef numpy.int64_t i, j, c</pre>
<pre class="cython line score-0">&#xA0;<span class="">1128</span>:     cdef double t1, t2, t</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1129</span>:     cdef numpy.int64_t x_shape = x.shape[0]</pre>
<pre class='cython code score-0 '>__pyx_v_x_shape = (__pyx_v_x.shape[0]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1130</span>:     cdef numpy.int64_t y_shape = y.shape[0]</pre>
<pre class='cython code score-0 '>__pyx_v_y_shape = (__pyx_v_y.shape[0]);</pre><pre class="cython line score-0">&#xA0;<span class="">1131</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1132</span>:     cdef mapp[unsigned long long, int] mp</pre>
<pre class="cython line score-0">&#xA0;<span class="">1133</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1134</span>:     cd = 0</pre>
<pre class='cython code score-1 '><span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);__pyx_v_cd = __pyx_int_0;</pre><pre class="cython line score-0">&#xA0;<span class="">1135</span>: </pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1136</span>:     cdef numpy.ndarray[int16, ndim=1] oh = numpy.empty(6, dtype=numpy.int16)</pre>
<pre class='cython code score-30 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1136, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1136, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1136, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1136, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1136, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1136, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__23, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1136, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1136, __pyx_L1_error)</span>__pyx_t_5 = ((PyArrayObject *)__pyx_t_4);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_5, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_int16, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_v_oh = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 1136, __pyx_L1_error)</span>} else {__pyx_pybuffernd_oh.diminfo[0].strides = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_oh.diminfo[0].shape = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.shape[0];}}__pyx_t_5 = 0;__pyx_v_oh = ((PyArrayObject *)__pyx_t_4);__pyx_t_4 = 0;__pyx_tuple__23 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_6);<span class='error_goto'> if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 1136, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__23);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__23);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1137</span>:     cdef int16 [:] oh_view = oh</pre>
<pre class='cython code score-0 '>__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(((PyObject *)__pyx_v_oh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1137, __pyx_L1_error)</span>__pyx_v_oh_view = __pyx_t_6;__pyx_t_6.memview = NULL;__pyx_t_6.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1138</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1139</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1140</span>:     for j in range(y_shape):</pre>
<pre class='cython code score-0 '>__pyx_t_7 = __pyx_v_y_shape;__pyx_t_8 = __pyx_t_7;for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {__pyx_v_j = __pyx_t_9;</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1141</span>:         oh[:2] = x[0]</pre>
<pre class='cython code score-6 '>__pyx_t_6.data = __pyx_v_x.data;__pyx_t_6.memview = __pyx_v_x.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_6, 1);{
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_x.strides[0];
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_x.shape[1];
__pyx_t_6.strides[0] = __pyx_v_x.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_6, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_8ccluster_int16, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_8ccluster_int16, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1141, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_oh), __pyx_slice__21, __pyx_t_4) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1141, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1142</span>:         oh[2:] = y[j]</pre>
<pre class='cython code score-6 '>__pyx_t_6.data = __pyx_v_y.data;__pyx_t_6.memview = __pyx_v_y.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_6, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_j;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_y.strides[0];
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_y.shape[1];
__pyx_t_6.strides[0] = __pyx_v_y.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_6, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_8ccluster_int16, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_8ccluster_int16, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1142, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_oh), __pyx_slice__22, __pyx_t_4) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1142, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1143</span>:         if(contains_duplicates_turn(oh)):</pre>
<pre class='cython code score-0 '>__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(((PyObject *)__pyx_v_oh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1143, __pyx_L1_error)</span>__pyx_t_10 = (__pyx_f_8ccluster_contains_duplicates_turn(__pyx_t_6) != 0);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;if (__pyx_t_10) {}}</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1144</span>:             cd += 1</pre>
<pre class='cython code score-3 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_cd, __pyx_int_1, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1144, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_cd, __pyx_t_4);__pyx_t_4 = 0;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1145</span>:     return cd</pre>
<pre class='cython code score-2 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cd);__pyx_r = __pyx_v_cd;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">1146</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1147</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1148</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1149</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1150</span>: cdef num_dupes(int16[:, :] x, int16[:, :] y):</pre>
<pre class='cython code score-16 '>static PyObject *__pyx_f_8ccluster_num_dupes(__Pyx_memviewslice __pyx_v_x, __Pyx_memviewslice __pyx_v_y) {CYTHON_UNUSED unsigned PY_LONG_LONG __pyx_v_total;__pyx_t_5numpy_int64_t __pyx_v_j;CYTHON_UNUSED __pyx_t_5numpy_int64_t __pyx_v_x_shape;__pyx_t_5numpy_int64_t __pyx_v_y_shape;PyObject *__pyx_v_cd = NULL;PyArrayObject *__pyx_v_oh = 0;CYTHON_UNUSED __Pyx_memviewslice __pyx_v_oh_view = { 0, 0, { 0 }, { 0 }, { 0 } };__Pyx_LocalBuf_ND __pyx_pybuffernd_oh;__Pyx_Buffer __pyx_pybuffer_oh;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("num_dupes", 0);__pyx_pybuffer_oh.pybuffer.buf = NULL;__pyx_pybuffer_oh.refcount = 0;__pyx_pybuffernd_oh.data = NULL;__pyx_pybuffernd_oh.rcbuffer = &amp;__pyx_pybuffer_oh;/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);{ PyObject *__pyx_type, *__pyx_value, *__pyx_tb;<span class='pyx_c_api'>__Pyx_PyThreadState_declare__Pyx_PyThreadState_assign__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);<span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.num_dupes", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = 0;goto __pyx_L2;__pyx_L0:;<span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer);__pyx_L2:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cd);<span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_oh);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_oh_view, 1);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1151</span>:     cdef unsigned long long int total = 0</pre>
<pre class='cython code score-0 '>__pyx_v_total = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1152</span>:     cdef numpy.int64_t i, j, c</pre>
<pre class="cython line score-0">&#xA0;<span class="">1153</span>:     cdef double t1, t2, t</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1154</span>:     cdef numpy.int64_t x_shape = x.shape[0]</pre>
<pre class='cython code score-0 '>__pyx_v_x_shape = (__pyx_v_x.shape[0]);</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1155</span>:     cdef numpy.int64_t y_shape = y.shape[0]</pre>
<pre class='cython code score-0 '>__pyx_v_y_shape = (__pyx_v_y.shape[0]);</pre><pre class="cython line score-0">&#xA0;<span class="">1156</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1157</span>:     cdef mapp[unsigned long long, int] mp</pre>
<pre class="cython line score-0">&#xA0;<span class="">1158</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1159</span>:     cd = 0</pre>
<pre class='cython code score-1 '><span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);__pyx_v_cd = __pyx_int_0;</pre><pre class="cython line score-0">&#xA0;<span class="">1160</span>: </pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1161</span>:     cdef numpy.ndarray[int16, ndim=1] oh = numpy.empty(7, dtype=numpy.int16)</pre>
<pre class='cython code score-25 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1161, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1161, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1161, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1161, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1161, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1161, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__13, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1161, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1161, __pyx_L1_error)</span>__pyx_t_5 = ((PyArrayObject *)__pyx_t_4);{__Pyx_BufFmt_StackElem __pyx_stack[1];if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_5, &amp;__Pyx_TypeInfo_nn___pyx_t_8ccluster_int16, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {__pyx_v_oh = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.buf = NULL;<span class='error_goto'>__PYX_ERR(0, 1161, __pyx_L1_error)</span>} else {__pyx_pybuffernd_oh.diminfo[0].strides = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_oh.diminfo[0].shape = __pyx_pybuffernd_oh.rcbuffer-&gt;pybuffer.shape[0];}}__pyx_t_5 = 0;__pyx_v_oh = ((PyArrayObject *)__pyx_t_4);__pyx_t_4 = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1162</span>:     cdef int16 [:] oh_view = oh</pre>
<pre class='cython code score-0 '>__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(((PyObject *)__pyx_v_oh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1162, __pyx_L1_error)</span>__pyx_v_oh_view = __pyx_t_6;__pyx_t_6.memview = NULL;__pyx_t_6.data = NULL;</pre><pre class="cython line score-0">&#xA0;<span class="">1163</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1164</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1165</span>:     for j in range(y_shape):</pre>
<pre class='cython code score-0 '>__pyx_t_7 = __pyx_v_y_shape;__pyx_t_8 = __pyx_t_7;for (__pyx_t_9 = 0; __pyx_t_9 &lt; __pyx_t_8; __pyx_t_9+=1) {__pyx_v_j = __pyx_t_9;</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1166</span>:         oh[:2] = x[0]</pre>
<pre class='cython code score-6 '>__pyx_t_6.data = __pyx_v_x.data;__pyx_t_6.memview = __pyx_v_x.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_6, 1);{
    Py_ssize_t __pyx_tmp_idx = 0;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_x.strides[0];
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_x.shape[1];
__pyx_t_6.strides[0] = __pyx_v_x.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_6, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_8ccluster_int16, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_8ccluster_int16, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1166, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_oh), __pyx_slice__21, __pyx_t_4) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1166, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1167</span>:         oh[2:] = y[j]</pre>
<pre class='cython code score-6 '>__pyx_t_6.data = __pyx_v_y.data;__pyx_t_6.memview = __pyx_v_y.memview;__PYX_INC_MEMVIEW(&amp;__pyx_t_6, 1);{
    Py_ssize_t __pyx_tmp_idx = __pyx_v_j;
    Py_ssize_t __pyx_tmp_stride = __pyx_v_y.strides[0];
        __pyx_t_6.data += __pyx_tmp_idx * __pyx_tmp_stride;
}

__pyx_t_6.shape[0] = __pyx_v_y.shape[1];
__pyx_t_6.strides[0] = __pyx_v_y.strides[1];
    __pyx_t_6.suboffsets[0] = -1;

__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_6, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_8ccluster_int16, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_8ccluster_int16, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1167, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_oh), __pyx_slice__22, __pyx_t_4) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1167, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1168</span>:         if(contains_duplicates(oh)):</pre>
<pre class='cython code score-0 '>__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_8ccluster_int16(((PyObject *)__pyx_v_oh), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1168, __pyx_L1_error)</span>__pyx_t_10 = (__pyx_f_8ccluster_contains_duplicates(__pyx_t_6) != 0);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;if (__pyx_t_10) {}}</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1169</span>:             cd += 1</pre>
<pre class='cython code score-3 '>__pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_cd, __pyx_int_1, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1169, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_cd, __pyx_t_4);__pyx_t_4 = 0;</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1170</span>:     return cd</pre>
<pre class='cython code score-2 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cd);__pyx_r = __pyx_v_cd;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">1171</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1172</span>: </pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1173</span>: @cython.boundscheck(False)</pre>
<pre class='cython code score-47 '>/* Python wrapper */static PyObject *__pyx_pw_8ccluster_17river_ehs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/static PyMethodDef __pyx_mdef_8ccluster_17river_ehs = {"river_ehs", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_8ccluster_17river_ehs, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};static PyObject *__pyx_pw_8ccluster_17river_ehs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {PyObject *__pyx_v_n = 0;PyObject *__pyx_v_k = 0;PyObject *__pyx_v_threads = 0;PyObject *__pyx_v_new_file = 0;#if !CYTHON_METH_FASTCALLCYTHON_UNUSED const Py_ssize_t __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);#endifCYTHON_UNUSED PyObject *const *__pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);PyObject *__pyx_r = 0;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("river_ehs (wrapper)", 0);{#if CYTHON_USE_MODULE_STATEPyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n,&amp;__pyx_n_s_k,&amp;__pyx_n_s_threads,&amp;__pyx_n_s_new_file,0};#elsestatic PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n,&amp;__pyx_n_s_k,&amp;__pyx_n_s_threads,&amp;__pyx_n_s_new_file,0};#endifPyObject* values[4] = {0,0,0,0};/* function exit code */<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}static PyObject *__pyx_pf_8ccluster_16river_ehs(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_n, PyObject *__pyx_v_k, PyObject *__pyx_v_threads, PyObject *__pyx_v_new_file) {PyObject *__pyx_v_x = NULL;PyObject *__pyx_v_y = NULL;PyObject *__pyx_v_dupes = NULL;PyObject *__pyx_v_z = NULL;PyObject *__pyx_v_z_f = NULL;PyObject *__pyx_v_chunksize = NULL;PyObject *__pyx_v_executor = NULL;PyObject *__pyx_v_futures = NULL;PyObject *__pyx_v_i = NULL;PyObject *__pyx_v_strt = NULL;PyObject *__pyx_v_stp = NULL;CYTHON_UNUSED PyObject *__pyx_v_output = NULL;PyObject *__pyx_8genexpr2__pyx_v_f = NULL;PyObject *__pyx_r = NULL;<span class='refnanny'>__Pyx_RefNannyDeclarations</span><span class='refnanny'>__Pyx_RefNannySetupContext</span>("river_ehs", 0);/* function exit code */__pyx_L1_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_5, 1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.river_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);__pyx_r = NULL;__pyx_L0:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dupes);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_z);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_z_f);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_chunksize);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_executor);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_futures);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_strt);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_stp);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_output);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr2__pyx_v_f);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return __pyx_r;}__pyx_tuple__54 = <span class='py_c_api'>PyTuple_Pack</span>(17, __pyx_n_s_n, __pyx_n_s_k, __pyx_n_s_threads, __pyx_n_s_new_file, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_dupes, __pyx_n_s_z, __pyx_n_s_z_f, __pyx_n_s_chunksize, __pyx_n_s_executor, __pyx_n_s_futures, __pyx_n_s_i, __pyx_n_s_strt, __pyx_n_s_stp, __pyx_n_s_output, __pyx_n_s_f);<span class='error_goto'> if (unlikely(!__pyx_tuple__54)) __PYX_ERR(0, 1173, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__54);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__54);__pyx_codeobj__55 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 17, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__54, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_ccluster_pyx, __pyx_n_s_river_ehs, 1173, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__55)) __PYX_ERR(0, 1173, __pyx_L1_error)</span>__pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_8ccluster_17river_ehs, 0, __pyx_n_s_river_ehs, NULL, __pyx_n_s_ccluster, __pyx_d, ((PyObject *)__pyx_codeobj__55));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1173, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__56);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_river_ehs, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1173, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_tuple__56 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)Py_False));<span class='error_goto'> if (unlikely(!__pyx_tuple__56)) __PYX_ERR(0, 1173, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__56);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__56);</pre><pre class="cython line score-0">&#xA0;<span class="">1174</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-56" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1175</span>: def river_ehs(n, k, threads, new_file=False):</pre>
<pre class='cython code score-56 '>values[3] = ((PyObject *)((PyObject *)Py_False));if (__pyx_kwds) {Py_ssize_t kw_args;switch (__pyx_nargs) {case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);CYTHON_FALLTHROUGH;case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);CYTHON_FALLTHROUGH;case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);CYTHON_FALLTHROUGH;case  0: break;default: goto __pyx_L5_argtuple_error;}kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);switch (__pyx_nargs) {case  0:if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1173, __pyx_L3_error)</span>else goto __pyx_L5_argtuple_error;CYTHON_FALLTHROUGH;case  1:if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_k)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1173, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("river_ehs", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 1173, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  2:if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_threads)) != 0)) kw_args--;else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1173, __pyx_L3_error)</span>else {<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("river_ehs", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 1173, __pyx_L3_error)</span>}CYTHON_FALLTHROUGH;case  3:if (kw_args &gt; 0) {PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_new_file);if (value) { values[3] = value; kw_args--; }else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1173, __pyx_L3_error)</span>}}if (unlikely(kw_args &gt; 0)) {const Py_ssize_t kwd_pos_args = __pyx_nargs;if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "river_ehs") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1173, __pyx_L3_error)</span>}} else {switch (__pyx_nargs) {case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);CYTHON_FALLTHROUGH;case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);break;default: goto __pyx_L5_argtuple_error;}}__pyx_v_n = values[0];__pyx_v_k = values[1];__pyx_v_threads = values[2];__pyx_v_new_file = values[3];}goto __pyx_L4_argument_unpacking_done;__pyx_L5_argtuple_error:;<span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("river_ehs", 0, 3, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1173, __pyx_L3_error)</span>__pyx_L3_error:;<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.river_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);<span class='refnanny'>__Pyx_RefNannyFinishContext</span>();return NULL;__pyx_L4_argument_unpacking_done:;__pyx_r = __pyx_pf_8ccluster_16river_ehs(__pyx_self, __pyx_v_n, __pyx_v_k, __pyx_v_threads, __pyx_v_new_file);</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1176</span>:     x = nump2(n, 2)</pre>
<pre class='cython code score-16 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_nump2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1176, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_n, __pyx_int_2};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1176, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}__pyx_v_x = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1177</span>:     y = nump2(n, k)</pre>
<pre class='cython code score-16 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_nump2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1177, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {__pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);if (likely(__pyx_t_3)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_n, __pyx_v_k};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1177, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;}__pyx_v_y = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1178</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1179</span>:     dupes = num_dupes(x, y)</pre>
<pre class='cython code score-0 '>__pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_v_x, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>__pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_8ccluster_int16(__pyx_v_y, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1179, __pyx_L1_error)</span>__pyx_t_1 = __pyx_f_8ccluster_num_dupes(__pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1179, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_5, 1);__pyx_t_5.memview = NULL; __pyx_t_5.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;__pyx_v_dupes = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1180</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1181</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1182</span>:     if(new_file):</pre>
<pre class='cython code score-2 '>__pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_new_file); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1182, __pyx_L1_error)</span>if (__pyx_t_7) {}</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1183</span>:         z = numpy.memmap('results/river.npy', mode = 'w+', dtype = numpy.int16, shape = ((y.shape[0] - dupes) * x.shape[0], 3))</pre>
<pre class='cython code score-64 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1183, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1183, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1183, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_mode, __pyx_kp_u_w) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1183, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1183, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int16);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1183, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1183, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1183, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_8, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1183, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1183, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_x, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1183, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1183, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_8, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1183, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1183, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_int_3);__pyx_t_3 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_shape, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1183, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__11, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1183, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_v_z = __pyx_t_9;__pyx_t_9 = 0;</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1184</span>:         z_f = numpy.memmap('results/river_f.npy', mode = 'w+', dtype = numpy.float32, shape = ((y.shape[0] - dupes) * x.shape[0], 1))</pre>
<pre class='cython code score-64 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1184, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_memmap);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1184, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1184, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_mode, __pyx_kp_u_w) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1184, __pyx_L1_error)</span><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1184, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1184, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1184, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1184, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1184, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_2, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1184, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_x, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1184, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1184, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1184, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1184, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);<span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_int_1);__pyx_t_2 = 0;if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_shape, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1184, __pyx_L1_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__12, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1184, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_v_z_f = __pyx_t_8;__pyx_t_8 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1185</span>:         #mp = numpy.memmap('results/map.npy', mode = 'w+', dtype = numpy.ulonglong, shape = ((y.shape[0] - dupes) * x.shape[0], 1))</pre>
<pre class="cython line score-0">&#xA0;<span class="">1186</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1187</span>:         z.flush()</pre>
<pre class='cython code score-17 '>__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_flush);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1187, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_1 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {__pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);if (likely(__pyx_t_1)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_1, };__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1187, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1188</span>:         z_f.flush()</pre>
<pre class='cython code score-17 '>__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z_f, __pyx_n_s_flush);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1188, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_1 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {__pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);if (likely(__pyx_t_1)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_1, };__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1188, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1189</span>:         #mp.flush()</pre>
<pre class="cython line score-0">&#xA0;<span class="">1190</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1191</span>:     chunksize = len(x) // (threads-1)</pre>
<pre class='cython code score-19 '>__pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_x);<span class='error_goto'> if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1191, __pyx_L1_error)</span>__pyx_t_8 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1191, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_threads, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1191, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_1 = <span class='py_c_api'>PyNumber_FloorDivide</span>(__pyx_t_8, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1191, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_v_chunksize = __pyx_t_1;__pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1192</span>: </pre>
<pre class="cython line score-86" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1193</span>:     with concurrent.futures.ProcessPoolExecutor() as executor:</pre>
<pre class='cython code score-86 '>/*with:*/ {<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_concurrent);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1193, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_futures);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1193, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_ProcessPoolExecutor);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1193, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;__pyx_t_8 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {__pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);if (likely(__pyx_t_8)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_8, };__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1193, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;}__pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_1, __pyx_n_s_exit);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1193, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_1, __pyx_n_s_enter);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1193, __pyx_L4_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_2 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {__pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);if (likely(__pyx_t_2)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_2, };__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1193, __pyx_L4_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;}__pyx_t_8 = __pyx_t_9;__pyx_t_9 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;/*try:*/ {{/*try:*/ {__pyx_v_executor = __pyx_t_8;__pyx_t_8 = 0;}<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;goto __pyx_L13_try_end;__pyx_L8_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17); __pyx_t_17 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18); __pyx_t_18 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_5, 1);__pyx_t_5.memview = NULL; __pyx_t_5.data = NULL;__PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_6, 1);__pyx_t_6.memview = NULL; __pyx_t_6.data = NULL;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;/*except:*/ {<span class='pyx_c_api'>__Pyx_AddTraceback</span>("ccluster.river_ehs", __pyx_clineno, __pyx_lineno, __pyx_filename);if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_8, &amp;__pyx_t_1, &amp;__pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1193, __pyx_L10_except_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_3 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_t_8, __pyx_t_1, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1193, __pyx_L10_except_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_3, NULL);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 1193, __pyx_L10_except_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);__pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_20);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;if (__pyx_t_7 &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1193, __pyx_L10_except_error)</span>__pyx_t_21 = (!__pyx_t_7);if (unlikely(__pyx_t_21)) {<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);<span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_t_8, __pyx_t_1, __pyx_t_9);__pyx_t_8 = 0; __pyx_t_1 = 0; __pyx_t_9 = 0; <span class='error_goto'>__PYX_ERR(0, 1193, __pyx_L10_except_error)</span>}<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;goto __pyx_L9_exception_handled;}__pyx_L10_except_error:;<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_12);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_13);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_14);<span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_12, __pyx_t_13, __pyx_t_14);goto __pyx_L1_error;__pyx_L9_exception_handled:;<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_12);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_13);<span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_14);<span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_12, __pyx_t_13, __pyx_t_14);__pyx_L13_try_end:;}}/*finally:*/ {/*normal exit:*/{if (__pyx_t_11) {__pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_tuple__24, NULL);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1193, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;}goto __pyx_L7;}__pyx_L7:;}goto __pyx_L25;__pyx_L4_error:;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;goto __pyx_L1_error;__pyx_L25:;}__pyx_tuple__24 = <span class='py_c_api'>PyTuple_Pack</span>(3, Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 1193, __pyx_L1_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__24);<span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__24);</pre><pre class="cython line score-0">&#xA0;<span class="">1194</span>:         # change threads to appropriate number of workers for your system</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1195</span>:         futures = []</pre>
<pre class='cython code score-5 '>__pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1195, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_v_futures = ((PyObject*)__pyx_t_8);__pyx_t_8 = 0;</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1196</span>:         for i in range(threads-1):</pre>
<pre class='cython code score-51 '>__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_threads, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1196, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1196, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {__pyx_t_8 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_10 = 0;__pyx_t_15 = NULL;} else {__pyx_t_10 = -1; __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1196, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1196, __pyx_L8_error)</span>}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;for (;;) {if (likely(!__pyx_t_15)) {if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8))) {if (__pyx_t_10 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_8)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_8, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_10++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1196, __pyx_L8_error)</span>#else__pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1196, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);#endif} else {if (__pyx_t_10 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_8)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_8, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_10++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1196, __pyx_L8_error)</span>#else__pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_8, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1196, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);#endif}} else {__pyx_t_1 = __pyx_t_15(__pyx_t_8);if (unlikely(!__pyx_t_1)) {PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();if (exc_type) {if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();else <span class='error_goto'>__PYX_ERR(0, 1196, __pyx_L8_error)</span>}break;}<span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);__pyx_t_1 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1197</span>:             strt = i * chunksize</pre>
<pre class='cython code score-6 '>__pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_i, __pyx_v_chunksize);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1197, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_strt, __pyx_t_1);__pyx_t_1 = 0;</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1198</span>:             stp = ((i + 1) * chunksize) if i != (threads - 2) else len(x)</pre>
<pre class='cython code score-30 '>__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_threads, __pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1198, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_i, __pyx_t_9, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1198, __pyx_L8_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1198, __pyx_L8_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;if (__pyx_t_7) {__pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1198, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_v_chunksize);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1198, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;__pyx_t_1 = __pyx_t_9;__pyx_t_9 = 0;} else {__pyx_t_16 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_x);<span class='error_goto'> if (unlikely(__pyx_t_16 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1198, __pyx_L8_error)</span>__pyx_t_9 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_16);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1198, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);__pyx_t_1 = __pyx_t_9;__pyx_t_9 = 0;}<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_stp, __pyx_t_1);__pyx_t_1 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1199</span>: </pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1200</span>:             futures.append(executor.submit(do_calc, strt * (y.shape[0]-dupes) * 3 * 2, x[strt:stp], y, dupes))</pre>
<pre class='cython code score-49 '>__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_executor, __pyx_n_s_submit);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1200, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_do_calc);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1200, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1200, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_17 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1200, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_17, __pyx_v_dupes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1200, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;__pyx_t_17 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_strt, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1200, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_MultiplyObjC</span>(__pyx_t_17, __pyx_int_3, 3, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1200, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;__pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyInt_MultiplyObjC</span>(__pyx_t_3, __pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 1200, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_17);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_x, 0, 0, &amp;__pyx_v_strt, &amp;__pyx_v_stp, NULL, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1200, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_18 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {__pyx_t_18 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);if (likely(__pyx_t_18)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_18);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[6] = {__pyx_t_18, __pyx_t_2, __pyx_t_17, __pyx_t_3, __pyx_v_y, __pyx_v_dupes};__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_4, 5+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18); __pyx_t_18 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_17); __pyx_t_17 = 0;<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1200, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;}__pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_futures, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_19 == ((int)-1))) __PYX_ERR(0, 1200, __pyx_L8_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1201</span>:         concurrent.futures.wait(futures)</pre>
<pre class='cython code score-23 '><span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_concurrent);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1201, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_futures);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1201, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;__pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_wait);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1201, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;__pyx_t_9 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {__pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);if (likely(__pyx_t_9)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_v_futures};__pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1201, __pyx_L8_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1202</span>: </pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1203</span>:         output = [f.result() for f in futures]</pre>
<pre class='cython code score-33 '>{ /* enter inner scope */__pyx_t_8 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1203, __pyx_L18_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);__pyx_t_1 = __pyx_v_futures; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_10 = 0;for (;;) {if (__pyx_t_10 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;#if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS__pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_10++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1203, __pyx_L18_error)</span>#else__pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1203, __pyx_L18_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);#endif<span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr2__pyx_v_f, __pyx_t_9);__pyx_t_9 = 0;__pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_8genexpr2__pyx_v_f, __pyx_n_s_result);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1203, __pyx_L18_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);__pyx_t_17 = NULL;__pyx_t_4 = 0;if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {__pyx_t_17 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);if (likely(__pyx_t_17)) {PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);<span class='pyx_macro_api'>__Pyx_INCREF</span>(function);<span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);__pyx_t_4 = 1;}}{PyObject *__pyx_callargs[1] = {__pyx_t_17, };__pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17); __pyx_t_17 = 0;<span class='error_goto'>if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1203, __pyx_L18_error)</span><span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;}if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_8, (PyObject*)__pyx_t_9))) <span class='error_goto'>__PYX_ERR(0, 1203, __pyx_L18_error)</span><span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;}<span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr2__pyx_v_f); __pyx_8genexpr2__pyx_v_f = 0;goto __pyx_L21_exit_scope;__pyx_L18_error:;<span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr2__pyx_v_f); __pyx_8genexpr2__pyx_v_f = 0;goto __pyx_L8_error;__pyx_L21_exit_scope:;} /* exit inner scope */__pyx_v_output = ((PyObject*)__pyx_t_8);__pyx_t_8 = 0;</pre><pre class="cython line score-0">&#xA0;<span class="">1204</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1205</span>:     return dupes</pre>
<pre class='cython code score-2 '><span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);<span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dupes);__pyx_r = __pyx_v_dupes;goto __pyx_L0;</pre><pre class="cython line score-0">&#xA0;<span class="">1206</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1207</span>: </pre>
</div></body></html>
